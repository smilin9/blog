{"meta":{"version":1,"warehouse":"4.0.1"},"models":{"Asset":[{"_id":"node_modules/hexo-theme-landscape/source/fancybox/jquery.fancybox.min.css","path":"fancybox/jquery.fancybox.min.css","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/fancybox/jquery.fancybox.min.js","path":"fancybox/jquery.fancybox.min.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/js/script.js","path":"js/script.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/js/jquery-3.4.1.min.js","path":"js/jquery-3.4.1.min.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/css/fonts/FontAwesome.otf","path":"css/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/css/fonts/fontawesome-webfont.eot","path":"css/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/css/fonts/fontawesome-webfont.svg","path":"css/fonts/fontawesome-webfont.svg","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/css/fonts/fontawesome-webfont.ttf","path":"css/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/css/fonts/fontawesome-webfont.woff","path":"css/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/css/fonts/fontawesome-webfont.woff2","path":"css/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/css/images/banner.jpg","path":"css/images/banner.jpg","modified":0,"renderable":1},{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"themes/maupassant/source/css/copycode.scss","path":"css/copycode.scss","modified":0,"renderable":1},{"_id":"themes/maupassant/source/css/copyright.scss","path":"css/copyright.scss","modified":0,"renderable":1},{"_id":"themes/maupassant/source/css/donate.scss","path":"css/donate.scss","modified":0,"renderable":1},{"_id":"themes/maupassant/source/css/search.scss","path":"css/search.scss","modified":0,"renderable":1},{"_id":"themes/maupassant/source/css/style.scss","path":"css/style.scss","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/alipay.svg","path":"img/alipay.svg","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/bitcoin.svg","path":"img/bitcoin.svg","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/github.svg","path":"img/github.svg","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/paypal.svg","path":"img/paypal.svg","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/wechat.svg","path":"img/wechat.svg","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/like.svg","path":"img/like.svg","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/codeblock-resizer.js","path":"js/codeblock-resizer.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/copycode.js","path":"js/copycode.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/copyright.js","path":"js/copyright.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/donate.js","path":"js/donate.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/fancybox.js","path":"js/fancybox.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/love.js","path":"js/love.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/search.js","path":"js/search.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/share.js","path":"js/share.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/smartresize.js","path":"js/smartresize.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/totop.js","path":"js/totop.js","modified":0,"renderable":1},{"_id":"source/favicon.ico","path":"favicon.ico","modified":0,"renderable":0},{"_id":"themes/butterfly/source/img/404.jpg","path":"img/404.jpg","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/favicon.png","path":"img/favicon.png","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/friend_404.gif","path":"img/friend_404.gif","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/main.js","path":"js/main.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/utils.js","path":"js/utils.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/tw_cn.js","path":"js/tw_cn.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/css/index.styl","path":"css/index.styl","modified":0,"renderable":1},{"_id":"themes/butterfly/source/css/var.styl","path":"css/var.styl","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/search/local-search.js","path":"js/search/local-search.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/search/algolia.js","path":"js/search/algolia.js","modified":0,"renderable":1}],"Cache":[{"_id":"source/_posts/hello-world.md","hash":"fa35b9a94c73fdeb95054b79c30fcd7a27b3369a","modified":1653725908424},{"_id":"node_modules/hexo-theme-landscape/package.json","hash":"9a94875cbf4c27fbe2e63da0496242addc6d2876","modified":1651245881801},{"_id":"node_modules/hexo-theme-landscape/languages/de.yml","hash":"3ebf0775abbee928c8d7bda943c191d166ded0d3","modified":1651245883470},{"_id":"node_modules/hexo-theme-landscape/LICENSE","hash":"c480fce396b23997ee23cc535518ffaaf7f458f8","modified":1651245880324},{"_id":"node_modules/hexo-theme-landscape/README.md","hash":"d2772ece6d4422ccdaa0359c3e07588834044052","modified":1651245881802},{"_id":"node_modules/hexo-theme-landscape/_config.yml","hash":"b608c1f1322760dce9805285a602a95832730a2e","modified":1651245883469},{"_id":"node_modules/hexo-theme-landscape/languages/hu.yml","hash":"284d557130bf54a74e7dcef9d42096130e4d9550","modified":1651245883474},{"_id":"node_modules/hexo-theme-landscape/languages/es.yml","hash":"76edb1171b86532ef12cfd15f5f2c1ac3949f061","modified":1651245883472},{"_id":"node_modules/hexo-theme-landscape/languages/en.yml","hash":"3083f319b352d21d80fc5e20113ddf27889c9d11","modified":1651245883471},{"_id":"node_modules/hexo-theme-landscape/languages/fr.yml","hash":"415e1c580ced8e4ce20b3b0aeedc3610341c76fb","modified":1651245883473},{"_id":"node_modules/hexo-theme-landscape/languages/it.yml","hash":"89b7d91306b2c1a0f3ac023b657bf974f798a1e8","modified":1651245883475},{"_id":"node_modules/hexo-theme-landscape/languages/ja.yml","hash":"a73e1b9c80fd6e930e2628b393bfe3fb716a21a9","modified":1651245883476},{"_id":"node_modules/hexo-theme-landscape/languages/ko.yml","hash":"881d6a0a101706e0452af81c580218e0bfddd9cf","modified":1651245883477},{"_id":"node_modules/hexo-theme-landscape/languages/nl.yml","hash":"12ed59faba1fc4e8cdd1d42ab55ef518dde8039c","modified":1651245883479},{"_id":"node_modules/hexo-theme-landscape/languages/mn.yml","hash":"2e7523951072a9403ead3840ad823edd1084c116","modified":1651245883478},{"_id":"node_modules/hexo-theme-landscape/languages/no.yml","hash":"965a171e70347215ec726952e63f5b47930931ef","modified":1651245883481},{"_id":"node_modules/hexo-theme-landscape/languages/ru.yml","hash":"4fda301bbd8b39f2c714e2c934eccc4b27c0a2b0","modified":1651245883482},{"_id":"node_modules/hexo-theme-landscape/languages/pt.yml","hash":"57d07b75d434fbfc33b0ddb543021cb5f53318a8","modified":1651245883481},{"_id":"node_modules/hexo-theme-landscape/languages/tr.yml","hash":"a1cdbfa17682d7a971de8ab8588bf57c74224b5b","modified":1651245883485},{"_id":"node_modules/hexo-theme-landscape/languages/zh-CN.yml","hash":"1efd95774f401c80193eac6ee3f1794bfe93dc5a","modified":1651245883486},{"_id":"node_modules/hexo-theme-landscape/languages/zh-TW.yml","hash":"53ce3000c5f767759c7d2c4efcaa9049788599c3","modified":1651245883487},{"_id":"node_modules/hexo-theme-landscape/layout/category.ejs","hash":"765426a9c8236828dc34759e604cc2c52292835a","modified":1651245880338},{"_id":"node_modules/hexo-theme-landscape/layout/archive.ejs","hash":"2703b07cc8ac64ae46d1d263f4653013c7e1666b","modified":1651245880334},{"_id":"node_modules/hexo-theme-landscape/scripts/fancybox.js","hash":"c857d7a5e4a5d71c743a009c5932bf84229db428","modified":1651245881652},{"_id":"node_modules/hexo-theme-landscape/layout/page.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1651245880349},{"_id":"node_modules/hexo-theme-landscape/layout/post.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1651245880350},{"_id":"node_modules/hexo-theme-landscape/layout/index.ejs","hash":"aa1b4456907bdb43e629be3931547e2d29ac58c8","modified":1651245880345},{"_id":"node_modules/hexo-theme-landscape/layout/tag.ejs","hash":"eaa7b4ccb2ca7befb90142e4e68995fb1ea68b2e","modified":1651245880355},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/archive-post.ejs","hash":"c7a71425a946d05414c069ec91811b5c09a92c47","modified":1651245880329},{"_id":"node_modules/hexo-theme-landscape/layout/layout.ejs","hash":"0d1765036e4874500e68256fedb7470e96eeb6ee","modified":1651245880346},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/footer.ejs","hash":"3656eb692254346671abc03cb3ba1459829e0dce","modified":1651245880340},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/archive.ejs","hash":"7cb70a7a54f8c7ae49b10d1f37c0a9b74eab8826","modified":1651245880330},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/after-footer.ejs","hash":"414914ebb159fac1922b056b905e570ac7521925","modified":1651245880328},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/gauges-analytics.ejs","hash":"21a1e2a3907d1a3dad1cd0ab855fe6735f233c74","modified":1651245880341},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/mobile-nav.ejs","hash":"e952a532dfc583930a666b9d4479c32d4a84b44e","modified":1651245880347},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/google-analytics.ejs","hash":"2ea7442ea1e1a8ab4e41e26c563f58413b59a3d0","modified":1651245880342},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/article.ejs","hash":"dfd555c00e85ffc4207c88968d12b219c1f086ec","modified":1651245880335},{"_id":"node_modules/hexo-theme-landscape/layout/_widget/archive.ejs","hash":"beb4a86fcc82a9bdda9289b59db5a1988918bec3","modified":1651245880332},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/head.ejs","hash":"f215d92a882247a7cc5ea80b241bedfcec0ea6ca","modified":1651245880343},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/header.ejs","hash":"c1acd247e14588cdf101a69460cb8319c18cd078","modified":1651245880344},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/sidebar.ejs","hash":"930da35cc2d447a92e5ee8f835735e6fd2232469","modified":1651245880353},{"_id":"node_modules/hexo-theme-landscape/layout/_widget/recent_posts.ejs","hash":"60c4b012dcc656438ff59997e60367e5a21ab746","modified":1651245880352},{"_id":"node_modules/hexo-theme-landscape/layout/_widget/category.ejs","hash":"dd1e5af3c6af3f5d6c85dfd5ca1766faed6a0b05","modified":1651245880337},{"_id":"node_modules/hexo-theme-landscape/layout/_widget/tagcloud.ejs","hash":"b4a2079101643f63993dcdb32925c9b071763b46","modified":1651245880356},{"_id":"node_modules/hexo-theme-landscape/source/css/_extend.styl","hash":"222fbe6d222531d61c1ef0f868c90f747b1c2ced","modified":1651245882042},{"_id":"node_modules/hexo-theme-landscape/source/css/_variables.styl","hash":"581b0cbefdaa5f894922133989dd2d3bf71ded79","modified":1651245882045},{"_id":"node_modules/hexo-theme-landscape/layout/_widget/tag.ejs","hash":"2de380865df9ab5f577f7d3bcadf44261eb5faae","modified":1651245880355},{"_id":"node_modules/hexo-theme-landscape/source/css/style.styl","hash":"9c451e5efd72c5bb8b56e8c2b94be731e99db05b","modified":1651245882063},{"_id":"node_modules/hexo-theme-landscape/source/fancybox/jquery.fancybox.min.css","hash":"1be9b79be02a1cfc5d96c4a5e0feb8f472babd95","modified":1651245880326},{"_id":"node_modules/hexo-theme-landscape/source/js/script.js","hash":"998ed4c5b147e1299bf62beebf33514474f28112","modified":1651245881800},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/post/category.ejs","hash":"c6bcd0e04271ffca81da25bcff5adf3d46f02fc0","modified":1651245880336},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/post/date.ejs","hash":"f1458584b679545830b75bef2526e2f3eb931045","modified":1651245880339},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/post/gallery.ejs","hash":"3d9d81a3c693ff2378ef06ddb6810254e509de5b","modified":1651245880340},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/post/title.ejs","hash":"4d7e62574ddf46de9b41605fe3140d77b5ddb26d","modified":1651245880357},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/post/nav.ejs","hash":"16a904de7bceccbb36b4267565f2215704db2880","modified":1651245880348},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/post/tag.ejs","hash":"2fcb0bf9c8847a644167a27824c9bb19ac74dd14","modified":1651245880354},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/archive.styl","hash":"db15f5677dc68f1730e82190bab69c24611ca292","modified":1651245882047},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/comment.styl","hash":"79d280d8d203abb3bd933ca9b8e38c78ec684987","modified":1651245882050},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/footer.styl","hash":"e35a060b8512031048919709a8e7b1ec0e40bc1b","modified":1651245882051},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/article.styl","hash":"80759482d07063c091e940f964a1cf6693d3d406","modified":1651245882049},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/highlight.styl","hash":"bf4e7be1968dad495b04e83c95eac14c4d0ad7c0","modified":1651245882057},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/header.styl","hash":"85ab11e082f4dd86dde72bed653d57ec5381f30c","modified":1651245882055},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/sidebar-bottom.styl","hash":"8fd4f30d319542babfd31f087ddbac550f000a8a","modified":1651245882061},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/mobile.styl","hash":"a399cf9e1e1cec3e4269066e2948d7ae5854d745","modified":1651245882059},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/sidebar-aside.styl","hash":"890349df5145abf46ce7712010c89237900b3713","modified":1651245882060},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/sidebar.styl","hash":"404ec059dc674a48b9ab89cd83f258dec4dcb24d","modified":1651245882062},{"_id":"node_modules/hexo-theme-landscape/source/css/_util/grid.styl","hash":"0bf55ee5d09f193e249083602ac5fcdb1e571aed","modified":1651245882054},{"_id":"node_modules/hexo-theme-landscape/source/css/_util/mixin.styl","hash":"44f32767d9fd3c1c08a60d91f181ee53c8f0dbb3","modified":1651245882058},{"_id":"node_modules/hexo-theme-landscape/source/fancybox/jquery.fancybox.min.js","hash":"6181412e73966696d08e1e5b1243a572d0f22ba6","modified":1651245881798},{"_id":"node_modules/hexo-theme-landscape/source/js/jquery-3.4.1.min.js","hash":"88523924351bac0b5d560fe0c5781e2556e7693d","modified":1651245881689},{"_id":"node_modules/hexo-theme-landscape/source/css/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1651245883426},{"_id":"node_modules/hexo-theme-landscape/source/css/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1651245883465},{"_id":"node_modules/hexo-theme-landscape/source/css/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1651245880568},{"_id":"node_modules/hexo-theme-landscape/source/css/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1651245883186},{"_id":"node_modules/hexo-theme-landscape/source/css/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1651245882040},{"_id":"node_modules/hexo-theme-landscape/source/css/images/banner.jpg","hash":"f44aa591089fcb3ec79770a1e102fd3289a7c6a6","modified":1651245881650},{"_id":"node_modules/hexo-theme-landscape/source/css/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1651245882600},{"_id":"public/2022/04/30/hello-world/index.html","hash":"ba6da1c7a542b0a1e32b4e923382735ae3efe0d4","modified":1653843541402},{"_id":"public/index.html","hash":"f0cf502d26b84e87fe4bc9eec4238b5b60614c69","modified":1653843649936},{"_id":"public/archives/index.html","hash":"9bd8d71185efe778541d79df7db7e4279adf00cf","modified":1653843649936},{"_id":"public/archives/2022/index.html","hash":"0fd0cd43aa1e969222ddef0f761c7a485086395d","modified":1653843649936},{"_id":"public/archives/2022/04/index.html","hash":"44cd9f06ae7a128ab248964a3ba01953fc1f0d2e","modified":1653843649936},{"_id":"public/css/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1651310250151},{"_id":"public/fancybox/jquery.fancybox.min.css","hash":"1be9b79be02a1cfc5d96c4a5e0feb8f472babd95","modified":1651310250151},{"_id":"public/js/script.js","hash":"998ed4c5b147e1299bf62beebf33514474f28112","modified":1651310250151},{"_id":"public/css/style.css","hash":"4735627811dd6de51dd1a3c7da9e62102d98c355","modified":1651327390384},{"_id":"public/fancybox/jquery.fancybox.min.js","hash":"6181412e73966696d08e1e5b1243a572d0f22ba6","modified":1651310250151},{"_id":"public/js/jquery-3.4.1.min.js","hash":"88523924351bac0b5d560fe0c5781e2556e7693d","modified":1651310250151},{"_id":"public/css/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1651310250151},{"_id":"public/css/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1651310250151},{"_id":"public/css/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1651310250151},{"_id":"public/css/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1651310250151},{"_id":"public/css/images/banner.jpg","hash":"f44aa591089fcb3ec79770a1e102fd3289a7c6a6","modified":1651310250151},{"_id":"public/css/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1651310250151},{"_id":"source/CNAME","hash":"28dcf47201d9a196691c9988c8392b0fb316c8de","modified":1651258024573},{"_id":"public/CNAME","hash":"28dcf47201d9a196691c9988c8392b0fb316c8de","modified":1651313549703},{"_id":"themes/sky/layout/_partial/categorys.ejs","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1651320173699},{"_id":"themes/sky/_config.yml","hash":"bb56f282eadaaf097a7d92b60f8cac6f63844307","modified":1651320173696},{"_id":"themes/sky/languages/default.yml","hash":"fcac8318f44201d3047869b6c795886bf4d7a380","modified":1651320173697},{"_id":"themes/sky/languages/en.yml","hash":"1cbbb9cac7753903aa55c739d8805cd3d4e7cae0","modified":1651320173697},{"_id":"themes/sky/README.md","hash":"09dbed10c11d9b553a2c6f4cb94d52a92059bda7","modified":1651320173696},{"_id":"themes/sky/languages/zh-CN.yml","hash":"fcac8318f44201d3047869b6c795886bf4d7a380","modified":1651320173698},{"_id":"themes/sky/layout/about.ejs","hash":"76b3601cb6103746d5e630209cd8b266e32991c3","modified":1651320173702},{"_id":"themes/sky/layout/categories.ejs","hash":"8f948a44125620fa62ca24887eca515c6cf9d64e","modified":1651320173703},{"_id":"themes/sky/layout/tags.ejs","hash":"926231b0bb373c67fd5ced2bd2c7a74df36429d4","modified":1651320173705},{"_id":"themes/sky/layout/index.ejs","hash":"4e3a2e8b3972e74faa530a9c6a2f5f757ccc5535","modified":1651320173703},{"_id":"themes/sky/layout/_partial/copyright.ejs","hash":"6181b792dcbab376880826ef7d988682201dfddd","modified":1651320173699},{"_id":"themes/sky/layout/archive.ejs","hash":"76e4a586a1651e11dd68184b8d57280ec518c487","modified":1651320173703},{"_id":"themes/sky/layout/post.ejs","hash":"28fc2e70f5a8c98d5177b4639e6adb19b63c410d","modified":1651320173704},{"_id":"themes/sky/layout/_partial/header.ejs","hash":"f7ce3e651ef299ba10bbf0fd2e67561466faca12","modified":1651320173700},{"_id":"themes/sky/layout/_partial/head.ejs","hash":"59c2f21b2757fe9e225cc1c1587b84ce079abab0","modified":1651320173700},{"_id":"themes/sky/layout/_partial/paginator.ejs","hash":"8390ff839e440ad6bd458543ed5b3b0e52bf7e78","modified":1651320173701},{"_id":"themes/sky/layout/_partial/social.ejs","hash":"1193ec44e5063e066c3e6b6551be25e4d05c20f5","modified":1651320173702},{"_id":"themes/sky/layout/_partial/mobile-header.ejs","hash":"c6865a03f907829f9043680265b6c6f029c146d9","modified":1651320173701},{"_id":"themes/sky/layout/_partial/toc.ejs","hash":"152da61440963d08fe17190d3657907b3fb8d006","modified":1651320173702},{"_id":"themes/sky/layout/layout.ejs","hash":"c1601dcfa435ec603a3de0422f0d543c15c806a0","modified":1651320173704},{"_id":"themes/sky/source/css/_reset.scss","hash":"05572018b6da81f21a9acfd12a73226a16a6d036","modified":1651320173711},{"_id":"themes/sky/source/css/gitment.css","hash":"c6951e8c4d709f1917c2cf78b9777d9610cb6532","modified":1651320173713},{"_id":"themes/sky/source/css/style.scss","hash":"69e0c5fe524ded6d1d69e9d66d3ff988de469571","modified":1651320173714},{"_id":"themes/sky/source/css/_variables.scss","hash":"e12dd6adf8777df4839491c6f8d6ee39e288afad","modified":1651320173712},{"_id":"themes/sky/source/css/_partial/_paginator.scss","hash":"3936f82d0728589d95a0243b798771bb3278f621","modified":1651320173708},{"_id":"themes/sky/source/css/_partial/_header.scss","hash":"4490dd9e14887e0d194d48a457e16e3700181276","modified":1651320173707},{"_id":"themes/sky/source/css/_partial/_post.scss","hash":"b0d0b07f8dc4c17f0f435124f2d2bcc0a1eead2a","modified":1651320173708},{"_id":"themes/sky/source/css/_partial/_tags.scss","hash":"abd235a70cb0f5edb2042e412ddde5aa63a6618a","modified":1651320173708},{"_id":"themes/sky/source/js/index.js","hash":"d920bfbafa72d5bc76eaa2870850c215b0503163","modified":1651320173714},{"_id":"themes/sky/source/css/_partial/copyright.scss","hash":"8265d6b06dc3c9474475e3bce7aef71e6a185c1b","modified":1651320173709},{"_id":"themes/sky/source/css/_partial/archive.scss","hash":"b150551b69c45673c19b9d65cffbb135fcbd2e7f","modified":1651320173709},{"_id":"themes/sky/source/css/common/_utils.scss","hash":"4dab0d4bbd787c78550d6d3a45d94aee93ba1b76","modified":1651320173712},{"_id":"themes/sky/source/css/_partial/mobile.scss","hash":"968812f56630bd98cf2277f912d8ac634244a5e5","modified":1651320173710},{"_id":"themes/sky/source/css/common/third-part.scss","hash":"9e6c9d7bab372df6983206b169ce5f9e6a7a5f9f","modified":1651320173713},{"_id":"themes/sky/source/css/_partial/post/code.scss","hash":"7372a76bf7c8d8828c670708e42f096fb9e8b918","modified":1651320173710},{"_id":"themes/sky/source/css/_partial/social.scss","hash":"f4126828c799557f177d24ee4d68277b6c3d2aa7","modified":1651320173711},{"_id":"themes/sky/source/css/_partial/post/toc.scss","hash":"c70f20162c5eaaea6d9f87c85aee1483cfd4a6d5","modified":1651320173710},{"_id":"public/css/style.scss","hash":"69e0c5fe524ded6d1d69e9d66d3ff988de469571","modified":1651322769588},{"_id":"public/css/common/third-part.scss","hash":"9e6c9d7bab372df6983206b169ce5f9e6a7a5f9f","modified":1651322769588},{"_id":"public/js/index.js","hash":"907faae45c668d3650efa971da364dddb674fb19","modified":1651322769588},{"_id":"public/css/gitment.css","hash":"926b553be983d6dd90bcb60c5d6d4ee215d268a6","modified":1651322769588},{"_id":"themes/maupassant/.gitignore","hash":"d7d27e5a9bcffe7f90dc2f4f0752e19020e40f40","modified":1651326682040},{"_id":"themes/maupassant/LICENSE","hash":"0663fd3a7ea9fc4f4c634b4d73e2da426b536f86","modified":1651326682041},{"_id":"themes/maupassant/README.md","hash":"f7f36a633be735f2d9f5c2746cc6b440eb60e03c","modified":1651326682042},{"_id":"themes/maupassant/.travis.yml","hash":"f8da426b97088e4caa5226cff219a5d95087961f","modified":1651326682041},{"_id":"themes/maupassant/_config.yml","hash":"88b1c782c35d9b29c00bb55ebc273f75c6a9da2f","modified":1651426379093},{"_id":"themes/maupassant/package.json","hash":"2cea786746e724c2e32c5a16fd30900be32e9ce5","modified":1651423097931},{"_id":"themes/maupassant/layout/archive.pug","hash":"8582db9eeebad1478db36f996292e2536b677694","modified":1651326682053},{"_id":"themes/maupassant/layout/base-without-sidebar.pug","hash":"c03e722ee31cd464cf2e6e39467bcdf398f4151f","modified":1651326682053},{"_id":"themes/maupassant/layout/index.pug","hash":"caa9bd16d9a6246e6e468865a0fe1aecde4457e8","modified":1651326682055},{"_id":"themes/maupassant/layout/base.pug","hash":"de21fa6e7ac20ef86c6ee93fc776f9ad5b164f21","modified":1651326682053},{"_id":"themes/maupassant/layout/page.pug","hash":"cb0aed2ea7892cdbc2f2ed7e3771e6a8229a31b8","modified":1651326682055},{"_id":"themes/maupassant/layout/tagcloud.pug","hash":"0e35112fa2f10ef337728cc0354ca10f81353209","modified":1651326682056},{"_id":"themes/maupassant/layout/post.pug","hash":"2101d882a46144a71a53c88cb9e12dbf1bd0290c","modified":1651326682055},{"_id":"themes/maupassant/languages/de-DE.yml","hash":"25d1d8cd8113045a7603c14af1ea1539fc6456ed","modified":1651326682042},{"_id":"themes/maupassant/layout/single-column.pug","hash":"8b4b731cdf86379d526821a1fa950bf15ed61f15","modified":1651326682056},{"_id":"themes/maupassant/languages/en.yml","hash":"93674c5df281d7f5647fe500e10924008d8017c6","modified":1651326682043},{"_id":"themes/maupassant/languages/fr-FR.yml","hash":"3a50568f200b9c1258415b53727e42c6b6c7ea0b","modified":1651326682044},{"_id":"themes/maupassant/languages/es-ES.yml","hash":"3cc9312fbdba4a8f8e8254804121e4724c719bcc","modified":1651326682043},{"_id":"themes/maupassant/languages/ko.yml","hash":"a454bcec60113507bc1d593a699849822386c196","modified":1651326682044},{"_id":"themes/maupassant/layout/timeline.pug","hash":"b041b77a941b788fad78d522d013bc158efe168c","modified":1651326682056},{"_id":"themes/maupassant/languages/ru.yml","hash":"36edc014c6aaef367d58929089bf7915375e71a6","modified":1651326682044},{"_id":"themes/maupassant/languages/zh-CN.yml","hash":"0cb8f0f895da5ff04b3af87824a9da1640f64620","modified":1651328059903},{"_id":"themes/maupassant/languages/zh-TW.yml","hash":"795f420382a150d570a06ffc278c4e7819260691","modified":1651326682045},{"_id":"themes/maupassant/layout/_partial/footer.pug","hash":"a5d429d636d3d81f904f033286e88a1a06aa8519","modified":1651328289424},{"_id":"themes/maupassant/layout/_partial/darkmode.pug","hash":"8a4c53229394ba6cf63afd427b4e6b1dc1156526","modified":1651326682046},{"_id":"themes/maupassant/layout/_partial/after_footer.pug","hash":"ce73a0531e28fd3bce3a0f90236b642e0e990fe2","modified":1651326682045},{"_id":"themes/maupassant/layout/_partial/comments.pug","hash":"6e448dfbebbe4848292092667d5dffd22ae137a6","modified":1651326682046},{"_id":"themes/maupassant/layout/_partial/head.pug","hash":"50818af5b69e5a44398134724adf4df98750b00d","modified":1651326682047},{"_id":"themes/maupassant/layout/_partial/mathjax2.pug","hash":"234a792e64ba208fa97d2f99772ece23056a53ec","modified":1651326682048},{"_id":"themes/maupassant/layout/_partial/helpers.pug","hash":"9e44f6d32f2449b4109c33118f8285fa2fc7b023","modified":1651326682047},{"_id":"themes/maupassant/layout/_partial/paginator.pug","hash":"03ad0c49ae6f8a999ae35b38d08e25775f51f52a","modified":1651326682049},{"_id":"themes/maupassant/layout/_partial/mathjax.pug","hash":"ac6e3a92bf18ab6bbd0e041b6796b295bae963ee","modified":1651326682048},{"_id":"themes/maupassant/layout/_partial/tag.pug","hash":"03a5c0c1e4ea717bdacf6e7c4c1173fcea1f75ef","modified":1651326682049},{"_id":"themes/maupassant/layout/_partial/post_nav.pug","hash":"b11d9e6000449838b17f508429f29ffb60f53096","modified":1651326682049},{"_id":"themes/maupassant/layout/_partial/wordcount.pug","hash":"d7ebbdcee193e345e3f92539ddffd291a870b5f9","modified":1651326682050},{"_id":"themes/maupassant/layout/_partial/totop.pug","hash":"eb91a3baf9411188c7c8130f63a674f541ca9c81","modified":1651326682050},{"_id":"themes/maupassant/layout/_widget/category.pug","hash":"e6bfc74e613f515dea534c22e4a9e1213c4db772","modified":1651326682051},{"_id":"themes/maupassant/layout/_widget/copyright.pug","hash":"4ee90ed25c0fb10d57ce3c58f8e4f725702637ef","modified":1651326682051},{"_id":"themes/maupassant/layout/_widget/donate.pug","hash":"e29fa0b74b8b01f6fe5ee827ab6d7dd25bb0accb","modified":1651326682051},{"_id":"themes/maupassant/layout/_widget/links.pug","hash":"2452cb2ffa159304a0d34c117250a4d12bd1b63f","modified":1651326682052},{"_id":"themes/maupassant/layout/_widget/recent_posts.pug","hash":"b717c372c8ff1285bcb87a4c28b318e9392bfbcc","modified":1651326682052},{"_id":"themes/maupassant/layout/_widget/recent_comments.pug","hash":"3f41457058740fe544ea061f29bb1e590271ff48","modified":1651326682052},{"_id":"themes/maupassant/layout/_widget/search.pug","hash":"89ce6c4e34ab003662913aca3158a9e078feb6d5","modified":1651326682053},{"_id":"themes/maupassant/layout/_widget/tag.pug","hash":"6d82d3c0def86d8f9445c9542f52033d2378956e","modified":1651326682053},{"_id":"themes/maupassant/source/css/copycode.scss","hash":"23fefb18f1d4dc7bde33e29d6ae737570277d943","modified":1651326682057},{"_id":"themes/maupassant/source/css/search.scss","hash":"a1720a63170ff4ae9048f634e8e1900e7a3cc45a","modified":1651326682058},{"_id":"themes/maupassant/source/img/alipay.svg","hash":"3d94d2f9b09e352802628c9225578e1086f5fef3","modified":1651326682059},{"_id":"themes/maupassant/source/css/copyright.scss","hash":"ad420043e1d0518bfbf3b2a2d87fb5b104587c6f","modified":1651326682058},{"_id":"themes/maupassant/source/css/donate.scss","hash":"d9ef1520e136198c0ae13acef7da22a275fb4dbf","modified":1651326682058},{"_id":"themes/maupassant/source/img/bitcoin.svg","hash":"590b6b6462896168d08b30dfe2de5f08950d5553","modified":1651326682060},{"_id":"themes/maupassant/source/img/paypal.svg","hash":"09786c983a10bc570dcd05b87cec601e9d01eb00","modified":1651326682061},{"_id":"themes/maupassant/source/css/style.scss","hash":"a69ab23cc2bbb64560fa3c20a8535e747b0413e0","modified":1651326682059},{"_id":"themes/maupassant/source/img/github.svg","hash":"277798d16cb6106e45ef74f6b9972011fa43401b","modified":1651326682060},{"_id":"themes/maupassant/source/img/wechat.svg","hash":"19c1f68ec8c0b8e9f7855e7a6e78077f70a1aedc","modified":1651326682061},{"_id":"themes/maupassant/source/img/like.svg","hash":"e6e4bd1af076be9358316cac89efdc22ef4a5064","modified":1651326682060},{"_id":"themes/maupassant/source/js/codeblock-resizer.js","hash":"c77270e684a60babc1abb7353e700ecdc5a66d30","modified":1651326682062},{"_id":"themes/maupassant/source/js/donate.js","hash":"82f06bd69782c1138c98b4276771a41e3a54c061","modified":1651326682063},{"_id":"themes/maupassant/source/js/copyright.js","hash":"0e9a845ae05d2f00721ff6ee910c8c3cace26043","modified":1651326682062},{"_id":"themes/maupassant/source/js/copycode.js","hash":"6df3139581744e7bcd47243e4587f5397c2a24c3","modified":1651326682062},{"_id":"themes/maupassant/source/js/fancybox.js","hash":"8a993c1c4ad40789d2960b682cb2130382a0f26a","modified":1651326682063},{"_id":"themes/maupassant/source/js/love.js","hash":"60df5dc3d09c8f33d1d02f54cbc73bf8d62f52fb","modified":1651326682063},{"_id":"themes/maupassant/source/js/share.js","hash":"514e726c1efae9f6566600fa0e945b4b9e620f2e","modified":1651326682064},{"_id":"themes/maupassant/source/js/smartresize.js","hash":"150ab1cad40d7ae081b0896b13f7d7cbac4e6338","modified":1651326682064},{"_id":"themes/maupassant/source/js/search.js","hash":"65d8e6d6c46fa060ce5b0d89e2fd778b6b2967d5","modified":1651326682063},{"_id":"themes/maupassant/source/js/totop.js","hash":"15de186b089c245fe60766d509b587919f05ff23","modified":1651326682066},{"_id":"public/img/alipay.svg","hash":"3d94d2f9b09e352802628c9225578e1086f5fef3","modified":1651327390384},{"_id":"public/img/bitcoin.svg","hash":"590b6b6462896168d08b30dfe2de5f08950d5553","modified":1651327390384},{"_id":"public/img/github.svg","hash":"277798d16cb6106e45ef74f6b9972011fa43401b","modified":1651327390384},{"_id":"public/img/wechat.svg","hash":"19c1f68ec8c0b8e9f7855e7a6e78077f70a1aedc","modified":1651327390384},{"_id":"public/img/paypal.svg","hash":"09786c983a10bc570dcd05b87cec601e9d01eb00","modified":1651327390384},{"_id":"public/img/like.svg","hash":"e6e4bd1af076be9358316cac89efdc22ef4a5064","modified":1651327390384},{"_id":"public/css/copycode.css","hash":"6abe2cb370b88a9884f5a10e29624b2f8ef24c89","modified":1651327390384},{"_id":"public/css/copyright.css","hash":"a6f68c735d459babe3f4f5c4412a635d8debaed5","modified":1651327390384},{"_id":"public/css/donate.css","hash":"f5126ddcc9dab3490c01e0ee26dd3ed46bac9988","modified":1651327390384},{"_id":"public/css/search.css","hash":"22fba8b3e985236a417e82486f07542562e06ee7","modified":1651327390384},{"_id":"public/js/codeblock-resizer.js","hash":"5d0b786d60bf225d9eabcc9cece2719ff4d9b6cd","modified":1651327390384},{"_id":"public/js/copycode.js","hash":"fde1f153bab1f00ae8930668094c00aa9ff3c7a3","modified":1651327390384},{"_id":"public/js/donate.js","hash":"bdddd8d9847462d020f7a511e7e12c046223195d","modified":1651327390384},{"_id":"public/js/search.js","hash":"6fdfd143646d12b8dbef9b5809cea768192f08aa","modified":1651327390384},{"_id":"public/js/copyright.js","hash":"7b1bd775ea22abf33d57f78628f436bf656e439a","modified":1651327390384},{"_id":"public/js/share.js","hash":"a2f9de374523dc7f2ddb90ed5f24b668c20d9272","modified":1651327390384},{"_id":"public/js/smartresize.js","hash":"3ef157fd877167e3290f42c67a624ea375a46c24","modified":1651327390384},{"_id":"public/js/love.js","hash":"5cf89f622bf891cf1986845eb92eadef6f358eb7","modified":1651327390384},{"_id":"public/js/fancybox.js","hash":"13c4781570339f4fba76a3d7f202e442817dd605","modified":1651327390384},{"_id":"public/js/totop.js","hash":"7dbf8fcf582a4fb6eb9b2c60d6de9f9c2091ec4c","modified":1651327390384},{"_id":"source/about/index.md","hash":"6bed381c2342dd08a834308cb4a8652a7a4bfb03","modified":1651426048285},{"_id":"public/about/index.html","hash":"43cba058ff159d37131a0cbc9aff218f3f728f98","modified":1653843649936},{"_id":"source/favicon.ico","hash":"49247d436b6a9824785e301c536a9fb7c4d3463d","modified":1651335606785},{"_id":"public/favicon.ico","hash":"49247d436b6a9824785e301c536a9fb7c4d3463d","modified":1651335929022},{"_id":"source/_posts/写在前面的一些话.md","hash":"85f9381beed5681161deb6142ecd4c7eb5efb00d","modified":1651423447152},{"_id":"public/2022/05/01/写在前面的一些话/index.html","hash":"5fe5758f7a8b4a6283df80bb602a79f380fcd7e8","modified":1653725724979},{"_id":"public/archives/2022/05/index.html","hash":"6b30207840de45f421cd19392f8d09319e0445c6","modified":1653843649936},{"_id":"public/tags/废话/index.html","hash":"e7e8c4f82c022f37850e92ee21a55a321937061a","modified":1653725817844},{"_id":"public/tags/废话-cryptohack/index.html","hash":"ec4901a26ae2b2f7ca17bb3053a54343331299f9","modified":1651350806861},{"_id":"public/tags/废话，-cryptohack/index.html","hash":"c76618f7b3163126edcb0573f45f9e3f227cc417","modified":1651350688313},{"_id":"public/tags/cryptohack/index.html","hash":"72f2f580d0b36044841d5c432307eeae2575edc6","modified":1653843649936},{"_id":"source/_posts/INTRODUCTION TO CRYPTOHACK.md","hash":"20f377a4dd23316ef5492a1939a563a613673859","modified":1651408944791},{"_id":"public/2022/05/01/INTRODUCTION TO CRYPTOHACK/index.html","hash":"7f8e7d2a974060699f1bd28f6c00612fa2ea70d7","modified":1651408960797},{"_id":"source/_posts/Introduction To Cryptohack.md","hash":"3cdf03de1bc57ff514f158a29cbefd11729772ed","modified":1653843437711},{"_id":"public/2022/05/01/Introduction To Cryptohack/index.html","hash":"26d7c3b42a50921a483cc05b08eb0dd923fb28e1","modified":1653843649936},{"_id":"source/css/external.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1651418685397},{"_id":"public/css/external.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1651423021490},{"_id":"themes/maupassant/package-lock.json","hash":"63d91ebb7545e7e82c39fe3d1df941bac0522f9e","modified":1651423151911},{"_id":"public/atom.xml","hash":"8685d9b2fe3b1d172bc614effecc730f4ec6ae9a","modified":1653843541402},{"_id":"source/timeline/index.md","hash":"bcb12f12e9b467b1322d5464336aa2d076796ddf","modified":1651424548084},{"_id":"public/timeline/index.html","hash":"4d3de1ac8e0b889d25fed4eeed92d3de8a8ef21a","modified":1651424845880},{"_id":"source/history/index.md","hash":"0a02c3c9ba22663d170bb30f2e713541f35b7902","modified":1651426226383},{"_id":"public/history/index.html","hash":"e1f3b3a17032d64d00137cb43a3a90a530354ecf","modified":1653843649936},{"_id":"source/history/timeline.md","hash":"bcb12f12e9b467b1322d5464336aa2d076796ddf","modified":1651425920247},{"_id":"public/history/timeline.html","hash":"48e0f5d97f99c7ed2492f132d9f9e387c4164e52","modified":1651426192434},{"_id":"source/_posts/Symmetric Cryptography_How AES Works.md","hash":"999fe173cbf43b033856e293e5ef69ff97c11a08","modified":1651861177564},{"_id":"source/_posts/RSA_STARTER.md","hash":"231e02a8f8e6cb6f1b246b5969705f4ca1031777","modified":1652040840432},{"_id":"source/_posts/Modular Arithmetic.md","hash":"78721ea34a598045bb1160f713c56205c6666687","modified":1651660064343},{"_id":"source/_posts/前三章补充.md","hash":"8807b2b5c6c37a1851a9ee691d866c67a65bc86f","modified":1652035774786},{"_id":"themes/butterfly/LICENSE","hash":"c8bc7df08db9dd3b39c2c2259a163a36cf2f6808","modified":1652624253270},{"_id":"themes/butterfly/package.json","hash":"0d66e1eb43bca8ffbe030c4651d6ce90d15f7bb2","modified":1652624253316},{"_id":"themes/butterfly/_config.yml","hash":"02baef6e17d673e21d2a02f70ddb4e520588bb3f","modified":1653729491554},{"_id":"themes/butterfly/README.md","hash":"d83c496aadb40f5bf9c67bdeba527353409bc559","modified":1652624253270},{"_id":"themes/butterfly/README_CN.md","hash":"fafeccf7b611e8d16d524d27558d942cc9fe0c2f","modified":1652624253271},{"_id":"themes/butterfly/languages/default.yml","hash":"335731ef259a3cec2499a2d5b050025ff4bdc608","modified":1652624253272},{"_id":"themes/butterfly/languages/zh-CN.yml","hash":"4adf079fb0170e3a8de6ddbb0392d6d1120030c4","modified":1652624253273},{"_id":"themes/butterfly/languages/en.yml","hash":"a96ab1bbe74e99ca2e4d67da9d83f442eb9b73af","modified":1652624253272},{"_id":"themes/butterfly/languages/zh-TW.yml","hash":"dcb10d62249bb149af8ad78db3ee6e342c6d6be7","modified":1652624253273},{"_id":"themes/butterfly/layout/category.pug","hash":"bf979aec88d78b644fc5d31518f8679ad7625792","modified":1652624253274},{"_id":"themes/butterfly/.github/stale.yml","hash":"79b830939587a5c029b20db6615ba73907d60bb4","modified":1652624253269},{"_id":"themes/butterfly/layout/archive.pug","hash":"2d5bf4b1755f89898c579c18d601be83d2bc8ebd","modified":1652624253274},{"_id":"themes/butterfly/layout/index.pug","hash":"648dcbdb3d145a710de81c909e000e8664d2ac9c","modified":1652624253314},{"_id":"themes/butterfly/layout/page.pug","hash":"bf2d6c6d2d156777b55292e51be02b0b3acf0af8","modified":1652624253314},{"_id":"themes/butterfly/scripts/events/config.js","hash":"8c3fa850933e4165c3354dea7b82d6f738bd7186","modified":1652624253317},{"_id":"themes/butterfly/scripts/events/404.js","hash":"f1d1c378356b776e9b2a8411e6dca88dc8c3245c","modified":1652624253317},{"_id":"themes/butterfly/scripts/events/init.js","hash":"b3e05e3440b078f57391c113d6b0c8ecff112720","modified":1652624253317},{"_id":"themes/butterfly/scripts/events/stylus.js","hash":"218add7e9b39b6fb6e69921abb9e44891a6cc3ce","modified":1652624253318},{"_id":"themes/butterfly/scripts/events/welcome.js","hash":"b92cc4648cfe5fb28c58943727823d1178b73a4a","modified":1652624253318},{"_id":"themes/butterfly/layout/tag.pug","hash":"4bb5efc6dabdf1626685bf6771aaa1467155ae86","modified":1652624253315},{"_id":"themes/butterfly/.github/workflows/publish.yml","hash":"e320b40c051bae1549156cd5ea4a51383cf78598","modified":1652624253270},{"_id":"themes/butterfly/scripts/filters/post_lazyload.js","hash":"5fd6c9659262dc8f61d87866d0417fd534292c88","modified":1652624253319},{"_id":"themes/butterfly/scripts/filters/random_cover.js","hash":"6c3b7d0874fa499800a4fd49894c481b05ec750c","modified":1652624253319},{"_id":"themes/butterfly/layout/post.pug","hash":"fdbb508b5e6dec30fb8753c5a7fdd494410c4fc0","modified":1652624253315},{"_id":"themes/butterfly/scripts/helpers/aside_categories.js","hash":"376e1884ea764404c38b1e73b16de0358ece519e","modified":1652624253320},{"_id":"themes/butterfly/scripts/helpers/aside_archives.js","hash":"4f712b4ea383b59a3122683db1d54c04a79ccc5d","modified":1652624253320},{"_id":"themes/butterfly/scripts/helpers/page.js","hash":"384de3c04809ec5fa996e8aa0628f770cd4bff3e","modified":1652624253321},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/bug_report.yml","hash":"e1043b8f149371d5a4ab0f1306eabc2988bed071","modified":1652624253268},{"_id":"themes/butterfly/scripts/helpers/inject_head_js.js","hash":"c445140fa16f19bf5fb617fa735504e7799d4d42","modified":1652624253321},{"_id":"themes/butterfly/scripts/helpers/related_post.js","hash":"83bfb16ab8d440be04e1b1f889f6affa7ad65a67","modified":1652624253322},{"_id":"themes/butterfly/scripts/tag/flink.js","hash":"3ba7677969ff01fab06fc6713455ddc6861f0024","modified":1652624253323},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/feature_request.yml","hash":"6e0f9470b18bd37d4891282ac73d61676b040e8c","modified":1652624253269},{"_id":"themes/butterfly/scripts/tag/button.js","hash":"44cca49ddc76921bb455465ef912cab46c993cef","modified":1652624253322},{"_id":"themes/butterfly/scripts/tag/inlineImg.js","hash":"7641adb0d520c5ff29dd36fc1fb8617c52ecc9fb","modified":1652624253324},{"_id":"themes/butterfly/scripts/tag/hide.js","hash":"e01a3967e5884881bab858b11635457df412de80","modified":1652624253324},{"_id":"themes/butterfly/scripts/tag/gallery.js","hash":"6d4cd2393945a9316339351cab588265f5c18d73","modified":1652624253323},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/config.yml","hash":"d9ff4bad9c9664e12729c7a531169a05698a3fd1","modified":1652624253268},{"_id":"themes/butterfly/scripts/tag/label.js","hash":"551f1b8edc973bd8afc5cce2eae546f002fa84c3","modified":1652624253324},{"_id":"themes/butterfly/source/img/404.jpg","hash":"fb4489bc1d30c93d28f7332158c1c6c1416148de","modified":1652624253347},{"_id":"themes/butterfly/scripts/tag/note.js","hash":"420ba8b11e7316b4c09eb301d39814bc9bae9f90","modified":1652624253325},{"_id":"themes/butterfly/scripts/tag/tabs.js","hash":"08ea00791bd4738952234cb5d8360e119df6f875","modified":1652624253325},{"_id":"themes/butterfly/scripts/tag/mermaid.js","hash":"fd683ccc090db3122d77c7ee73e8d35dc8735ee3","modified":1652624253325},{"_id":"themes/butterfly/scripts/tag/timeline.js","hash":"4c7056d3cd56f10bd209d2ba4d3cc2027aad1440","modified":1652624253326},{"_id":"themes/butterfly/source/img/friend_404.gif","hash":"8d2d0ebef70a8eb07329f57e645889b0e420fa48","modified":1652624253348},{"_id":"themes/butterfly/source/img/favicon.png","hash":"3cf89864b4f6c9b532522a4d260a2e887971c92d","modified":1652624253347},{"_id":"themes/butterfly/source/js/tw_cn.js","hash":"4db1170be7a9360e2c5399d281b979da730df2a3","modified":1652624253352},{"_id":"themes/butterfly/layout/includes/404.pug","hash":"aace9ddff469de4226e47a52ede1c81e66d66d5c","modified":1652624253275},{"_id":"themes/butterfly/source/js/main.js","hash":"a2c1c55b5b8ec9a83cf6242ebc9ea9be95e1f0c1","modified":1652624253350},{"_id":"themes/butterfly/source/js/utils.js","hash":"fdb9e5b38f076953a2431b8f682388b030694b55","modified":1652624253353},{"_id":"themes/butterfly/source/css/index.styl","hash":"c7924868adcb046b46498626a9223c7a7b3f2e30","modified":1652624253346},{"_id":"themes/butterfly/layout/includes/additional-js.pug","hash":"ddea99847fd41323f183cd0c9dae3174c586f5b3","modified":1652624253275},{"_id":"themes/butterfly/layout/includes/footer.pug","hash":"8715948b93e7508b84d913be1969b28c6b067b9b","modified":1652624253275},{"_id":"themes/butterfly/source/css/var.styl","hash":"584ef7b18d5e677eb2e62f9b139097d3b714a993","modified":1652624253346},{"_id":"themes/butterfly/layout/includes/head.pug","hash":"343f3cb328eb27ef04c0a4bf7fab44b1be76100a","modified":1652624253276},{"_id":"themes/butterfly/layout/includes/layout.pug","hash":"4473ba26e06a782e91ed181d0ceb83f8745aad1f","modified":1652624253283},{"_id":"themes/butterfly/layout/includes/sidebar.pug","hash":"4f41fc46410e1e3018ff87e1d1a5c28be7258119","modified":1652624253289},{"_id":"themes/butterfly/layout/includes/pagination.pug","hash":"bb1847f45e713cc88b1c0a97035ec01f0209c995","modified":1652624253287},{"_id":"themes/butterfly/layout/includes/rightside.pug","hash":"205562ec188bfba5686c51af77486550d0927df5","modified":1652624253288},{"_id":"themes/butterfly/source/css/_global/function.styl","hash":"f562648de515abc873609bfe9b9f799c8cf42b72","modified":1652624253327},{"_id":"themes/butterfly/source/css/_global/index.styl","hash":"b9d7d23dc8810542b8c8ffcbfbd3694318debcc6","modified":1652624253327},{"_id":"themes/butterfly/source/js/search/local-search.js","hash":"f72e002d56903a49c36174e77e42f88b8af8bd44","modified":1652624253352},{"_id":"themes/butterfly/source/css/_highlight/theme.styl","hash":"3c178608406c31d768af355ef1d7326da37cc75f","modified":1652624253331},{"_id":"themes/butterfly/source/js/search/algolia.js","hash":"6e20ab5f90a0dd6eb6fdca58e69961bd2f16a632","modified":1652624253351},{"_id":"themes/butterfly/source/css/_highlight/highlight.styl","hash":"a2aa5caf338ff5323b6ff0601ebcc09e710d8398","modified":1652624253328},{"_id":"themes/butterfly/source/css/_mode/darkmode.styl","hash":"0bcd07ffbd2a86a1b24eaefabd7e278034b14ee2","modified":1652624253337},{"_id":"themes/butterfly/source/css/_mode/readmode.styl","hash":"1fed25162d7204480e9bcf476b3246e1717107ca","modified":1652624253337},{"_id":"themes/butterfly/source/css/_search/index.styl","hash":"cced94e70b4b90130cfa215582be2adbf883efba","modified":1652624253340},{"_id":"themes/butterfly/source/css/_search/local-search.styl","hash":"45792c13c7c439d412b7dc597d74d24f3b598406","modified":1652624253342},{"_id":"themes/butterfly/source/css/_search/algolia.styl","hash":"d1398399eb7f1cc004fbcefa18f56188cc8fec8c","modified":1652624253340},{"_id":"themes/butterfly/source/css/_page/404.styl","hash":"a7223a8fcc4fa7b81e552c9a2554be7df9de312e","modified":1652624253338},{"_id":"themes/butterfly/source/css/_page/categories.styl","hash":"68bc8cbea25dbb3cdc170f09f9b43ce130547717","modified":1652624253339},{"_id":"themes/butterfly/source/css/_page/common.styl","hash":"a714776e3d585369f2285b6bb4e1564539c58d8b","modified":1652624253339},{"_id":"themes/butterfly/source/css/_page/flink.styl","hash":"ecc2b2e28c179eb9406fc2c6f00e141078249cdd","modified":1652624253339},{"_id":"themes/butterfly/source/css/_page/archives.styl","hash":"d72218cb5a6bfe048ae1c92009bd815a08a53d3a","modified":1652624253338},{"_id":"themes/butterfly/source/css/_page/homepage.styl","hash":"c42b872df237726483d93d6124b8751d4f64cf86","modified":1652624253340},{"_id":"themes/butterfly/source/css/_page/tags.styl","hash":"9e35f91847773b915c74a78b8aa66c7bdb950ad0","modified":1652624253340},{"_id":"themes/butterfly/source/css/_tags/button.styl","hash":"62da1de0d5b8453fcecbfacddb16985265638ba5","modified":1652624253342},{"_id":"themes/butterfly/source/css/_tags/inlineImg.styl","hash":"5a873d01fabebcf7ddf7a6b1c2e2e5e2714097f4","modified":1652624253344},{"_id":"themes/butterfly/source/css/_tags/gallery.styl","hash":"84c42716e833d2d1dd47195ea996803ffa0e58ec","modified":1652624253343},{"_id":"themes/butterfly/source/css/_tags/hexo.styl","hash":"985b183db7b7bfd8f9bdb60494549fb7f850348b","modified":1652624253343},{"_id":"themes/butterfly/source/css/_tags/hide.styl","hash":"b7cf7753479fcf2fe07287ffdb0e568adbba4c18","modified":1652624253343},{"_id":"themes/butterfly/source/css/_tags/tabs.styl","hash":"ec81ea316c82b83d6aee31e52f248d329559d5d3","modified":1652624253344},{"_id":"themes/butterfly/source/css/_tags/label.styl","hash":"2f83bd145b870d80d4b18b0ac603235229a5694e","modified":1652624253344},{"_id":"themes/butterfly/source/css/_tags/timeline.styl","hash":"07ea7134db7a66c87658116f089fb1a2a6906563","modified":1652624253345},{"_id":"themes/butterfly/source/css/_tags/note.styl","hash":"076cd87805207c9b5612ec9771f6994287f4c169","modified":1652624253344},{"_id":"themes/butterfly/source/css/_third-party/normalize.min.css","hash":"8549829fb7d3c21cd9e119884962e8c463a4a267","modified":1652624253345},{"_id":"themes/butterfly/source/css/_layout/comments.styl","hash":"0abe05309a186682772a94e5e759b63f8028e61a","modified":1652624253332},{"_id":"themes/butterfly/source/css/_layout/footer.styl","hash":"e931ef81754a7b9d999fa23d134c620e68e75491","modified":1652624253333},{"_id":"themes/butterfly/source/css/_layout/aside.styl","hash":"b224bed22ce063d0d74e1f135812e16fdba87bca","modified":1652624253331},{"_id":"themes/butterfly/source/css/_layout/chat.styl","hash":"f27ad7b5d781c98bcac5c12c2d70b69b830e0374","modified":1652624253332},{"_id":"themes/butterfly/source/css/_layout/loading.styl","hash":"844858ae87c7278996ce484c6b456db354c48764","modified":1652624253334},{"_id":"themes/butterfly/source/css/_layout/pagination.styl","hash":"bd099f7d3adef4b7edd24c0a25a07415b156e587","modified":1652624253334},{"_id":"themes/butterfly/source/css/_layout/post.styl","hash":"9f880a6fa91784a4d3e9ffb0d4607e8a74d4d929","modified":1652624253335},{"_id":"themes/butterfly/source/css/_layout/head.styl","hash":"f3aac52defb3497079a313e8c63ac2f7ee24dfbe","modified":1652624253333},{"_id":"themes/butterfly/source/css/_layout/relatedposts.styl","hash":"6dcf19c0933c8828a439f801b0f4b256447dec07","modified":1652624253335},{"_id":"themes/butterfly/source/css/_layout/reward.styl","hash":"b5ba2c3339ad406ce611d12d3f8cc84f864fbc03","modified":1652624253335},{"_id":"themes/butterfly/layout/includes/header/index.pug","hash":"3a2797d2744607ba6cdb5a02853851957c0f7e29","modified":1652624253280},{"_id":"themes/butterfly/layout/includes/header/menu_item.pug","hash":"ca8bcd90ad9467819330bfe7c02b76322754bccf","modified":1652624253281},{"_id":"themes/butterfly/source/css/_layout/rightside.styl","hash":"1c1c585ba99cb4004956b5e98fc044260b456f99","modified":1652624253336},{"_id":"themes/butterfly/source/css/_layout/sidebar.styl","hash":"7e9b65dcae7ac54e0183bc841fea0f4bd4d78e5c","modified":1652624253336},{"_id":"themes/butterfly/source/css/_layout/third-party.styl","hash":"e02b52bdd337c0ed3c9d3a507d1011403c38881d","modified":1652624253336},{"_id":"themes/butterfly/layout/includes/head/Open_Graph.pug","hash":"07380718ed3af19a7e64b30e8c13726fe5983947","modified":1652624253276},{"_id":"themes/butterfly/layout/includes/header/nav.pug","hash":"a9e56b1c41bf327859b0a7bcb8e72b458bd851b2","modified":1652624253281},{"_id":"themes/butterfly/layout/includes/header/social.pug","hash":"631ec7000fd4d6cfa2de118ee02ad8a42ffb34f5","modified":1652624253282},{"_id":"themes/butterfly/layout/includes/head/analytics.pug","hash":"c1e45d4d0bd905ddcd2282de4fe89be92e67847d","modified":1652624253277},{"_id":"themes/butterfly/layout/includes/header/post-info.pug","hash":"711e92da2677c3a9e9f50babd4430929dba0f524","modified":1652624253281},{"_id":"themes/butterfly/layout/includes/head/config.pug","hash":"8a3f9e674b44e6a92d4df22baca65d9d30007dc3","modified":1652624253277},{"_id":"themes/butterfly/layout/includes/head/google_adsense.pug","hash":"f29123e603cbbcc6ce277d4e8f600ba67498077c","modified":1652624253278},{"_id":"themes/butterfly/layout/includes/head/config_site.pug","hash":"bd5dd5452e28a4fe94c3241a758ec6f4fdb7a149","modified":1652624253278},{"_id":"themes/butterfly/layout/includes/head/noscript.pug","hash":"72efaa09ff60843567458bd54152e06f0cb2757e","modified":1652624253278},{"_id":"themes/butterfly/layout/includes/head/preconnect.pug","hash":"fc3e67e5ae4774d9e89964ba96beed28f34ee8f0","modified":1652624253278},{"_id":"themes/butterfly/layout/includes/head/pwa.pug","hash":"6dc2c9b85df9ab4f5b554305339fd80a90a6cf43","modified":1652624253278},{"_id":"themes/butterfly/layout/includes/head/site_verification.pug","hash":"5168caadc4cf541f5d6676a9c5e8ae47a948f9ad","modified":1652624253280},{"_id":"themes/butterfly/layout/includes/mixins/post-ui.pug","hash":"9c8e65939d048a579ea08d063c0f98550376f536","modified":1652624253285},{"_id":"themes/butterfly/layout/includes/mixins/article-sort.pug","hash":"971038debf539333b1687b4a1d87cf4fc965a846","modified":1652624253285},{"_id":"themes/butterfly/layout/includes/page/categories.pug","hash":"5276a8d2835e05bd535fedc9f593a0ce8c3e8437","modified":1652624253285},{"_id":"themes/butterfly/layout/includes/loading/loading.pug","hash":"dd8e6813976be64e80eba6562b54e74527ab306d","modified":1652624253284},{"_id":"themes/butterfly/layout/includes/loading/loading-js.pug","hash":"2e1ab0c2ca59a1ff5a5ba9b6ef60f3e34af5430c","modified":1652624253283},{"_id":"themes/butterfly/layout/includes/page/default-page.pug","hash":"e9459f122af7b733398578f9f0f8ab3c5e12a217","modified":1652624253286},{"_id":"themes/butterfly/layout/includes/page/tags.pug","hash":"8f43fdeaf8cff4a35bab74b48c963786ca015620","modified":1652624253286},{"_id":"themes/butterfly/layout/includes/post/post-copyright.pug","hash":"cc1f7ae8a7ce5445277215821092e712ec8cc296","modified":1652624253287},{"_id":"themes/butterfly/layout/includes/post/reward.pug","hash":"594626a18b7efbf771232855dfbce143fb244bc6","modified":1652624253288},{"_id":"themes/butterfly/layout/includes/third-party/aplayer.pug","hash":"e939344fd389aeb11864ee697d5fd9b036d8325f","modified":1652624253289},{"_id":"themes/butterfly/layout/includes/page/flink.pug","hash":"e2eba0fcb8332cb333b2aff9c76664e40e2e1974","modified":1652624253286},{"_id":"themes/butterfly/layout/includes/third-party/pangu.pug","hash":"f0898509da70388b5c532f19e762756d74080200","modified":1652624253305},{"_id":"themes/butterfly/layout/includes/third-party/prismjs.pug","hash":"08979afbfecb4476a5ae8e360947b92624d285b8","modified":1652624253306},{"_id":"themes/butterfly/layout/includes/third-party/effect.pug","hash":"4e37535c63149708ecbedb262336014524ad8723","modified":1652624253300},{"_id":"themes/butterfly/layout/includes/third-party/pjax.pug","hash":"a5e6f9a88fe146c2c42c38e79f85c42351e9346d","modified":1652624253306},{"_id":"themes/butterfly/layout/includes/widget/card_ad.pug","hash":"a8312b527493dabbadbb1280760168d3bc909a3b","modified":1652624253310},{"_id":"themes/butterfly/layout/includes/widget/card_archives.pug","hash":"73d33b6930e7944187a4b3403daf25d27077a2dd","modified":1652624253310},{"_id":"themes/butterfly/layout/includes/widget/card_announcement.pug","hash":"21e019bdc3b1e796bb00976bb29af2d51f873624","modified":1652624253310},{"_id":"themes/butterfly/layout/includes/widget/card_bottom_self.pug","hash":"1dba77d250eeebfb6e293d504352c7e9ea31980b","modified":1652624253311},{"_id":"themes/butterfly/layout/includes/widget/card_author.pug","hash":"08641633d38903351a7424baf9893d9038ba057d","modified":1652624253310},{"_id":"themes/butterfly/layout/includes/third-party/subtitle.pug","hash":"7b5fea9e1c113cab4c75f9d31d8efebe70d82e7a","modified":1652624253309},{"_id":"themes/butterfly/layout/includes/widget/card_categories.pug","hash":"66e383b4ef374951eb87dd1bf4cdb7a667193fb5","modified":1652624253311},{"_id":"themes/butterfly/layout/includes/widget/card_newest_comment.pug","hash":"c02b1779bd0ebca6749f195be096b6ca574bfa29","modified":1652624253311},{"_id":"themes/butterfly/layout/includes/widget/card_recent_post.pug","hash":"471b20e71a19db1f5115727082e5188200c49383","modified":1652624253312},{"_id":"themes/butterfly/layout/includes/widget/card_post_toc.pug","hash":"59d979702fa21d960443824198614d63aaf69662","modified":1652624253312},{"_id":"themes/butterfly/layout/includes/widget/card_tags.pug","hash":"9755cac8424dc578e9ec07dbcaa429fddbedd392","modified":1652624253312},{"_id":"themes/butterfly/layout/includes/widget/card_top_self.pug","hash":"7b5ae404a1205546b7de4be42291315cf918f2b3","modified":1652624253313},{"_id":"themes/butterfly/layout/includes/widget/card_webinfo.pug","hash":"62adef7998fb9bebc5891a49472cfea944a1bf7a","modified":1652624253313},{"_id":"themes/butterfly/layout/includes/widget/index.pug","hash":"5e0e9e9b2cd3c256d52423e2278e790aa387a53a","modified":1652624253313},{"_id":"themes/butterfly/source/css/_highlight/highlight/index.styl","hash":"fc702a4614d0562a381907b083f71ba63d301d86","modified":1652624253328},{"_id":"themes/butterfly/source/css/_highlight/highlight/diff.styl","hash":"6e77f1ca0cfb0db6b028f5c0238780e66d344f3d","modified":1652624253328},{"_id":"themes/butterfly/source/css/_highlight/prismjs/index.styl","hash":"01ff9e77eb1bd454bec65a6ff5972c8e219bc708","modified":1652624253330},{"_id":"themes/butterfly/source/css/_highlight/prismjs/line-number.styl","hash":"0b8aea62d1550113e1fcc237fae1b03743190208","modified":1652624253330},{"_id":"themes/butterfly/source/css/_highlight/prismjs/diff.styl","hash":"1309292f1c8c53d96cd7333507b106bcc24ca8fc","modified":1652624253330},{"_id":"themes/butterfly/layout/includes/third-party/chat/crisp.pug","hash":"b741b5e942481d779a8a1fe94c45154a62a6b748","modified":1652624253293},{"_id":"themes/butterfly/layout/includes/third-party/chat/chatra.pug","hash":"f3f6eaecbcf9352342e259f4a5a3ad7160f31fc9","modified":1652624253292},{"_id":"themes/butterfly/layout/includes/third-party/chat/gitter.pug","hash":"794ce3911f17d354b7196deb8c36d191afac63fb","modified":1652624253293},{"_id":"themes/butterfly/layout/includes/third-party/chat/daovoice.pug","hash":"e5af55cdb87d1ffd3d8702bc77097159acf95b54","modified":1652624253293},{"_id":"themes/butterfly/layout/includes/third-party/chat/index.pug","hash":"bb467bb22f3d0775b33f9eacbfc086ecb7831e78","modified":1652624253294},{"_id":"themes/butterfly/layout/includes/third-party/chat/tidio.pug","hash":"cd7ab4a776be93eea96a6f6fd0a547977fbe1ea3","modified":1652624253294},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/disqus.pug","hash":"f4d21dcbc3b00eed9b1f604e132c4c6811a0a059","modified":1652624253290},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/fb.pug","hash":"4eebb2d94ca75809ef0cf32d70f13e9bf1e87091","modified":1652624253290},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/index.pug","hash":"a18415004d03c0a1783eccac522fbcb6ce0ea1f1","modified":1652624253291},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/twikoo.pug","hash":"2fb4df7ecf4c404f9dba848660ec9a2f7616acd3","modified":1652624253291},{"_id":"themes/butterfly/layout/includes/third-party/math/index.pug","hash":"2afa4c21dd19890f47fb568cfb0d90efb676a253","modified":1652624253300},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/valine.pug","hash":"13741770ce1fbc86396e2a34741750f18014de68","modified":1652624253291},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/waline.pug","hash":"6e5ccc9ea4346c71ad4cbf1e9f1cb83bb45e6f27","modified":1652624253292},{"_id":"themes/butterfly/layout/includes/third-party/math/katex.pug","hash":"cd358595d04894d4d647b79b80d995abbc0f061b","modified":1652624253301},{"_id":"themes/butterfly/layout/includes/third-party/math/mathjax.pug","hash":"e435f8b55508c82b9151842375952f50ee012ff1","modified":1652624253301},{"_id":"themes/butterfly/layout/includes/third-party/comments/disqus.pug","hash":"d5f81fd5443a1b09efb165b5f4447a35949d14ad","modified":1652624253295},{"_id":"themes/butterfly/layout/includes/third-party/math/mermaid.pug","hash":"a0b332b8666eafc07f1a5166cff92b3c926d4500","modified":1652624253302},{"_id":"themes/butterfly/layout/includes/third-party/comments/disqusjs.pug","hash":"5f921c64073f73ae1f2d80969f4d3905d91396ce","modified":1652624253295},{"_id":"themes/butterfly/layout/includes/third-party/comments/facebook_comments.pug","hash":"a222477bddba3c646ee9b8560442c2cb204adb11","modified":1652624253295},{"_id":"themes/butterfly/layout/includes/third-party/comments/giscus.pug","hash":"319463fc8ff993b798f2293b659b522ad7770cf0","modified":1652624253296},{"_id":"themes/butterfly/layout/includes/third-party/comments/gitalk.pug","hash":"3df2f59c9552a1f2e6f0d50c4ae97e72c5392b59","modified":1652624253296},{"_id":"themes/butterfly/layout/includes/third-party/comments/js.pug","hash":"810e8ca2669433f649329859922aabbb30d76178","modified":1652624253297},{"_id":"themes/butterfly/layout/includes/third-party/comments/index.pug","hash":"414f876d28f8497d6d551363a89c5c69bf1533eb","modified":1652624253296},{"_id":"themes/butterfly/layout/includes/third-party/comments/livere.pug","hash":"589f8503f264d4fda971c8daf2028f45c4f2867b","modified":1652624253297},{"_id":"themes/butterfly/layout/includes/third-party/comments/twikoo.pug","hash":"4dedd90365d3a3779c83f0a2572c29e6b2aad623","modified":1652624253298},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/disqus-comment.pug","hash":"cd1ce86441dc508e4c3dbf8b829046455ba8a6b4","modified":1652624253302},{"_id":"themes/butterfly/layout/includes/third-party/comments/utterances.pug","hash":"d48d59ebf8c0142fb3c4592a0d35874f85e6fd4c","modified":1652624253298},{"_id":"themes/butterfly/layout/includes/third-party/comments/valine.pug","hash":"cba55cbbd0962bf84b8956195e686b0e158ed247","modified":1652624253299},{"_id":"themes/butterfly/layout/includes/third-party/comments/waline.pug","hash":"e45152e4ebc3fb2462916be93f98d18f0574f2d3","modified":1652624253299},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/index.pug","hash":"16cf05cf9649322da57e9b8d316573bb65f8d8d8","modified":1652624253303},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/github-issues.pug","hash":"b2ede1f6b41026ebd233ac076a405889a6eec76b","modified":1652624253303},{"_id":"themes/butterfly/layout/includes/third-party/search/algolia.pug","hash":"af5d3d87b736598dafcf5871863596592cacdfe1","modified":1652624253307},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/valine.pug","hash":"33368c0b80e4c4e78f3c7ee9bec0fed70ad838ca","modified":1652624253304},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/twikoo-comment.pug","hash":"fa83e2320b2c0f469341817eadc2603644df71ee","modified":1652624253304},{"_id":"themes/butterfly/layout/includes/third-party/search/index.pug","hash":"ff3727c3ec698ec61a28c55cbc8c8508f0efb0a0","modified":1652624253307},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/waline.pug","hash":"63ef0b2a75cf26a94c5bcd885f3a1c144451b852","modified":1652624253305},{"_id":"themes/butterfly/layout/includes/third-party/share/add-this.pug","hash":"8b4034e53ca5bf85097f681a6e76a53ce685c205","modified":1652624253308},{"_id":"themes/butterfly/layout/includes/third-party/search/local-search.pug","hash":"3b5ef84744a1a8fec5a63554079008040d96f924","modified":1652624253307},{"_id":"themes/butterfly/layout/includes/third-party/share/addtoany.pug","hash":"1f02a26730e5f36cc2dfec7ff4d5c93a099ed5ba","modified":1652624253308},{"_id":"themes/butterfly/layout/includes/third-party/share/index.pug","hash":"4898a09d8e67fb358ffd74b3a1f0014f555dd856","modified":1652624253308},{"_id":"themes/butterfly/layout/includes/third-party/share/share-js.pug","hash":"b45fc15c3ae7db3a0fbce0d6da74a72a95ca8a2b","modified":1652624253309},{"_id":"public/2022/05/05/Symmetric Cryptography_How AES Works/index.html","hash":"d73b0f021d5f697672bb60b32e445536b4f81598","modified":1653843541402},{"_id":"public/2022/05/08/前三章补充/index.html","hash":"31005d062be668d4edb889dab68f137717a8f0da","modified":1653843541402},{"_id":"public/2022/05/09/RSA_STARTER/index.html","hash":"30f64433c5a7059979b57074d52381741e1016b7","modified":1652636677566},{"_id":"public/2022/05/03/Modular Arithmetic/index.html","hash":"4e02f02791d20b5899b2ddcbf665181981453493","modified":1653843541402},{"_id":"public/img/404.jpg","hash":"fb4489bc1d30c93d28f7332158c1c6c1416148de","modified":1652626042349},{"_id":"public/img/favicon.png","hash":"3cf89864b4f6c9b532522a4d260a2e887971c92d","modified":1652626042349},{"_id":"public/img/friend_404.gif","hash":"8d2d0ebef70a8eb07329f57e645889b0e420fa48","modified":1652626042349},{"_id":"public/js/utils.js","hash":"0b95daada72abb5d64a1e3236049a60120e47cca","modified":1652626042349},{"_id":"public/css/var.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1652626042349},{"_id":"public/js/search/local-search.js","hash":"3071a4208fdf89ad7e0031536dd6ffa7bc951e4d","modified":1652626042349},{"_id":"public/js/search/algolia.js","hash":"ce8131b712dca80f289015aef75f86e727f62981","modified":1652626042349},{"_id":"public/js/main.js","hash":"04efcbd28b37875cfec88eb87cab7256a9ebb327","modified":1652626042349},{"_id":"public/js/tw_cn.js","hash":"00053ce73210274b3679f42607edef1206eebc68","modified":1652626042349},{"_id":"public/css/index.css","hash":"61551503130fa9c41cbee888625cc4e871316999","modified":1652626042349},{"_id":"source/categories/index.md","hash":"edfc64c1979cc8e4133738c10837a26e02648bf1","modified":1652627292158},{"_id":"source/tags/index.md","hash":"96cecd34c7662b5dcaef02c153501e67a0298b01","modified":1652627278612},{"_id":"source/link/index.md","hash":"4d018d48744fd93dcb2369b1d8ecf46a3e3314b0","modified":1652627264345},{"_id":"source/data/link.yml","hash":"ccf705b7f00ebeadca09d56977de3ddef6bda683","modified":1652628857937},{"_id":"public/data/link.json","hash":"e2126ac59392c48be370389bc4e62cafbc1ffaaf","modified":1652628864316},{"_id":"public/categories/index.html","hash":"fab0a1ba7d46d856a708165e3df73d415d2cc6c5","modified":1653843649936},{"_id":"public/link/index.html","hash":"7b575273e9bdd63fa19c8579d521f3529f78ac59","modified":1653843649936},{"_id":"public/tags/index.html","hash":"5a11f7497199b9bdbc41bdb6827e8b4d525508fe","modified":1653843649936},{"_id":"public/404.html","hash":"5c174603038abd144c45f76c2d75e1c06ef80fb7","modified":1653843649936},{"_id":"source/_posts/RSA_Starter.md","hash":"231e02a8f8e6cb6f1b246b5969705f4ca1031777","modified":1652040840432},{"_id":"public/2022/05/09/RSA_Starter/index.html","hash":"0290f8cebbc7a32803e5391bbccefa428c45c56e","modified":1653843649936},{"_id":"source/_posts/开始cryptohack.md","hash":"daefb8c83630d9410bcf01b25983ce5dc1661077","modified":1653725962108},{"_id":"public/2022/05/01/开始cryptohack/index.html","hash":"6f256696b1f4a04b78d1c1409648360ccdba67d4","modified":1653843541402},{"_id":"public/tags/垃圾桶/index.html","hash":"cfc909255222154d92dba5c677d116d21a4bf261","modified":1653843649936}],"Category":[],"Data":[],"Page":[{"_content":"# 关于\n\n Nickname: [s9](https://www.smilin9.com/) (?\n\nQQ: 861597494\n\n Email: [861597494@qq.com](mailto:861597494@qq.com)\n\n Github: [@smilin9](https://github.com/smilin9)","source":"about/index.md","raw":"# 关于\n\n Nickname: [s9](https://www.smilin9.com/) (?\n\nQQ: 861597494\n\n Email: [861597494@qq.com](mailto:861597494@qq.com)\n\n Github: [@smilin9](https://github.com/smilin9)","date":"2022-05-01T17:27:28.285Z","updated":"2022-05-01T17:27:28.285Z","path":"about/index.html","_id":"cl2m0u0760000eks2ciya0lc7","title":"","comments":1,"layout":"page","content":"<h1 id=\"关于\"><a href=\"#关于\" class=\"headerlink\" title=\"关于\"></a>关于</h1><p> Nickname: <a href=\"https://www.smilin9.com/\">s9</a> (?</p>\n<p>QQ: 861597494</p>\n<p> Email: <a href=\"mailto:861597494@qq.com\">861597494@qq.com</a></p>\n<p> Github: <a href=\"https://github.com/smilin9\">@smilin9</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"关于\"><a href=\"#关于\" class=\"headerlink\" title=\"关于\"></a>关于</h1><p> Nickname: <a href=\"https://www.smilin9.com/\">s9</a> (?</p>\n<p>QQ: 861597494</p>\n<p> Email: <a href=\"mailto:861597494@qq.com\">861597494@qq.com</a></p>\n<p> Github: <a href=\"https://github.com/smilin9\">@smilin9</a></p>\n"},{"_content":"","source":"css/external.css","raw":"","date":"2022-05-01T15:25:05.674Z","updated":"2022-05-01T15:24:45.397Z","path":"css/external.css","layout":"false","title":"","comments":1,"_id":"cl2nimnmr000050s2aqrj2r9p","content":"","site":{"data":{}},"excerpt":"","more":""},{"layout":"timeline","_content":"\n# history\n\n","source":"history/index.md","raw":"---\nlayout: timeline\n---\n\n# history\n\n","date":"2022-05-01T17:30:26.383Z","updated":"2022-05-01T17:30:26.383Z","path":"history/index.html","_id":"cl2njrxa80000jws2eieveggj","title":"","comments":1,"content":"<h1 id=\"history\"><a href=\"#history\" class=\"headerlink\" title=\"history\"></a>history</h1>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"history\"><a href=\"#history\" class=\"headerlink\" title=\"history\"></a>history</h1>"},{"_content":"- class_name: 友链\n  class_desc: \n  link_list:\n    - name: hawa130\n      link: https://hawa130.com/\n      avatar: https://gravatar.loli.net/avatar/ede3afe16459e2cd9347dcde4c20973f?s=512\n      descr: 书记\n    - name: ksf\n      link: blog.ksfu.top\n      avatar: https://blog.ksfu.top/img/head.webp\n      descr: 康师傅","source":"data/link.yml","raw":"- class_name: 友链\n  class_desc: \n  link_list:\n    - name: hawa130\n      link: https://hawa130.com/\n      avatar: https://gravatar.loli.net/avatar/ede3afe16459e2cd9347dcde4c20973f?s=512\n      descr: 书记\n    - name: ksf\n      link: blog.ksfu.top\n      avatar: https://blog.ksfu.top/img/head.webp\n      descr: 康师傅","date":"2022-05-15T15:34:17.937Z","updated":"2022-05-15T15:34:17.937Z","path":"data/link.json","layout":"false","_id":"cl37g68iy0000r4fsc2341uvc","title":"","comments":1,"content":"[{\"class_name\":\"友链\",\"class_desc\":null,\"link_list\":[{\"name\":\"hawa130\",\"link\":\"https://hawa130.com/\",\"avatar\":\"https://gravatar.loli.net/avatar/ede3afe16459e2cd9347dcde4c20973f?s=512\",\"descr\":\"书记\"},{\"name\":\"ksf\",\"link\":\"blog.ksfu.top\",\"avatar\":\"https://blog.ksfu.top/img/head.webp\",\"descr\":\"康师傅\"}]}]","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"","more":"[{\"class_name\":\"友链\",\"class_desc\":null,\"link_list\":[{\"name\":\"hawa130\",\"link\":\"https://hawa130.com/\",\"avatar\":\"https://gravatar.loli.net/avatar/ede3afe16459e2cd9347dcde4c20973f?s=512\",\"descr\":\"书记\"},{\"name\":\"ksf\",\"link\":\"blog.ksfu.top\",\"avatar\":\"https://blog.ksfu.top/img/head.webp\",\"descr\":\"康师傅\"}]}]"},{"title":"分类","date":"2022-05-15T15:06:27.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: 分类\ndate: 2022-05-15 23:06:27\ntype: \"categories\"\n---\n","updated":"2022-05-15T15:08:12.158Z","path":"categories/index.html","comments":1,"layout":"page","_id":"cl37g68j00001r4fsdk7e6yw0","content":"","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"","more":""},{"title":"友链","date":"2022-05-15T15:07:14.000Z","type":"link","_content":"","source":"link/index.md","raw":"---\ntitle: 友链\ndate: 2022-05-15 23:07:14\ntype: \"link\"\n---\n","updated":"2022-05-15T15:07:44.345Z","path":"link/index.html","comments":1,"layout":"page","_id":"cl37g68j10002r4fsax142jhq","content":"","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"","more":""},{"title":"标签","date":"2022-05-15T15:05:20.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: 标签\ndate: 2022-05-15 23:05:20\ntype: \"tags\"\n---\n","updated":"2022-05-15T15:07:58.612Z","path":"tags/index.html","comments":1,"layout":"page","_id":"cl37g68j10003r4fsao25dpc0","content":"","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"","more":""}],"Post":[{"title":"Hello World！","date":"2022-04-30T07:30:00.000Z","_content":"欢迎来到我的 Blog！这是本博客的第一篇文章。\n\n<!--more-->\n\n这是~~超厉害的~~ smilin9 历时两天（其实加起来不到一天）搭建的静态博客。\n\n非常感谢 [hawa130](https://hawa130.com/) 耐心解答我的一系列傻瓜问题。\n\n欢迎交流学习！\n\n\n\n\n\n\n\n\n\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World！\ndate: 2022-04-30 15:30:00\ntags: 垃圾桶\n---\n欢迎来到我的 Blog！这是本博客的第一篇文章。\n\n<!--more-->\n\n这是~~超厉害的~~ smilin9 历时两天（其实加起来不到一天）搭建的静态博客。\n\n非常感谢 [hawa130](https://hawa130.com/) 耐心解答我的一系列傻瓜问题。\n\n欢迎交流学习！\n\n\n\n\n\n\n\n\n\n","slug":"hello-world","published":1,"updated":"2022-05-28T08:18:28.424Z","_id":"cl2lnhlj0000084s2am0j7q4q","comments":1,"layout":"post","photos":[],"link":"","content":"<p>欢迎来到我的 Blog！这是本博客的第一篇文章。</p>\n<span id=\"more\"></span>\n\n<p>这是<del>超厉害的</del> smilin9 历时两天（其实加起来不到一天）搭建的静态博客。</p>\n<p>非常感谢 <a href=\"https://hawa130.com/\">hawa130</a> 耐心解答我的一系列傻瓜问题。</p>\n<p>欢迎交流学习！</p>\n","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"<p>欢迎来到我的 Blog！这是本博客的第一篇文章。</p>","more":"<p>这是<del>超厉害的</del> smilin9 历时两天（其实加起来不到一天）搭建的静态博客。</p>\n<p>非常感谢 <a href=\"https://hawa130.com/\">hawa130</a> 耐心解答我的一系列傻瓜问题。</p>\n<p>欢迎交流学习！</p>"},{"title":"Introduction To Cryptohack","date":"2022-05-01T11:33:32.000Z","cover":"https://img.hawa130.com/Introduction.jpg","mathjax":true,"_content":"\n做完第一章咯~\n\n<!--more-->\n\n做了大半天才做完，主要是 python 语法什么的写起来比较手生，有 python 基础的话可能会做得更顺手一点。\n\n这一章的知识都属于比较基础的，甚至大部分题几乎都是直接把 flag 怼脸上（笑\n\n做完题之后犹豫了一下博客是单纯写解题相关还是顺便附上知识点总结，想起之前说的浅（shen）浅（shen）记录，所以还是打算都写写，不是什么坏事捏。\n\n# Introduction To Cryptohack\n\n## Finding Flags\n\n### Description\n\nEach challenge is designed to help introduce you to a new piece of cryptography. Solving a challenge will require you to find a \"flag\".\n\nThese flags will usually be in the format`crypto{y0ur_f1rst_fl4g}`. The flag format helps you verify that you found the correct solution.\n\nTry submitting this into the form below to solve your first challenge.\n\n###  Analyze\n\n简单说了下 flag 是啥，格式是 `crypto{y0ur_f1rst_fl4g}`。flag 已经给咯，直接填~\n\n## Great Snakes\n\n### Description\n\nModern cryptography involves code, and code involves coding. CryptoHack provides a good opportunity to sharpen your skills.\n\nOf all modern programming languages, Python 3 stands out as ideal for quickly writing cryptographic scripts and attacks.\n\nRun the attached Python script and it will output your flag.\n\n###  Analyze\n\n就直接在 python3 下运行 .py 文件就看到 `flag` 咯。\n\n直接在 vscode 里跑的时候老是报错，发现第一行注释 `#!/usr/bin/env python3` 是给 Linux/macOS 环境准备的，Windows 直接删掉就好咯。\n\n~~（孤儿 Windows 实锤）~~\n\n## ASCII\n\n### Description\n\nASCII is a 7-bit encoding standard which allows the representation of text using the integers 0-127.\n\nUsing the below integer array, convert the numbers to their corresponding ASCII characters to obtain a flag.\n\n```\n[99, 114, 121, 112, 116, 111, 123, 65, 83, 67, 73, 73, 95, 112, 114, 49, 110, 116, 52, 98, 108, 51, 125]\n```\n\n> In Python, the `chr()` function can be used to convert an ASCII ordinal number to a character (the `ord()` function does the opposite).\n\n###  Analyze\n\n介绍了下 ASCII 是啥，直接按给出的 `chr()` 函数转换一下输出 `flag`。\n\n### Code\n\n```python\nord = [99, 114, 121, 112, 116, 111, 123, 65, 83, 67, 73, 73, 95, 112, 114, 49, 110, 116,\n       52, 98, 108, 51, 125]\n\nprint(''.join(chr(o) for o in ord))\n```\n\n### SumUp\n\n```python\nfunction:\nchr()  # ASCII-->char\nord()  # char-->ASCII\n```\n\n## Hex\n\n### Description\n\nWhen we encrypt something the resulting ciphertext commonly has bytes which are not printable ASCII characters. If we want to share our encrypted data, it's common to encode it into something more user-friendly and portable across different systems.\n\nIncluded below is a flag encoded as a hex string. Decode this back into bytes to get the flag.\n\n```\n63727970746f7b596f755f77696c6c5f62655f776f726b696e675f776974685f6865785f737472696e67735f615f6c6f747d\n```\n\n In Python, the `bytes.fromhex()` function can be used to convert hex to bytes. The `.hex()` instance method can be called on byte strings to get the hex representation.\n\n###  Analyze\n\n十六进制来咯。\n\n要求把给出的十六进制 decode 回 byte，用给出的函数直接 decode 输出。\n\n### Code\n\n```python\nh = '63727970746f7b596f755f77696c6c5f62655f776f726b696e675f77697685f6865785f737472696e67\\\n35f615f6c6f747d'\nprint(bytes.fromhex(h))\n```\n\n### SumUp\n\n```python\nfunction:\nbytes.fromhex()  # hex-->bytes\nbytes.hex()  # bytes-->hex\n```\n\n## Base64\n\n### Description\n\nAnother common encoding scheme is Base64, which allows us to represent binary data as an ASCII string using 64 characters. One character of a Base64 string encodes 6 bits, and so 4 characters of Base64 encode three 8-bit bytes.\n\nBase64 is most commonly used online, so binary data such as images can be easily included into HTML or CSS files.\n\nTake the below hex string, *decode* it into bytes and then *encode* it into Base64.\n\n```\n72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf\n```\n\n In Python, after importing the base64 module with `import base64`, you can use the `base64.b64encode()` function. Remember to decode the hex first as the challenge description states.\n\n###  Analyze\n\n是 base64 捏，给的是十六进制字符串，先用 `bytes.fromhex` 函数 encode 得到 byte，然后用 base64 库里的 `base64.b64encode()` 函数编码。\n\n记得先安 base64 库喔~\n\n### Code\n\n```python\nimport base64\n\nh = '72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf'\ndecode = bytes.fromhex(h)  # hex --> bytes\nprint(base64.b64encode(decode))  # base64 编码\n```\n\n### SumUp\n\n```python\nimport base64\nbase64.b64encode() # bytes-->base64Code\n```\n\n## Bytes and Big Integers\n\n### Description\n\nCryptosystems like RSA works on numbers, but messages are made up of characters. How should we convert our messages into numbers so that mathematical operations can be applied?\n\nThe most common way is to take the ordinal bytes of the message, convert them into hexadecimal, and concatenate. This can be interpreted as a base-16 number, and also represented in base-10.\n\nTo illustrate:\n\n```\nmessage: HELLO\nascii bytes: [72, 69, 76, 76, 79]\nhex bytes: [0x48, 0x45, 0x4c, 0x4c, 0x4f]\nbase-16: 0x48454c4c4f\nbase-10: 310400273487\n```\n\n> Python's PyCryptodome library implements this with the methods `Crypto.Util.number.bytes_to_long()` and `Crypto.Util.number.long_to_bytes()`. You may first have to install PyCryptodome and import it with `from Crypto.Util.number import *`. \n\nConvert the following integer back into a message:\n\n```\n11515195063862318899931685488813747395775516287289682636499965282714637259206269\n```\n\n###  Analyze\n\n给了一个大整数，用函数 `long_to_bytes()` 转化下就解决咯。\n\n### Code\n\n```python\nfrom Crypto.Util.number import *\n\nlis = 11515195063862318899931685488813747395775516287289682636499965282714637259206269\nprint(long_to_bytes(lis))\n```\n\n### SumUp\n\n```python\nfrom Crypto.Util.number import *\nCrypto.Util.number.bytes_to_long()\nCrypto.Util.number.long_to_bytes()\n```\n\n虽然但是，我一定要吐槽 Crypto 库，这也太烦了！\n\n安了之后还是不停报错说没有找到 Crypto 库，又是卸载重装又是重启。\n\n试了一系列办法之后求助互联网，去 `.\\python310\\Lib\\site-packages` 里面把 crypto 文件夹直接重命名为 Crypto，然后它就好了？代码就跑起来了！\n\n装 py 库真的可以治疗低血压。。\n\n## XOR Starter\n\n### Description\n\nXOR is a bitwise operator which returns 0 if the bits are the same, and 1 otherwise. In textbooks the XOR operator is denoted by ⊕, but in most challenges and programming languages you will see the caret `^` used instead.\n\n|  A   |  B   | Output |\n| :--: | :--: | :----: |\n|  0   |  0   |   0    |\n|  0   |  1   |   1    |\n|  1   |  0   |   1    |\n|  1   |  1   |   0    |\n\nFor longer binary numbers we XOR bit by bit: `0110 ^ 1010 = 1100`. We can XOR integers by first converting the integer from decimal to binary. We can XOR strings by first converting each character to the integer representing the Unicode character.\n\nGiven the string `\"label\"`, XOR each character with the integer `13`. Convert these integers back to a string and submit the flag as `crypto{new_string}`.\n\n> The Python `pwntools` library has a convenient `xor()` function that can XOR together data of different types and lengths.\n\n###  Analyze\n\n给了字符串 `\"label\"`，每个字符和整数 13 异或得到 flag。\n\n顺手下载 pwntools 和 pwn 库喔~\n\n`pip install pwntools`\n\n`pip install pwn`\n\n### Code\n\n```python\ndef XOR(str, key):\n    res=''\n    for s in str:\n        res += chr(ord(s) ^ key)\n    #print(o)\n    return res\n\nstr = 'label'\nflag = XOR(str,13)\nprint('crypto{%s}'% flag)\n```\n\n### SumUp\n\n```python\nfrom pwntools import xor\nxor()  # 可以把不同长度和类型的数据进行异或，什么类型的数据都可以喔\n```\n\n## XOR Properties\n\n### Description\n\nIn the last challenge, you saw how XOR worked at the level of bits. In this one, we're going to cover the properties of the XOR operation and then use them to undo a chain of operations that have encrypted a flag. Gaining an intuition for how this works will help greatly when you come to attacking real cryptosystems later, especially in the block ciphers category.\n\nThere are four main properties we should consider when we solve challenges using the XOR operator\n\n```\nCommutative: A ⊕ B = B ⊕ A\nAssociative: A ⊕ (B ⊕ C) = (A ⊕ B) ⊕ C\nIdentity: A ⊕ 0 = A\nSelf-Inverse: A ⊕ A = 0\n```\n\nLet's break this down. Commutative means that the order of the XOR operations is not important. Associative means that a chain of operations can be carried out without order (we do not need to worry about brackets). The identity is 0, so XOR with 0 \"does nothing\", and lastly something XOR'd with itself returns zero.\n\nLet's try this out in action! Below is a series of outputs where three random keys have been XOR'd together and with the flag. Use the above properties to undo the encryption in the final line to obtain the flag.\n\n```\nKEY1 = a6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313\nKEY2 ^ KEY1 = 37dcb292030faa90d07eec17e3b1c6d8daf94c35d4c9191a5e1e\nKEY2 ^ KEY3 = c1545756687e7573db23aa1c3452a098b71a7fbf0fddddde5fc1\nFLAG ^ KEY1 ^ KEY3 ^ KEY2 = 04ee9855208a2cd59091d04767ae47963170d1660df7f56f5faf\n```\n\n Before you XOR these objects, be sure to decode from hex to bytes.\n\n###  Analyze\n\n异或的一些性质~\n\n很简单的一点数学运算\n\n$$\\begin{align}&FK123⊕K1⊕K23 \\\\\\ =&(F⊕K1⊕K2⊕K3)⊕K1⊕(K2⊕K3) \\\\\\ =&(F⊕K2⊕K3)⊕0⊕(K2⊕K3) \\\\\\ =&(F⊕K2⊕K3)⊕(K2⊕K3) \\\\\\ =&F⊕0 \\\\\\ =&F\\end{align}$$\n\n（其实只是想浅试一下数学公式的功能~\n\n### Code\n\n```python\nfrom pwn import xor\nK1 = 'a6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313'\nK21 = '37dcb292030faa90d07eec17e3b1c6d8daf94c35d4c9191a5e1e'\nK23 = 'c1545756687e7573db23aa1c3452a098b71a7fbf0fddddde5fc1'\nFK132 = '04ee9855208a2cd59091d04767ae47963170d1660df7f56f5faf'\nflag = xor(bytes.fromhex(FK132), bytes.fromhex(K1), bytes.fromhex(K23))\nprint(flag)\n```\n\n## Favourite byte\n\n### Description\n\nFor the next few challenges, you'll use what you've just learned to solve some more XOR puzzles.\n\nI've hidden some data using XOR with a single byte, but that byte is a secret. Don't forget to decode from hex first.\n\n```\n73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d\n```\n\n###  Analyze\n\n先从16进制 decode 喔\n\n因为之和单个 byte 进行了异或，又知道 flag 的首字母是 `'c'`，所以可以用 decode 之后的第一位和 `'c'` 进行异或得到 secret。\n\n之后把整个字符串和 secret 异或之后输出。\n\n### Code\n\n```python\ndef xor_byte(a: bytes, b: int):\n    res = bytes([_a ^ b for _a in a])\n    return res\n\nlis = '73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d'\ndecode = bytes.fromhex(lis)\nsecret = decode[0] ^ ord('c')\nprint(xor_byte(decode, secret))\n```\n\n## You either know, XOR you don't\n\n### Description\n\nI've encrypted the flag with my secret key, you'll never be able to guess it.\n\n> Remember the flag format and how it might help you in this challenge!\n\n```\n0e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e263451150104\n```\n\n###  Analyze\n\n第一步当然也是从十六进制 decode 咯。\n\n和上一题的思路有点像捏，也可以利用 flag 的格式得到加密用到的 key。\n\n只要把 `'c'` 换成 `'crypto{'`，然后加上一点点的猜想~~（自动补全）~~就可以咯。\n\n### Code\n\n```python\nfrom pwn import xor\n\n\nlis = '0e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e263451150\\\n104'\ndecode = bytes.fromhex(lis)\nflag = 'crypto{'\n# akey = xor(decode[:7], [ord(o) for o in flag])\n# print(akey)\nkey = 'myXORkey'\nprint(xor(decode, key))\n\n# akey = myXORke,猜想key = myXORkey\n```\n\n## 致谢~~（被迫的）~~\n\n非常感谢 [hawa130](https://hawa130.com/) 对本文排版等问题的细心纠正。\n","source":"_posts/Introduction To Cryptohack.md","raw":"---\ntitle: Introduction To Cryptohack\ndate: 2022-05-01 19:33:32\ntags: cryptohack\ncover: https://img.hawa130.com/Introduction.jpg\nmathjax: true\n---\n\n做完第一章咯~\n\n<!--more-->\n\n做了大半天才做完，主要是 python 语法什么的写起来比较手生，有 python 基础的话可能会做得更顺手一点。\n\n这一章的知识都属于比较基础的，甚至大部分题几乎都是直接把 flag 怼脸上（笑\n\n做完题之后犹豫了一下博客是单纯写解题相关还是顺便附上知识点总结，想起之前说的浅（shen）浅（shen）记录，所以还是打算都写写，不是什么坏事捏。\n\n# Introduction To Cryptohack\n\n## Finding Flags\n\n### Description\n\nEach challenge is designed to help introduce you to a new piece of cryptography. Solving a challenge will require you to find a \"flag\".\n\nThese flags will usually be in the format`crypto{y0ur_f1rst_fl4g}`. The flag format helps you verify that you found the correct solution.\n\nTry submitting this into the form below to solve your first challenge.\n\n###  Analyze\n\n简单说了下 flag 是啥，格式是 `crypto{y0ur_f1rst_fl4g}`。flag 已经给咯，直接填~\n\n## Great Snakes\n\n### Description\n\nModern cryptography involves code, and code involves coding. CryptoHack provides a good opportunity to sharpen your skills.\n\nOf all modern programming languages, Python 3 stands out as ideal for quickly writing cryptographic scripts and attacks.\n\nRun the attached Python script and it will output your flag.\n\n###  Analyze\n\n就直接在 python3 下运行 .py 文件就看到 `flag` 咯。\n\n直接在 vscode 里跑的时候老是报错，发现第一行注释 `#!/usr/bin/env python3` 是给 Linux/macOS 环境准备的，Windows 直接删掉就好咯。\n\n~~（孤儿 Windows 实锤）~~\n\n## ASCII\n\n### Description\n\nASCII is a 7-bit encoding standard which allows the representation of text using the integers 0-127.\n\nUsing the below integer array, convert the numbers to their corresponding ASCII characters to obtain a flag.\n\n```\n[99, 114, 121, 112, 116, 111, 123, 65, 83, 67, 73, 73, 95, 112, 114, 49, 110, 116, 52, 98, 108, 51, 125]\n```\n\n> In Python, the `chr()` function can be used to convert an ASCII ordinal number to a character (the `ord()` function does the opposite).\n\n###  Analyze\n\n介绍了下 ASCII 是啥，直接按给出的 `chr()` 函数转换一下输出 `flag`。\n\n### Code\n\n```python\nord = [99, 114, 121, 112, 116, 111, 123, 65, 83, 67, 73, 73, 95, 112, 114, 49, 110, 116,\n       52, 98, 108, 51, 125]\n\nprint(''.join(chr(o) for o in ord))\n```\n\n### SumUp\n\n```python\nfunction:\nchr()  # ASCII-->char\nord()  # char-->ASCII\n```\n\n## Hex\n\n### Description\n\nWhen we encrypt something the resulting ciphertext commonly has bytes which are not printable ASCII characters. If we want to share our encrypted data, it's common to encode it into something more user-friendly and portable across different systems.\n\nIncluded below is a flag encoded as a hex string. Decode this back into bytes to get the flag.\n\n```\n63727970746f7b596f755f77696c6c5f62655f776f726b696e675f776974685f6865785f737472696e67735f615f6c6f747d\n```\n\n In Python, the `bytes.fromhex()` function can be used to convert hex to bytes. The `.hex()` instance method can be called on byte strings to get the hex representation.\n\n###  Analyze\n\n十六进制来咯。\n\n要求把给出的十六进制 decode 回 byte，用给出的函数直接 decode 输出。\n\n### Code\n\n```python\nh = '63727970746f7b596f755f77696c6c5f62655f776f726b696e675f77697685f6865785f737472696e67\\\n35f615f6c6f747d'\nprint(bytes.fromhex(h))\n```\n\n### SumUp\n\n```python\nfunction:\nbytes.fromhex()  # hex-->bytes\nbytes.hex()  # bytes-->hex\n```\n\n## Base64\n\n### Description\n\nAnother common encoding scheme is Base64, which allows us to represent binary data as an ASCII string using 64 characters. One character of a Base64 string encodes 6 bits, and so 4 characters of Base64 encode three 8-bit bytes.\n\nBase64 is most commonly used online, so binary data such as images can be easily included into HTML or CSS files.\n\nTake the below hex string, *decode* it into bytes and then *encode* it into Base64.\n\n```\n72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf\n```\n\n In Python, after importing the base64 module with `import base64`, you can use the `base64.b64encode()` function. Remember to decode the hex first as the challenge description states.\n\n###  Analyze\n\n是 base64 捏，给的是十六进制字符串，先用 `bytes.fromhex` 函数 encode 得到 byte，然后用 base64 库里的 `base64.b64encode()` 函数编码。\n\n记得先安 base64 库喔~\n\n### Code\n\n```python\nimport base64\n\nh = '72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf'\ndecode = bytes.fromhex(h)  # hex --> bytes\nprint(base64.b64encode(decode))  # base64 编码\n```\n\n### SumUp\n\n```python\nimport base64\nbase64.b64encode() # bytes-->base64Code\n```\n\n## Bytes and Big Integers\n\n### Description\n\nCryptosystems like RSA works on numbers, but messages are made up of characters. How should we convert our messages into numbers so that mathematical operations can be applied?\n\nThe most common way is to take the ordinal bytes of the message, convert them into hexadecimal, and concatenate. This can be interpreted as a base-16 number, and also represented in base-10.\n\nTo illustrate:\n\n```\nmessage: HELLO\nascii bytes: [72, 69, 76, 76, 79]\nhex bytes: [0x48, 0x45, 0x4c, 0x4c, 0x4f]\nbase-16: 0x48454c4c4f\nbase-10: 310400273487\n```\n\n> Python's PyCryptodome library implements this with the methods `Crypto.Util.number.bytes_to_long()` and `Crypto.Util.number.long_to_bytes()`. You may first have to install PyCryptodome and import it with `from Crypto.Util.number import *`. \n\nConvert the following integer back into a message:\n\n```\n11515195063862318899931685488813747395775516287289682636499965282714637259206269\n```\n\n###  Analyze\n\n给了一个大整数，用函数 `long_to_bytes()` 转化下就解决咯。\n\n### Code\n\n```python\nfrom Crypto.Util.number import *\n\nlis = 11515195063862318899931685488813747395775516287289682636499965282714637259206269\nprint(long_to_bytes(lis))\n```\n\n### SumUp\n\n```python\nfrom Crypto.Util.number import *\nCrypto.Util.number.bytes_to_long()\nCrypto.Util.number.long_to_bytes()\n```\n\n虽然但是，我一定要吐槽 Crypto 库，这也太烦了！\n\n安了之后还是不停报错说没有找到 Crypto 库，又是卸载重装又是重启。\n\n试了一系列办法之后求助互联网，去 `.\\python310\\Lib\\site-packages` 里面把 crypto 文件夹直接重命名为 Crypto，然后它就好了？代码就跑起来了！\n\n装 py 库真的可以治疗低血压。。\n\n## XOR Starter\n\n### Description\n\nXOR is a bitwise operator which returns 0 if the bits are the same, and 1 otherwise. In textbooks the XOR operator is denoted by ⊕, but in most challenges and programming languages you will see the caret `^` used instead.\n\n|  A   |  B   | Output |\n| :--: | :--: | :----: |\n|  0   |  0   |   0    |\n|  0   |  1   |   1    |\n|  1   |  0   |   1    |\n|  1   |  1   |   0    |\n\nFor longer binary numbers we XOR bit by bit: `0110 ^ 1010 = 1100`. We can XOR integers by first converting the integer from decimal to binary. We can XOR strings by first converting each character to the integer representing the Unicode character.\n\nGiven the string `\"label\"`, XOR each character with the integer `13`. Convert these integers back to a string and submit the flag as `crypto{new_string}`.\n\n> The Python `pwntools` library has a convenient `xor()` function that can XOR together data of different types and lengths.\n\n###  Analyze\n\n给了字符串 `\"label\"`，每个字符和整数 13 异或得到 flag。\n\n顺手下载 pwntools 和 pwn 库喔~\n\n`pip install pwntools`\n\n`pip install pwn`\n\n### Code\n\n```python\ndef XOR(str, key):\n    res=''\n    for s in str:\n        res += chr(ord(s) ^ key)\n    #print(o)\n    return res\n\nstr = 'label'\nflag = XOR(str,13)\nprint('crypto{%s}'% flag)\n```\n\n### SumUp\n\n```python\nfrom pwntools import xor\nxor()  # 可以把不同长度和类型的数据进行异或，什么类型的数据都可以喔\n```\n\n## XOR Properties\n\n### Description\n\nIn the last challenge, you saw how XOR worked at the level of bits. In this one, we're going to cover the properties of the XOR operation and then use them to undo a chain of operations that have encrypted a flag. Gaining an intuition for how this works will help greatly when you come to attacking real cryptosystems later, especially in the block ciphers category.\n\nThere are four main properties we should consider when we solve challenges using the XOR operator\n\n```\nCommutative: A ⊕ B = B ⊕ A\nAssociative: A ⊕ (B ⊕ C) = (A ⊕ B) ⊕ C\nIdentity: A ⊕ 0 = A\nSelf-Inverse: A ⊕ A = 0\n```\n\nLet's break this down. Commutative means that the order of the XOR operations is not important. Associative means that a chain of operations can be carried out without order (we do not need to worry about brackets). The identity is 0, so XOR with 0 \"does nothing\", and lastly something XOR'd with itself returns zero.\n\nLet's try this out in action! Below is a series of outputs where three random keys have been XOR'd together and with the flag. Use the above properties to undo the encryption in the final line to obtain the flag.\n\n```\nKEY1 = a6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313\nKEY2 ^ KEY1 = 37dcb292030faa90d07eec17e3b1c6d8daf94c35d4c9191a5e1e\nKEY2 ^ KEY3 = c1545756687e7573db23aa1c3452a098b71a7fbf0fddddde5fc1\nFLAG ^ KEY1 ^ KEY3 ^ KEY2 = 04ee9855208a2cd59091d04767ae47963170d1660df7f56f5faf\n```\n\n Before you XOR these objects, be sure to decode from hex to bytes.\n\n###  Analyze\n\n异或的一些性质~\n\n很简单的一点数学运算\n\n$$\\begin{align}&FK123⊕K1⊕K23 \\\\\\ =&(F⊕K1⊕K2⊕K3)⊕K1⊕(K2⊕K3) \\\\\\ =&(F⊕K2⊕K3)⊕0⊕(K2⊕K3) \\\\\\ =&(F⊕K2⊕K3)⊕(K2⊕K3) \\\\\\ =&F⊕0 \\\\\\ =&F\\end{align}$$\n\n（其实只是想浅试一下数学公式的功能~\n\n### Code\n\n```python\nfrom pwn import xor\nK1 = 'a6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313'\nK21 = '37dcb292030faa90d07eec17e3b1c6d8daf94c35d4c9191a5e1e'\nK23 = 'c1545756687e7573db23aa1c3452a098b71a7fbf0fddddde5fc1'\nFK132 = '04ee9855208a2cd59091d04767ae47963170d1660df7f56f5faf'\nflag = xor(bytes.fromhex(FK132), bytes.fromhex(K1), bytes.fromhex(K23))\nprint(flag)\n```\n\n## Favourite byte\n\n### Description\n\nFor the next few challenges, you'll use what you've just learned to solve some more XOR puzzles.\n\nI've hidden some data using XOR with a single byte, but that byte is a secret. Don't forget to decode from hex first.\n\n```\n73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d\n```\n\n###  Analyze\n\n先从16进制 decode 喔\n\n因为之和单个 byte 进行了异或，又知道 flag 的首字母是 `'c'`，所以可以用 decode 之后的第一位和 `'c'` 进行异或得到 secret。\n\n之后把整个字符串和 secret 异或之后输出。\n\n### Code\n\n```python\ndef xor_byte(a: bytes, b: int):\n    res = bytes([_a ^ b for _a in a])\n    return res\n\nlis = '73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d'\ndecode = bytes.fromhex(lis)\nsecret = decode[0] ^ ord('c')\nprint(xor_byte(decode, secret))\n```\n\n## You either know, XOR you don't\n\n### Description\n\nI've encrypted the flag with my secret key, you'll never be able to guess it.\n\n> Remember the flag format and how it might help you in this challenge!\n\n```\n0e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e263451150104\n```\n\n###  Analyze\n\n第一步当然也是从十六进制 decode 咯。\n\n和上一题的思路有点像捏，也可以利用 flag 的格式得到加密用到的 key。\n\n只要把 `'c'` 换成 `'crypto{'`，然后加上一点点的猜想~~（自动补全）~~就可以咯。\n\n### Code\n\n```python\nfrom pwn import xor\n\n\nlis = '0e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e263451150\\\n104'\ndecode = bytes.fromhex(lis)\nflag = 'crypto{'\n# akey = xor(decode[:7], [ord(o) for o in flag])\n# print(akey)\nkey = 'myXORkey'\nprint(xor(decode, key))\n\n# akey = myXORke,猜想key = myXORkey\n```\n\n## 致谢~~（被迫的）~~\n\n非常感谢 [hawa130](https://hawa130.com/) 对本文排版等问题的细心纠正。\n","slug":"Introduction To Cryptohack","published":1,"updated":"2022-05-29T16:57:17.711Z","_id":"cl2neel3w0000dss27mh13an9","comments":1,"layout":"post","photos":[],"link":"","content":"<p>做完第一章咯~</p>\n<span id=\"more\"></span>\n\n<p>做了大半天才做完，主要是 python 语法什么的写起来比较手生，有 python 基础的话可能会做得更顺手一点。</p>\n<p>这一章的知识都属于比较基础的，甚至大部分题几乎都是直接把 flag 怼脸上（笑</p>\n<p>做完题之后犹豫了一下博客是单纯写解题相关还是顺便附上知识点总结，想起之前说的浅（shen）浅（shen）记录，所以还是打算都写写，不是什么坏事捏。</p>\n<h1 id=\"Introduction-To-Cryptohack\"><a href=\"#Introduction-To-Cryptohack\" class=\"headerlink\" title=\"Introduction To Cryptohack\"></a>Introduction To Cryptohack</h1><h2 id=\"Finding-Flags\"><a href=\"#Finding-Flags\" class=\"headerlink\" title=\"Finding Flags\"></a>Finding Flags</h2><h3 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Each challenge is designed to help introduce you to a new piece of cryptography. Solving a challenge will require you to find a “flag”.</p>\n<p>These flags will usually be in the format<code>crypto&#123;y0ur_f1rst_fl4g&#125;</code>. The flag format helps you verify that you found the correct solution.</p>\n<p>Try submitting this into the form below to solve your first challenge.</p>\n<h3 id=\"Analyze\"><a href=\"#Analyze\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>简单说了下 flag 是啥，格式是 <code>crypto&#123;y0ur_f1rst_fl4g&#125;</code>。flag 已经给咯，直接填~</p>\n<h2 id=\"Great-Snakes\"><a href=\"#Great-Snakes\" class=\"headerlink\" title=\"Great Snakes\"></a>Great Snakes</h2><h3 id=\"Description-1\"><a href=\"#Description-1\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Modern cryptography involves code, and code involves coding. CryptoHack provides a good opportunity to sharpen your skills.</p>\n<p>Of all modern programming languages, Python 3 stands out as ideal for quickly writing cryptographic scripts and attacks.</p>\n<p>Run the attached Python script and it will output your flag.</p>\n<h3 id=\"Analyze-1\"><a href=\"#Analyze-1\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>就直接在 python3 下运行 .py 文件就看到 <code>flag</code> 咯。</p>\n<p>直接在 vscode 里跑的时候老是报错，发现第一行注释 <code>#!/usr/bin/env python3</code> 是给 Linux&#x2F;macOS 环境准备的，Windows 直接删掉就好咯。</p>\n<p><del>（孤儿 Windows 实锤）</del></p>\n<h2 id=\"ASCII\"><a href=\"#ASCII\" class=\"headerlink\" title=\"ASCII\"></a>ASCII</h2><h3 id=\"Description-2\"><a href=\"#Description-2\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>ASCII is a 7-bit encoding standard which allows the representation of text using the integers 0-127.</p>\n<p>Using the below integer array, convert the numbers to their corresponding ASCII characters to obtain a flag.</p>\n<figure class=\"highlight accesslog\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">[99, 114, 121, 112, 116, 111, 123, 65, 83, 67, 73, 73, 95, 112, 114, 49, 110, 116, 52, 98, 108, 51, 125]</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>In Python, the <code>chr()</code> function can be used to convert an ASCII ordinal number to a character (the <code>ord()</code> function does the opposite).</p>\n</blockquote>\n<h3 id=\"Analyze-2\"><a href=\"#Analyze-2\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>介绍了下 ASCII 是啥，直接按给出的 <code>chr()</code> 函数转换一下输出 <code>flag</code>。</p>\n<h3 id=\"Code\"><a href=\"#Code\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">ord</span> = [<span class=\"number\">99</span>, <span class=\"number\">114</span>, <span class=\"number\">121</span>, <span class=\"number\">112</span>, <span class=\"number\">116</span>, <span class=\"number\">111</span>, <span class=\"number\">123</span>, <span class=\"number\">65</span>, <span class=\"number\">83</span>, <span class=\"number\">67</span>, <span class=\"number\">73</span>, <span class=\"number\">73</span>, <span class=\"number\">95</span>, <span class=\"number\">112</span>, <span class=\"number\">114</span>, <span class=\"number\">49</span>, <span class=\"number\">110</span>, <span class=\"number\">116</span>,</span><br><span class=\"line\">       <span class=\"number\">52</span>, <span class=\"number\">98</span>, <span class=\"number\">108</span>, <span class=\"number\">51</span>, <span class=\"number\">125</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;&#x27;</span>.join(<span class=\"built_in\">chr</span>(o) <span class=\"keyword\">for</span> o <span class=\"keyword\">in</span> <span class=\"built_in\">ord</span>))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp\"><a href=\"#SumUp\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">function:</span><br><span class=\"line\"><span class=\"built_in\">chr</span>()  <span class=\"comment\"># ASCII--&gt;char</span></span><br><span class=\"line\"><span class=\"built_in\">ord</span>()  <span class=\"comment\"># char--&gt;ASCII</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Hex\"><a href=\"#Hex\" class=\"headerlink\" title=\"Hex\"></a>Hex</h2><h3 id=\"Description-3\"><a href=\"#Description-3\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>When we encrypt something the resulting ciphertext commonly has bytes which are not printable ASCII characters. If we want to share our encrypted data, it’s common to encode it into something more user-friendly and portable across different systems.</p>\n<p>Included below is a flag encoded as a hex string. Decode this back into bytes to get the flag.</p>\n<figure class=\"highlight llvm\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">63727970746</span>f<span class=\"number\">7</span>b<span class=\"number\">596</span>f<span class=\"number\">755</span>f<span class=\"number\">77696</span><span class=\"keyword\">c</span><span class=\"number\">6</span><span class=\"keyword\">c</span><span class=\"number\">5</span>f<span class=\"number\">62655</span>f<span class=\"number\">776</span>f<span class=\"number\">726</span>b<span class=\"number\">696e675</span>f<span class=\"number\">776974685</span>f<span class=\"number\">6865785</span>f<span class=\"number\">737472696e67735</span>f<span class=\"number\">615</span>f<span class=\"number\">6</span><span class=\"keyword\">c</span><span class=\"number\">6</span>f<span class=\"number\">747</span>d</span><br></pre></td></tr></table></figure>\n\n<p> In Python, the <code>bytes.fromhex()</code> function can be used to convert hex to bytes. The <code>.hex()</code> instance method can be called on byte strings to get the hex representation.</p>\n<h3 id=\"Analyze-3\"><a href=\"#Analyze-3\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>十六进制来咯。</p>\n<p>要求把给出的十六进制 decode 回 byte，用给出的函数直接 decode 输出。</p>\n<h3 id=\"Code-1\"><a href=\"#Code-1\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">h = <span class=\"string\">&#x27;63727970746f7b596f755f77696c6c5f62655f776f726b696e675f77697685f6865785f737472696e67\\</span></span><br><span class=\"line\"><span class=\"string\">35f615f6c6f747d&#x27;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">bytes</span>.fromhex(h))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-1\"><a href=\"#SumUp-1\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">function:</span><br><span class=\"line\"><span class=\"built_in\">bytes</span>.fromhex()  <span class=\"comment\"># hex--&gt;bytes</span></span><br><span class=\"line\"><span class=\"built_in\">bytes</span>.<span class=\"built_in\">hex</span>()  <span class=\"comment\"># bytes--&gt;hex</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Base64\"><a href=\"#Base64\" class=\"headerlink\" title=\"Base64\"></a>Base64</h2><h3 id=\"Description-4\"><a href=\"#Description-4\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Another common encoding scheme is Base64, which allows us to represent binary data as an ASCII string using 64 characters. One character of a Base64 string encodes 6 bits, and so 4 characters of Base64 encode three 8-bit bytes.</p>\n<p>Base64 is most commonly used online, so binary data such as images can be easily included into HTML or CSS files.</p>\n<p>Take the below hex string, <em>decode</em> it into bytes and then <em>encode</em> it into Base64.</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf</span><br></pre></td></tr></table></figure>\n\n<p> In Python, after importing the base64 module with <code>import base64</code>, you can use the <code>base64.b64encode()</code> function. Remember to decode the hex first as the challenge description states.</p>\n<h3 id=\"Analyze-4\"><a href=\"#Analyze-4\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>是 base64 捏，给的是十六进制字符串，先用 <code>bytes.fromhex</code> 函数 encode 得到 byte，然后用 base64 库里的 <code>base64.b64encode()</code> 函数编码。</p>\n<p>记得先安 base64 库喔~</p>\n<h3 id=\"Code-2\"><a href=\"#Code-2\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> base64</span><br><span class=\"line\"></span><br><span class=\"line\">h = <span class=\"string\">&#x27;72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf&#x27;</span></span><br><span class=\"line\">decode = <span class=\"built_in\">bytes</span>.fromhex(h)  <span class=\"comment\"># hex --&gt; bytes</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(base64.b64encode(decode))  <span class=\"comment\"># base64 编码</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-2\"><a href=\"#SumUp-2\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> base64</span><br><span class=\"line\">base64.b64encode() <span class=\"comment\"># bytes--&gt;base64Code</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Bytes-and-Big-Integers\"><a href=\"#Bytes-and-Big-Integers\" class=\"headerlink\" title=\"Bytes and Big Integers\"></a>Bytes and Big Integers</h2><h3 id=\"Description-5\"><a href=\"#Description-5\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Cryptosystems like RSA works on numbers, but messages are made up of characters. How should we convert our messages into numbers so that mathematical operations can be applied?</p>\n<p>The most common way is to take the ordinal bytes of the message, convert them into hexadecimal, and concatenate. This can be interpreted as a base-16 number, and also represented in base-10.</p>\n<p>To illustrate:</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">message</span>: HELLO</span><br><span class=\"line\"><span class=\"attribute\">ascii</span> bytes:<span class=\"meta\"> [72, 69, 76, 76, 79]</span></span><br><span class=\"line\"><span class=\"attribute\">hex</span> bytes:<span class=\"meta\"> [0x48, 0x45, 0x4c, 0x4c, 0x4f]</span></span><br><span class=\"line\"><span class=\"attribute\">base</span>-<span class=\"number\">16</span>: <span class=\"number\">0</span>x48454c4c4f</span><br><span class=\"line\"><span class=\"attribute\">base</span>-<span class=\"number\">10</span>: <span class=\"number\">310400273487</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Python’s PyCryptodome library implements this with the methods <code>Crypto.Util.number.bytes_to_long()</code> and <code>Crypto.Util.number.long_to_bytes()</code>. You may first have to install PyCryptodome and import it with <code>from Crypto.Util.number import *</code>. </p>\n</blockquote>\n<p>Convert the following integer back into a message:</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">11515195063862318899931685488813747395775516287289682636499965282714637259206269</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Analyze-5\"><a href=\"#Analyze-5\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>给了一个大整数，用函数 <code>long_to_bytes()</code> 转化下就解决咯。</p>\n<h3 id=\"Code-3\"><a href=\"#Code-3\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> Crypto.Util.number <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">lis = <span class=\"number\">11515195063862318899931685488813747395775516287289682636499965282714637259206269</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(long_to_bytes(lis))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-3\"><a href=\"#SumUp-3\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> Crypto.Util.number <span class=\"keyword\">import</span> *</span><br><span class=\"line\">Crypto.Util.number.bytes_to_long()</span><br><span class=\"line\">Crypto.Util.number.long_to_bytes()</span><br></pre></td></tr></table></figure>\n\n<p>虽然但是，我一定要吐槽 Crypto 库，这也太烦了！</p>\n<p>安了之后还是不停报错说没有找到 Crypto 库，又是卸载重装又是重启。</p>\n<p>试了一系列办法之后求助互联网，去 <code>.\\python310\\Lib\\site-packages</code> 里面把 crypto 文件夹直接重命名为 Crypto，然后它就好了？代码就跑起来了！</p>\n<p>装 py 库真的可以治疗低血压。。</p>\n<h2 id=\"XOR-Starter\"><a href=\"#XOR-Starter\" class=\"headerlink\" title=\"XOR Starter\"></a>XOR Starter</h2><h3 id=\"Description-6\"><a href=\"#Description-6\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>XOR is a bitwise operator which returns 0 if the bits are the same, and 1 otherwise. In textbooks the XOR operator is denoted by ⊕, but in most challenges and programming languages you will see the caret <code>^</code> used instead.</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">A</th>\n<th align=\"center\">B</th>\n<th align=\"center\">Output</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">0</td>\n<td align=\"center\">0</td>\n<td align=\"center\">0</td>\n</tr>\n<tr>\n<td align=\"center\">0</td>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td align=\"center\">1</td>\n<td align=\"center\">0</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n<td align=\"center\">0</td>\n</tr>\n</tbody></table>\n<p>For longer binary numbers we XOR bit by bit: <code>0110 ^ 1010 = 1100</code>. We can XOR integers by first converting the integer from decimal to binary. We can XOR strings by first converting each character to the integer representing the Unicode character.</p>\n<p>Given the string <code>&quot;label&quot;</code>, XOR each character with the integer <code>13</code>. Convert these integers back to a string and submit the flag as <code>crypto&#123;new_string&#125;</code>.</p>\n<blockquote>\n<p>The Python <code>pwntools</code> library has a convenient <code>xor()</code> function that can XOR together data of different types and lengths.</p>\n</blockquote>\n<h3 id=\"Analyze-6\"><a href=\"#Analyze-6\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>给了字符串 <code>&quot;label&quot;</code>，每个字符和整数 13 异或得到 flag。</p>\n<p>顺手下载 pwntools 和 pwn 库喔~</p>\n<p><code>pip install pwntools</code></p>\n<p><code>pip install pwn</code></p>\n<h3 id=\"Code-4\"><a href=\"#Code-4\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">XOR</span>(<span class=\"params\"><span class=\"built_in\">str</span>, key</span>):</span><br><span class=\"line\">    res=<span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> s <span class=\"keyword\">in</span> <span class=\"built_in\">str</span>:</span><br><span class=\"line\">        res += <span class=\"built_in\">chr</span>(<span class=\"built_in\">ord</span>(s) ^ key)</span><br><span class=\"line\">    <span class=\"comment\">#print(o)</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">str</span> = <span class=\"string\">&#x27;label&#x27;</span></span><br><span class=\"line\">flag = XOR(<span class=\"built_in\">str</span>,<span class=\"number\">13</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;crypto&#123;%s&#125;&#x27;</span>% flag)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-4\"><a href=\"#SumUp-4\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwntools <span class=\"keyword\">import</span> xor</span><br><span class=\"line\">xor()  <span class=\"comment\"># 可以把不同长度和类型的数据进行异或，什么类型的数据都可以喔</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"XOR-Properties\"><a href=\"#XOR-Properties\" class=\"headerlink\" title=\"XOR Properties\"></a>XOR Properties</h2><h3 id=\"Description-7\"><a href=\"#Description-7\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>In the last challenge, you saw how XOR worked at the level of bits. In this one, we’re going to cover the properties of the XOR operation and then use them to undo a chain of operations that have encrypted a flag. Gaining an intuition for how this works will help greatly when you come to attacking real cryptosystems later, especially in the block ciphers category.</p>\n<p>There are four main properties we should consider when we solve challenges using the XOR operator</p>\n<figure class=\"highlight dns\"><table><tr><td class=\"code\"><pre><span class=\"line\">Commutative: <span class=\"keyword\">A</span> ⊕ B = B ⊕ <span class=\"keyword\">A</span></span><br><span class=\"line\">Associative: <span class=\"keyword\">A</span> ⊕ (B ⊕ C) = (<span class=\"keyword\">A</span> ⊕ B) ⊕ C</span><br><span class=\"line\">Identity: <span class=\"keyword\">A</span> ⊕ <span class=\"number\">0</span> = <span class=\"keyword\">A</span></span><br><span class=\"line\">Self-Inverse: <span class=\"keyword\">A</span> ⊕ <span class=\"keyword\">A</span> = <span class=\"number\">0</span></span><br></pre></td></tr></table></figure>\n\n<p>Let’s break this down. Commutative means that the order of the XOR operations is not important. Associative means that a chain of operations can be carried out without order (we do not need to worry about brackets). The identity is 0, so XOR with 0 “does nothing”, and lastly something XOR’d with itself returns zero.</p>\n<p>Let’s try this out in action! Below is a series of outputs where three random keys have been XOR’d together and with the flag. Use the above properties to undo the encryption in the final line to obtain the flag.</p>\n<figure class=\"highlight llvm\"><table><tr><td class=\"code\"><pre><span class=\"line\">KEY<span class=\"number\">1</span> <span class=\"operator\">=</span> a<span class=\"number\">6</span><span class=\"keyword\">c</span><span class=\"number\">8</span>b<span class=\"number\">6733</span><span class=\"keyword\">c</span><span class=\"number\">9</span>b<span class=\"number\">22</span>de<span class=\"number\">7</span>bc<span class=\"number\">0253266</span>a<span class=\"number\">3867</span>df<span class=\"number\">55</span>acde<span class=\"number\">8635e19</span><span class=\"keyword\">c</span><span class=\"number\">73313</span></span><br><span class=\"line\">KEY<span class=\"number\">2</span> ^ KEY<span class=\"number\">1</span> <span class=\"operator\">=</span> <span class=\"number\">37</span>dcb<span class=\"number\">292030</span>faa<span class=\"number\">90</span>d<span class=\"number\">07</span>eec<span class=\"number\">17e3</span>b<span class=\"number\">1</span><span class=\"keyword\">c</span><span class=\"number\">6</span>d<span class=\"number\">8</span>daf<span class=\"number\">94</span><span class=\"keyword\">c</span><span class=\"number\">35</span>d<span class=\"number\">4</span><span class=\"keyword\">c</span><span class=\"number\">9191</span>a<span class=\"number\">5e1</span>e</span><br><span class=\"line\">KEY<span class=\"number\">2</span> ^ KEY<span class=\"number\">3</span> <span class=\"operator\">=</span> <span class=\"keyword\">c</span><span class=\"number\">1545756687e7573</span>db<span class=\"number\">23</span>aa<span class=\"number\">1</span><span class=\"keyword\">c</span><span class=\"number\">3452</span>a<span class=\"number\">098</span>b<span class=\"number\">71</span>a<span class=\"number\">7</span>fbf<span class=\"number\">0</span>fddddde<span class=\"number\">5</span>fc<span class=\"number\">1</span></span><br><span class=\"line\">FLAG ^ KEY<span class=\"number\">1</span> ^ KEY<span class=\"number\">3</span> ^ KEY<span class=\"number\">2</span> <span class=\"operator\">=</span> <span class=\"number\">04</span>ee<span class=\"number\">9855208</span>a<span class=\"number\">2</span>cd<span class=\"number\">59091</span>d<span class=\"number\">04767</span>ae<span class=\"number\">47963170</span>d<span class=\"number\">1660</span>df<span class=\"number\">7</span>f<span class=\"number\">56</span>f<span class=\"number\">5</span>faf</span><br></pre></td></tr></table></figure>\n\n<p> Before you XOR these objects, be sure to decode from hex to bytes.</p>\n<h3 id=\"Analyze-7\"><a href=\"#Analyze-7\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>异或的一些性质~</p>\n<p>很简单的一点数学运算</p>\n<p>$$\\begin{align}&amp;FK123⊕K1⊕K23 \\\\ &#x3D;&amp;(F⊕K1⊕K2⊕K3)⊕K1⊕(K2⊕K3) \\\\ &#x3D;&amp;(F⊕K2⊕K3)⊕0⊕(K2⊕K3) \\\\ &#x3D;&amp;(F⊕K2⊕K3)⊕(K2⊕K3) \\\\ &#x3D;&amp;F⊕0 \\\\ &#x3D;&amp;F\\end{align}$$</p>\n<p>（其实只是想浅试一下数学公式的功能~</p>\n<h3 id=\"Code-5\"><a href=\"#Code-5\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> xor</span><br><span class=\"line\">K1 = <span class=\"string\">&#x27;a6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313&#x27;</span></span><br><span class=\"line\">K21 = <span class=\"string\">&#x27;37dcb292030faa90d07eec17e3b1c6d8daf94c35d4c9191a5e1e&#x27;</span></span><br><span class=\"line\">K23 = <span class=\"string\">&#x27;c1545756687e7573db23aa1c3452a098b71a7fbf0fddddde5fc1&#x27;</span></span><br><span class=\"line\">FK132 = <span class=\"string\">&#x27;04ee9855208a2cd59091d04767ae47963170d1660df7f56f5faf&#x27;</span></span><br><span class=\"line\">flag = xor(<span class=\"built_in\">bytes</span>.fromhex(FK132), <span class=\"built_in\">bytes</span>.fromhex(K1), <span class=\"built_in\">bytes</span>.fromhex(K23))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(flag)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Favourite-byte\"><a href=\"#Favourite-byte\" class=\"headerlink\" title=\"Favourite byte\"></a>Favourite byte</h2><h3 id=\"Description-8\"><a href=\"#Description-8\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>For the next few challenges, you’ll use what you’ve just learned to solve some more XOR puzzles.</p>\n<p>I’ve hidden some data using XOR with a single byte, but that byte is a secret. Don’t forget to decode from hex first.</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Analyze-8\"><a href=\"#Analyze-8\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>先从16进制 decode 喔</p>\n<p>因为之和单个 byte 进行了异或，又知道 flag 的首字母是 <code>&#39;c&#39;</code>，所以可以用 decode 之后的第一位和 <code>&#39;c&#39;</code> 进行异或得到 secret。</p>\n<p>之后把整个字符串和 secret 异或之后输出。</p>\n<h3 id=\"Code-6\"><a href=\"#Code-6\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">xor_byte</span>(<span class=\"params\">a: <span class=\"built_in\">bytes</span>, b: <span class=\"built_in\">int</span></span>):</span><br><span class=\"line\">    res = <span class=\"built_in\">bytes</span>([_a ^ b <span class=\"keyword\">for</span> _a <span class=\"keyword\">in</span> a])</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res</span><br><span class=\"line\"></span><br><span class=\"line\">lis = <span class=\"string\">&#x27;73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d&#x27;</span></span><br><span class=\"line\">decode = <span class=\"built_in\">bytes</span>.fromhex(lis)</span><br><span class=\"line\">secret = decode[<span class=\"number\">0</span>] ^ <span class=\"built_in\">ord</span>(<span class=\"string\">&#x27;c&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(xor_byte(decode, secret))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"You-either-know-XOR-you-don’t\"><a href=\"#You-either-know-XOR-you-don’t\" class=\"headerlink\" title=\"You either know, XOR you don’t\"></a>You either know, XOR you don’t</h2><h3 id=\"Description-9\"><a href=\"#Description-9\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>I’ve encrypted the flag with my secret key, you’ll never be able to guess it.</p>\n<blockquote>\n<p>Remember the flag format and how it might help you in this challenge!</p>\n</blockquote>\n<figure class=\"highlight dns\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">0</span>e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e<span class=\"number\">263451150104</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Analyze-9\"><a href=\"#Analyze-9\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>第一步当然也是从十六进制 decode 咯。</p>\n<p>和上一题的思路有点像捏，也可以利用 flag 的格式得到加密用到的 key。</p>\n<p>只要把 <code>&#39;c&#39;</code> 换成 <code>&#39;crypto&#123;&#39;</code>，然后加上一点点的猜想<del>（自动补全）</del>就可以咯。</p>\n<h3 id=\"Code-7\"><a href=\"#Code-7\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> xor</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">lis = <span class=\"string\">&#x27;0e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e263451150\\</span></span><br><span class=\"line\"><span class=\"string\">104&#x27;</span></span><br><span class=\"line\">decode = <span class=\"built_in\">bytes</span>.fromhex(lis)</span><br><span class=\"line\">flag = <span class=\"string\">&#x27;crypto&#123;&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># akey = xor(decode[:7], [ord(o) for o in flag])</span></span><br><span class=\"line\"><span class=\"comment\"># print(akey)</span></span><br><span class=\"line\">key = <span class=\"string\">&#x27;myXORkey&#x27;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(xor(decode, key))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># akey = myXORke,猜想key = myXORkey</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"致谢（被迫的）\"><a href=\"#致谢（被迫的）\" class=\"headerlink\" title=\"致谢（被迫的）\"></a>致谢<del>（被迫的）</del></h2><p>非常感谢 <a href=\"https://hawa130.com/\">hawa130</a> 对本文排版等问题的细心纠正。</p>\n","site":{"data":{}},"excerpt":"<p>做完第一章咯~</p>","more":"<p>做了大半天才做完，主要是 python 语法什么的写起来比较手生，有 python 基础的话可能会做得更顺手一点。</p>\n<p>这一章的知识都属于比较基础的，甚至大部分题几乎都是直接把 flag 怼脸上（笑</p>\n<p>做完题之后犹豫了一下博客是单纯写解题相关还是顺便附上知识点总结，想起之前说的浅（shen）浅（shen）记录，所以还是打算都写写，不是什么坏事捏。</p>\n<h1 id=\"Introduction-To-Cryptohack\"><a href=\"#Introduction-To-Cryptohack\" class=\"headerlink\" title=\"Introduction To Cryptohack\"></a>Introduction To Cryptohack</h1><h2 id=\"Finding-Flags\"><a href=\"#Finding-Flags\" class=\"headerlink\" title=\"Finding Flags\"></a>Finding Flags</h2><h3 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Each challenge is designed to help introduce you to a new piece of cryptography. Solving a challenge will require you to find a “flag”.</p>\n<p>These flags will usually be in the format<code>crypto&#123;y0ur_f1rst_fl4g&#125;</code>. The flag format helps you verify that you found the correct solution.</p>\n<p>Try submitting this into the form below to solve your first challenge.</p>\n<h3 id=\"Analyze\"><a href=\"#Analyze\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>简单说了下 flag 是啥，格式是 <code>crypto&#123;y0ur_f1rst_fl4g&#125;</code>。flag 已经给咯，直接填~</p>\n<h2 id=\"Great-Snakes\"><a href=\"#Great-Snakes\" class=\"headerlink\" title=\"Great Snakes\"></a>Great Snakes</h2><h3 id=\"Description-1\"><a href=\"#Description-1\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Modern cryptography involves code, and code involves coding. CryptoHack provides a good opportunity to sharpen your skills.</p>\n<p>Of all modern programming languages, Python 3 stands out as ideal for quickly writing cryptographic scripts and attacks.</p>\n<p>Run the attached Python script and it will output your flag.</p>\n<h3 id=\"Analyze-1\"><a href=\"#Analyze-1\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>就直接在 python3 下运行 .py 文件就看到 <code>flag</code> 咯。</p>\n<p>直接在 vscode 里跑的时候老是报错，发现第一行注释 <code>#!/usr/bin/env python3</code> 是给 Linux&#x2F;macOS 环境准备的，Windows 直接删掉就好咯。</p>\n<p><del>（孤儿 Windows 实锤）</del></p>\n<h2 id=\"ASCII\"><a href=\"#ASCII\" class=\"headerlink\" title=\"ASCII\"></a>ASCII</h2><h3 id=\"Description-2\"><a href=\"#Description-2\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>ASCII is a 7-bit encoding standard which allows the representation of text using the integers 0-127.</p>\n<p>Using the below integer array, convert the numbers to their corresponding ASCII characters to obtain a flag.</p>\n<figure class=\"highlight accesslog\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">[99, 114, 121, 112, 116, 111, 123, 65, 83, 67, 73, 73, 95, 112, 114, 49, 110, 116, 52, 98, 108, 51, 125]</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>In Python, the <code>chr()</code> function can be used to convert an ASCII ordinal number to a character (the <code>ord()</code> function does the opposite).</p>\n</blockquote>\n<h3 id=\"Analyze-2\"><a href=\"#Analyze-2\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>介绍了下 ASCII 是啥，直接按给出的 <code>chr()</code> 函数转换一下输出 <code>flag</code>。</p>\n<h3 id=\"Code\"><a href=\"#Code\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">ord</span> = [<span class=\"number\">99</span>, <span class=\"number\">114</span>, <span class=\"number\">121</span>, <span class=\"number\">112</span>, <span class=\"number\">116</span>, <span class=\"number\">111</span>, <span class=\"number\">123</span>, <span class=\"number\">65</span>, <span class=\"number\">83</span>, <span class=\"number\">67</span>, <span class=\"number\">73</span>, <span class=\"number\">73</span>, <span class=\"number\">95</span>, <span class=\"number\">112</span>, <span class=\"number\">114</span>, <span class=\"number\">49</span>, <span class=\"number\">110</span>, <span class=\"number\">116</span>,</span><br><span class=\"line\">       <span class=\"number\">52</span>, <span class=\"number\">98</span>, <span class=\"number\">108</span>, <span class=\"number\">51</span>, <span class=\"number\">125</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;&#x27;</span>.join(<span class=\"built_in\">chr</span>(o) <span class=\"keyword\">for</span> o <span class=\"keyword\">in</span> <span class=\"built_in\">ord</span>))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp\"><a href=\"#SumUp\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">function:</span><br><span class=\"line\"><span class=\"built_in\">chr</span>()  <span class=\"comment\"># ASCII--&gt;char</span></span><br><span class=\"line\"><span class=\"built_in\">ord</span>()  <span class=\"comment\"># char--&gt;ASCII</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Hex\"><a href=\"#Hex\" class=\"headerlink\" title=\"Hex\"></a>Hex</h2><h3 id=\"Description-3\"><a href=\"#Description-3\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>When we encrypt something the resulting ciphertext commonly has bytes which are not printable ASCII characters. If we want to share our encrypted data, it’s common to encode it into something more user-friendly and portable across different systems.</p>\n<p>Included below is a flag encoded as a hex string. Decode this back into bytes to get the flag.</p>\n<figure class=\"highlight llvm\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">63727970746</span>f<span class=\"number\">7</span>b<span class=\"number\">596</span>f<span class=\"number\">755</span>f<span class=\"number\">77696</span><span class=\"keyword\">c</span><span class=\"number\">6</span><span class=\"keyword\">c</span><span class=\"number\">5</span>f<span class=\"number\">62655</span>f<span class=\"number\">776</span>f<span class=\"number\">726</span>b<span class=\"number\">696e675</span>f<span class=\"number\">776974685</span>f<span class=\"number\">6865785</span>f<span class=\"number\">737472696e67735</span>f<span class=\"number\">615</span>f<span class=\"number\">6</span><span class=\"keyword\">c</span><span class=\"number\">6</span>f<span class=\"number\">747</span>d</span><br></pre></td></tr></table></figure>\n\n<p> In Python, the <code>bytes.fromhex()</code> function can be used to convert hex to bytes. The <code>.hex()</code> instance method can be called on byte strings to get the hex representation.</p>\n<h3 id=\"Analyze-3\"><a href=\"#Analyze-3\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>十六进制来咯。</p>\n<p>要求把给出的十六进制 decode 回 byte，用给出的函数直接 decode 输出。</p>\n<h3 id=\"Code-1\"><a href=\"#Code-1\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">h = <span class=\"string\">&#x27;63727970746f7b596f755f77696c6c5f62655f776f726b696e675f77697685f6865785f737472696e67\\</span></span><br><span class=\"line\"><span class=\"string\">35f615f6c6f747d&#x27;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">bytes</span>.fromhex(h))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-1\"><a href=\"#SumUp-1\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">function:</span><br><span class=\"line\"><span class=\"built_in\">bytes</span>.fromhex()  <span class=\"comment\"># hex--&gt;bytes</span></span><br><span class=\"line\"><span class=\"built_in\">bytes</span>.<span class=\"built_in\">hex</span>()  <span class=\"comment\"># bytes--&gt;hex</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Base64\"><a href=\"#Base64\" class=\"headerlink\" title=\"Base64\"></a>Base64</h2><h3 id=\"Description-4\"><a href=\"#Description-4\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Another common encoding scheme is Base64, which allows us to represent binary data as an ASCII string using 64 characters. One character of a Base64 string encodes 6 bits, and so 4 characters of Base64 encode three 8-bit bytes.</p>\n<p>Base64 is most commonly used online, so binary data such as images can be easily included into HTML or CSS files.</p>\n<p>Take the below hex string, <em>decode</em> it into bytes and then <em>encode</em> it into Base64.</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf</span><br></pre></td></tr></table></figure>\n\n<p> In Python, after importing the base64 module with <code>import base64</code>, you can use the <code>base64.b64encode()</code> function. Remember to decode the hex first as the challenge description states.</p>\n<h3 id=\"Analyze-4\"><a href=\"#Analyze-4\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>是 base64 捏，给的是十六进制字符串，先用 <code>bytes.fromhex</code> 函数 encode 得到 byte，然后用 base64 库里的 <code>base64.b64encode()</code> 函数编码。</p>\n<p>记得先安 base64 库喔~</p>\n<h3 id=\"Code-2\"><a href=\"#Code-2\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> base64</span><br><span class=\"line\"></span><br><span class=\"line\">h = <span class=\"string\">&#x27;72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf&#x27;</span></span><br><span class=\"line\">decode = <span class=\"built_in\">bytes</span>.fromhex(h)  <span class=\"comment\"># hex --&gt; bytes</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(base64.b64encode(decode))  <span class=\"comment\"># base64 编码</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-2\"><a href=\"#SumUp-2\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> base64</span><br><span class=\"line\">base64.b64encode() <span class=\"comment\"># bytes--&gt;base64Code</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Bytes-and-Big-Integers\"><a href=\"#Bytes-and-Big-Integers\" class=\"headerlink\" title=\"Bytes and Big Integers\"></a>Bytes and Big Integers</h2><h3 id=\"Description-5\"><a href=\"#Description-5\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Cryptosystems like RSA works on numbers, but messages are made up of characters. How should we convert our messages into numbers so that mathematical operations can be applied?</p>\n<p>The most common way is to take the ordinal bytes of the message, convert them into hexadecimal, and concatenate. This can be interpreted as a base-16 number, and also represented in base-10.</p>\n<p>To illustrate:</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">message</span>: HELLO</span><br><span class=\"line\"><span class=\"attribute\">ascii</span> bytes:<span class=\"meta\"> [72, 69, 76, 76, 79]</span></span><br><span class=\"line\"><span class=\"attribute\">hex</span> bytes:<span class=\"meta\"> [0x48, 0x45, 0x4c, 0x4c, 0x4f]</span></span><br><span class=\"line\"><span class=\"attribute\">base</span>-<span class=\"number\">16</span>: <span class=\"number\">0</span>x48454c4c4f</span><br><span class=\"line\"><span class=\"attribute\">base</span>-<span class=\"number\">10</span>: <span class=\"number\">310400273487</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Python’s PyCryptodome library implements this with the methods <code>Crypto.Util.number.bytes_to_long()</code> and <code>Crypto.Util.number.long_to_bytes()</code>. You may first have to install PyCryptodome and import it with <code>from Crypto.Util.number import *</code>. </p>\n</blockquote>\n<p>Convert the following integer back into a message:</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">11515195063862318899931685488813747395775516287289682636499965282714637259206269</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Analyze-5\"><a href=\"#Analyze-5\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>给了一个大整数，用函数 <code>long_to_bytes()</code> 转化下就解决咯。</p>\n<h3 id=\"Code-3\"><a href=\"#Code-3\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> Crypto.Util.number <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">lis = <span class=\"number\">11515195063862318899931685488813747395775516287289682636499965282714637259206269</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(long_to_bytes(lis))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-3\"><a href=\"#SumUp-3\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> Crypto.Util.number <span class=\"keyword\">import</span> *</span><br><span class=\"line\">Crypto.Util.number.bytes_to_long()</span><br><span class=\"line\">Crypto.Util.number.long_to_bytes()</span><br></pre></td></tr></table></figure>\n\n<p>虽然但是，我一定要吐槽 Crypto 库，这也太烦了！</p>\n<p>安了之后还是不停报错说没有找到 Crypto 库，又是卸载重装又是重启。</p>\n<p>试了一系列办法之后求助互联网，去 <code>.\\python310\\Lib\\site-packages</code> 里面把 crypto 文件夹直接重命名为 Crypto，然后它就好了？代码就跑起来了！</p>\n<p>装 py 库真的可以治疗低血压。。</p>\n<h2 id=\"XOR-Starter\"><a href=\"#XOR-Starter\" class=\"headerlink\" title=\"XOR Starter\"></a>XOR Starter</h2><h3 id=\"Description-6\"><a href=\"#Description-6\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>XOR is a bitwise operator which returns 0 if the bits are the same, and 1 otherwise. In textbooks the XOR operator is denoted by ⊕, but in most challenges and programming languages you will see the caret <code>^</code> used instead.</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">A</th>\n<th align=\"center\">B</th>\n<th align=\"center\">Output</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">0</td>\n<td align=\"center\">0</td>\n<td align=\"center\">0</td>\n</tr>\n<tr>\n<td align=\"center\">0</td>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td align=\"center\">1</td>\n<td align=\"center\">0</td>\n<td align=\"center\">1</td>\n</tr>\n<tr>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n<td align=\"center\">0</td>\n</tr>\n</tbody></table>\n<p>For longer binary numbers we XOR bit by bit: <code>0110 ^ 1010 = 1100</code>. We can XOR integers by first converting the integer from decimal to binary. We can XOR strings by first converting each character to the integer representing the Unicode character.</p>\n<p>Given the string <code>&quot;label&quot;</code>, XOR each character with the integer <code>13</code>. Convert these integers back to a string and submit the flag as <code>crypto&#123;new_string&#125;</code>.</p>\n<blockquote>\n<p>The Python <code>pwntools</code> library has a convenient <code>xor()</code> function that can XOR together data of different types and lengths.</p>\n</blockquote>\n<h3 id=\"Analyze-6\"><a href=\"#Analyze-6\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>给了字符串 <code>&quot;label&quot;</code>，每个字符和整数 13 异或得到 flag。</p>\n<p>顺手下载 pwntools 和 pwn 库喔~</p>\n<p><code>pip install pwntools</code></p>\n<p><code>pip install pwn</code></p>\n<h3 id=\"Code-4\"><a href=\"#Code-4\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">XOR</span>(<span class=\"params\"><span class=\"built_in\">str</span>, key</span>):</span><br><span class=\"line\">    res=<span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> s <span class=\"keyword\">in</span> <span class=\"built_in\">str</span>:</span><br><span class=\"line\">        res += <span class=\"built_in\">chr</span>(<span class=\"built_in\">ord</span>(s) ^ key)</span><br><span class=\"line\">    <span class=\"comment\">#print(o)</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> res</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">str</span> = <span class=\"string\">&#x27;label&#x27;</span></span><br><span class=\"line\">flag = XOR(<span class=\"built_in\">str</span>,<span class=\"number\">13</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;crypto&#123;%s&#125;&#x27;</span>% flag)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-4\"><a href=\"#SumUp-4\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwntools <span class=\"keyword\">import</span> xor</span><br><span class=\"line\">xor()  <span class=\"comment\"># 可以把不同长度和类型的数据进行异或，什么类型的数据都可以喔</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"XOR-Properties\"><a href=\"#XOR-Properties\" class=\"headerlink\" title=\"XOR Properties\"></a>XOR Properties</h2><h3 id=\"Description-7\"><a href=\"#Description-7\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>In the last challenge, you saw how XOR worked at the level of bits. In this one, we’re going to cover the properties of the XOR operation and then use them to undo a chain of operations that have encrypted a flag. Gaining an intuition for how this works will help greatly when you come to attacking real cryptosystems later, especially in the block ciphers category.</p>\n<p>There are four main properties we should consider when we solve challenges using the XOR operator</p>\n<figure class=\"highlight dns\"><table><tr><td class=\"code\"><pre><span class=\"line\">Commutative: <span class=\"keyword\">A</span> ⊕ B = B ⊕ <span class=\"keyword\">A</span></span><br><span class=\"line\">Associative: <span class=\"keyword\">A</span> ⊕ (B ⊕ C) = (<span class=\"keyword\">A</span> ⊕ B) ⊕ C</span><br><span class=\"line\">Identity: <span class=\"keyword\">A</span> ⊕ <span class=\"number\">0</span> = <span class=\"keyword\">A</span></span><br><span class=\"line\">Self-Inverse: <span class=\"keyword\">A</span> ⊕ <span class=\"keyword\">A</span> = <span class=\"number\">0</span></span><br></pre></td></tr></table></figure>\n\n<p>Let’s break this down. Commutative means that the order of the XOR operations is not important. Associative means that a chain of operations can be carried out without order (we do not need to worry about brackets). The identity is 0, so XOR with 0 “does nothing”, and lastly something XOR’d with itself returns zero.</p>\n<p>Let’s try this out in action! Below is a series of outputs where three random keys have been XOR’d together and with the flag. Use the above properties to undo the encryption in the final line to obtain the flag.</p>\n<figure class=\"highlight llvm\"><table><tr><td class=\"code\"><pre><span class=\"line\">KEY<span class=\"number\">1</span> <span class=\"operator\">=</span> a<span class=\"number\">6</span><span class=\"keyword\">c</span><span class=\"number\">8</span>b<span class=\"number\">6733</span><span class=\"keyword\">c</span><span class=\"number\">9</span>b<span class=\"number\">22</span>de<span class=\"number\">7</span>bc<span class=\"number\">0253266</span>a<span class=\"number\">3867</span>df<span class=\"number\">55</span>acde<span class=\"number\">8635e19</span><span class=\"keyword\">c</span><span class=\"number\">73313</span></span><br><span class=\"line\">KEY<span class=\"number\">2</span> ^ KEY<span class=\"number\">1</span> <span class=\"operator\">=</span> <span class=\"number\">37</span>dcb<span class=\"number\">292030</span>faa<span class=\"number\">90</span>d<span class=\"number\">07</span>eec<span class=\"number\">17e3</span>b<span class=\"number\">1</span><span class=\"keyword\">c</span><span class=\"number\">6</span>d<span class=\"number\">8</span>daf<span class=\"number\">94</span><span class=\"keyword\">c</span><span class=\"number\">35</span>d<span class=\"number\">4</span><span class=\"keyword\">c</span><span class=\"number\">9191</span>a<span class=\"number\">5e1</span>e</span><br><span class=\"line\">KEY<span class=\"number\">2</span> ^ KEY<span class=\"number\">3</span> <span class=\"operator\">=</span> <span class=\"keyword\">c</span><span class=\"number\">1545756687e7573</span>db<span class=\"number\">23</span>aa<span class=\"number\">1</span><span class=\"keyword\">c</span><span class=\"number\">3452</span>a<span class=\"number\">098</span>b<span class=\"number\">71</span>a<span class=\"number\">7</span>fbf<span class=\"number\">0</span>fddddde<span class=\"number\">5</span>fc<span class=\"number\">1</span></span><br><span class=\"line\">FLAG ^ KEY<span class=\"number\">1</span> ^ KEY<span class=\"number\">3</span> ^ KEY<span class=\"number\">2</span> <span class=\"operator\">=</span> <span class=\"number\">04</span>ee<span class=\"number\">9855208</span>a<span class=\"number\">2</span>cd<span class=\"number\">59091</span>d<span class=\"number\">04767</span>ae<span class=\"number\">47963170</span>d<span class=\"number\">1660</span>df<span class=\"number\">7</span>f<span class=\"number\">56</span>f<span class=\"number\">5</span>faf</span><br></pre></td></tr></table></figure>\n\n<p> Before you XOR these objects, be sure to decode from hex to bytes.</p>\n<h3 id=\"Analyze-7\"><a href=\"#Analyze-7\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>异或的一些性质~</p>\n<p>很简单的一点数学运算</p>\n<p>$$\\begin{align}&amp;FK123⊕K1⊕K23 \\\\ &#x3D;&amp;(F⊕K1⊕K2⊕K3)⊕K1⊕(K2⊕K3) \\\\ &#x3D;&amp;(F⊕K2⊕K3)⊕0⊕(K2⊕K3) \\\\ &#x3D;&amp;(F⊕K2⊕K3)⊕(K2⊕K3) \\\\ &#x3D;&amp;F⊕0 \\\\ &#x3D;&amp;F\\end{align}$$</p>\n<p>（其实只是想浅试一下数学公式的功能~</p>\n<h3 id=\"Code-5\"><a href=\"#Code-5\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> xor</span><br><span class=\"line\">K1 = <span class=\"string\">&#x27;a6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313&#x27;</span></span><br><span class=\"line\">K21 = <span class=\"string\">&#x27;37dcb292030faa90d07eec17e3b1c6d8daf94c35d4c9191a5e1e&#x27;</span></span><br><span class=\"line\">K23 = <span class=\"string\">&#x27;c1545756687e7573db23aa1c3452a098b71a7fbf0fddddde5fc1&#x27;</span></span><br><span class=\"line\">FK132 = <span class=\"string\">&#x27;04ee9855208a2cd59091d04767ae47963170d1660df7f56f5faf&#x27;</span></span><br><span class=\"line\">flag = xor(<span class=\"built_in\">bytes</span>.fromhex(FK132), <span class=\"built_in\">bytes</span>.fromhex(K1), <span class=\"built_in\">bytes</span>.fromhex(K23))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(flag)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Favourite-byte\"><a href=\"#Favourite-byte\" class=\"headerlink\" title=\"Favourite byte\"></a>Favourite byte</h2><h3 id=\"Description-8\"><a href=\"#Description-8\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>For the next few challenges, you’ll use what you’ve just learned to solve some more XOR puzzles.</p>\n<p>I’ve hidden some data using XOR with a single byte, but that byte is a secret. Don’t forget to decode from hex first.</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Analyze-8\"><a href=\"#Analyze-8\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>先从16进制 decode 喔</p>\n<p>因为之和单个 byte 进行了异或，又知道 flag 的首字母是 <code>&#39;c&#39;</code>，所以可以用 decode 之后的第一位和 <code>&#39;c&#39;</code> 进行异或得到 secret。</p>\n<p>之后把整个字符串和 secret 异或之后输出。</p>\n<h3 id=\"Code-6\"><a href=\"#Code-6\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">xor_byte</span>(<span class=\"params\">a: <span class=\"built_in\">bytes</span>, b: <span class=\"built_in\">int</span></span>):</span><br><span class=\"line\">    res = <span class=\"built_in\">bytes</span>([_a ^ b <span class=\"keyword\">for</span> _a <span class=\"keyword\">in</span> a])</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res</span><br><span class=\"line\"></span><br><span class=\"line\">lis = <span class=\"string\">&#x27;73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d&#x27;</span></span><br><span class=\"line\">decode = <span class=\"built_in\">bytes</span>.fromhex(lis)</span><br><span class=\"line\">secret = decode[<span class=\"number\">0</span>] ^ <span class=\"built_in\">ord</span>(<span class=\"string\">&#x27;c&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(xor_byte(decode, secret))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"You-either-know-XOR-you-don’t\"><a href=\"#You-either-know-XOR-you-don’t\" class=\"headerlink\" title=\"You either know, XOR you don’t\"></a>You either know, XOR you don’t</h2><h3 id=\"Description-9\"><a href=\"#Description-9\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>I’ve encrypted the flag with my secret key, you’ll never be able to guess it.</p>\n<blockquote>\n<p>Remember the flag format and how it might help you in this challenge!</p>\n</blockquote>\n<figure class=\"highlight dns\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">0</span>e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e<span class=\"number\">263451150104</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Analyze-9\"><a href=\"#Analyze-9\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>第一步当然也是从十六进制 decode 咯。</p>\n<p>和上一题的思路有点像捏，也可以利用 flag 的格式得到加密用到的 key。</p>\n<p>只要把 <code>&#39;c&#39;</code> 换成 <code>&#39;crypto&#123;&#39;</code>，然后加上一点点的猜想<del>（自动补全）</del>就可以咯。</p>\n<h3 id=\"Code-7\"><a href=\"#Code-7\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> xor</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">lis = <span class=\"string\">&#x27;0e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e263451150\\</span></span><br><span class=\"line\"><span class=\"string\">104&#x27;</span></span><br><span class=\"line\">decode = <span class=\"built_in\">bytes</span>.fromhex(lis)</span><br><span class=\"line\">flag = <span class=\"string\">&#x27;crypto&#123;&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># akey = xor(decode[:7], [ord(o) for o in flag])</span></span><br><span class=\"line\"><span class=\"comment\"># print(akey)</span></span><br><span class=\"line\">key = <span class=\"string\">&#x27;myXORkey&#x27;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(xor(decode, key))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># akey = myXORke,猜想key = myXORkey</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"致谢（被迫的）\"><a href=\"#致谢（被迫的）\" class=\"headerlink\" title=\"致谢（被迫的）\"></a>致谢<del>（被迫的）</del></h2><p>非常感谢 <a href=\"https://hawa130.com/\">hawa130</a> 对本文排版等问题的细心纠正。</p>"},{"title":"Modular Arithmetic","date":"2022-05-03T11:56:00.000Z","mathjax":true,"_content":"\n第二章也做完咯~\n\n<!--more-->\n\n看到这章的标题就感觉要寄。\n\n进去一看果然，全是数学。。（数学废物笑不出来\n\n做了近两天，我只能说数学博大精深，做数学题真的会谢。。\n\n交完最后一题的 flag 觉得整个人都放松下来了，然后就感觉精疲力尽。\n\n做的很艰难，尤其 python 用的还是那么不利索。\n\n由于有些题的代码是通过推导之后直接通过数学定理化简，所以代码很简单。\n\n# Modular Arithmetic\n\n## Greatest Common Divisor\n\n### Description\n\nThe Greatest Common Divisor (GCD), sometimes known as the highest common factor, is the largest number which divides two positive integers (a,b).\n\nFor `a = 12, b = 8` we can calculate the divisors of a: `{1,2,3,4,6,12}` and the divisors of b: `{1,2,4,8}`. Comparing these two, we see that `gcd(a,b) = 4`.\n\nNow imagine we take `a = 11, b = 17`. Both `a` and `b` are prime numbers. As a prime number has only itself and `1` as divisors, `gcd(a,b) = 1`.\n\nWe say that for any two integers `a,b`, if `gcd(a,b) = 1` then `a` and `b` are coprime integers.\n\nIf `a` and `b` are prime, they are also coprime. If `a` is prime and `b < a` then `a` and `b` are coprime.\n\n> Think about the case for `a` prime and `b > a`, why are these not necessarily coprime?\n\nThere are many tools to calculate the GCD of two integers, but for this task we recommend looking up [Euclid's Algorithm](https://en.wikipedia.org/wiki/Euclidean_algorithm).\n\nTry coding it up; it's only a couple of lines. Use `a = 12, b = 8` to test it.\n\nNow calculate `gcd(a,b)` for `a = 66528, b = 52920` and enter it below.\n\n###  Analyze\n\n就是算最大公约数啦，简单写个函数就好咯。\n\n现在再看这题是真简单啊。\n\n### Code\n\n```python\ndef gcd(a: int, b: int) -> int:\n    while b:\n        a, b = b, a % b\n    return a\n\n\na = int(input())\nb = int(input())\nprint(gcd(a, b))\n```\n\n### SumUp\n\n```python\n# 欧几里得算法，是 C 语言做过的东西\n# function： gcd(a, b)\ndef gcd(a: int, b: int) -> int:\n    while b:\n        a, b = b, a % b\n    return a\n```\n\n## Extended GCD\n\n### Description\n\nLet `a` and `b` be positive integers.\n\nThe extended Euclidean algorithm is an efficient way to find integers `u,v` such that\n\n```\na * u + b * v = gcd(a,b)\n```\n\n> Later, when we learn to decrypt RSA, we will need this algorithm to calculate the modular inverse of the public exponent.\n\nUsing the two primes `p = 26513, q = 32321`, find the integers `u,v` such that\n\n```\np * u + q * v = gcd(p,q)\n```\n\nEnter whichever of `u` and `v` is the lower number as the flag.\n\n> Knowing that `p,q` are prime, what would you expect `gcd(p,q)` to be? For more details on the extended Euclidean algorithm, check out [this page](http://www-math.ucdenver.edu/~wcherowi/courses/m5410/exeucalg.html).\n\n###  Analyze\n\n用到扩展的欧几里得算法，数学原理和辗转相除大同小异，简单代下数字手推一遍详细过程就知道怎么回事咯。\n\n### Code\n\n```python\ndef exgcd(a: int, b: int) -> (int, int, int):\n    if a < b:\n        t = a\n        a = b\n        b = t\n    if b == 0:\n        return a, 1, 0\n    else:\n        g, x, y = exgcd(b, a % b)\n        return g, y, x - (a // b) * y\n\n\na = int(input())\nb = int(input())\nprint(exgcd(a, b))\n```\n\n### SumUp\n\n```python\n# 扩展欧几里得，不限制输入的大小顺序\ndef exgcd(a: int, b: int) -> (int, int, int):\n    if a < b:\n        t = a\n        a = b\n        b = t\n    if b == 0:\n        return a, 1, 0\n    else:\n        g, x, y = exgcd(b, a % b)\n        return g, y, x - (a // b) * y\n# ax0 + by0 = gcd(a, b)\n# 输入 a, b\n# 输出 g, x0, y0\n# 其中 g = gcd(a, b)\n```\n\n## Modular Arithmetic 1\n\n### Description\n\nImagine you lean over and look at a cryptographer's notebook. You see some notes in the margin:\n\n```\n4 + 9 = 1\n5 - 7 = 10\n2 + 3 = 5\n```\n\nAt first you might think they've gone mad. Maybe this is why there are so many data leaks nowadays you'd think, but this is nothing more than modular arithmetic modulo 12 (albeit with some sloppy notation).\n\nYou may not have been calling it modular arithmetic, but you've been doing these kinds of calculations since you learnt to tell the time (look again at those equations and think about adding hours).\n\nFormally, \"calculating time\" is described by the theory of congruences. We say that two integers are congruent modulo m if `a ≡ b mod m`.\n\nAnother way of saying this, is that when we divide the integer `a` by `m`, the remainder is `b`. This tells you that if m divides a (this can be written as `m | a`) then `a ≡ 0 mod m`.\n\nCalculate the following integers:\n\n```\n11 ≡ x mod 6\n8146798528947 ≡ y mod 17\n```\n\nThe solution is the smaller of the two integers.\n\n###  Analyze\n\n模运算来了，头大。后面全是和模运算有关的（准确来说这一整章都是\n\n这道算简单，取余算一下 x 和 y，然后按要求输出小的。没啥好思考的捏。\n\n### Code\n\n```python\nn = 8146798528947\nprint(min(n % 17, 11 % 6))\n```\n\n## Modular Arithmetic 2\n\n### Description\n\nWe'll pick up from the last challenge and imagine we've picked a modulus `p`, and we will restrict ourselves to the case when `p` is prime.\n\nThe integers modulo `p` define a field, denoted `Fp`.\n\n> If the modulus is not prime, the set of integers modulo `n` define a ring.\n\nA finite field `Fp` is the set of integers `{0,1,...,p-1}`, and under both addition and multiplication there is an inverse element `b` for every element `a` in the set, such that `a + b = 0` and `a * b = 1`.\n\n> Note that the identity element for addition and multiplication is different! This is because the identity when acted with the operator should do nothing: `a + 0 = a` and `a * 1 = a`.\n\nLets say we pick `p = 17`. Calculate `317 mod 17`. Now do the same but with `517 mod 17`.\n\nWhat would you expect to get for `716 mod 17`? Try calculating that.\n\nThis interesting fact is known as Fermat's little theorem. We'll be needing this (and its generalisations) when we look at RSA cryptography.\n\nNow take the prime `p = 65537`. Calculate `27324678765465536 mod 65537`.\n\nDid you need a calculator?\n\n###  Analyze\n\n费马小定理，蛮有意思的一个公式。\n\n$a^{p} \\equiv a \\mod p$，浅浅变形一下：$a^{p-1} \\equiv 1 \\mod p$\n\n主要题目描述这个定理的时候略微有一点写复杂咯，不够优雅（ bushi。\n\n这么推导出来其实没有写代码的必要。\n\n### Code\n\n```python\na = 273246787654\np = 65537\nprint(1 % p)\n\n# a^(p-1) ≡ 1(mod p)\n```\n\n## Modular Inverting\n\n### Description\n\nAs we've seen, we can work within a finite field `Fp`, adding and multiplying elements, and always obtain another element of the field.\n\nFor all elements `g` in the field, there exists a unique integer `d` such that `g * d ≡ 1 mod p`.\n\nThis is the multiplicative inverse of `g`.\n\n**Example**: `7 * 8 = 56 ≡ 1 mod 11`\n\nWhat is the inverse element: `3 * d ≡ 1 mod 13`?\n\n> Think about the little theorem we just worked with. How does this help you find the inverse of an element?\n\n###  Analyze\n\n模逆运算，同余这块的知识。主要是欧拉定理和费马小定理的应用。\n\n欧拉定理：$a^{φ(n)} \\equiv 1 \\mod n$\n\n费马小定理：$a^{p-1} \\equiv 1 \\mod p$\n\n对于这道题，有 $3 * d \\equiv 1 \\mod 13$\n\n因为 gcd(3, 13) = 1，所以可以直接得$$d\\ =\\ 3^{φ(13)-1}\\ *\\ 1=3^{11} \\mod 13$$ \n\npython 的 pow() 函数真的很好用！\n\n### Code\n\n```python\nd = pow (3, 11, 13)\nprint(d)\n```\n\n### SumUp\n\n$φ(n)$ 即 `1 ~ (n-1)` 范围内与 n 互素的数的个数，若 n 本身为素数，则 $φ(n)=n-1$ 。\n\n## Quadratic Residues\n\n### Description\n\nWe've looked at multiplication and division in modular arithmetic, but what does it mean to take the square root modulo an integer?\n\nFor the following discussion, let's work modulo `p = 29`. We can take the integer `a = 11` and calculate `a² = 5 mod 29`.\n\nAs `a = 11, a² = 5`, we say the square root of `5` is `11`.\n\nThis feels good, but now let's think about the square root of `18`. From the above, we know we need to find some integer `a` such that `a² = 18`\n\nYour first idea might be to start with `a = 1` and loop to `a = p-1`. In this discussion `p` isn't too large and we can quickly look.\n\nHave a go, try coding this and see what you find. If you've coded it right, you'll find that for all `a ∈ Fp*` you never find an `a` such that `a² = 18`.\n\nWhat we are seeing, is that for the elements of `F*p`, not every element has a square root. In fact, what we find is that for roughly one half of the elements of `Fp*`, there is no square root.\n\n> We say that an integer `x` is a *Quadratic Residue* if there exists an `a` such that `a² = x mod p`. If there is no such solution, then the integer is a *Quadratic Non-Residue*.\n\nIn other words, `x` is a quadratic residue when it is possible to take the square root of `x` modulo an integer `p`.\n\nIn the below list there are two non-quadratic residues and one quadratic residue.\n\nFind the quadratic residue and then calculate its square root. Of the two possible roots, submit the smaller one as the flag.\n\n> If `a² = x` then (-a)² = x. So if `x` is a quadratic residue in some finite field, then there are always two solutions for `a`.\n\n```\np = 29\nints = [14, 6, 11]\n```\n\n###  Analyze\n\nLegendre 符号（欧拉判别法）的内容，二次剩余。\n\n定义：如果 $a^2 \\equiv x \\mod p$ 有解，则 x 是模 p 的二次剩余，否则称为二次非剩余,。\n\nGiven: p, x[]\n\nAsked: 找出二次剩余，并求出平方根。\n\n遍历 x in range(1, p)，计算 x 的平方模 p，并与 ints[] 中的元素进行比较，找出模 p 的二次剩余，此时的 x 即为该二次剩余的平方根。\n\n公式和题里的 a 和 x 参数真的很容易弄混，理了半天才理清楚 。。\n\n### Code\n\n```python\np = 29\nints = [14, 6, 11]\nflag = min(x for x in range(1, p) if pow(x, 2, p) in ints)\nprint(flag)\n```\n\n## Legendre Symbol\n\n### Description\n\nIn Quadratic Residues we learnt what it means to take the square root modulo an integer. We also saw that taking a root isn't always possible.\n\nIn the previous case when `p = 29`, even the simplest method of calculating the square root was fast enough, but as `p` gets larger, this method becomes wildly unreasonable.\n\nLucky for us, we have a way to check whether an integer is a quadratic residue with a single calculation thanks to Legendre. In the following, we will assume we are working modulo a prime `p`.\n\nBefore looking at Legendre's symbol, let's take a brief detour to see an interesting property of quadratic (non-)residues.\n\n```\nQuadratic Residue * Quadratic Residue = Quadratic Residue\nQuadratic Residue * Quadratic Non-residue = Quadratic Non-residue\nQuadratic Non-residue * Quadratic Non-residue = Quadratic Residue\n```\n\n> Want an easy way to remember this? Replace \"Quadratic Residue\" with `+1` and \"Quadratic Non-residue\" with `-1`, all three results are the same!\n\nSo what's the trick? The [Legendre Symbol](https://en.wikipedia.org/wiki/Legendre_symbol) gives an efficient way to determine whether an integer is a quadratic residue modulo an odd prime `p`.\n\nLegendre's Symbol: `(a / p) ≡ a(p-1)/2 mod p` obeys:\n\n```\n(a / p) = 1 if a is a quadratic residue and a ≢ 0 mod p\n(a / p) = -1 if a is a quadratic non-residue mod p\n(a / p) = 0 if a ≡ 0 mod p\n```\n\nWhich means given any integer `a`, calculating `pow(a,(p-1)/2,p)` is enough to determine if `a` is a quadratic residue.\n\nNow for the flag. Given the following 1024 bit prime and 10 integers, find the quadratic residue and then calculate its square root; the square root is your flag. Of the two possible roots, submit the larger one as your answer.\n\n> So Legendre's symbol tells us which integer is a quadratic residue, but how do we find the square root?! The prime supplied obeys `p = 3 mod 4`, which allows us easily compute the square root. The answer is online, but you can figure it out yourself if you think about Fermat's little theorem.\n\n###  Analyze\n\nLegendre 符号的欧拉判别法。\n\n$$\\left(\\frac{a}{p}\\right)=\\begin{cases}1, &a ≢ 0 \\mod p\\text{ 且 }a\\text{ 是模 }p\\text{ 的二次剩余} \\\\\\ -1, &a ≢ 0 \\mod p\\text{ 且 }a\\text{ 是模 }p\\text{ 的二次非剩余} \\\\\\ 0, &a ≡0 \\mod p \\end{cases}$$\n\n欧拉判别法内容：$(a/p) \\equiv a^{(p-1)/2} \\mod p$。\n\n遍历 ints 判断各自对应的 $(a/p)$ 是否等于 1，得到二次剩余 a 之后计算平方根 $a^{(p+1)/4} \\mod p$ 。\n\n### Code\n\n```python\np = 101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139\nints = [25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803, 45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555, 17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325, 14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863, 4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318, 85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771, 50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987, 96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871, 4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721, 18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565]\n\nres = [x for x in ints if pow(x, (p-1)//2, p) == 1][0]\nprint(pow(res, (p + 1)//4, p))\n```\n\n## Modular Square Root\n\n### Description\n\nIn Legendre Symbol we introduced a fast way to determine whether a number is a square root modulo a prime. We can go further: there are algorithms for efficiently calculating such roots. The best one in practice is called Tonelli-Shanks, which gets its funny name from the fact that it was first described by an Italian in the 19th century and rediscovered independently by Daniel Shanks in the 1970s.\n\nAll primes that aren't 2 are of the form `p ≡ 1 mod 4` or `p ≡ 3 mod 4`, since all odd numbers obey these congruences. As the previous challenge hinted, in the `p ≡ 3 mod 4` case, a really simple formula for computing square roots can be [derived](https://crypto.stackexchange.com/a/20994) directly from Fermat's little theorem. That leaves us still with the `p ≡ 1 mod 4` case, so a more general algorithm is required.\n\nIn a congruence of the form `r² ≡ a mod p`, Tonelli-Shanks calculates `r`.\n\n> Tonelli-Shanks doesn't work for composite (non-prime) moduli. Finding square roots modulo composites is computationally equivalent to integer factorization.\n\nThe main use-case for this algorithm is finding elliptic curve co-ordinates. Its operation is somewhat complex so we're not going to discuss the details, however, implementations are easy to find and Sage has one built-in.\n\nFind the square root of `a` modulo the 2048-bit prime `p`. Give the smaller of the two roots as your answer.\n\n###  Analyze\n\nsympy 模块内有封装好的函数可以计算二次剩余。\n\n函数 nthroot_mod(a, n, p) 用于求解于 $x^{n} \\equiv a\\ mod\\ p$ 的同余式。\n\n题目给了表达式 $r^2 \\equiv a\\ mod\\ p$，求 r。\n\n写了半天函数心态爆炸，然后搜了下 python 相关的库，几行就解决。\n\n再次感叹，python 真是个好东西。\n\n### Code\n\n```python\nimport sympy\na = 8479994658316772151941616510097127087554541274812435112009425778595495359700244470400642403747058566807127814165396640215844192327900454116257979487432016769329970767046735091249898678088061634796559556704959846424131820416048436501387617211770124292793308079214153179977624440438616958575058361193975686620046439877308339989295604537867493683872778843921771307305602776398786978353866231661453376056771972069776398999013769588936194859344941268223184197231368887060609212875507518936172060702209557124430477137421847130682601666968691651447236917018634902407704797328509461854842432015009878011354022108661461024768\np = 30531851861994333252675935111487950694414332763909083514133769861350960895076504687261369815735742549428789138300843082086550059082835141454526618160634109969195486322015775943030060449557090064811940139431735209185996454739163555910726493597222646855506445602953689527405362207926990442391705014604777038685880527537489845359101552442292804398472642356609304810680731556542002301547846635101455995732584071355903010856718680732337369128498655255277003643669031694516851390505923416710601212618443109844041514942401969629158975457079026906304328749039997262960301209158175920051890620947063936347307238412281568760161\nr = sympy.nthroot_mod(a, 2, p)\nprint(r)\n```\n\n### SumUp\n\n$x^{n} \\equiv a\\ mod\\ p$，求 x\n\n```python\n# function:\nfrom sympy.ntheory.residue_ntheory import nthroot_mod\nx = nthroot_mod(a, n, p)\n```\n\n## Chinese Remainder Theorem\n\n### Description\n\nThe Chinese Remainder Theorem gives a unique solution to a set of linear congruences if their moduli are coprime.\n\nThis means, that given a set of arbitrary integers `ai`, and pairwise coprime integers `ni`, such that the following linear congruences hold:\n\n> Note \"pairwise coprime integers\" means that if we have a set of integers `{n1, n2, ..., ni}`, all pairs of integers selected from the set are coprime: `gcd(ni, nj) = 1`.\n\n```\nx ≡ a1 mod n1\nx ≡ a2 mod n2\n...\nx ≡ an mod nn\n```\n\nThere is a unique solution `x ≡ a mod N` where `N = n1 * n2 * ... * nn`.\n\nIn cryptography, we commonly use the Chinese Remainder Theorem to help us reduce a problem of very large integers into a set of several, easier problems.\n\nGiven the following set of linear congruences:\n\n```\nx ≡ 2 mod 5\nx ≡ 3 mod 11\nx ≡ 5 mod 17\n```\n\nFind the integer `a` such that `x ≡ a mod 935`\n\n> Starting with the congruence with the largest modulus, use that for `x ≡ a mod p` we can write `x = a + k*p` for arbitrary integer `k`.\n\n###  Analyze\n\n中国剩余定理，也叫孙子定理。主要针对同余方程组的求解问题。\n\nYouTube 上找了个视频看了原理，跟着视频手算出来了结果，感觉跟着例题一步步算真的能加深理解诶，很容易就理解到了原理和用法。\n\n![求解过程](https://img.hawa130.com/求解过程.jpg)\n\n算法直接找了个板子，偷个懒捏。\n\n### Code\n\n```python\nfrom functools import reduce\n\n\ndef chinese_remainder(n, a):\n    sum = 0\n    prod = reduce(lambda a, b: a * b, n)\n    for n_i, a_i in zip(n, a):\n        p = prod // n_i\n        sum += a_i * mul_inv(p, n_i) * p\n    return sum % prod\n\n\ndef mul_inv(a, b):\n    b0 = b\n    x0, x1 = 0, 1\n    if b == 1:\n        return 1\n    while a > 1:\n        q = a // b\n        a, b = b, a % b\n        x0, x1 = x1 - q * x0, x0\n    if x1 < 0:\n        x1 += b0\n    return x1\n\n\nn = [5, 11, 17]\na = [2, 3, 5]\nprint(chinese_remainder(n, a))\n```\n\n## Adrien's Signs\n\n### Description\n\nAdrien's been looking at ways to encrypt his messages with the help of symbols and minus signs. Can you find a way to recover the flag?\n\n###  Analyze\n\npython 学得不好，加密函数理解了好久。\n\n解密倒还好，拿到密文直接正常取对数，取不到就负数取余把 n 还原回去再取对数。\n\n不过代码得跑一会才能出结果，后面或许可以再看看有没有更优解。\n\n（最后一行的代码简直写得太优雅咯\n\n### Code\n\n```python\nfrom numpy import arange\nfrom sympy import discrete_log\n\nlis = [67594220461269, 501237540280788, 718316769824518, 296304224247167, 48290626940198, 30829701196032, 521453693392074, 840985324383794, 770420008897119, 745131486581197, 729163531979577, 334563813238599, 289746215495432, 538664937794468, 894085795317163, 983410189487558, 863330928724430, 996272871140947, 352175210511707, 306237700811584, 631393408838583, 589243747914057, 538776819034934, 365364592128161, 454970171810424, 986711310037393, 657756453404881, 388329936724352, 90991447679370, 714742162831112, 62293519842555, 653941126489711, 448552658212336, 970169071154259, 339472870407614, 406225588145372, 205721593331090, 926225022409823, 904451547059845, 789074084078342, 886420071481685, 796827329208633, 433047156347276, 21271315846750, 719248860593631, 534059295222748, 879864647580512, 918055794962142, 635545050939893, 319549343320339, 93008646178282, 926080110625306, 385476640825005, 483740420173050, 866208659796189, 883359067574584, 913405110264883, 898864873510337, 208598541987988, 23412800024088, 911541450703474, 57446699305445, 513296484586451, 180356843554043, 756391301483653, 823695939808936, 452898981558365, 383286682802447, 381394258915860, 385482809649632, 357950424436020, 212891024562585, 906036654538589, 706766032862393, 500658491083279, 134746243085697, 240386541491998, 850341345692155, 826490944132718, 329513332018620, 41046816597282, 396581286424992, 488863267297267, 92023040998362, 529684488438507, 925328511390026, 524897846090435, 413156582909097, 840524616502482, 325719016994120, 402494835113608, 145033960690364, 43932113323388, 683561775499473, 434510534220939, 92584300328516, 763767269974656, 289837041593468, 11468527450938, 628247946152943, 8844724571683, 813851806959975, 72001988637120, 875394575395153, 70667866716476, 75304931994100, 226809172374264, 767059176444181, 45462007920789, 472607315695803, 325973946551448, 64200767729194, 534886246409921, 950408390792175, 492288777130394, 226746605380806, 944479111810431, 776057001143579, 658971626589122, 231918349590349, 699710172246548, 122457405264610, 643115611310737, 999072890586878, 203230862786955, 348112034218733, 240143417330886, 927148962961842, 661569511006072, 190334725550806, 763365444730995, 516228913786395, 846501182194443, 741210200995504, 511935604454925, 687689993302203, 631038090127480, 961606522916414, 138550017953034, 932105540686829, 215285284639233, 772628158955819, 496858298527292, 730971468815108, 896733219370353, 967083685727881, 607660822695530, 650953466617730, 133773994258132, 623283311953090, 436380836970128, 237114930094468, 115451711811481, 674593269112948, 140400921371770, 659335660634071, 536749311958781, 854645598266824, 303305169095255, 91430489108219, 573739385205188, 400604977158702, 728593782212529, 807432219147040, 893541884126828, 183964371201281, 422680633277230, 218817645778789, 313025293025224, 657253930848472, 747562211812373, 83456701182914, 470417289614736, 641146659305859, 468130225316006, 46960547227850, 875638267674897, 662661765336441, 186533085001285, 743250648436106, 451414956181714, 527954145201673, 922589993405001, 242119479617901, 865476357142231, 988987578447349, 430198555146088, 477890180119931, 844464003254807, 503374203275928, 775374254241792, 346653210679737, 789242808338116, 48503976498612, 604300186163323, 475930096252359, 860836853339514, 994513691290102, 591343659366796, 944852018048514, 82396968629164, 152776642436549, 916070996204621, 305574094667054, 981194179562189, 126174175810273, 55636640522694, 44670495393401, 74724541586529, 988608465654705, 870533906709633, 374564052429787, 486493568142979, 469485372072295, 221153171135022, 289713227465073, 952450431038075, 107298466441025, 938262809228861, 253919870663003, 835790485199226, 655456538877798, 595464842927075, 191621819564547]\na = 288260533169915\np = 1007621497415251\ndecode = ''\nfor i in arange(len(lis)):\n    cipher = lis[i]\n    try:\n        r = discrete_log(p, cipher, a)\n        decode += '1'\n    except:\n        r = discrete_log(p, -cipher % p, a)\n        decode += '0'\nprint(''.join([chr(int(decode[i:i+8], 2)) for i in range(0, len(decode), 8)]))\n```\n\n## Modular Binomials\n\n### Description\n\nRearrange the following equations to get `p,q`\n\n```\nN = p*q\nc1 = (2*p + 3*q)**e1 mod N\nc2 = (5*p + 7*q)**e2 mod N\n```\n\n###  Analyze\n\n给了五个参数，求两个未知数 p 和 q，一眼看到给了 p，q 的乘积 N，所以只要随便求出来其中一个然后除 N 就可以咯。\n\n我是先求了 q，所以先把两个方程右边配成齐次的，然后把要消掉的 p 的系数配成一样的，q 的系数刚好是 15 和 14，相减就是 q 咯。\n\n最后一道题倒是没啥技术含量，就嗯解方程组。\n\n### Code\n\n```python\nimport math\nN = 14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073\ne1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137\ne2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697\nc1 = 14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051\nc2 = 14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519\n\n\nq = math.gcd(N, pow(c1, e2, N) * pow(5, e1 * e2, N) - pow(c2, e1, N) * pow(2, e1 * e2, N))\np = N // q\nprint(p)\nprint(q)\n```\n","source":"_posts/Modular Arithmetic.md","raw":"---\ntitle: Modular Arithmetic\ndate: 2022-05-03 19:56:00\ntags: cryptohack\nmathjax: true\n---\n\n第二章也做完咯~\n\n<!--more-->\n\n看到这章的标题就感觉要寄。\n\n进去一看果然，全是数学。。（数学废物笑不出来\n\n做了近两天，我只能说数学博大精深，做数学题真的会谢。。\n\n交完最后一题的 flag 觉得整个人都放松下来了，然后就感觉精疲力尽。\n\n做的很艰难，尤其 python 用的还是那么不利索。\n\n由于有些题的代码是通过推导之后直接通过数学定理化简，所以代码很简单。\n\n# Modular Arithmetic\n\n## Greatest Common Divisor\n\n### Description\n\nThe Greatest Common Divisor (GCD), sometimes known as the highest common factor, is the largest number which divides two positive integers (a,b).\n\nFor `a = 12, b = 8` we can calculate the divisors of a: `{1,2,3,4,6,12}` and the divisors of b: `{1,2,4,8}`. Comparing these two, we see that `gcd(a,b) = 4`.\n\nNow imagine we take `a = 11, b = 17`. Both `a` and `b` are prime numbers. As a prime number has only itself and `1` as divisors, `gcd(a,b) = 1`.\n\nWe say that for any two integers `a,b`, if `gcd(a,b) = 1` then `a` and `b` are coprime integers.\n\nIf `a` and `b` are prime, they are also coprime. If `a` is prime and `b < a` then `a` and `b` are coprime.\n\n> Think about the case for `a` prime and `b > a`, why are these not necessarily coprime?\n\nThere are many tools to calculate the GCD of two integers, but for this task we recommend looking up [Euclid's Algorithm](https://en.wikipedia.org/wiki/Euclidean_algorithm).\n\nTry coding it up; it's only a couple of lines. Use `a = 12, b = 8` to test it.\n\nNow calculate `gcd(a,b)` for `a = 66528, b = 52920` and enter it below.\n\n###  Analyze\n\n就是算最大公约数啦，简单写个函数就好咯。\n\n现在再看这题是真简单啊。\n\n### Code\n\n```python\ndef gcd(a: int, b: int) -> int:\n    while b:\n        a, b = b, a % b\n    return a\n\n\na = int(input())\nb = int(input())\nprint(gcd(a, b))\n```\n\n### SumUp\n\n```python\n# 欧几里得算法，是 C 语言做过的东西\n# function： gcd(a, b)\ndef gcd(a: int, b: int) -> int:\n    while b:\n        a, b = b, a % b\n    return a\n```\n\n## Extended GCD\n\n### Description\n\nLet `a` and `b` be positive integers.\n\nThe extended Euclidean algorithm is an efficient way to find integers `u,v` such that\n\n```\na * u + b * v = gcd(a,b)\n```\n\n> Later, when we learn to decrypt RSA, we will need this algorithm to calculate the modular inverse of the public exponent.\n\nUsing the two primes `p = 26513, q = 32321`, find the integers `u,v` such that\n\n```\np * u + q * v = gcd(p,q)\n```\n\nEnter whichever of `u` and `v` is the lower number as the flag.\n\n> Knowing that `p,q` are prime, what would you expect `gcd(p,q)` to be? For more details on the extended Euclidean algorithm, check out [this page](http://www-math.ucdenver.edu/~wcherowi/courses/m5410/exeucalg.html).\n\n###  Analyze\n\n用到扩展的欧几里得算法，数学原理和辗转相除大同小异，简单代下数字手推一遍详细过程就知道怎么回事咯。\n\n### Code\n\n```python\ndef exgcd(a: int, b: int) -> (int, int, int):\n    if a < b:\n        t = a\n        a = b\n        b = t\n    if b == 0:\n        return a, 1, 0\n    else:\n        g, x, y = exgcd(b, a % b)\n        return g, y, x - (a // b) * y\n\n\na = int(input())\nb = int(input())\nprint(exgcd(a, b))\n```\n\n### SumUp\n\n```python\n# 扩展欧几里得，不限制输入的大小顺序\ndef exgcd(a: int, b: int) -> (int, int, int):\n    if a < b:\n        t = a\n        a = b\n        b = t\n    if b == 0:\n        return a, 1, 0\n    else:\n        g, x, y = exgcd(b, a % b)\n        return g, y, x - (a // b) * y\n# ax0 + by0 = gcd(a, b)\n# 输入 a, b\n# 输出 g, x0, y0\n# 其中 g = gcd(a, b)\n```\n\n## Modular Arithmetic 1\n\n### Description\n\nImagine you lean over and look at a cryptographer's notebook. You see some notes in the margin:\n\n```\n4 + 9 = 1\n5 - 7 = 10\n2 + 3 = 5\n```\n\nAt first you might think they've gone mad. Maybe this is why there are so many data leaks nowadays you'd think, but this is nothing more than modular arithmetic modulo 12 (albeit with some sloppy notation).\n\nYou may not have been calling it modular arithmetic, but you've been doing these kinds of calculations since you learnt to tell the time (look again at those equations and think about adding hours).\n\nFormally, \"calculating time\" is described by the theory of congruences. We say that two integers are congruent modulo m if `a ≡ b mod m`.\n\nAnother way of saying this, is that when we divide the integer `a` by `m`, the remainder is `b`. This tells you that if m divides a (this can be written as `m | a`) then `a ≡ 0 mod m`.\n\nCalculate the following integers:\n\n```\n11 ≡ x mod 6\n8146798528947 ≡ y mod 17\n```\n\nThe solution is the smaller of the two integers.\n\n###  Analyze\n\n模运算来了，头大。后面全是和模运算有关的（准确来说这一整章都是\n\n这道算简单，取余算一下 x 和 y，然后按要求输出小的。没啥好思考的捏。\n\n### Code\n\n```python\nn = 8146798528947\nprint(min(n % 17, 11 % 6))\n```\n\n## Modular Arithmetic 2\n\n### Description\n\nWe'll pick up from the last challenge and imagine we've picked a modulus `p`, and we will restrict ourselves to the case when `p` is prime.\n\nThe integers modulo `p` define a field, denoted `Fp`.\n\n> If the modulus is not prime, the set of integers modulo `n` define a ring.\n\nA finite field `Fp` is the set of integers `{0,1,...,p-1}`, and under both addition and multiplication there is an inverse element `b` for every element `a` in the set, such that `a + b = 0` and `a * b = 1`.\n\n> Note that the identity element for addition and multiplication is different! This is because the identity when acted with the operator should do nothing: `a + 0 = a` and `a * 1 = a`.\n\nLets say we pick `p = 17`. Calculate `317 mod 17`. Now do the same but with `517 mod 17`.\n\nWhat would you expect to get for `716 mod 17`? Try calculating that.\n\nThis interesting fact is known as Fermat's little theorem. We'll be needing this (and its generalisations) when we look at RSA cryptography.\n\nNow take the prime `p = 65537`. Calculate `27324678765465536 mod 65537`.\n\nDid you need a calculator?\n\n###  Analyze\n\n费马小定理，蛮有意思的一个公式。\n\n$a^{p} \\equiv a \\mod p$，浅浅变形一下：$a^{p-1} \\equiv 1 \\mod p$\n\n主要题目描述这个定理的时候略微有一点写复杂咯，不够优雅（ bushi。\n\n这么推导出来其实没有写代码的必要。\n\n### Code\n\n```python\na = 273246787654\np = 65537\nprint(1 % p)\n\n# a^(p-1) ≡ 1(mod p)\n```\n\n## Modular Inverting\n\n### Description\n\nAs we've seen, we can work within a finite field `Fp`, adding and multiplying elements, and always obtain another element of the field.\n\nFor all elements `g` in the field, there exists a unique integer `d` such that `g * d ≡ 1 mod p`.\n\nThis is the multiplicative inverse of `g`.\n\n**Example**: `7 * 8 = 56 ≡ 1 mod 11`\n\nWhat is the inverse element: `3 * d ≡ 1 mod 13`?\n\n> Think about the little theorem we just worked with. How does this help you find the inverse of an element?\n\n###  Analyze\n\n模逆运算，同余这块的知识。主要是欧拉定理和费马小定理的应用。\n\n欧拉定理：$a^{φ(n)} \\equiv 1 \\mod n$\n\n费马小定理：$a^{p-1} \\equiv 1 \\mod p$\n\n对于这道题，有 $3 * d \\equiv 1 \\mod 13$\n\n因为 gcd(3, 13) = 1，所以可以直接得$$d\\ =\\ 3^{φ(13)-1}\\ *\\ 1=3^{11} \\mod 13$$ \n\npython 的 pow() 函数真的很好用！\n\n### Code\n\n```python\nd = pow (3, 11, 13)\nprint(d)\n```\n\n### SumUp\n\n$φ(n)$ 即 `1 ~ (n-1)` 范围内与 n 互素的数的个数，若 n 本身为素数，则 $φ(n)=n-1$ 。\n\n## Quadratic Residues\n\n### Description\n\nWe've looked at multiplication and division in modular arithmetic, but what does it mean to take the square root modulo an integer?\n\nFor the following discussion, let's work modulo `p = 29`. We can take the integer `a = 11` and calculate `a² = 5 mod 29`.\n\nAs `a = 11, a² = 5`, we say the square root of `5` is `11`.\n\nThis feels good, but now let's think about the square root of `18`. From the above, we know we need to find some integer `a` such that `a² = 18`\n\nYour first idea might be to start with `a = 1` and loop to `a = p-1`. In this discussion `p` isn't too large and we can quickly look.\n\nHave a go, try coding this and see what you find. If you've coded it right, you'll find that for all `a ∈ Fp*` you never find an `a` such that `a² = 18`.\n\nWhat we are seeing, is that for the elements of `F*p`, not every element has a square root. In fact, what we find is that for roughly one half of the elements of `Fp*`, there is no square root.\n\n> We say that an integer `x` is a *Quadratic Residue* if there exists an `a` such that `a² = x mod p`. If there is no such solution, then the integer is a *Quadratic Non-Residue*.\n\nIn other words, `x` is a quadratic residue when it is possible to take the square root of `x` modulo an integer `p`.\n\nIn the below list there are two non-quadratic residues and one quadratic residue.\n\nFind the quadratic residue and then calculate its square root. Of the two possible roots, submit the smaller one as the flag.\n\n> If `a² = x` then (-a)² = x. So if `x` is a quadratic residue in some finite field, then there are always two solutions for `a`.\n\n```\np = 29\nints = [14, 6, 11]\n```\n\n###  Analyze\n\nLegendre 符号（欧拉判别法）的内容，二次剩余。\n\n定义：如果 $a^2 \\equiv x \\mod p$ 有解，则 x 是模 p 的二次剩余，否则称为二次非剩余,。\n\nGiven: p, x[]\n\nAsked: 找出二次剩余，并求出平方根。\n\n遍历 x in range(1, p)，计算 x 的平方模 p，并与 ints[] 中的元素进行比较，找出模 p 的二次剩余，此时的 x 即为该二次剩余的平方根。\n\n公式和题里的 a 和 x 参数真的很容易弄混，理了半天才理清楚 。。\n\n### Code\n\n```python\np = 29\nints = [14, 6, 11]\nflag = min(x for x in range(1, p) if pow(x, 2, p) in ints)\nprint(flag)\n```\n\n## Legendre Symbol\n\n### Description\n\nIn Quadratic Residues we learnt what it means to take the square root modulo an integer. We also saw that taking a root isn't always possible.\n\nIn the previous case when `p = 29`, even the simplest method of calculating the square root was fast enough, but as `p` gets larger, this method becomes wildly unreasonable.\n\nLucky for us, we have a way to check whether an integer is a quadratic residue with a single calculation thanks to Legendre. In the following, we will assume we are working modulo a prime `p`.\n\nBefore looking at Legendre's symbol, let's take a brief detour to see an interesting property of quadratic (non-)residues.\n\n```\nQuadratic Residue * Quadratic Residue = Quadratic Residue\nQuadratic Residue * Quadratic Non-residue = Quadratic Non-residue\nQuadratic Non-residue * Quadratic Non-residue = Quadratic Residue\n```\n\n> Want an easy way to remember this? Replace \"Quadratic Residue\" with `+1` and \"Quadratic Non-residue\" with `-1`, all three results are the same!\n\nSo what's the trick? The [Legendre Symbol](https://en.wikipedia.org/wiki/Legendre_symbol) gives an efficient way to determine whether an integer is a quadratic residue modulo an odd prime `p`.\n\nLegendre's Symbol: `(a / p) ≡ a(p-1)/2 mod p` obeys:\n\n```\n(a / p) = 1 if a is a quadratic residue and a ≢ 0 mod p\n(a / p) = -1 if a is a quadratic non-residue mod p\n(a / p) = 0 if a ≡ 0 mod p\n```\n\nWhich means given any integer `a`, calculating `pow(a,(p-1)/2,p)` is enough to determine if `a` is a quadratic residue.\n\nNow for the flag. Given the following 1024 bit prime and 10 integers, find the quadratic residue and then calculate its square root; the square root is your flag. Of the two possible roots, submit the larger one as your answer.\n\n> So Legendre's symbol tells us which integer is a quadratic residue, but how do we find the square root?! The prime supplied obeys `p = 3 mod 4`, which allows us easily compute the square root. The answer is online, but you can figure it out yourself if you think about Fermat's little theorem.\n\n###  Analyze\n\nLegendre 符号的欧拉判别法。\n\n$$\\left(\\frac{a}{p}\\right)=\\begin{cases}1, &a ≢ 0 \\mod p\\text{ 且 }a\\text{ 是模 }p\\text{ 的二次剩余} \\\\\\ -1, &a ≢ 0 \\mod p\\text{ 且 }a\\text{ 是模 }p\\text{ 的二次非剩余} \\\\\\ 0, &a ≡0 \\mod p \\end{cases}$$\n\n欧拉判别法内容：$(a/p) \\equiv a^{(p-1)/2} \\mod p$。\n\n遍历 ints 判断各自对应的 $(a/p)$ 是否等于 1，得到二次剩余 a 之后计算平方根 $a^{(p+1)/4} \\mod p$ 。\n\n### Code\n\n```python\np = 101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139\nints = [25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803, 45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555, 17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325, 14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863, 4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318, 85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771, 50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987, 96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871, 4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721, 18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565]\n\nres = [x for x in ints if pow(x, (p-1)//2, p) == 1][0]\nprint(pow(res, (p + 1)//4, p))\n```\n\n## Modular Square Root\n\n### Description\n\nIn Legendre Symbol we introduced a fast way to determine whether a number is a square root modulo a prime. We can go further: there are algorithms for efficiently calculating such roots. The best one in practice is called Tonelli-Shanks, which gets its funny name from the fact that it was first described by an Italian in the 19th century and rediscovered independently by Daniel Shanks in the 1970s.\n\nAll primes that aren't 2 are of the form `p ≡ 1 mod 4` or `p ≡ 3 mod 4`, since all odd numbers obey these congruences. As the previous challenge hinted, in the `p ≡ 3 mod 4` case, a really simple formula for computing square roots can be [derived](https://crypto.stackexchange.com/a/20994) directly from Fermat's little theorem. That leaves us still with the `p ≡ 1 mod 4` case, so a more general algorithm is required.\n\nIn a congruence of the form `r² ≡ a mod p`, Tonelli-Shanks calculates `r`.\n\n> Tonelli-Shanks doesn't work for composite (non-prime) moduli. Finding square roots modulo composites is computationally equivalent to integer factorization.\n\nThe main use-case for this algorithm is finding elliptic curve co-ordinates. Its operation is somewhat complex so we're not going to discuss the details, however, implementations are easy to find and Sage has one built-in.\n\nFind the square root of `a` modulo the 2048-bit prime `p`. Give the smaller of the two roots as your answer.\n\n###  Analyze\n\nsympy 模块内有封装好的函数可以计算二次剩余。\n\n函数 nthroot_mod(a, n, p) 用于求解于 $x^{n} \\equiv a\\ mod\\ p$ 的同余式。\n\n题目给了表达式 $r^2 \\equiv a\\ mod\\ p$，求 r。\n\n写了半天函数心态爆炸，然后搜了下 python 相关的库，几行就解决。\n\n再次感叹，python 真是个好东西。\n\n### Code\n\n```python\nimport sympy\na = 8479994658316772151941616510097127087554541274812435112009425778595495359700244470400642403747058566807127814165396640215844192327900454116257979487432016769329970767046735091249898678088061634796559556704959846424131820416048436501387617211770124292793308079214153179977624440438616958575058361193975686620046439877308339989295604537867493683872778843921771307305602776398786978353866231661453376056771972069776398999013769588936194859344941268223184197231368887060609212875507518936172060702209557124430477137421847130682601666968691651447236917018634902407704797328509461854842432015009878011354022108661461024768\np = 30531851861994333252675935111487950694414332763909083514133769861350960895076504687261369815735742549428789138300843082086550059082835141454526618160634109969195486322015775943030060449557090064811940139431735209185996454739163555910726493597222646855506445602953689527405362207926990442391705014604777038685880527537489845359101552442292804398472642356609304810680731556542002301547846635101455995732584071355903010856718680732337369128498655255277003643669031694516851390505923416710601212618443109844041514942401969629158975457079026906304328749039997262960301209158175920051890620947063936347307238412281568760161\nr = sympy.nthroot_mod(a, 2, p)\nprint(r)\n```\n\n### SumUp\n\n$x^{n} \\equiv a\\ mod\\ p$，求 x\n\n```python\n# function:\nfrom sympy.ntheory.residue_ntheory import nthroot_mod\nx = nthroot_mod(a, n, p)\n```\n\n## Chinese Remainder Theorem\n\n### Description\n\nThe Chinese Remainder Theorem gives a unique solution to a set of linear congruences if their moduli are coprime.\n\nThis means, that given a set of arbitrary integers `ai`, and pairwise coprime integers `ni`, such that the following linear congruences hold:\n\n> Note \"pairwise coprime integers\" means that if we have a set of integers `{n1, n2, ..., ni}`, all pairs of integers selected from the set are coprime: `gcd(ni, nj) = 1`.\n\n```\nx ≡ a1 mod n1\nx ≡ a2 mod n2\n...\nx ≡ an mod nn\n```\n\nThere is a unique solution `x ≡ a mod N` where `N = n1 * n2 * ... * nn`.\n\nIn cryptography, we commonly use the Chinese Remainder Theorem to help us reduce a problem of very large integers into a set of several, easier problems.\n\nGiven the following set of linear congruences:\n\n```\nx ≡ 2 mod 5\nx ≡ 3 mod 11\nx ≡ 5 mod 17\n```\n\nFind the integer `a` such that `x ≡ a mod 935`\n\n> Starting with the congruence with the largest modulus, use that for `x ≡ a mod p` we can write `x = a + k*p` for arbitrary integer `k`.\n\n###  Analyze\n\n中国剩余定理，也叫孙子定理。主要针对同余方程组的求解问题。\n\nYouTube 上找了个视频看了原理，跟着视频手算出来了结果，感觉跟着例题一步步算真的能加深理解诶，很容易就理解到了原理和用法。\n\n![求解过程](https://img.hawa130.com/求解过程.jpg)\n\n算法直接找了个板子，偷个懒捏。\n\n### Code\n\n```python\nfrom functools import reduce\n\n\ndef chinese_remainder(n, a):\n    sum = 0\n    prod = reduce(lambda a, b: a * b, n)\n    for n_i, a_i in zip(n, a):\n        p = prod // n_i\n        sum += a_i * mul_inv(p, n_i) * p\n    return sum % prod\n\n\ndef mul_inv(a, b):\n    b0 = b\n    x0, x1 = 0, 1\n    if b == 1:\n        return 1\n    while a > 1:\n        q = a // b\n        a, b = b, a % b\n        x0, x1 = x1 - q * x0, x0\n    if x1 < 0:\n        x1 += b0\n    return x1\n\n\nn = [5, 11, 17]\na = [2, 3, 5]\nprint(chinese_remainder(n, a))\n```\n\n## Adrien's Signs\n\n### Description\n\nAdrien's been looking at ways to encrypt his messages with the help of symbols and minus signs. Can you find a way to recover the flag?\n\n###  Analyze\n\npython 学得不好，加密函数理解了好久。\n\n解密倒还好，拿到密文直接正常取对数，取不到就负数取余把 n 还原回去再取对数。\n\n不过代码得跑一会才能出结果，后面或许可以再看看有没有更优解。\n\n（最后一行的代码简直写得太优雅咯\n\n### Code\n\n```python\nfrom numpy import arange\nfrom sympy import discrete_log\n\nlis = [67594220461269, 501237540280788, 718316769824518, 296304224247167, 48290626940198, 30829701196032, 521453693392074, 840985324383794, 770420008897119, 745131486581197, 729163531979577, 334563813238599, 289746215495432, 538664937794468, 894085795317163, 983410189487558, 863330928724430, 996272871140947, 352175210511707, 306237700811584, 631393408838583, 589243747914057, 538776819034934, 365364592128161, 454970171810424, 986711310037393, 657756453404881, 388329936724352, 90991447679370, 714742162831112, 62293519842555, 653941126489711, 448552658212336, 970169071154259, 339472870407614, 406225588145372, 205721593331090, 926225022409823, 904451547059845, 789074084078342, 886420071481685, 796827329208633, 433047156347276, 21271315846750, 719248860593631, 534059295222748, 879864647580512, 918055794962142, 635545050939893, 319549343320339, 93008646178282, 926080110625306, 385476640825005, 483740420173050, 866208659796189, 883359067574584, 913405110264883, 898864873510337, 208598541987988, 23412800024088, 911541450703474, 57446699305445, 513296484586451, 180356843554043, 756391301483653, 823695939808936, 452898981558365, 383286682802447, 381394258915860, 385482809649632, 357950424436020, 212891024562585, 906036654538589, 706766032862393, 500658491083279, 134746243085697, 240386541491998, 850341345692155, 826490944132718, 329513332018620, 41046816597282, 396581286424992, 488863267297267, 92023040998362, 529684488438507, 925328511390026, 524897846090435, 413156582909097, 840524616502482, 325719016994120, 402494835113608, 145033960690364, 43932113323388, 683561775499473, 434510534220939, 92584300328516, 763767269974656, 289837041593468, 11468527450938, 628247946152943, 8844724571683, 813851806959975, 72001988637120, 875394575395153, 70667866716476, 75304931994100, 226809172374264, 767059176444181, 45462007920789, 472607315695803, 325973946551448, 64200767729194, 534886246409921, 950408390792175, 492288777130394, 226746605380806, 944479111810431, 776057001143579, 658971626589122, 231918349590349, 699710172246548, 122457405264610, 643115611310737, 999072890586878, 203230862786955, 348112034218733, 240143417330886, 927148962961842, 661569511006072, 190334725550806, 763365444730995, 516228913786395, 846501182194443, 741210200995504, 511935604454925, 687689993302203, 631038090127480, 961606522916414, 138550017953034, 932105540686829, 215285284639233, 772628158955819, 496858298527292, 730971468815108, 896733219370353, 967083685727881, 607660822695530, 650953466617730, 133773994258132, 623283311953090, 436380836970128, 237114930094468, 115451711811481, 674593269112948, 140400921371770, 659335660634071, 536749311958781, 854645598266824, 303305169095255, 91430489108219, 573739385205188, 400604977158702, 728593782212529, 807432219147040, 893541884126828, 183964371201281, 422680633277230, 218817645778789, 313025293025224, 657253930848472, 747562211812373, 83456701182914, 470417289614736, 641146659305859, 468130225316006, 46960547227850, 875638267674897, 662661765336441, 186533085001285, 743250648436106, 451414956181714, 527954145201673, 922589993405001, 242119479617901, 865476357142231, 988987578447349, 430198555146088, 477890180119931, 844464003254807, 503374203275928, 775374254241792, 346653210679737, 789242808338116, 48503976498612, 604300186163323, 475930096252359, 860836853339514, 994513691290102, 591343659366796, 944852018048514, 82396968629164, 152776642436549, 916070996204621, 305574094667054, 981194179562189, 126174175810273, 55636640522694, 44670495393401, 74724541586529, 988608465654705, 870533906709633, 374564052429787, 486493568142979, 469485372072295, 221153171135022, 289713227465073, 952450431038075, 107298466441025, 938262809228861, 253919870663003, 835790485199226, 655456538877798, 595464842927075, 191621819564547]\na = 288260533169915\np = 1007621497415251\ndecode = ''\nfor i in arange(len(lis)):\n    cipher = lis[i]\n    try:\n        r = discrete_log(p, cipher, a)\n        decode += '1'\n    except:\n        r = discrete_log(p, -cipher % p, a)\n        decode += '0'\nprint(''.join([chr(int(decode[i:i+8], 2)) for i in range(0, len(decode), 8)]))\n```\n\n## Modular Binomials\n\n### Description\n\nRearrange the following equations to get `p,q`\n\n```\nN = p*q\nc1 = (2*p + 3*q)**e1 mod N\nc2 = (5*p + 7*q)**e2 mod N\n```\n\n###  Analyze\n\n给了五个参数，求两个未知数 p 和 q，一眼看到给了 p，q 的乘积 N，所以只要随便求出来其中一个然后除 N 就可以咯。\n\n我是先求了 q，所以先把两个方程右边配成齐次的，然后把要消掉的 p 的系数配成一样的，q 的系数刚好是 15 和 14，相减就是 q 咯。\n\n最后一道题倒是没啥技术含量，就嗯解方程组。\n\n### Code\n\n```python\nimport math\nN = 14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073\ne1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137\ne2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697\nc1 = 14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051\nc2 = 14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519\n\n\nq = math.gcd(N, pow(c1, e2, N) * pow(5, e1 * e2, N) - pow(c2, e1, N) * pow(2, e1 * e2, N))\np = N // q\nprint(p)\nprint(q)\n```\n","slug":"Modular Arithmetic","published":1,"updated":"2022-05-04T10:27:44.343Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl37evnxx00009wfs0vv4b77m","content":"<p>第二章也做完咯~</p>\n<span id=\"more\"></span>\n\n<p>看到这章的标题就感觉要寄。</p>\n<p>进去一看果然，全是数学。。（数学废物笑不出来</p>\n<p>做了近两天，我只能说数学博大精深，做数学题真的会谢。。</p>\n<p>交完最后一题的 flag 觉得整个人都放松下来了，然后就感觉精疲力尽。</p>\n<p>做的很艰难，尤其 python 用的还是那么不利索。</p>\n<p>由于有些题的代码是通过推导之后直接通过数学定理化简，所以代码很简单。</p>\n<h1 id=\"Modular-Arithmetic\"><a href=\"#Modular-Arithmetic\" class=\"headerlink\" title=\"Modular Arithmetic\"></a>Modular Arithmetic</h1><h2 id=\"Greatest-Common-Divisor\"><a href=\"#Greatest-Common-Divisor\" class=\"headerlink\" title=\"Greatest Common Divisor\"></a>Greatest Common Divisor</h2><h3 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>The Greatest Common Divisor (GCD), sometimes known as the highest common factor, is the largest number which divides two positive integers (a,b).</p>\n<p>For <code>a = 12, b = 8</code> we can calculate the divisors of a: <code>&#123;1,2,3,4,6,12&#125;</code> and the divisors of b: <code>&#123;1,2,4,8&#125;</code>. Comparing these two, we see that <code>gcd(a,b) = 4</code>.</p>\n<p>Now imagine we take <code>a = 11, b = 17</code>. Both <code>a</code> and <code>b</code> are prime numbers. As a prime number has only itself and <code>1</code> as divisors, <code>gcd(a,b) = 1</code>.</p>\n<p>We say that for any two integers <code>a,b</code>, if <code>gcd(a,b) = 1</code> then <code>a</code> and <code>b</code> are coprime integers.</p>\n<p>If <code>a</code> and <code>b</code> are prime, they are also coprime. If <code>a</code> is prime and <code>b &lt; a</code> then <code>a</code> and <code>b</code> are coprime.</p>\n<blockquote>\n<p>Think about the case for <code>a</code> prime and <code>b &gt; a</code>, why are these not necessarily coprime?</p>\n</blockquote>\n<p>There are many tools to calculate the GCD of two integers, but for this task we recommend looking up <a href=\"https://en.wikipedia.org/wiki/Euclidean_algorithm\">Euclid’s Algorithm</a>.</p>\n<p>Try coding it up; it’s only a couple of lines. Use <code>a = 12, b = 8</code> to test it.</p>\n<p>Now calculate <code>gcd(a,b)</code> for <code>a = 66528, b = 52920</code> and enter it below.</p>\n<h3 id=\"Analyze\"><a href=\"#Analyze\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>就是算最大公约数啦，简单写个函数就好咯。</p>\n<p>现在再看这题是真简单啊。</p>\n<h3 id=\"Code\"><a href=\"#Code\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">gcd</span>(<span class=\"params\">a: <span class=\"built_in\">int</span>, b: <span class=\"built_in\">int</span></span>) -&gt; <span class=\"built_in\">int</span>:</span><br><span class=\"line\">    <span class=\"keyword\">while</span> b:</span><br><span class=\"line\">        a, b = b, a % b</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">a = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\">b = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\"><span class=\"built_in\">print</span>(gcd(a, b))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp\"><a href=\"#SumUp\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 欧几里得算法，是 C 语言做过的东西</span></span><br><span class=\"line\"><span class=\"comment\"># function： gcd(a, b)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">gcd</span>(<span class=\"params\">a: <span class=\"built_in\">int</span>, b: <span class=\"built_in\">int</span></span>) -&gt; <span class=\"built_in\">int</span>:</span><br><span class=\"line\">    <span class=\"keyword\">while</span> b:</span><br><span class=\"line\">        a, b = b, a % b</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Extended-GCD\"><a href=\"#Extended-GCD\" class=\"headerlink\" title=\"Extended GCD\"></a>Extended GCD</h2><h3 id=\"Description-1\"><a href=\"#Description-1\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Let <code>a</code> and <code>b</code> be positive integers.</p>\n<p>The extended Euclidean algorithm is an efficient way to find integers <code>u,v</code> such that</p>\n<figure class=\"highlight livecodeserver\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">a</span> * u + b * v = gcd(<span class=\"keyword\">a</span>,b)</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Later, when we learn to decrypt RSA, we will need this algorithm to calculate the modular inverse of the public exponent.</p>\n</blockquote>\n<p>Using the two primes <code>p = 26513, q = 32321</code>, find the integers <code>u,v</code> such that</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p <span class=\"emphasis\">* u + q *</span> v = gcd(p,q)</span><br></pre></td></tr></table></figure>\n\n<p>Enter whichever of <code>u</code> and <code>v</code> is the lower number as the flag.</p>\n<blockquote>\n<p>Knowing that <code>p,q</code> are prime, what would you expect <code>gcd(p,q)</code> to be? For more details on the extended Euclidean algorithm, check out <a href=\"http://www-math.ucdenver.edu/~wcherowi/courses/m5410/exeucalg.html\">this page</a>.</p>\n</blockquote>\n<h3 id=\"Analyze-1\"><a href=\"#Analyze-1\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>用到扩展的欧几里得算法，数学原理和辗转相除大同小异，简单代下数字手推一遍详细过程就知道怎么回事咯。</p>\n<h3 id=\"Code-1\"><a href=\"#Code-1\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">exgcd</span>(<span class=\"params\">a: <span class=\"built_in\">int</span>, b: <span class=\"built_in\">int</span></span>) -&gt; (<span class=\"built_in\">int</span>, <span class=\"built_in\">int</span>, <span class=\"built_in\">int</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> a &lt; b:</span><br><span class=\"line\">        t = a</span><br><span class=\"line\">        a = b</span><br><span class=\"line\">        b = t</span><br><span class=\"line\">    <span class=\"keyword\">if</span> b == <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a, <span class=\"number\">1</span>, <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        g, x, y = exgcd(b, a % b)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> g, y, x - (a // b) * y</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">a = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\">b = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\"><span class=\"built_in\">print</span>(exgcd(a, b))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-1\"><a href=\"#SumUp-1\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 扩展欧几里得，不限制输入的大小顺序</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">exgcd</span>(<span class=\"params\">a: <span class=\"built_in\">int</span>, b: <span class=\"built_in\">int</span></span>) -&gt; (<span class=\"built_in\">int</span>, <span class=\"built_in\">int</span>, <span class=\"built_in\">int</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> a &lt; b:</span><br><span class=\"line\">        t = a</span><br><span class=\"line\">        a = b</span><br><span class=\"line\">        b = t</span><br><span class=\"line\">    <span class=\"keyword\">if</span> b == <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a, <span class=\"number\">1</span>, <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        g, x, y = exgcd(b, a % b)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> g, y, x - (a // b) * y</span><br><span class=\"line\"><span class=\"comment\"># ax0 + by0 = gcd(a, b)</span></span><br><span class=\"line\"><span class=\"comment\"># 输入 a, b</span></span><br><span class=\"line\"><span class=\"comment\"># 输出 g, x0, y0</span></span><br><span class=\"line\"><span class=\"comment\"># 其中 g = gcd(a, b)</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Modular-Arithmetic-1\"><a href=\"#Modular-Arithmetic-1\" class=\"headerlink\" title=\"Modular Arithmetic 1\"></a>Modular Arithmetic 1</h2><h3 id=\"Description-2\"><a href=\"#Description-2\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Imagine you lean over and look at a cryptographer’s notebook. You see some notes in the margin:</p>\n<figure class=\"highlight basic\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">4 </span>+ <span class=\"number\">9</span> = <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"symbol\">5 </span>- <span class=\"number\">7</span> = <span class=\"number\">10</span></span><br><span class=\"line\"><span class=\"symbol\">2 </span>+ <span class=\"number\">3</span> = <span class=\"number\">5</span></span><br></pre></td></tr></table></figure>\n\n<p>At first you might think they’ve gone mad. Maybe this is why there are so many data leaks nowadays you’d think, but this is nothing more than modular arithmetic modulo 12 (albeit with some sloppy notation).</p>\n<p>You may not have been calling it modular arithmetic, but you’ve been doing these kinds of calculations since you learnt to tell the time (look again at those equations and think about adding hours).</p>\n<p>Formally, “calculating time” is described by the theory of congruences. We say that two integers are congruent modulo m if <code>a ≡ b mod m</code>.</p>\n<p>Another way of saying this, is that when we divide the integer <code>a</code> by <code>m</code>, the remainder is <code>b</code>. This tells you that if m divides a (this can be written as <code>m | a</code>) then <code>a ≡ 0 mod m</code>.</p>\n<p>Calculate the following integers:</p>\n<figure class=\"highlight basic\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">11 </span>≡ x <span class=\"keyword\">mod</span> <span class=\"number\">6</span></span><br><span class=\"line\"><span class=\"symbol\">8146798528947 </span>≡ y <span class=\"keyword\">mod</span> <span class=\"number\">17</span></span><br></pre></td></tr></table></figure>\n\n<p>The solution is the smaller of the two integers.</p>\n<h3 id=\"Analyze-2\"><a href=\"#Analyze-2\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>模运算来了，头大。后面全是和模运算有关的（准确来说这一整章都是</p>\n<p>这道算简单，取余算一下 x 和 y，然后按要求输出小的。没啥好思考的捏。</p>\n<h3 id=\"Code-2\"><a href=\"#Code-2\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">n = <span class=\"number\">8146798528947</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">min</span>(n % <span class=\"number\">17</span>, <span class=\"number\">11</span> % <span class=\"number\">6</span>))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Modular-Arithmetic-2\"><a href=\"#Modular-Arithmetic-2\" class=\"headerlink\" title=\"Modular Arithmetic 2\"></a>Modular Arithmetic 2</h2><h3 id=\"Description-3\"><a href=\"#Description-3\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>We’ll pick up from the last challenge and imagine we’ve picked a modulus <code>p</code>, and we will restrict ourselves to the case when <code>p</code> is prime.</p>\n<p>The integers modulo <code>p</code> define a field, denoted <code>Fp</code>.</p>\n<blockquote>\n<p>If the modulus is not prime, the set of integers modulo <code>n</code> define a ring.</p>\n</blockquote>\n<p>A finite field <code>Fp</code> is the set of integers <code>&#123;0,1,...,p-1&#125;</code>, and under both addition and multiplication there is an inverse element <code>b</code> for every element <code>a</code> in the set, such that <code>a + b = 0</code> and <code>a * b = 1</code>.</p>\n<blockquote>\n<p>Note that the identity element for addition and multiplication is different! This is because the identity when acted with the operator should do nothing: <code>a + 0 = a</code> and <code>a * 1 = a</code>.</p>\n</blockquote>\n<p>Lets say we pick <code>p = 17</code>. Calculate <code>317 mod 17</code>. Now do the same but with <code>517 mod 17</code>.</p>\n<p>What would you expect to get for <code>716 mod 17</code>? Try calculating that.</p>\n<p>This interesting fact is known as Fermat’s little theorem. We’ll be needing this (and its generalisations) when we look at RSA cryptography.</p>\n<p>Now take the prime <code>p = 65537</code>. Calculate <code>27324678765465536 mod 65537</code>.</p>\n<p>Did you need a calculator?</p>\n<h3 id=\"Analyze-3\"><a href=\"#Analyze-3\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>费马小定理，蛮有意思的一个公式。</p>\n<p>$a^{p} \\equiv a \\mod p$，浅浅变形一下：$a^{p-1} \\equiv 1 \\mod p$</p>\n<p>主要题目描述这个定理的时候略微有一点写复杂咯，不够优雅（ bushi。</p>\n<p>这么推导出来其实没有写代码的必要。</p>\n<h3 id=\"Code-3\"><a href=\"#Code-3\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = <span class=\"number\">273246787654</span></span><br><span class=\"line\">p = <span class=\"number\">65537</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"number\">1</span> % p)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># a^(p-1) ≡ 1(mod p)</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Modular-Inverting\"><a href=\"#Modular-Inverting\" class=\"headerlink\" title=\"Modular Inverting\"></a>Modular Inverting</h2><h3 id=\"Description-4\"><a href=\"#Description-4\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>As we’ve seen, we can work within a finite field <code>Fp</code>, adding and multiplying elements, and always obtain another element of the field.</p>\n<p>For all elements <code>g</code> in the field, there exists a unique integer <code>d</code> such that <code>g * d ≡ 1 mod p</code>.</p>\n<p>This is the multiplicative inverse of <code>g</code>.</p>\n<p><strong>Example</strong>: <code>7 * 8 = 56 ≡ 1 mod 11</code></p>\n<p>What is the inverse element: <code>3 * d ≡ 1 mod 13</code>?</p>\n<blockquote>\n<p>Think about the little theorem we just worked with. How does this help you find the inverse of an element?</p>\n</blockquote>\n<h3 id=\"Analyze-4\"><a href=\"#Analyze-4\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>模逆运算，同余这块的知识。主要是欧拉定理和费马小定理的应用。</p>\n<p>欧拉定理：$a^{φ(n)} \\equiv 1 \\mod n$</p>\n<p>费马小定理：$a^{p-1} \\equiv 1 \\mod p$</p>\n<p>对于这道题，有 $3 * d \\equiv 1 \\mod 13$</p>\n<p>因为 gcd(3, 13) &#x3D; 1，所以可以直接得$$d\\ &#x3D;\\ 3^{φ(13)-1}\\ *\\ 1&#x3D;3^{11} \\mod 13$$ </p>\n<p>python 的 pow() 函数真的很好用！</p>\n<h3 id=\"Code-4\"><a href=\"#Code-4\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">d = <span class=\"built_in\">pow</span> (<span class=\"number\">3</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(d)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-2\"><a href=\"#SumUp-2\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><p>$φ(n)$ 即 <code>1 ~ (n-1)</code> 范围内与 n 互素的数的个数，若 n 本身为素数，则 $φ(n)&#x3D;n-1$ 。</p>\n<h2 id=\"Quadratic-Residues\"><a href=\"#Quadratic-Residues\" class=\"headerlink\" title=\"Quadratic Residues\"></a>Quadratic Residues</h2><h3 id=\"Description-5\"><a href=\"#Description-5\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>We’ve looked at multiplication and division in modular arithmetic, but what does it mean to take the square root modulo an integer?</p>\n<p>For the following discussion, let’s work modulo <code>p = 29</code>. We can take the integer <code>a = 11</code> and calculate <code>a² = 5 mod 29</code>.</p>\n<p>As <code>a = 11, a² = 5</code>, we say the square root of <code>5</code> is <code>11</code>.</p>\n<p>This feels good, but now let’s think about the square root of <code>18</code>. From the above, we know we need to find some integer <code>a</code> such that <code>a² = 18</code></p>\n<p>Your first idea might be to start with <code>a = 1</code> and loop to <code>a = p-1</code>. In this discussion <code>p</code> isn’t too large and we can quickly look.</p>\n<p>Have a go, try coding this and see what you find. If you’ve coded it right, you’ll find that for all <code>a ∈ Fp*</code> you never find an <code>a</code> such that <code>a² = 18</code>.</p>\n<p>What we are seeing, is that for the elements of <code>F*p</code>, not every element has a square root. In fact, what we find is that for roughly one half of the elements of <code>Fp*</code>, there is no square root.</p>\n<blockquote>\n<p>We say that an integer <code>x</code> is a <em>Quadratic Residue</em> if there exists an <code>a</code> such that <code>a² = x mod p</code>. If there is no such solution, then the integer is a <em>Quadratic Non-Residue</em>.</p>\n</blockquote>\n<p>In other words, <code>x</code> is a quadratic residue when it is possible to take the square root of <code>x</code> modulo an integer <code>p</code>.</p>\n<p>In the below list there are two non-quadratic residues and one quadratic residue.</p>\n<p>Find the quadratic residue and then calculate its square root. Of the two possible roots, submit the smaller one as the flag.</p>\n<blockquote>\n<p>If <code>a² = x</code> then (-a)² &#x3D; x. So if <code>x</code> is a quadratic residue in some finite field, then there are always two solutions for <code>a</code>.</p>\n</blockquote>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">p</span> = <span class=\"number\">29</span></span><br><span class=\"line\"><span class=\"attr\">ints</span> = [<span class=\"number\">14</span>, <span class=\"number\">6</span>, <span class=\"number\">11</span>]</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Analyze-5\"><a href=\"#Analyze-5\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>Legendre 符号（欧拉判别法）的内容，二次剩余。</p>\n<p>定义：如果 $a^2 \\equiv x \\mod p$ 有解，则 x 是模 p 的二次剩余，否则称为二次非剩余,。</p>\n<p>Given: p, x[]</p>\n<p>Asked: 找出二次剩余，并求出平方根。</p>\n<p>遍历 x in range(1, p)，计算 x 的平方模 p，并与 ints[] 中的元素进行比较，找出模 p 的二次剩余，此时的 x 即为该二次剩余的平方根。</p>\n<p>公式和题里的 a 和 x 参数真的很容易弄混，理了半天才理清楚 。。</p>\n<h3 id=\"Code-5\"><a href=\"#Code-5\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = <span class=\"number\">29</span></span><br><span class=\"line\">ints = [<span class=\"number\">14</span>, <span class=\"number\">6</span>, <span class=\"number\">11</span>]</span><br><span class=\"line\">flag = <span class=\"built_in\">min</span>(x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, p) <span class=\"keyword\">if</span> <span class=\"built_in\">pow</span>(x, <span class=\"number\">2</span>, p) <span class=\"keyword\">in</span> ints)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(flag)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Legendre-Symbol\"><a href=\"#Legendre-Symbol\" class=\"headerlink\" title=\"Legendre Symbol\"></a>Legendre Symbol</h2><h3 id=\"Description-6\"><a href=\"#Description-6\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>In Quadratic Residues we learnt what it means to take the square root modulo an integer. We also saw that taking a root isn’t always possible.</p>\n<p>In the previous case when <code>p = 29</code>, even the simplest method of calculating the square root was fast enough, but as <code>p</code> gets larger, this method becomes wildly unreasonable.</p>\n<p>Lucky for us, we have a way to check whether an integer is a quadratic residue with a single calculation thanks to Legendre. In the following, we will assume we are working modulo a prime <code>p</code>.</p>\n<p>Before looking at Legendre’s symbol, let’s take a brief detour to see an interesting property of quadratic (non-)residues.</p>\n<figure class=\"highlight mathematica\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">Quadratic</span> <span class=\"built_in\">Residue</span> <span class=\"operator\">*</span> <span class=\"variable\">Quadratic</span> <span class=\"built_in\">Residue</span> <span class=\"operator\">=</span> <span class=\"variable\">Quadratic</span> <span class=\"built_in\">Residue</span></span><br><span class=\"line\"><span class=\"variable\">Quadratic</span> <span class=\"built_in\">Residue</span> <span class=\"operator\">*</span> <span class=\"variable\">Quadratic</span> <span class=\"variable\">Non</span><span class=\"operator\">-</span><span class=\"variable\">residue</span> <span class=\"operator\">=</span> <span class=\"variable\">Quadratic</span> <span class=\"variable\">Non</span><span class=\"operator\">-</span><span class=\"variable\">residue</span></span><br><span class=\"line\"><span class=\"variable\">Quadratic</span> <span class=\"variable\">Non</span><span class=\"operator\">-</span><span class=\"variable\">residue</span> <span class=\"operator\">*</span> <span class=\"variable\">Quadratic</span> <span class=\"variable\">Non</span><span class=\"operator\">-</span><span class=\"variable\">residue</span> <span class=\"operator\">=</span> <span class=\"variable\">Quadratic</span> <span class=\"built_in\">Residue</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Want an easy way to remember this? Replace “Quadratic Residue” with <code>+1</code> and “Quadratic Non-residue” with <code>-1</code>, all three results are the same!</p>\n</blockquote>\n<p>So what’s the trick? The <a href=\"https://en.wikipedia.org/wiki/Legendre_symbol\">Legendre Symbol</a> gives an efficient way to determine whether an integer is a quadratic residue modulo an odd prime <code>p</code>.</p>\n<p>Legendre’s Symbol: <code>(a / p) ≡ a(p-1)/2 mod p</code> obeys:</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"selector-tag\">a</span> / p) = <span class=\"number\">1</span> <span class=\"keyword\">if</span> <span class=\"selector-tag\">a</span> is <span class=\"selector-tag\">a</span> quadratic residue and <span class=\"selector-tag\">a</span> ≢ <span class=\"number\">0</span> mod <span class=\"selector-tag\">p</span></span><br><span class=\"line\">(<span class=\"selector-tag\">a</span> / p) = -<span class=\"number\">1</span> <span class=\"keyword\">if</span> <span class=\"selector-tag\">a</span> is <span class=\"selector-tag\">a</span> quadratic non-residue mod <span class=\"selector-tag\">p</span></span><br><span class=\"line\">(<span class=\"selector-tag\">a</span> / p) = <span class=\"number\">0</span> <span class=\"keyword\">if</span> <span class=\"selector-tag\">a</span> ≡ <span class=\"number\">0</span> mod p</span><br></pre></td></tr></table></figure>\n\n<p>Which means given any integer <code>a</code>, calculating <code>pow(a,(p-1)/2,p)</code> is enough to determine if <code>a</code> is a quadratic residue.</p>\n<p>Now for the flag. Given the following 1024 bit prime and 10 integers, find the quadratic residue and then calculate its square root; the square root is your flag. Of the two possible roots, submit the larger one as your answer.</p>\n<blockquote>\n<p>So Legendre’s symbol tells us which integer is a quadratic residue, but how do we find the square root?! The prime supplied obeys <code>p = 3 mod 4</code>, which allows us easily compute the square root. The answer is online, but you can figure it out yourself if you think about Fermat’s little theorem.</p>\n</blockquote>\n<h3 id=\"Analyze-6\"><a href=\"#Analyze-6\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>Legendre 符号的欧拉判别法。</p>\n<p>$$\\left(\\frac{a}{p}\\right)&#x3D;\\begin{cases}1, &amp;a ≢ 0 \\mod p\\text{ 且 }a\\text{ 是模 }p\\text{ 的二次剩余} \\\\ -1, &amp;a ≢ 0 \\mod p\\text{ 且 }a\\text{ 是模 }p\\text{ 的二次非剩余} \\\\ 0, &amp;a ≡0 \\mod p \\end{cases}$$</p>\n<p>欧拉判别法内容：$(a&#x2F;p) \\equiv a^{(p-1)&#x2F;2} \\mod p$。</p>\n<p>遍历 ints 判断各自对应的 $(a&#x2F;p)$ 是否等于 1，得到二次剩余 a 之后计算平方根 $a^{(p+1)&#x2F;4} \\mod p$ 。</p>\n<h3 id=\"Code-6\"><a href=\"#Code-6\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = <span class=\"number\">101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139</span></span><br><span class=\"line\">ints = [<span class=\"number\">25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803</span>, <span class=\"number\">45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555</span>, <span class=\"number\">17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325</span>, <span class=\"number\">14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863</span>, <span class=\"number\">4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318</span>, <span class=\"number\">85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771</span>, <span class=\"number\">50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987</span>, <span class=\"number\">96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871</span>, <span class=\"number\">4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721</span>, <span class=\"number\">18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">res = [x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> ints <span class=\"keyword\">if</span> <span class=\"built_in\">pow</span>(x, (p-<span class=\"number\">1</span>)//<span class=\"number\">2</span>, p) == <span class=\"number\">1</span>][<span class=\"number\">0</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">pow</span>(res, (p + <span class=\"number\">1</span>)//<span class=\"number\">4</span>, p))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Modular-Square-Root\"><a href=\"#Modular-Square-Root\" class=\"headerlink\" title=\"Modular Square Root\"></a>Modular Square Root</h2><h3 id=\"Description-7\"><a href=\"#Description-7\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>In Legendre Symbol we introduced a fast way to determine whether a number is a square root modulo a prime. We can go further: there are algorithms for efficiently calculating such roots. The best one in practice is called Tonelli-Shanks, which gets its funny name from the fact that it was first described by an Italian in the 19th century and rediscovered independently by Daniel Shanks in the 1970s.</p>\n<p>All primes that aren’t 2 are of the form <code>p ≡ 1 mod 4</code> or <code>p ≡ 3 mod 4</code>, since all odd numbers obey these congruences. As the previous challenge hinted, in the <code>p ≡ 3 mod 4</code> case, a really simple formula for computing square roots can be <a href=\"https://crypto.stackexchange.com/a/20994\">derived</a> directly from Fermat’s little theorem. That leaves us still with the <code>p ≡ 1 mod 4</code> case, so a more general algorithm is required.</p>\n<p>In a congruence of the form <code>r² ≡ a mod p</code>, Tonelli-Shanks calculates <code>r</code>.</p>\n<blockquote>\n<p>Tonelli-Shanks doesn’t work for composite (non-prime) moduli. Finding square roots modulo composites is computationally equivalent to integer factorization.</p>\n</blockquote>\n<p>The main use-case for this algorithm is finding elliptic curve co-ordinates. Its operation is somewhat complex so we’re not going to discuss the details, however, implementations are easy to find and Sage has one built-in.</p>\n<p>Find the square root of <code>a</code> modulo the 2048-bit prime <code>p</code>. Give the smaller of the two roots as your answer.</p>\n<h3 id=\"Analyze-7\"><a href=\"#Analyze-7\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>sympy 模块内有封装好的函数可以计算二次剩余。</p>\n<p>函数 nthroot_mod(a, n, p) 用于求解于 $x^{n} \\equiv a\\ mod\\ p$ 的同余式。</p>\n<p>题目给了表达式 $r^2 \\equiv a\\ mod\\ p$，求 r。</p>\n<p>写了半天函数心态爆炸，然后搜了下 python 相关的库，几行就解决。</p>\n<p>再次感叹，python 真是个好东西。</p>\n<h3 id=\"Code-7\"><a href=\"#Code-7\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> sympy</span><br><span class=\"line\">a = <span class=\"number\">8479994658316772151941616510097127087554541274812435112009425778595495359700244470400642403747058566807127814165396640215844192327900454116257979487432016769329970767046735091249898678088061634796559556704959846424131820416048436501387617211770124292793308079214153179977624440438616958575058361193975686620046439877308339989295604537867493683872778843921771307305602776398786978353866231661453376056771972069776398999013769588936194859344941268223184197231368887060609212875507518936172060702209557124430477137421847130682601666968691651447236917018634902407704797328509461854842432015009878011354022108661461024768</span></span><br><span class=\"line\">p = <span class=\"number\">30531851861994333252675935111487950694414332763909083514133769861350960895076504687261369815735742549428789138300843082086550059082835141454526618160634109969195486322015775943030060449557090064811940139431735209185996454739163555910726493597222646855506445602953689527405362207926990442391705014604777038685880527537489845359101552442292804398472642356609304810680731556542002301547846635101455995732584071355903010856718680732337369128498655255277003643669031694516851390505923416710601212618443109844041514942401969629158975457079026906304328749039997262960301209158175920051890620947063936347307238412281568760161</span></span><br><span class=\"line\">r = sympy.nthroot_mod(a, <span class=\"number\">2</span>, p)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(r)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-3\"><a href=\"#SumUp-3\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><p>$x^{n} \\equiv a\\ mod\\ p$，求 x</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># function:</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> sympy.ntheory.residue_ntheory <span class=\"keyword\">import</span> nthroot_mod</span><br><span class=\"line\">x = nthroot_mod(a, n, p)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Chinese-Remainder-Theorem\"><a href=\"#Chinese-Remainder-Theorem\" class=\"headerlink\" title=\"Chinese Remainder Theorem\"></a>Chinese Remainder Theorem</h2><h3 id=\"Description-8\"><a href=\"#Description-8\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>The Chinese Remainder Theorem gives a unique solution to a set of linear congruences if their moduli are coprime.</p>\n<p>This means, that given a set of arbitrary integers <code>ai</code>, and pairwise coprime integers <code>ni</code>, such that the following linear congruences hold:</p>\n<blockquote>\n<p>Note “pairwise coprime integers” means that if we have a set of integers <code>&#123;n1, n2, ..., ni&#125;</code>, all pairs of integers selected from the set are coprime: <code>gcd(ni, nj) = 1</code>.</p>\n</blockquote>\n<figure class=\"highlight livecodeserver\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x ≡ a1 <span class=\"keyword\">mod</span> n1</span><br><span class=\"line\">x ≡ a2 <span class=\"keyword\">mod</span> n2</span><br><span class=\"line\">...</span><br><span class=\"line\">x ≡ <span class=\"keyword\">an</span> <span class=\"keyword\">mod</span> nn</span><br></pre></td></tr></table></figure>\n\n<p>There is a unique solution <code>x ≡ a mod N</code> where <code>N = n1 * n2 * ... * nn</code>.</p>\n<p>In cryptography, we commonly use the Chinese Remainder Theorem to help us reduce a problem of very large integers into a set of several, easier problems.</p>\n<p>Given the following set of linear congruences:</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">x</span> ≡ <span class=\"number\">2</span> mod <span class=\"number\">5</span></span><br><span class=\"line\"><span class=\"attribute\">x</span> ≡ <span class=\"number\">3</span> mod <span class=\"number\">11</span></span><br><span class=\"line\"><span class=\"attribute\">x</span> ≡ <span class=\"number\">5</span> mod <span class=\"number\">17</span></span><br></pre></td></tr></table></figure>\n\n<p>Find the integer <code>a</code> such that <code>x ≡ a mod 935</code></p>\n<blockquote>\n<p>Starting with the congruence with the largest modulus, use that for <code>x ≡ a mod p</code> we can write <code>x = a + k*p</code> for arbitrary integer <code>k</code>.</p>\n</blockquote>\n<h3 id=\"Analyze-8\"><a href=\"#Analyze-8\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>中国剩余定理，也叫孙子定理。主要针对同余方程组的求解问题。</p>\n<p>YouTube 上找了个视频看了原理，跟着视频手算出来了结果，感觉跟着例题一步步算真的能加深理解诶，很容易就理解到了原理和用法。</p>\n<p><img src=\"https://img.hawa130.com/%E6%B1%82%E8%A7%A3%E8%BF%87%E7%A8%8B.jpg\" alt=\"求解过程\"></p>\n<p>算法直接找了个板子，偷个懒捏。</p>\n<h3 id=\"Code-8\"><a href=\"#Code-8\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> functools <span class=\"keyword\">import</span> reduce</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">chinese_remainder</span>(<span class=\"params\">n, a</span>):</span><br><span class=\"line\">    <span class=\"built_in\">sum</span> = <span class=\"number\">0</span></span><br><span class=\"line\">    prod = reduce(<span class=\"keyword\">lambda</span> a, b: a * b, n)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> n_i, a_i <span class=\"keyword\">in</span> <span class=\"built_in\">zip</span>(n, a):</span><br><span class=\"line\">        p = prod // n_i</span><br><span class=\"line\">        <span class=\"built_in\">sum</span> += a_i * mul_inv(p, n_i) * p</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">sum</span> % prod</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">mul_inv</span>(<span class=\"params\">a, b</span>):</span><br><span class=\"line\">    b0 = b</span><br><span class=\"line\">    x0, x1 = <span class=\"number\">0</span>, <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> b == <span class=\"number\">1</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> a &gt; <span class=\"number\">1</span>:</span><br><span class=\"line\">        q = a // b</span><br><span class=\"line\">        a, b = b, a % b</span><br><span class=\"line\">        x0, x1 = x1 - q * x0, x0</span><br><span class=\"line\">    <span class=\"keyword\">if</span> x1 &lt; <span class=\"number\">0</span>:</span><br><span class=\"line\">        x1 += b0</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x1</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">n = [<span class=\"number\">5</span>, <span class=\"number\">11</span>, <span class=\"number\">17</span>]</span><br><span class=\"line\">a = [<span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(chinese_remainder(n, a))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Adrien’s-Signs\"><a href=\"#Adrien’s-Signs\" class=\"headerlink\" title=\"Adrien’s Signs\"></a>Adrien’s Signs</h2><h3 id=\"Description-9\"><a href=\"#Description-9\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Adrien’s been looking at ways to encrypt his messages with the help of symbols and minus signs. Can you find a way to recover the flag?</p>\n<h3 id=\"Analyze-9\"><a href=\"#Analyze-9\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>python 学得不好，加密函数理解了好久。</p>\n<p>解密倒还好，拿到密文直接正常取对数，取不到就负数取余把 n 还原回去再取对数。</p>\n<p>不过代码得跑一会才能出结果，后面或许可以再看看有没有更优解。</p>\n<p>（最后一行的代码简直写得太优雅咯</p>\n<h3 id=\"Code-9\"><a href=\"#Code-9\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> numpy <span class=\"keyword\">import</span> arange</span><br><span class=\"line\"><span class=\"keyword\">from</span> sympy <span class=\"keyword\">import</span> discrete_log</span><br><span class=\"line\"></span><br><span class=\"line\">lis = [<span class=\"number\">67594220461269</span>, <span class=\"number\">501237540280788</span>, <span class=\"number\">718316769824518</span>, <span class=\"number\">296304224247167</span>, <span class=\"number\">48290626940198</span>, <span class=\"number\">30829701196032</span>, <span class=\"number\">521453693392074</span>, <span class=\"number\">840985324383794</span>, <span class=\"number\">770420008897119</span>, <span class=\"number\">745131486581197</span>, <span class=\"number\">729163531979577</span>, <span class=\"number\">334563813238599</span>, <span class=\"number\">289746215495432</span>, <span class=\"number\">538664937794468</span>, <span class=\"number\">894085795317163</span>, <span class=\"number\">983410189487558</span>, <span class=\"number\">863330928724430</span>, <span class=\"number\">996272871140947</span>, <span class=\"number\">352175210511707</span>, <span class=\"number\">306237700811584</span>, <span class=\"number\">631393408838583</span>, <span class=\"number\">589243747914057</span>, <span class=\"number\">538776819034934</span>, <span class=\"number\">365364592128161</span>, <span class=\"number\">454970171810424</span>, <span class=\"number\">986711310037393</span>, <span class=\"number\">657756453404881</span>, <span class=\"number\">388329936724352</span>, <span class=\"number\">90991447679370</span>, <span class=\"number\">714742162831112</span>, <span class=\"number\">62293519842555</span>, <span class=\"number\">653941126489711</span>, <span class=\"number\">448552658212336</span>, <span class=\"number\">970169071154259</span>, <span class=\"number\">339472870407614</span>, <span class=\"number\">406225588145372</span>, <span class=\"number\">205721593331090</span>, <span class=\"number\">926225022409823</span>, <span class=\"number\">904451547059845</span>, <span class=\"number\">789074084078342</span>, <span class=\"number\">886420071481685</span>, <span class=\"number\">796827329208633</span>, <span class=\"number\">433047156347276</span>, <span class=\"number\">21271315846750</span>, <span class=\"number\">719248860593631</span>, <span class=\"number\">534059295222748</span>, <span class=\"number\">879864647580512</span>, <span class=\"number\">918055794962142</span>, <span class=\"number\">635545050939893</span>, <span class=\"number\">319549343320339</span>, <span class=\"number\">93008646178282</span>, <span class=\"number\">926080110625306</span>, <span class=\"number\">385476640825005</span>, <span class=\"number\">483740420173050</span>, <span class=\"number\">866208659796189</span>, <span class=\"number\">883359067574584</span>, <span class=\"number\">913405110264883</span>, <span class=\"number\">898864873510337</span>, <span class=\"number\">208598541987988</span>, <span class=\"number\">23412800024088</span>, <span class=\"number\">911541450703474</span>, <span class=\"number\">57446699305445</span>, <span class=\"number\">513296484586451</span>, <span class=\"number\">180356843554043</span>, <span class=\"number\">756391301483653</span>, <span class=\"number\">823695939808936</span>, <span class=\"number\">452898981558365</span>, <span class=\"number\">383286682802447</span>, <span class=\"number\">381394258915860</span>, <span class=\"number\">385482809649632</span>, <span class=\"number\">357950424436020</span>, <span class=\"number\">212891024562585</span>, <span class=\"number\">906036654538589</span>, <span class=\"number\">706766032862393</span>, <span class=\"number\">500658491083279</span>, <span class=\"number\">134746243085697</span>, <span class=\"number\">240386541491998</span>, <span class=\"number\">850341345692155</span>, <span class=\"number\">826490944132718</span>, <span class=\"number\">329513332018620</span>, <span class=\"number\">41046816597282</span>, <span class=\"number\">396581286424992</span>, <span class=\"number\">488863267297267</span>, <span class=\"number\">92023040998362</span>, <span class=\"number\">529684488438507</span>, <span class=\"number\">925328511390026</span>, <span class=\"number\">524897846090435</span>, <span class=\"number\">413156582909097</span>, <span class=\"number\">840524616502482</span>, <span class=\"number\">325719016994120</span>, <span class=\"number\">402494835113608</span>, <span class=\"number\">145033960690364</span>, <span class=\"number\">43932113323388</span>, <span class=\"number\">683561775499473</span>, <span class=\"number\">434510534220939</span>, <span class=\"number\">92584300328516</span>, <span class=\"number\">763767269974656</span>, <span class=\"number\">289837041593468</span>, <span class=\"number\">11468527450938</span>, <span class=\"number\">628247946152943</span>, <span class=\"number\">8844724571683</span>, <span class=\"number\">813851806959975</span>, <span class=\"number\">72001988637120</span>, <span class=\"number\">875394575395153</span>, <span class=\"number\">70667866716476</span>, <span class=\"number\">75304931994100</span>, <span class=\"number\">226809172374264</span>, <span class=\"number\">767059176444181</span>, <span class=\"number\">45462007920789</span>, <span class=\"number\">472607315695803</span>, <span class=\"number\">325973946551448</span>, <span class=\"number\">64200767729194</span>, <span class=\"number\">534886246409921</span>, <span class=\"number\">950408390792175</span>, <span class=\"number\">492288777130394</span>, <span class=\"number\">226746605380806</span>, <span class=\"number\">944479111810431</span>, <span class=\"number\">776057001143579</span>, <span class=\"number\">658971626589122</span>, <span class=\"number\">231918349590349</span>, <span class=\"number\">699710172246548</span>, <span class=\"number\">122457405264610</span>, <span class=\"number\">643115611310737</span>, <span class=\"number\">999072890586878</span>, <span class=\"number\">203230862786955</span>, <span class=\"number\">348112034218733</span>, <span class=\"number\">240143417330886</span>, <span class=\"number\">927148962961842</span>, <span class=\"number\">661569511006072</span>, <span class=\"number\">190334725550806</span>, <span class=\"number\">763365444730995</span>, <span class=\"number\">516228913786395</span>, <span class=\"number\">846501182194443</span>, <span class=\"number\">741210200995504</span>, <span class=\"number\">511935604454925</span>, <span class=\"number\">687689993302203</span>, <span class=\"number\">631038090127480</span>, <span class=\"number\">961606522916414</span>, <span class=\"number\">138550017953034</span>, <span class=\"number\">932105540686829</span>, <span class=\"number\">215285284639233</span>, <span class=\"number\">772628158955819</span>, <span class=\"number\">496858298527292</span>, <span class=\"number\">730971468815108</span>, <span class=\"number\">896733219370353</span>, <span class=\"number\">967083685727881</span>, <span class=\"number\">607660822695530</span>, <span class=\"number\">650953466617730</span>, <span class=\"number\">133773994258132</span>, <span class=\"number\">623283311953090</span>, <span class=\"number\">436380836970128</span>, <span class=\"number\">237114930094468</span>, <span class=\"number\">115451711811481</span>, <span class=\"number\">674593269112948</span>, <span class=\"number\">140400921371770</span>, <span class=\"number\">659335660634071</span>, <span class=\"number\">536749311958781</span>, <span class=\"number\">854645598266824</span>, <span class=\"number\">303305169095255</span>, <span class=\"number\">91430489108219</span>, <span class=\"number\">573739385205188</span>, <span class=\"number\">400604977158702</span>, <span class=\"number\">728593782212529</span>, <span class=\"number\">807432219147040</span>, <span class=\"number\">893541884126828</span>, <span class=\"number\">183964371201281</span>, <span class=\"number\">422680633277230</span>, <span class=\"number\">218817645778789</span>, <span class=\"number\">313025293025224</span>, <span class=\"number\">657253930848472</span>, <span class=\"number\">747562211812373</span>, <span class=\"number\">83456701182914</span>, <span class=\"number\">470417289614736</span>, <span class=\"number\">641146659305859</span>, <span class=\"number\">468130225316006</span>, <span class=\"number\">46960547227850</span>, <span class=\"number\">875638267674897</span>, <span class=\"number\">662661765336441</span>, <span class=\"number\">186533085001285</span>, <span class=\"number\">743250648436106</span>, <span class=\"number\">451414956181714</span>, <span class=\"number\">527954145201673</span>, <span class=\"number\">922589993405001</span>, <span class=\"number\">242119479617901</span>, <span class=\"number\">865476357142231</span>, <span class=\"number\">988987578447349</span>, <span class=\"number\">430198555146088</span>, <span class=\"number\">477890180119931</span>, <span class=\"number\">844464003254807</span>, <span class=\"number\">503374203275928</span>, <span class=\"number\">775374254241792</span>, <span class=\"number\">346653210679737</span>, <span class=\"number\">789242808338116</span>, <span class=\"number\">48503976498612</span>, <span class=\"number\">604300186163323</span>, <span class=\"number\">475930096252359</span>, <span class=\"number\">860836853339514</span>, <span class=\"number\">994513691290102</span>, <span class=\"number\">591343659366796</span>, <span class=\"number\">944852018048514</span>, <span class=\"number\">82396968629164</span>, <span class=\"number\">152776642436549</span>, <span class=\"number\">916070996204621</span>, <span class=\"number\">305574094667054</span>, <span class=\"number\">981194179562189</span>, <span class=\"number\">126174175810273</span>, <span class=\"number\">55636640522694</span>, <span class=\"number\">44670495393401</span>, <span class=\"number\">74724541586529</span>, <span class=\"number\">988608465654705</span>, <span class=\"number\">870533906709633</span>, <span class=\"number\">374564052429787</span>, <span class=\"number\">486493568142979</span>, <span class=\"number\">469485372072295</span>, <span class=\"number\">221153171135022</span>, <span class=\"number\">289713227465073</span>, <span class=\"number\">952450431038075</span>, <span class=\"number\">107298466441025</span>, <span class=\"number\">938262809228861</span>, <span class=\"number\">253919870663003</span>, <span class=\"number\">835790485199226</span>, <span class=\"number\">655456538877798</span>, <span class=\"number\">595464842927075</span>, <span class=\"number\">191621819564547</span>]</span><br><span class=\"line\">a = <span class=\"number\">288260533169915</span></span><br><span class=\"line\">p = <span class=\"number\">1007621497415251</span></span><br><span class=\"line\">decode = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> arange(<span class=\"built_in\">len</span>(lis)):</span><br><span class=\"line\">    cipher = lis[i]</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        r = discrete_log(p, cipher, a)</span><br><span class=\"line\">        decode += <span class=\"string\">&#x27;1&#x27;</span></span><br><span class=\"line\">    <span class=\"keyword\">except</span>:</span><br><span class=\"line\">        r = discrete_log(p, -cipher % p, a)</span><br><span class=\"line\">        decode += <span class=\"string\">&#x27;0&#x27;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;&#x27;</span>.join([<span class=\"built_in\">chr</span>(<span class=\"built_in\">int</span>(decode[i:i+<span class=\"number\">8</span>], <span class=\"number\">2</span>)) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(decode), <span class=\"number\">8</span>)]))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Modular-Binomials\"><a href=\"#Modular-Binomials\" class=\"headerlink\" title=\"Modular Binomials\"></a>Modular Binomials</h2><h3 id=\"Description-10\"><a href=\"#Description-10\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Rearrange the following equations to get <code>p,q</code></p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">N</span> = p*q</span><br><span class=\"line\"><span class=\"attr\">c1</span> = (<span class=\"number\">2</span>*p + <span class=\"number\">3</span>*q)**e1 mod N</span><br><span class=\"line\"><span class=\"attr\">c2</span> = (<span class=\"number\">5</span>*p + <span class=\"number\">7</span>*q)**e2 mod N</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Analyze-10\"><a href=\"#Analyze-10\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>给了五个参数，求两个未知数 p 和 q，一眼看到给了 p，q 的乘积 N，所以只要随便求出来其中一个然后除 N 就可以咯。</p>\n<p>我是先求了 q，所以先把两个方程右边配成齐次的，然后把要消掉的 p 的系数配成一样的，q 的系数刚好是 15 和 14，相减就是 q 咯。</p>\n<p>最后一道题倒是没啥技术含量，就嗯解方程组。</p>\n<h3 id=\"Code-10\"><a href=\"#Code-10\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> math</span><br><span class=\"line\">N = <span class=\"number\">14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073</span></span><br><span class=\"line\">e1 = <span class=\"number\">12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137</span></span><br><span class=\"line\">e2 = <span class=\"number\">12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697</span></span><br><span class=\"line\">c1 = <span class=\"number\">14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051</span></span><br><span class=\"line\">c2 = <span class=\"number\">14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">q = math.gcd(N, <span class=\"built_in\">pow</span>(c1, e2, N) * <span class=\"built_in\">pow</span>(<span class=\"number\">5</span>, e1 * e2, N) - <span class=\"built_in\">pow</span>(c2, e1, N) * <span class=\"built_in\">pow</span>(<span class=\"number\">2</span>, e1 * e2, N))</span><br><span class=\"line\">p = N // q</span><br><span class=\"line\"><span class=\"built_in\">print</span>(p)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(q)</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"<p>第二章也做完咯~</p>","more":"<p>看到这章的标题就感觉要寄。</p>\n<p>进去一看果然，全是数学。。（数学废物笑不出来</p>\n<p>做了近两天，我只能说数学博大精深，做数学题真的会谢。。</p>\n<p>交完最后一题的 flag 觉得整个人都放松下来了，然后就感觉精疲力尽。</p>\n<p>做的很艰难，尤其 python 用的还是那么不利索。</p>\n<p>由于有些题的代码是通过推导之后直接通过数学定理化简，所以代码很简单。</p>\n<h1 id=\"Modular-Arithmetic\"><a href=\"#Modular-Arithmetic\" class=\"headerlink\" title=\"Modular Arithmetic\"></a>Modular Arithmetic</h1><h2 id=\"Greatest-Common-Divisor\"><a href=\"#Greatest-Common-Divisor\" class=\"headerlink\" title=\"Greatest Common Divisor\"></a>Greatest Common Divisor</h2><h3 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>The Greatest Common Divisor (GCD), sometimes known as the highest common factor, is the largest number which divides two positive integers (a,b).</p>\n<p>For <code>a = 12, b = 8</code> we can calculate the divisors of a: <code>&#123;1,2,3,4,6,12&#125;</code> and the divisors of b: <code>&#123;1,2,4,8&#125;</code>. Comparing these two, we see that <code>gcd(a,b) = 4</code>.</p>\n<p>Now imagine we take <code>a = 11, b = 17</code>. Both <code>a</code> and <code>b</code> are prime numbers. As a prime number has only itself and <code>1</code> as divisors, <code>gcd(a,b) = 1</code>.</p>\n<p>We say that for any two integers <code>a,b</code>, if <code>gcd(a,b) = 1</code> then <code>a</code> and <code>b</code> are coprime integers.</p>\n<p>If <code>a</code> and <code>b</code> are prime, they are also coprime. If <code>a</code> is prime and <code>b &lt; a</code> then <code>a</code> and <code>b</code> are coprime.</p>\n<blockquote>\n<p>Think about the case for <code>a</code> prime and <code>b &gt; a</code>, why are these not necessarily coprime?</p>\n</blockquote>\n<p>There are many tools to calculate the GCD of two integers, but for this task we recommend looking up <a href=\"https://en.wikipedia.org/wiki/Euclidean_algorithm\">Euclid’s Algorithm</a>.</p>\n<p>Try coding it up; it’s only a couple of lines. Use <code>a = 12, b = 8</code> to test it.</p>\n<p>Now calculate <code>gcd(a,b)</code> for <code>a = 66528, b = 52920</code> and enter it below.</p>\n<h3 id=\"Analyze\"><a href=\"#Analyze\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>就是算最大公约数啦，简单写个函数就好咯。</p>\n<p>现在再看这题是真简单啊。</p>\n<h3 id=\"Code\"><a href=\"#Code\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">gcd</span>(<span class=\"params\">a: <span class=\"built_in\">int</span>, b: <span class=\"built_in\">int</span></span>) -&gt; <span class=\"built_in\">int</span>:</span><br><span class=\"line\">    <span class=\"keyword\">while</span> b:</span><br><span class=\"line\">        a, b = b, a % b</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">a = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\">b = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\"><span class=\"built_in\">print</span>(gcd(a, b))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp\"><a href=\"#SumUp\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 欧几里得算法，是 C 语言做过的东西</span></span><br><span class=\"line\"><span class=\"comment\"># function： gcd(a, b)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">gcd</span>(<span class=\"params\">a: <span class=\"built_in\">int</span>, b: <span class=\"built_in\">int</span></span>) -&gt; <span class=\"built_in\">int</span>:</span><br><span class=\"line\">    <span class=\"keyword\">while</span> b:</span><br><span class=\"line\">        a, b = b, a % b</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Extended-GCD\"><a href=\"#Extended-GCD\" class=\"headerlink\" title=\"Extended GCD\"></a>Extended GCD</h2><h3 id=\"Description-1\"><a href=\"#Description-1\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Let <code>a</code> and <code>b</code> be positive integers.</p>\n<p>The extended Euclidean algorithm is an efficient way to find integers <code>u,v</code> such that</p>\n<figure class=\"highlight livecodeserver\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">a</span> * u + b * v = gcd(<span class=\"keyword\">a</span>,b)</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Later, when we learn to decrypt RSA, we will need this algorithm to calculate the modular inverse of the public exponent.</p>\n</blockquote>\n<p>Using the two primes <code>p = 26513, q = 32321</code>, find the integers <code>u,v</code> such that</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p <span class=\"emphasis\">* u + q *</span> v = gcd(p,q)</span><br></pre></td></tr></table></figure>\n\n<p>Enter whichever of <code>u</code> and <code>v</code> is the lower number as the flag.</p>\n<blockquote>\n<p>Knowing that <code>p,q</code> are prime, what would you expect <code>gcd(p,q)</code> to be? For more details on the extended Euclidean algorithm, check out <a href=\"http://www-math.ucdenver.edu/~wcherowi/courses/m5410/exeucalg.html\">this page</a>.</p>\n</blockquote>\n<h3 id=\"Analyze-1\"><a href=\"#Analyze-1\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>用到扩展的欧几里得算法，数学原理和辗转相除大同小异，简单代下数字手推一遍详细过程就知道怎么回事咯。</p>\n<h3 id=\"Code-1\"><a href=\"#Code-1\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">exgcd</span>(<span class=\"params\">a: <span class=\"built_in\">int</span>, b: <span class=\"built_in\">int</span></span>) -&gt; (<span class=\"built_in\">int</span>, <span class=\"built_in\">int</span>, <span class=\"built_in\">int</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> a &lt; b:</span><br><span class=\"line\">        t = a</span><br><span class=\"line\">        a = b</span><br><span class=\"line\">        b = t</span><br><span class=\"line\">    <span class=\"keyword\">if</span> b == <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a, <span class=\"number\">1</span>, <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        g, x, y = exgcd(b, a % b)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> g, y, x - (a // b) * y</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">a = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\">b = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\"><span class=\"built_in\">print</span>(exgcd(a, b))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-1\"><a href=\"#SumUp-1\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 扩展欧几里得，不限制输入的大小顺序</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">exgcd</span>(<span class=\"params\">a: <span class=\"built_in\">int</span>, b: <span class=\"built_in\">int</span></span>) -&gt; (<span class=\"built_in\">int</span>, <span class=\"built_in\">int</span>, <span class=\"built_in\">int</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> a &lt; b:</span><br><span class=\"line\">        t = a</span><br><span class=\"line\">        a = b</span><br><span class=\"line\">        b = t</span><br><span class=\"line\">    <span class=\"keyword\">if</span> b == <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> a, <span class=\"number\">1</span>, <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        g, x, y = exgcd(b, a % b)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> g, y, x - (a // b) * y</span><br><span class=\"line\"><span class=\"comment\"># ax0 + by0 = gcd(a, b)</span></span><br><span class=\"line\"><span class=\"comment\"># 输入 a, b</span></span><br><span class=\"line\"><span class=\"comment\"># 输出 g, x0, y0</span></span><br><span class=\"line\"><span class=\"comment\"># 其中 g = gcd(a, b)</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Modular-Arithmetic-1\"><a href=\"#Modular-Arithmetic-1\" class=\"headerlink\" title=\"Modular Arithmetic 1\"></a>Modular Arithmetic 1</h2><h3 id=\"Description-2\"><a href=\"#Description-2\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Imagine you lean over and look at a cryptographer’s notebook. You see some notes in the margin:</p>\n<figure class=\"highlight basic\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">4 </span>+ <span class=\"number\">9</span> = <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"symbol\">5 </span>- <span class=\"number\">7</span> = <span class=\"number\">10</span></span><br><span class=\"line\"><span class=\"symbol\">2 </span>+ <span class=\"number\">3</span> = <span class=\"number\">5</span></span><br></pre></td></tr></table></figure>\n\n<p>At first you might think they’ve gone mad. Maybe this is why there are so many data leaks nowadays you’d think, but this is nothing more than modular arithmetic modulo 12 (albeit with some sloppy notation).</p>\n<p>You may not have been calling it modular arithmetic, but you’ve been doing these kinds of calculations since you learnt to tell the time (look again at those equations and think about adding hours).</p>\n<p>Formally, “calculating time” is described by the theory of congruences. We say that two integers are congruent modulo m if <code>a ≡ b mod m</code>.</p>\n<p>Another way of saying this, is that when we divide the integer <code>a</code> by <code>m</code>, the remainder is <code>b</code>. This tells you that if m divides a (this can be written as <code>m | a</code>) then <code>a ≡ 0 mod m</code>.</p>\n<p>Calculate the following integers:</p>\n<figure class=\"highlight basic\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">11 </span>≡ x <span class=\"keyword\">mod</span> <span class=\"number\">6</span></span><br><span class=\"line\"><span class=\"symbol\">8146798528947 </span>≡ y <span class=\"keyword\">mod</span> <span class=\"number\">17</span></span><br></pre></td></tr></table></figure>\n\n<p>The solution is the smaller of the two integers.</p>\n<h3 id=\"Analyze-2\"><a href=\"#Analyze-2\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>模运算来了，头大。后面全是和模运算有关的（准确来说这一整章都是</p>\n<p>这道算简单，取余算一下 x 和 y，然后按要求输出小的。没啥好思考的捏。</p>\n<h3 id=\"Code-2\"><a href=\"#Code-2\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">n = <span class=\"number\">8146798528947</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">min</span>(n % <span class=\"number\">17</span>, <span class=\"number\">11</span> % <span class=\"number\">6</span>))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Modular-Arithmetic-2\"><a href=\"#Modular-Arithmetic-2\" class=\"headerlink\" title=\"Modular Arithmetic 2\"></a>Modular Arithmetic 2</h2><h3 id=\"Description-3\"><a href=\"#Description-3\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>We’ll pick up from the last challenge and imagine we’ve picked a modulus <code>p</code>, and we will restrict ourselves to the case when <code>p</code> is prime.</p>\n<p>The integers modulo <code>p</code> define a field, denoted <code>Fp</code>.</p>\n<blockquote>\n<p>If the modulus is not prime, the set of integers modulo <code>n</code> define a ring.</p>\n</blockquote>\n<p>A finite field <code>Fp</code> is the set of integers <code>&#123;0,1,...,p-1&#125;</code>, and under both addition and multiplication there is an inverse element <code>b</code> for every element <code>a</code> in the set, such that <code>a + b = 0</code> and <code>a * b = 1</code>.</p>\n<blockquote>\n<p>Note that the identity element for addition and multiplication is different! This is because the identity when acted with the operator should do nothing: <code>a + 0 = a</code> and <code>a * 1 = a</code>.</p>\n</blockquote>\n<p>Lets say we pick <code>p = 17</code>. Calculate <code>317 mod 17</code>. Now do the same but with <code>517 mod 17</code>.</p>\n<p>What would you expect to get for <code>716 mod 17</code>? Try calculating that.</p>\n<p>This interesting fact is known as Fermat’s little theorem. We’ll be needing this (and its generalisations) when we look at RSA cryptography.</p>\n<p>Now take the prime <code>p = 65537</code>. Calculate <code>27324678765465536 mod 65537</code>.</p>\n<p>Did you need a calculator?</p>\n<h3 id=\"Analyze-3\"><a href=\"#Analyze-3\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>费马小定理，蛮有意思的一个公式。</p>\n<p>$a^{p} \\equiv a \\mod p$，浅浅变形一下：$a^{p-1} \\equiv 1 \\mod p$</p>\n<p>主要题目描述这个定理的时候略微有一点写复杂咯，不够优雅（ bushi。</p>\n<p>这么推导出来其实没有写代码的必要。</p>\n<h3 id=\"Code-3\"><a href=\"#Code-3\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = <span class=\"number\">273246787654</span></span><br><span class=\"line\">p = <span class=\"number\">65537</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"number\">1</span> % p)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># a^(p-1) ≡ 1(mod p)</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Modular-Inverting\"><a href=\"#Modular-Inverting\" class=\"headerlink\" title=\"Modular Inverting\"></a>Modular Inverting</h2><h3 id=\"Description-4\"><a href=\"#Description-4\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>As we’ve seen, we can work within a finite field <code>Fp</code>, adding and multiplying elements, and always obtain another element of the field.</p>\n<p>For all elements <code>g</code> in the field, there exists a unique integer <code>d</code> such that <code>g * d ≡ 1 mod p</code>.</p>\n<p>This is the multiplicative inverse of <code>g</code>.</p>\n<p><strong>Example</strong>: <code>7 * 8 = 56 ≡ 1 mod 11</code></p>\n<p>What is the inverse element: <code>3 * d ≡ 1 mod 13</code>?</p>\n<blockquote>\n<p>Think about the little theorem we just worked with. How does this help you find the inverse of an element?</p>\n</blockquote>\n<h3 id=\"Analyze-4\"><a href=\"#Analyze-4\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>模逆运算，同余这块的知识。主要是欧拉定理和费马小定理的应用。</p>\n<p>欧拉定理：$a^{φ(n)} \\equiv 1 \\mod n$</p>\n<p>费马小定理：$a^{p-1} \\equiv 1 \\mod p$</p>\n<p>对于这道题，有 $3 * d \\equiv 1 \\mod 13$</p>\n<p>因为 gcd(3, 13) &#x3D; 1，所以可以直接得$$d\\ &#x3D;\\ 3^{φ(13)-1}\\ *\\ 1&#x3D;3^{11} \\mod 13$$ </p>\n<p>python 的 pow() 函数真的很好用！</p>\n<h3 id=\"Code-4\"><a href=\"#Code-4\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">d = <span class=\"built_in\">pow</span> (<span class=\"number\">3</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(d)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-2\"><a href=\"#SumUp-2\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><p>$φ(n)$ 即 <code>1 ~ (n-1)</code> 范围内与 n 互素的数的个数，若 n 本身为素数，则 $φ(n)&#x3D;n-1$ 。</p>\n<h2 id=\"Quadratic-Residues\"><a href=\"#Quadratic-Residues\" class=\"headerlink\" title=\"Quadratic Residues\"></a>Quadratic Residues</h2><h3 id=\"Description-5\"><a href=\"#Description-5\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>We’ve looked at multiplication and division in modular arithmetic, but what does it mean to take the square root modulo an integer?</p>\n<p>For the following discussion, let’s work modulo <code>p = 29</code>. We can take the integer <code>a = 11</code> and calculate <code>a² = 5 mod 29</code>.</p>\n<p>As <code>a = 11, a² = 5</code>, we say the square root of <code>5</code> is <code>11</code>.</p>\n<p>This feels good, but now let’s think about the square root of <code>18</code>. From the above, we know we need to find some integer <code>a</code> such that <code>a² = 18</code></p>\n<p>Your first idea might be to start with <code>a = 1</code> and loop to <code>a = p-1</code>. In this discussion <code>p</code> isn’t too large and we can quickly look.</p>\n<p>Have a go, try coding this and see what you find. If you’ve coded it right, you’ll find that for all <code>a ∈ Fp*</code> you never find an <code>a</code> such that <code>a² = 18</code>.</p>\n<p>What we are seeing, is that for the elements of <code>F*p</code>, not every element has a square root. In fact, what we find is that for roughly one half of the elements of <code>Fp*</code>, there is no square root.</p>\n<blockquote>\n<p>We say that an integer <code>x</code> is a <em>Quadratic Residue</em> if there exists an <code>a</code> such that <code>a² = x mod p</code>. If there is no such solution, then the integer is a <em>Quadratic Non-Residue</em>.</p>\n</blockquote>\n<p>In other words, <code>x</code> is a quadratic residue when it is possible to take the square root of <code>x</code> modulo an integer <code>p</code>.</p>\n<p>In the below list there are two non-quadratic residues and one quadratic residue.</p>\n<p>Find the quadratic residue and then calculate its square root. Of the two possible roots, submit the smaller one as the flag.</p>\n<blockquote>\n<p>If <code>a² = x</code> then (-a)² &#x3D; x. So if <code>x</code> is a quadratic residue in some finite field, then there are always two solutions for <code>a</code>.</p>\n</blockquote>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">p</span> = <span class=\"number\">29</span></span><br><span class=\"line\"><span class=\"attr\">ints</span> = [<span class=\"number\">14</span>, <span class=\"number\">6</span>, <span class=\"number\">11</span>]</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Analyze-5\"><a href=\"#Analyze-5\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>Legendre 符号（欧拉判别法）的内容，二次剩余。</p>\n<p>定义：如果 $a^2 \\equiv x \\mod p$ 有解，则 x 是模 p 的二次剩余，否则称为二次非剩余,。</p>\n<p>Given: p, x[]</p>\n<p>Asked: 找出二次剩余，并求出平方根。</p>\n<p>遍历 x in range(1, p)，计算 x 的平方模 p，并与 ints[] 中的元素进行比较，找出模 p 的二次剩余，此时的 x 即为该二次剩余的平方根。</p>\n<p>公式和题里的 a 和 x 参数真的很容易弄混，理了半天才理清楚 。。</p>\n<h3 id=\"Code-5\"><a href=\"#Code-5\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = <span class=\"number\">29</span></span><br><span class=\"line\">ints = [<span class=\"number\">14</span>, <span class=\"number\">6</span>, <span class=\"number\">11</span>]</span><br><span class=\"line\">flag = <span class=\"built_in\">min</span>(x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, p) <span class=\"keyword\">if</span> <span class=\"built_in\">pow</span>(x, <span class=\"number\">2</span>, p) <span class=\"keyword\">in</span> ints)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(flag)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Legendre-Symbol\"><a href=\"#Legendre-Symbol\" class=\"headerlink\" title=\"Legendre Symbol\"></a>Legendre Symbol</h2><h3 id=\"Description-6\"><a href=\"#Description-6\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>In Quadratic Residues we learnt what it means to take the square root modulo an integer. We also saw that taking a root isn’t always possible.</p>\n<p>In the previous case when <code>p = 29</code>, even the simplest method of calculating the square root was fast enough, but as <code>p</code> gets larger, this method becomes wildly unreasonable.</p>\n<p>Lucky for us, we have a way to check whether an integer is a quadratic residue with a single calculation thanks to Legendre. In the following, we will assume we are working modulo a prime <code>p</code>.</p>\n<p>Before looking at Legendre’s symbol, let’s take a brief detour to see an interesting property of quadratic (non-)residues.</p>\n<figure class=\"highlight mathematica\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">Quadratic</span> <span class=\"built_in\">Residue</span> <span class=\"operator\">*</span> <span class=\"variable\">Quadratic</span> <span class=\"built_in\">Residue</span> <span class=\"operator\">=</span> <span class=\"variable\">Quadratic</span> <span class=\"built_in\">Residue</span></span><br><span class=\"line\"><span class=\"variable\">Quadratic</span> <span class=\"built_in\">Residue</span> <span class=\"operator\">*</span> <span class=\"variable\">Quadratic</span> <span class=\"variable\">Non</span><span class=\"operator\">-</span><span class=\"variable\">residue</span> <span class=\"operator\">=</span> <span class=\"variable\">Quadratic</span> <span class=\"variable\">Non</span><span class=\"operator\">-</span><span class=\"variable\">residue</span></span><br><span class=\"line\"><span class=\"variable\">Quadratic</span> <span class=\"variable\">Non</span><span class=\"operator\">-</span><span class=\"variable\">residue</span> <span class=\"operator\">*</span> <span class=\"variable\">Quadratic</span> <span class=\"variable\">Non</span><span class=\"operator\">-</span><span class=\"variable\">residue</span> <span class=\"operator\">=</span> <span class=\"variable\">Quadratic</span> <span class=\"built_in\">Residue</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Want an easy way to remember this? Replace “Quadratic Residue” with <code>+1</code> and “Quadratic Non-residue” with <code>-1</code>, all three results are the same!</p>\n</blockquote>\n<p>So what’s the trick? The <a href=\"https://en.wikipedia.org/wiki/Legendre_symbol\">Legendre Symbol</a> gives an efficient way to determine whether an integer is a quadratic residue modulo an odd prime <code>p</code>.</p>\n<p>Legendre’s Symbol: <code>(a / p) ≡ a(p-1)/2 mod p</code> obeys:</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"selector-tag\">a</span> / p) = <span class=\"number\">1</span> <span class=\"keyword\">if</span> <span class=\"selector-tag\">a</span> is <span class=\"selector-tag\">a</span> quadratic residue and <span class=\"selector-tag\">a</span> ≢ <span class=\"number\">0</span> mod <span class=\"selector-tag\">p</span></span><br><span class=\"line\">(<span class=\"selector-tag\">a</span> / p) = -<span class=\"number\">1</span> <span class=\"keyword\">if</span> <span class=\"selector-tag\">a</span> is <span class=\"selector-tag\">a</span> quadratic non-residue mod <span class=\"selector-tag\">p</span></span><br><span class=\"line\">(<span class=\"selector-tag\">a</span> / p) = <span class=\"number\">0</span> <span class=\"keyword\">if</span> <span class=\"selector-tag\">a</span> ≡ <span class=\"number\">0</span> mod p</span><br></pre></td></tr></table></figure>\n\n<p>Which means given any integer <code>a</code>, calculating <code>pow(a,(p-1)/2,p)</code> is enough to determine if <code>a</code> is a quadratic residue.</p>\n<p>Now for the flag. Given the following 1024 bit prime and 10 integers, find the quadratic residue and then calculate its square root; the square root is your flag. Of the two possible roots, submit the larger one as your answer.</p>\n<blockquote>\n<p>So Legendre’s symbol tells us which integer is a quadratic residue, but how do we find the square root?! The prime supplied obeys <code>p = 3 mod 4</code>, which allows us easily compute the square root. The answer is online, but you can figure it out yourself if you think about Fermat’s little theorem.</p>\n</blockquote>\n<h3 id=\"Analyze-6\"><a href=\"#Analyze-6\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>Legendre 符号的欧拉判别法。</p>\n<p>$$\\left(\\frac{a}{p}\\right)&#x3D;\\begin{cases}1, &amp;a ≢ 0 \\mod p\\text{ 且 }a\\text{ 是模 }p\\text{ 的二次剩余} \\\\ -1, &amp;a ≢ 0 \\mod p\\text{ 且 }a\\text{ 是模 }p\\text{ 的二次非剩余} \\\\ 0, &amp;a ≡0 \\mod p \\end{cases}$$</p>\n<p>欧拉判别法内容：$(a&#x2F;p) \\equiv a^{(p-1)&#x2F;2} \\mod p$。</p>\n<p>遍历 ints 判断各自对应的 $(a&#x2F;p)$ 是否等于 1，得到二次剩余 a 之后计算平方根 $a^{(p+1)&#x2F;4} \\mod p$ 。</p>\n<h3 id=\"Code-6\"><a href=\"#Code-6\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = <span class=\"number\">101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139</span></span><br><span class=\"line\">ints = [<span class=\"number\">25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803</span>, <span class=\"number\">45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555</span>, <span class=\"number\">17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325</span>, <span class=\"number\">14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863</span>, <span class=\"number\">4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318</span>, <span class=\"number\">85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771</span>, <span class=\"number\">50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987</span>, <span class=\"number\">96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871</span>, <span class=\"number\">4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721</span>, <span class=\"number\">18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">res = [x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> ints <span class=\"keyword\">if</span> <span class=\"built_in\">pow</span>(x, (p-<span class=\"number\">1</span>)//<span class=\"number\">2</span>, p) == <span class=\"number\">1</span>][<span class=\"number\">0</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">pow</span>(res, (p + <span class=\"number\">1</span>)//<span class=\"number\">4</span>, p))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Modular-Square-Root\"><a href=\"#Modular-Square-Root\" class=\"headerlink\" title=\"Modular Square Root\"></a>Modular Square Root</h2><h3 id=\"Description-7\"><a href=\"#Description-7\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>In Legendre Symbol we introduced a fast way to determine whether a number is a square root modulo a prime. We can go further: there are algorithms for efficiently calculating such roots. The best one in practice is called Tonelli-Shanks, which gets its funny name from the fact that it was first described by an Italian in the 19th century and rediscovered independently by Daniel Shanks in the 1970s.</p>\n<p>All primes that aren’t 2 are of the form <code>p ≡ 1 mod 4</code> or <code>p ≡ 3 mod 4</code>, since all odd numbers obey these congruences. As the previous challenge hinted, in the <code>p ≡ 3 mod 4</code> case, a really simple formula for computing square roots can be <a href=\"https://crypto.stackexchange.com/a/20994\">derived</a> directly from Fermat’s little theorem. That leaves us still with the <code>p ≡ 1 mod 4</code> case, so a more general algorithm is required.</p>\n<p>In a congruence of the form <code>r² ≡ a mod p</code>, Tonelli-Shanks calculates <code>r</code>.</p>\n<blockquote>\n<p>Tonelli-Shanks doesn’t work for composite (non-prime) moduli. Finding square roots modulo composites is computationally equivalent to integer factorization.</p>\n</blockquote>\n<p>The main use-case for this algorithm is finding elliptic curve co-ordinates. Its operation is somewhat complex so we’re not going to discuss the details, however, implementations are easy to find and Sage has one built-in.</p>\n<p>Find the square root of <code>a</code> modulo the 2048-bit prime <code>p</code>. Give the smaller of the two roots as your answer.</p>\n<h3 id=\"Analyze-7\"><a href=\"#Analyze-7\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>sympy 模块内有封装好的函数可以计算二次剩余。</p>\n<p>函数 nthroot_mod(a, n, p) 用于求解于 $x^{n} \\equiv a\\ mod\\ p$ 的同余式。</p>\n<p>题目给了表达式 $r^2 \\equiv a\\ mod\\ p$，求 r。</p>\n<p>写了半天函数心态爆炸，然后搜了下 python 相关的库，几行就解决。</p>\n<p>再次感叹，python 真是个好东西。</p>\n<h3 id=\"Code-7\"><a href=\"#Code-7\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> sympy</span><br><span class=\"line\">a = <span class=\"number\">8479994658316772151941616510097127087554541274812435112009425778595495359700244470400642403747058566807127814165396640215844192327900454116257979487432016769329970767046735091249898678088061634796559556704959846424131820416048436501387617211770124292793308079214153179977624440438616958575058361193975686620046439877308339989295604537867493683872778843921771307305602776398786978353866231661453376056771972069776398999013769588936194859344941268223184197231368887060609212875507518936172060702209557124430477137421847130682601666968691651447236917018634902407704797328509461854842432015009878011354022108661461024768</span></span><br><span class=\"line\">p = <span class=\"number\">30531851861994333252675935111487950694414332763909083514133769861350960895076504687261369815735742549428789138300843082086550059082835141454526618160634109969195486322015775943030060449557090064811940139431735209185996454739163555910726493597222646855506445602953689527405362207926990442391705014604777038685880527537489845359101552442292804398472642356609304810680731556542002301547846635101455995732584071355903010856718680732337369128498655255277003643669031694516851390505923416710601212618443109844041514942401969629158975457079026906304328749039997262960301209158175920051890620947063936347307238412281568760161</span></span><br><span class=\"line\">r = sympy.nthroot_mod(a, <span class=\"number\">2</span>, p)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(r)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-3\"><a href=\"#SumUp-3\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><p>$x^{n} \\equiv a\\ mod\\ p$，求 x</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># function:</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> sympy.ntheory.residue_ntheory <span class=\"keyword\">import</span> nthroot_mod</span><br><span class=\"line\">x = nthroot_mod(a, n, p)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Chinese-Remainder-Theorem\"><a href=\"#Chinese-Remainder-Theorem\" class=\"headerlink\" title=\"Chinese Remainder Theorem\"></a>Chinese Remainder Theorem</h2><h3 id=\"Description-8\"><a href=\"#Description-8\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>The Chinese Remainder Theorem gives a unique solution to a set of linear congruences if their moduli are coprime.</p>\n<p>This means, that given a set of arbitrary integers <code>ai</code>, and pairwise coprime integers <code>ni</code>, such that the following linear congruences hold:</p>\n<blockquote>\n<p>Note “pairwise coprime integers” means that if we have a set of integers <code>&#123;n1, n2, ..., ni&#125;</code>, all pairs of integers selected from the set are coprime: <code>gcd(ni, nj) = 1</code>.</p>\n</blockquote>\n<figure class=\"highlight livecodeserver\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x ≡ a1 <span class=\"keyword\">mod</span> n1</span><br><span class=\"line\">x ≡ a2 <span class=\"keyword\">mod</span> n2</span><br><span class=\"line\">...</span><br><span class=\"line\">x ≡ <span class=\"keyword\">an</span> <span class=\"keyword\">mod</span> nn</span><br></pre></td></tr></table></figure>\n\n<p>There is a unique solution <code>x ≡ a mod N</code> where <code>N = n1 * n2 * ... * nn</code>.</p>\n<p>In cryptography, we commonly use the Chinese Remainder Theorem to help us reduce a problem of very large integers into a set of several, easier problems.</p>\n<p>Given the following set of linear congruences:</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">x</span> ≡ <span class=\"number\">2</span> mod <span class=\"number\">5</span></span><br><span class=\"line\"><span class=\"attribute\">x</span> ≡ <span class=\"number\">3</span> mod <span class=\"number\">11</span></span><br><span class=\"line\"><span class=\"attribute\">x</span> ≡ <span class=\"number\">5</span> mod <span class=\"number\">17</span></span><br></pre></td></tr></table></figure>\n\n<p>Find the integer <code>a</code> such that <code>x ≡ a mod 935</code></p>\n<blockquote>\n<p>Starting with the congruence with the largest modulus, use that for <code>x ≡ a mod p</code> we can write <code>x = a + k*p</code> for arbitrary integer <code>k</code>.</p>\n</blockquote>\n<h3 id=\"Analyze-8\"><a href=\"#Analyze-8\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>中国剩余定理，也叫孙子定理。主要针对同余方程组的求解问题。</p>\n<p>YouTube 上找了个视频看了原理，跟着视频手算出来了结果，感觉跟着例题一步步算真的能加深理解诶，很容易就理解到了原理和用法。</p>\n<p><img src=\"https://img.hawa130.com/%E6%B1%82%E8%A7%A3%E8%BF%87%E7%A8%8B.jpg\" alt=\"求解过程\"></p>\n<p>算法直接找了个板子，偷个懒捏。</p>\n<h3 id=\"Code-8\"><a href=\"#Code-8\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> functools <span class=\"keyword\">import</span> reduce</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">chinese_remainder</span>(<span class=\"params\">n, a</span>):</span><br><span class=\"line\">    <span class=\"built_in\">sum</span> = <span class=\"number\">0</span></span><br><span class=\"line\">    prod = reduce(<span class=\"keyword\">lambda</span> a, b: a * b, n)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> n_i, a_i <span class=\"keyword\">in</span> <span class=\"built_in\">zip</span>(n, a):</span><br><span class=\"line\">        p = prod // n_i</span><br><span class=\"line\">        <span class=\"built_in\">sum</span> += a_i * mul_inv(p, n_i) * p</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">sum</span> % prod</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">mul_inv</span>(<span class=\"params\">a, b</span>):</span><br><span class=\"line\">    b0 = b</span><br><span class=\"line\">    x0, x1 = <span class=\"number\">0</span>, <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> b == <span class=\"number\">1</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> a &gt; <span class=\"number\">1</span>:</span><br><span class=\"line\">        q = a // b</span><br><span class=\"line\">        a, b = b, a % b</span><br><span class=\"line\">        x0, x1 = x1 - q * x0, x0</span><br><span class=\"line\">    <span class=\"keyword\">if</span> x1 &lt; <span class=\"number\">0</span>:</span><br><span class=\"line\">        x1 += b0</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x1</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">n = [<span class=\"number\">5</span>, <span class=\"number\">11</span>, <span class=\"number\">17</span>]</span><br><span class=\"line\">a = [<span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(chinese_remainder(n, a))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Adrien’s-Signs\"><a href=\"#Adrien’s-Signs\" class=\"headerlink\" title=\"Adrien’s Signs\"></a>Adrien’s Signs</h2><h3 id=\"Description-9\"><a href=\"#Description-9\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Adrien’s been looking at ways to encrypt his messages with the help of symbols and minus signs. Can you find a way to recover the flag?</p>\n<h3 id=\"Analyze-9\"><a href=\"#Analyze-9\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>python 学得不好，加密函数理解了好久。</p>\n<p>解密倒还好，拿到密文直接正常取对数，取不到就负数取余把 n 还原回去再取对数。</p>\n<p>不过代码得跑一会才能出结果，后面或许可以再看看有没有更优解。</p>\n<p>（最后一行的代码简直写得太优雅咯</p>\n<h3 id=\"Code-9\"><a href=\"#Code-9\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> numpy <span class=\"keyword\">import</span> arange</span><br><span class=\"line\"><span class=\"keyword\">from</span> sympy <span class=\"keyword\">import</span> discrete_log</span><br><span class=\"line\"></span><br><span class=\"line\">lis = [<span class=\"number\">67594220461269</span>, <span class=\"number\">501237540280788</span>, <span class=\"number\">718316769824518</span>, <span class=\"number\">296304224247167</span>, <span class=\"number\">48290626940198</span>, <span class=\"number\">30829701196032</span>, <span class=\"number\">521453693392074</span>, <span class=\"number\">840985324383794</span>, <span class=\"number\">770420008897119</span>, <span class=\"number\">745131486581197</span>, <span class=\"number\">729163531979577</span>, <span class=\"number\">334563813238599</span>, <span class=\"number\">289746215495432</span>, <span class=\"number\">538664937794468</span>, <span class=\"number\">894085795317163</span>, <span class=\"number\">983410189487558</span>, <span class=\"number\">863330928724430</span>, <span class=\"number\">996272871140947</span>, <span class=\"number\">352175210511707</span>, <span class=\"number\">306237700811584</span>, <span class=\"number\">631393408838583</span>, <span class=\"number\">589243747914057</span>, <span class=\"number\">538776819034934</span>, <span class=\"number\">365364592128161</span>, <span class=\"number\">454970171810424</span>, <span class=\"number\">986711310037393</span>, <span class=\"number\">657756453404881</span>, <span class=\"number\">388329936724352</span>, <span class=\"number\">90991447679370</span>, <span class=\"number\">714742162831112</span>, <span class=\"number\">62293519842555</span>, <span class=\"number\">653941126489711</span>, <span class=\"number\">448552658212336</span>, <span class=\"number\">970169071154259</span>, <span class=\"number\">339472870407614</span>, <span class=\"number\">406225588145372</span>, <span class=\"number\">205721593331090</span>, <span class=\"number\">926225022409823</span>, <span class=\"number\">904451547059845</span>, <span class=\"number\">789074084078342</span>, <span class=\"number\">886420071481685</span>, <span class=\"number\">796827329208633</span>, <span class=\"number\">433047156347276</span>, <span class=\"number\">21271315846750</span>, <span class=\"number\">719248860593631</span>, <span class=\"number\">534059295222748</span>, <span class=\"number\">879864647580512</span>, <span class=\"number\">918055794962142</span>, <span class=\"number\">635545050939893</span>, <span class=\"number\">319549343320339</span>, <span class=\"number\">93008646178282</span>, <span class=\"number\">926080110625306</span>, <span class=\"number\">385476640825005</span>, <span class=\"number\">483740420173050</span>, <span class=\"number\">866208659796189</span>, <span class=\"number\">883359067574584</span>, <span class=\"number\">913405110264883</span>, <span class=\"number\">898864873510337</span>, <span class=\"number\">208598541987988</span>, <span class=\"number\">23412800024088</span>, <span class=\"number\">911541450703474</span>, <span class=\"number\">57446699305445</span>, <span class=\"number\">513296484586451</span>, <span class=\"number\">180356843554043</span>, <span class=\"number\">756391301483653</span>, <span class=\"number\">823695939808936</span>, <span class=\"number\">452898981558365</span>, <span class=\"number\">383286682802447</span>, <span class=\"number\">381394258915860</span>, <span class=\"number\">385482809649632</span>, <span class=\"number\">357950424436020</span>, <span class=\"number\">212891024562585</span>, <span class=\"number\">906036654538589</span>, <span class=\"number\">706766032862393</span>, <span class=\"number\">500658491083279</span>, <span class=\"number\">134746243085697</span>, <span class=\"number\">240386541491998</span>, <span class=\"number\">850341345692155</span>, <span class=\"number\">826490944132718</span>, <span class=\"number\">329513332018620</span>, <span class=\"number\">41046816597282</span>, <span class=\"number\">396581286424992</span>, <span class=\"number\">488863267297267</span>, <span class=\"number\">92023040998362</span>, <span class=\"number\">529684488438507</span>, <span class=\"number\">925328511390026</span>, <span class=\"number\">524897846090435</span>, <span class=\"number\">413156582909097</span>, <span class=\"number\">840524616502482</span>, <span class=\"number\">325719016994120</span>, <span class=\"number\">402494835113608</span>, <span class=\"number\">145033960690364</span>, <span class=\"number\">43932113323388</span>, <span class=\"number\">683561775499473</span>, <span class=\"number\">434510534220939</span>, <span class=\"number\">92584300328516</span>, <span class=\"number\">763767269974656</span>, <span class=\"number\">289837041593468</span>, <span class=\"number\">11468527450938</span>, <span class=\"number\">628247946152943</span>, <span class=\"number\">8844724571683</span>, <span class=\"number\">813851806959975</span>, <span class=\"number\">72001988637120</span>, <span class=\"number\">875394575395153</span>, <span class=\"number\">70667866716476</span>, <span class=\"number\">75304931994100</span>, <span class=\"number\">226809172374264</span>, <span class=\"number\">767059176444181</span>, <span class=\"number\">45462007920789</span>, <span class=\"number\">472607315695803</span>, <span class=\"number\">325973946551448</span>, <span class=\"number\">64200767729194</span>, <span class=\"number\">534886246409921</span>, <span class=\"number\">950408390792175</span>, <span class=\"number\">492288777130394</span>, <span class=\"number\">226746605380806</span>, <span class=\"number\">944479111810431</span>, <span class=\"number\">776057001143579</span>, <span class=\"number\">658971626589122</span>, <span class=\"number\">231918349590349</span>, <span class=\"number\">699710172246548</span>, <span class=\"number\">122457405264610</span>, <span class=\"number\">643115611310737</span>, <span class=\"number\">999072890586878</span>, <span class=\"number\">203230862786955</span>, <span class=\"number\">348112034218733</span>, <span class=\"number\">240143417330886</span>, <span class=\"number\">927148962961842</span>, <span class=\"number\">661569511006072</span>, <span class=\"number\">190334725550806</span>, <span class=\"number\">763365444730995</span>, <span class=\"number\">516228913786395</span>, <span class=\"number\">846501182194443</span>, <span class=\"number\">741210200995504</span>, <span class=\"number\">511935604454925</span>, <span class=\"number\">687689993302203</span>, <span class=\"number\">631038090127480</span>, <span class=\"number\">961606522916414</span>, <span class=\"number\">138550017953034</span>, <span class=\"number\">932105540686829</span>, <span class=\"number\">215285284639233</span>, <span class=\"number\">772628158955819</span>, <span class=\"number\">496858298527292</span>, <span class=\"number\">730971468815108</span>, <span class=\"number\">896733219370353</span>, <span class=\"number\">967083685727881</span>, <span class=\"number\">607660822695530</span>, <span class=\"number\">650953466617730</span>, <span class=\"number\">133773994258132</span>, <span class=\"number\">623283311953090</span>, <span class=\"number\">436380836970128</span>, <span class=\"number\">237114930094468</span>, <span class=\"number\">115451711811481</span>, <span class=\"number\">674593269112948</span>, <span class=\"number\">140400921371770</span>, <span class=\"number\">659335660634071</span>, <span class=\"number\">536749311958781</span>, <span class=\"number\">854645598266824</span>, <span class=\"number\">303305169095255</span>, <span class=\"number\">91430489108219</span>, <span class=\"number\">573739385205188</span>, <span class=\"number\">400604977158702</span>, <span class=\"number\">728593782212529</span>, <span class=\"number\">807432219147040</span>, <span class=\"number\">893541884126828</span>, <span class=\"number\">183964371201281</span>, <span class=\"number\">422680633277230</span>, <span class=\"number\">218817645778789</span>, <span class=\"number\">313025293025224</span>, <span class=\"number\">657253930848472</span>, <span class=\"number\">747562211812373</span>, <span class=\"number\">83456701182914</span>, <span class=\"number\">470417289614736</span>, <span class=\"number\">641146659305859</span>, <span class=\"number\">468130225316006</span>, <span class=\"number\">46960547227850</span>, <span class=\"number\">875638267674897</span>, <span class=\"number\">662661765336441</span>, <span class=\"number\">186533085001285</span>, <span class=\"number\">743250648436106</span>, <span class=\"number\">451414956181714</span>, <span class=\"number\">527954145201673</span>, <span class=\"number\">922589993405001</span>, <span class=\"number\">242119479617901</span>, <span class=\"number\">865476357142231</span>, <span class=\"number\">988987578447349</span>, <span class=\"number\">430198555146088</span>, <span class=\"number\">477890180119931</span>, <span class=\"number\">844464003254807</span>, <span class=\"number\">503374203275928</span>, <span class=\"number\">775374254241792</span>, <span class=\"number\">346653210679737</span>, <span class=\"number\">789242808338116</span>, <span class=\"number\">48503976498612</span>, <span class=\"number\">604300186163323</span>, <span class=\"number\">475930096252359</span>, <span class=\"number\">860836853339514</span>, <span class=\"number\">994513691290102</span>, <span class=\"number\">591343659366796</span>, <span class=\"number\">944852018048514</span>, <span class=\"number\">82396968629164</span>, <span class=\"number\">152776642436549</span>, <span class=\"number\">916070996204621</span>, <span class=\"number\">305574094667054</span>, <span class=\"number\">981194179562189</span>, <span class=\"number\">126174175810273</span>, <span class=\"number\">55636640522694</span>, <span class=\"number\">44670495393401</span>, <span class=\"number\">74724541586529</span>, <span class=\"number\">988608465654705</span>, <span class=\"number\">870533906709633</span>, <span class=\"number\">374564052429787</span>, <span class=\"number\">486493568142979</span>, <span class=\"number\">469485372072295</span>, <span class=\"number\">221153171135022</span>, <span class=\"number\">289713227465073</span>, <span class=\"number\">952450431038075</span>, <span class=\"number\">107298466441025</span>, <span class=\"number\">938262809228861</span>, <span class=\"number\">253919870663003</span>, <span class=\"number\">835790485199226</span>, <span class=\"number\">655456538877798</span>, <span class=\"number\">595464842927075</span>, <span class=\"number\">191621819564547</span>]</span><br><span class=\"line\">a = <span class=\"number\">288260533169915</span></span><br><span class=\"line\">p = <span class=\"number\">1007621497415251</span></span><br><span class=\"line\">decode = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> arange(<span class=\"built_in\">len</span>(lis)):</span><br><span class=\"line\">    cipher = lis[i]</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        r = discrete_log(p, cipher, a)</span><br><span class=\"line\">        decode += <span class=\"string\">&#x27;1&#x27;</span></span><br><span class=\"line\">    <span class=\"keyword\">except</span>:</span><br><span class=\"line\">        r = discrete_log(p, -cipher % p, a)</span><br><span class=\"line\">        decode += <span class=\"string\">&#x27;0&#x27;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;&#x27;</span>.join([<span class=\"built_in\">chr</span>(<span class=\"built_in\">int</span>(decode[i:i+<span class=\"number\">8</span>], <span class=\"number\">2</span>)) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(decode), <span class=\"number\">8</span>)]))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Modular-Binomials\"><a href=\"#Modular-Binomials\" class=\"headerlink\" title=\"Modular Binomials\"></a>Modular Binomials</h2><h3 id=\"Description-10\"><a href=\"#Description-10\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Rearrange the following equations to get <code>p,q</code></p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">N</span> = p*q</span><br><span class=\"line\"><span class=\"attr\">c1</span> = (<span class=\"number\">2</span>*p + <span class=\"number\">3</span>*q)**e1 mod N</span><br><span class=\"line\"><span class=\"attr\">c2</span> = (<span class=\"number\">5</span>*p + <span class=\"number\">7</span>*q)**e2 mod N</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Analyze-10\"><a href=\"#Analyze-10\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>给了五个参数，求两个未知数 p 和 q，一眼看到给了 p，q 的乘积 N，所以只要随便求出来其中一个然后除 N 就可以咯。</p>\n<p>我是先求了 q，所以先把两个方程右边配成齐次的，然后把要消掉的 p 的系数配成一样的，q 的系数刚好是 15 和 14，相减就是 q 咯。</p>\n<p>最后一道题倒是没啥技术含量，就嗯解方程组。</p>\n<h3 id=\"Code-10\"><a href=\"#Code-10\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> math</span><br><span class=\"line\">N = <span class=\"number\">14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073</span></span><br><span class=\"line\">e1 = <span class=\"number\">12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137</span></span><br><span class=\"line\">e2 = <span class=\"number\">12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697</span></span><br><span class=\"line\">c1 = <span class=\"number\">14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051</span></span><br><span class=\"line\">c2 = <span class=\"number\">14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">q = math.gcd(N, <span class=\"built_in\">pow</span>(c1, e2, N) * <span class=\"built_in\">pow</span>(<span class=\"number\">5</span>, e1 * e2, N) - <span class=\"built_in\">pow</span>(c2, e1, N) * <span class=\"built_in\">pow</span>(<span class=\"number\">2</span>, e1 * e2, N))</span><br><span class=\"line\">p = N // q</span><br><span class=\"line\"><span class=\"built_in\">print</span>(p)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(q)</span><br></pre></td></tr></table></figure>"},{"title":"Symmetric Cryptography_How AES Works","date":"2022-05-05T15:42:00.000Z","mathjax":true,"_content":"\n第三章好像是做的最迷的\n\n<!--more-->\n\n虽然只需要做 ”How AES Works” 部分。但是——\n\n刚开始第三章：还以为会越来越难，没想到做完数论就柳暗花明了？\n\n第三章最后一题：什么东西啊这是，这怎么比数论那块还复杂。。\n\n# Symmetric Cryptography_How AES Works\n\n## Keyed Permutations\n\n### Description\n\nAES, like all good block ciphers, performs a \"keyed permutation\". This means that it maps every possible input block to a unique output block, with a key determining which permutation to perform.\n\n> A \"block\" just refers to a fixed number of bits or bytes, which may represent any kind of data. AES processes a block and outputs another block. We'll be specifically talking the variant of AES which works on 128 bit (16 byte) blocks and a 128 bit key, known as AES-128.\n\nUsing the same key, the permutation can be performed in reverse, mapping the output block back to the original input block. It is important that there is a one-to-one correspondence between input and output blocks, otherwise we wouldn't be able to rely on the ciphertext to decrypt back to the same plaintext we started with.\n\nWhat is the mathematical term for a one-to-one correspondence?\n\n###  Analyze\n\n喔这题简单，我不知道但 Google 知道，浅搜一下”一一对应的数学术语“，知道叫双射函数，浅浅上个百科，就知道英语咯。\n\n## Resisting Bruteforce\n\n### Description\n\nIf a block cipher is secure, there should be no way for an attacker to distinguish the output of AES from a [random permutation](https://en.wikipedia.org/wiki/Pseudorandom_permutation) of bits. Furthermore, there should be no better way to undo the permutation than simply bruteforcing every possible key. That's why academics consider a cipher theoretically \"broken\" if they can find an attack that takes fewer steps to perform than bruteforcing the key, even if that attack is practically infeasible.\n\n> How difficult is it to bruteforce a 128-bit keyspace? [Somebody estimated](https://crypto.stackexchange.com/a/48669) that if you turned the power of the entire Bitcoin mining network against an AES-128 key, it would take over a hundred times the age of the universe to crack the key.\n\nIt turns out that there is [an attack](https://en.wikipedia.org/wiki/Biclique_attack) on AES that's better than bruteforce, but only slightly – it lowers the security level of AES-128 down to 126.1 bits, and hasn't been improved on for over 8 years. Given the large \"security margin\" provided by 128 bits, and the lack of improvements despite extensive study, it's not considered a credible risk to the security of AES. But yes, in a very narrow sense, it \"breaks\" AES.\n\nFinally, while quantum computers have the potential to completely break popular public-key cryptosystems like RSA via [Shor's algorithm](https://en.wikipedia.org/wiki/Shor's_algorithm), they are thought to only cut in half the security level of symmetric cryptosystems via [Grover's algorithm](https://en.wikipedia.org/wiki/Grover's_algorithm). This is one reason why people recommend using AES-256, despite it being less performant, as it would still provide a very adequate 128 bits of security in a quantum future.\n\nWhat is the name for the best single-key attack against AES?\n\n###  Analyze\n\n虽然但是，依然去查了 Google，靠谱！\n\n不过发现网上搜 biclique 的结果居然不是很多，我打开方式有问题吗是，后面再看看。\n\n## Structure of AES\n\n### Description\n\nTo achieve a keyed permutation that is infeasible to invert without the key, AES applies a large number of ad-hoc mixing operations on the input. This is in stark contrast to public-key cryptosystems like RSA, which are based on elegant individual mathematical problems. AES is much less elegant, but it's very fast.\n\nAt a high level, AES-128 begins with a \"key schedule\" and then runs 10 rounds over a state. The starting state is just the plaintext block that we want to encrypt, represented as a 4x4 matrix of bytes. Over the course of the 10 rounds, the state is repeatedly modified by a number of invertible transformations.\n\n> Each transformation step has a defined purpose based on theoretical properties of secure ciphers established by Claude Shannon in the 1940s. We'll look closer at each of these in the following challenges.\n\nHere's an overview of the phases of AES encryption:\n\n![diagram showing AES rounds](https://cryptohack.org/static/img/aes/Structure.png)\n\n1. **KeyExpansion** or Key Schedule\n\n From the 128 bit key, 11 separate 128 bit \"round keys\" are derived: one to be used in each AddRoundKey step.\n\n2. **Initial key addition**\n\n *AddRoundKey* - the bytes of the first round key are XOR'd with the bytes of the state.\n\n3. **Round** - this phase is looped 10 times, for 9 main rounds plus one \"final round\"\n\n \ta) *SubBytes* - each byte of the state is substituted for a different byte according to a lookup table (\"S-box\").\n\n​\t b) *ShiftRows* - the last three rows of the state matrix are transposed—shifted over a column or two or three.\n\n​\t c) *MixColumns* - matrix multiplication is performed on the columns of the state, combining the four bytes in each column. This is skipped in the final round.\n\n​\t d) *AddRoundKey* - the bytes of the current round key are XOR'd with the bytes of the state.\n\nIncluded is a `bytes2matrix` function for converting our initial plaintext block into a state matrix. Write a `matrix2bytes` function to turn that matrix back into bytes, and submit the resulting plaintext as the flag.\n\n###  Analyze\n\n这题我会！\n\n补全 matrix2bytes()，直接用 sum() 把矩阵压缩成一维列表，然后转字节输出。\n\n补全函数的题比自己写代码的简单多了（bushi\n\n### Code\n\n```python\ndef bytes2matrix(text):\n    \"\"\" Converts a 16-byte array into a 4x4 matrix.  \"\"\"\n    return [list(text[i:i+4]) for i in range(0, len(text), 4)]\n\n\ndef matrix2bytes(matrix):\n    \"\"\" Converts a 4x4 matrix into a 16-byte array.  \"\"\"\n    return bytes(sum(matrix, []))\n\n\nmatrix = [\n    [99, 114, 121, 112],\n    [116, 111, 123, 105],\n    [110, 109, 97, 116],\n    [114, 105, 120, 125],\n]\n\nprint(matrix2bytes(matrix))\n```\n\n### SumUp\n\n```python\n# function\nsum()  # 把迭代对象里的每一个元素相加。（当元素是列表，就有压平的效果咯）\n```\n\n## Round Keys\n\n### Description\n\nWe're going to skip over the finer details of the **KeyExpansion** phase for now. The main point is that it takes in our 16 byte key and produces 11 4x4 matrices called \"round keys\" derived from our initial key. These round keys allow AES to get extra mileage out of the single key that we provided.\n\nThe **initial key addition** phase, which is next, has a single *AddRoundKey* step. The *AddRoundKey* step is straightforward: it XORs the current state with the current round key.\n\n![diagram showing AddRoundKey](https://cryptohack.org/static/img/aes/AddRoundKey.png)\n\n*AddRoundKey* also occurs as the final step of each round. *AddRoundKey* is what makes AES a \"keyed permutation\" rather than just a permutation. It's the only part of AES where the key is mixed into the state, but is crucial for determining the permutation that occurs.\n\nAs you've seen in previous challenges, XOR is an easily invertible operation if you know the key, but tough to undo if you don't. Now imagine trying to recover plaintext which has been XOR'd with 11 different keys, and heavily jumbled between each XOR operation with a series of substitution and transposition ciphers. That's kinda what AES does! And we'll see just how effective the jumbling is in the next few challenges.\n\nComplete the `add_round_key` function, then use the `matrix2bytes` function to get your next flag.\n\n###  Analyze\n\n遇到异或就搬 pwn.xor()！\n\n明文经过了 11 个不同的密钥进行异或，再异或回去就可以得到原文。\n\n返回异或值就 ok。\n\n感觉异或还是蛮有意思的。\n\n### Code\n\n```python\nfrom pwn import xor\nstate = [\n    [206, 243, 61, 34],\n    [171, 11, 93, 31],\n    [16, 200, 91, 108],\n    [150, 3, 194, 51],\n]\n\nround_key = [\n    [173, 129, 68, 82],\n    [223, 100, 38, 109],\n    [32, 189, 53, 8],\n    [253, 48, 187, 78],\n]\n\n\ndef add_round_key(s, k):\n    return xor(s, k)\n\n\nprint(add_round_key(state, round_key))\n```\n\n## Confusion through Substitution\n\n### Description\n\nThe first step of each AES round is *SubBytes*. This involves taking each byte of the state matrix and substituting it for a different byte in a preset 16x16 lookup table. The lookup table is called a \"Substitution box\" or \"S-box\" for short, and can be perplexing at first sight. Let's break it down.\n\n![diagram showing Substitution](https://cryptohack.org/static/img/aes/Substitution.png)\n\nIn 1945 American mathematician Claude Shannon published a groundbreaking paper on Information Theory. It identified \"confusion\" as an essential property of a secure cipher. \"Confusion\" means that the relationship between the ciphertext and the key should be as complex as possible. Given just a ciphertext, there should be no way to learn anything about the key.\n\nIf a cipher has poor confusion, it is possible to express a relationship between ciphertext, key, and plaintext as a linear function. For instance, in a Caesar cipher, `ciphertext = plaintext + key`. That's an obvious relation, which is easy to reverse. More complicated linear transformations can be solved using techniques like Gaussian elimination. Even low-degree polynomials, e.g. an equation like `x^4 + 51x^3 + x`, can be solved efficiently using [algebraic methods](https://math.stackexchange.com/a/1078515). However, the higher the degree of a polynomial, generally the harder it becomes to solve – it can only be approximated by a larger and larger amount of linear functions.\n\nThe main purpose of the S-box is to transform the input in a way that is resistant to being approximated by linear functions. S-boxes are aiming for high *non-linearity*, and while AES's one is not perfect, it's pretty close. The fast lookup in an S-box is a shortcut for performing a very nonlinear function on the input bytes. This function involves taking the modular inverse in the [Galois field 2**8](https://www.samiam.org/galois.html) and then applying an affine transformation which has been tweaked for maximum confusion. The simplest way to express the function is through the following high-degree polynomial:\n\n![diagram showing S-Box equation](https://cryptohack.org/static/img/aes/SBoxEq.png)\n\nTo make the S-box, the function has been calculated on all input values from 0x00 to 0xff and the outputs put in the lookup table.\n\nImplement `sub_bytes`, send the state matrix through the inverse S-box and then convert it to bytes to get the flag.\n\n###  Analyze\n\n意思就是让补全 sub_bytes 函数，然后转换成字节得到 flag。\n\n其实 state 里面的存的是它每个位置上本来的数据在查找库 sbox 中的序号，所以遍历 state，按序号取出对应的原数据，然后返回字节就好咯。\n\n### Code\n\n```python\n# 写法一\ndef sub_bytes(s, sbox=s_box):\n    for i in range(4):\n        for j in range(4):\n            s[i][j] = sbox[s[i][j]]\n    return bytes(sum(s, []))\n\n\nprint(sub_bytes(state, sbox=inv_s_box))\n\n# 写法二\ndef matrix2bytes(matrix):\n    \"\"\" Converts a 4x4 matrix into a 16-byte array.  \"\"\"\n    return bytes(sum(matrix, []))\ndef sub_bytes(s, sbox=s_box):\n    for i in range(4):\n        for j in range(4):\n            s[i][j] = sbox[s[i][j]]\n    return s\n\n\nprint(matrix2bytes(sub_bytes(state, sbox=inv_s_box)))\n```\n\n### SumUp\n\n两种写法怎么说呢，第一种更简洁明了，看起来好像也更优雅。\n\n第二种虽然搬过来了 matrix2bytes() 函数（也可以不搬函数直接一行搞定，不过读起来费劲点），看起来更繁琐，不过这种写法更不容易吃亏（在最后一题已经深刻体会过了）。所以本来是喜欢第一种写法的，做完最后一题之后还是喜欢第二种了。\n\n（呜呜呜我也不想被钓啊，可是它解题更好用诶）。\n\n## Diffusion through Permutation\n\n### Description\n\nWe've seen how S-box substitution provides confusion. The other crucial property described by Shannon is \"diffusion\". This relates to how every part of a cipher's input should spread to every part of the output.\n\nSubstitution on its own creates non-linearity, however it doesn't distribute it over the entire state. Without diffusion, the same byte in the same position would get the same transformations applied to it each round. This would allow cryptanalysts to attack each byte position in the state matrix separately. We need to alternate substitutions by scrambling the state (in an invertible way) so that substitutions applied on one byte influence all other bytes in the state. Each input into the next S-box then becomes a function of multiple bytes, meaning that with every round the algebraic complexity of the system increases enormously.\n\n> An ideal amount of diffusion causes a change of one bit in the plaintext to lead to a change in statistically half the bits of the ciphertext. This desirable outcome is called the [Avalanche effect](https://en.wikipedia.org/wiki/Avalanche_effect).\n\nThe *ShiftRows* and *MixColumns* steps combine to achieve this. They work together to ensure every byte affects every other byte in the state within just two rounds.\n\n*ShiftRows* is the most simple transformation in AES. It keeps the first row of the state matrix the same. The second row is shifted over one column to the left, wrapping around. The third row is shifted two columns, the fourth row by three. Wikipedia puts it nicely: \"the importance of this step is to avoid the columns being encrypted independently, in which case AES degenerates into four independent block ciphers.\"\n\n![diagram showing ShiftRows](https://cryptohack.org/static/img/aes/ShiftRows.png)\n\n*MixColumns* is more complex. It performs Matrix multiplication in Rijndael's Galois field between the columns of the state matrix and a preset matrix. Each single byte of each column therefore affects all the bytes of the resulting column. The implementation details are nuanced; [this page](https://www.samiam.org/mix-column.html) and [Wikipedia](https://en.wikipedia.org/wiki/Rijndael_MixColumns) do a good job of covering them.\n\n![diagram showing MixColumns](https://cryptohack.org/static/img/aes/MixColumns.png)\n\nWe've provided code to perform MixColumns and the forward ShiftRows operation. After implementing `inv_shift_rows`, take the state, run `inv_mix_columns` on it, then `inv_shift_rows`, convert to bytes and you will have your flag.\n\n###  Analyze\n\n首先是补全 inv_shift_rows()，参考 shift_rows()，发现是给第 n 行向左移动 n 个单位 ，那 inv_shift_rows 就给第 n 行向右移动 n 个单位。\n\n然后根据 description 依次运行 `inv_mix_columns(state)` `inv_shift_rows(state)`，然后把前面用过的矩阵转字节的函数 matrix2bytes() 搬过来，输出一下。\n\n### Code\n\n```python\ndef inv_shift_rows(s):\n    s[0][1], s[1][1], s[2][1], s[3][1] = s[3][1], s[0][1], s[1][1], s[2][1]\n    s[0][2], s[1][2], s[2][2], s[3][2] = s[2][2], s[3][2], s[0][2], s[1][2]\n    s[0][3], s[1][3], s[2][3], s[3][3] = s[1][3], s[2][3], s[3][3], s[0][3]\n\n\ndef matrix2bytes(matrix):\n    \"\"\" Converts a 4x4 matrix into a 16-byte array.  \"\"\"\n    return bytes(sum(matrix, []))\n\n\ninv_mix_columns(state)\ninv_shift_rows(state)\nprint(matrix2bytes(state))\n```\n\n## Bringing It All Together\n\n### Description\n\nApart from the **KeyExpansion** phase, we've sketched out all the components of AES. We've shown how *SubBytes* provides confusion and *ShiftRows* and *MixColumns* provide diffusion, and how these two properties work together to repeatedly circulate non-linear transformations over the state. Finally, *AddRoundKey* seeds the key into this substitution-permutation network, making the cipher a keyed permutation.\n\nDecryption involves performing the steps described in the \"Structure of AES\" challenge in reverse, applying the inverse operations. Note that the KeyExpansion still needs to be run first, and the round keys will be used in reverse order. *AddRoundKey* and its inverse are identical as XOR has the self-inverse property.\n\n![diagram showing AES decryption](https://cryptohack.org/static/img/aes/Structure2.png)\n\nWe've provided the key expansion code, and ciphertext that's been properly encrypted by AES-128. Copy in all the building blocks you've coded so far, and complete the `decrypt` function that implements the steps shown in the diagram. The decrypted plaintext is the flag.\n\nYes, you can cheat on this challenge, but where's the fun in that?\n\nThe code used in these exercises has been taken from Bo Zhu's super simple Python AES implementation, so we've reproduced the license here.\n\n###  Analyze\n\n这题最头疼了，开始没明白到底要啥，看了半天发现是要补全好几处代码，而且给的 .py 文件还各种报错，很烦反正。\n\n后面发现这是 AES 基础的最后一道相当于总结的题，就直接把前面几道题用到的函数和矩阵啥的全粘过来了，然后看了看有注释但没代码的地方，几乎是把前几个文件的代码拼到一起咯。然后基本就是一个完整的 AES。\n\n还有，前面有一道题提到用了 pwn 库的 xor() 函数，现在想给自己埋咯。\n\n最后代码一直报错，看了看日志，手写了一下 xor，居然就很顺利了？\n\n把 pwn 库埋咯！\n\n（因为这题需要自己写的代码分布比较零散，找起来也比较麻烦，所以干脆把全部代码贴上来。）\n\n### Code\n\n```python\nN_ROUNDS = 10\n\nkey = b'\\xc3,\\\\\\xa6\\xb5\\x80^\\x0c\\xdb\\x8d\\xa5z*\\xb6\\xfe\\\\'\nciphertext = b'\\xd1O\\x14j\\xa4+O\\xb6\\xa1\\xc4\\x08B)\\x8f\\x12\\xdd'\ns_box = (\n    0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76,\n    0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0,\n    0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15,\n    0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75,\n    0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84,\n    0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF,\n    0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8,\n    0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2,\n    0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73,\n    0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB,\n    0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79,\n    0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08,\n    0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A,\n    0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E,\n    0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF,\n    0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16,\n)\ninv_s_box = (\n    0x52, 0x09, 0x6A, 0xD5, 0x30, 0x36, 0xA5, 0x38, 0xBF, 0x40, 0xA3, 0x9E, 0x81, 0xF3, 0xD7, 0xFB,\n    0x7C, 0xE3, 0x39, 0x82, 0x9B, 0x2F, 0xFF, 0x87, 0x34, 0x8E, 0x43, 0x44, 0xC4, 0xDE, 0xE9, 0xCB,\n    0x54, 0x7B, 0x94, 0x32, 0xA6, 0xC2, 0x23, 0x3D, 0xEE, 0x4C, 0x95, 0x0B, 0x42, 0xFA, 0xC3, 0x4E,\n    0x08, 0x2E, 0xA1, 0x66, 0x28, 0xD9, 0x24, 0xB2, 0x76, 0x5B, 0xA2, 0x49, 0x6D, 0x8B, 0xD1, 0x25,\n    0x72, 0xF8, 0xF6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xD4, 0xA4, 0x5C, 0xCC, 0x5D, 0x65, 0xB6, 0x92,\n    0x6C, 0x70, 0x48, 0x50, 0xFD, 0xED, 0xB9, 0xDA, 0x5E, 0x15, 0x46, 0x57, 0xA7, 0x8D, 0x9D, 0x84,\n    0x90, 0xD8, 0xAB, 0x00, 0x8C, 0xBC, 0xD3, 0x0A, 0xF7, 0xE4, 0x58, 0x05, 0xB8, 0xB3, 0x45, 0x06,\n    0xD0, 0x2C, 0x1E, 0x8F, 0xCA, 0x3F, 0x0F, 0x02, 0xC1, 0xAF, 0xBD, 0x03, 0x01, 0x13, 0x8A, 0x6B,\n    0x3A, 0x91, 0x11, 0x41, 0x4F, 0x67, 0xDC, 0xEA, 0x97, 0xF2, 0xCF, 0xCE, 0xF0, 0xB4, 0xE6, 0x73,\n    0x96, 0xAC, 0x74, 0x22, 0xE7, 0xAD, 0x35, 0x85, 0xE2, 0xF9, 0x37, 0xE8, 0x1C, 0x75, 0xDF, 0x6E,\n    0x47, 0xF1, 0x1A, 0x71, 0x1D, 0x29, 0xC5, 0x89, 0x6F, 0xB7, 0x62, 0x0E, 0xAA, 0x18, 0xBE, 0x1B,\n    0xFC, 0x56, 0x3E, 0x4B, 0xC6, 0xD2, 0x79, 0x20, 0x9A, 0xDB, 0xC0, 0xFE, 0x78, 0xCD, 0x5A, 0xF4,\n    0x1F, 0xDD, 0xA8, 0x33, 0x88, 0x07, 0xC7, 0x31, 0xB1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xEC, 0x5F,\n    0x60, 0x51, 0x7F, 0xA9, 0x19, 0xB5, 0x4A, 0x0D, 0x2D, 0xE5, 0x7A, 0x9F, 0x93, 0xC9, 0x9C, 0xEF,\n    0xA0, 0xE0, 0x3B, 0x4D, 0xAE, 0x2A, 0xF5, 0xB0, 0xC8, 0xEB, 0xBB, 0x3C, 0x83, 0x53, 0x99, 0x61,\n    0x17, 0x2B, 0x04, 0x7E, 0xBA, 0x77, 0xD6, 0x26, 0xE1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0C, 0x7D,\n)\n\n\ndef bytes2matrix(text):\n    \"\"\" Converts a 16-byte array into a 4x4 matrix.  \"\"\"\n    return [list(text[i:i+4]) for i in range(0, len(text), 4)]\n\n\ndef matrix2bytes(matrix):\n    \"\"\" Converts a 4x4 matrix into a 16-byte array.  \"\"\"\n    return bytes(sum(matrix, []))\n\n\ndef add_round_key(s, k):\n    return [\n        [s[i][j] ^ k[i][j] for j in range(4)]\n        for i in range(4)\n    ]\n\n\ndef sub_bytes(s, sbox=s_box):\n    for i in range(4):\n        for j in range(4):\n            s[i][j] = sbox[s[i][j]]\n    return s\n\n\ndef shift_rows(s):\n    s[0][1], s[1][1], s[2][1], s[3][1] = s[1][1], s[2][1], s[3][1], s[0][1]\n    s[0][2], s[1][2], s[2][2], s[3][2] = s[2][2], s[3][2], s[0][2], s[1][2]\n    s[0][3], s[1][3], s[2][3], s[3][3] = s[3][3], s[0][3], s[1][3], s[2][3]\n\n\ndef inv_shift_rows(s):\n    s[0][1], s[1][1], s[2][1], s[3][1] = s[3][1], s[0][1], s[1][1], s[2][1]\n    s[0][2], s[1][2], s[2][2], s[3][2] = s[2][2], s[3][2], s[0][2], s[1][2]\n    s[0][3], s[1][3], s[2][3], s[3][3] = s[1][3], s[2][3], s[3][3], s[0][3]\n\n\n# learned from http://cs.ucsb.edu/~koc/cs178/projects/JT/aes.c\nxtime = lambda a: (((a << 1) ^ 0x1B) & 0xFF) if (a & 0x80) else (a << 1)\n\n\ndef mix_single_column(a):\n    # see Sec 4.1.2 in The Design of Rijndael\n    t = a[0] ^ a[1] ^ a[2] ^ a[3]\n    u = a[0]\n    a[0] ^= t ^ xtime(a[0] ^ a[1])\n    a[1] ^= t ^ xtime(a[1] ^ a[2])\n    a[2] ^= t ^ xtime(a[2] ^ a[3])\n    a[3] ^= t ^ xtime(a[3] ^ u)\n\n\ndef mix_columns(s):\n    for i in range(4):\n        mix_single_column(s[i])\n\n\ndef inv_mix_columns(s):\n    # see Sec 4.1.3 in The Design of Rijndael\n    for i in range(4):\n        u = xtime(xtime(s[i][0] ^ s[i][2]))\n        v = xtime(xtime(s[i][1] ^ s[i][3]))\n        s[i][0] ^= u\n        s[i][1] ^= v\n        s[i][2] ^= u\n        s[i][3] ^= v\n\n    mix_columns(s)\n\n\ndef expand_key(master_key):\n    \"\"\"\n    Expands and returns a list of key matrices for the given master_key.\n    \"\"\"\n\n    # Round constants https://en.wikipedia.org/wiki/AES_key_schedule#Round_constants\n    r_con = (\n        0x00, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40,\n        0x80, 0x1B, 0x36, 0x6C, 0xD8, 0xAB, 0x4D, 0x9A,\n        0x2F, 0x5E, 0xBC, 0x63, 0xC6, 0x97, 0x35, 0x6A,\n        0xD4, 0xB3, 0x7D, 0xFA, 0xEF, 0xC5, 0x91, 0x39,\n    )\n\n    # Initialize round keys with raw key material.\n    key_columns = bytes2matrix(master_key)\n    iteration_size = len(master_key) // 4\n\n    # Each iteration has exactly as many columns as the key material.\n    i = 1\n    while len(key_columns) < (N_ROUNDS + 1) * 4:\n        # Copy previous word.\n        word = list(key_columns[-1])\n\n        # Perform schedule_core once every \"row\".\n        if len(key_columns) % iteration_size == 0:\n            # Circular shift.\n            word.append(word.pop(0))\n            # Map to S-BOX.\n            word = [s_box[b] for b in word]\n            # XOR with first byte of R-CON, since the others bytes of R-CON are 0.\n            word[0] ^= r_con[i]\n            i += 1\n        elif len(master_key) == 32 and len(key_columns) % iteration_size == 4:\n            # Run word through S-box in the fourth iteration when using a\n            # 256-bit key.\n            word = [s_box[b] for b in word]\n\n        # XOR with equivalent word from previous iteration.\n        word = bytes(i ^ j for i, j in zip(word, key_columns[-iteration_size]))\n        key_columns.append(word)\n\n    # Group key words in 4x4 byte matrices.\n    return [key_columns[4 * i: 4*(i+1)] for i in range(len(key_columns) // 4)]\n\n\ndef decrypt(key, ciphertext):\n    round_keys = expand_key(key)  # Remember to start from the last round key and work backwards through them when decrypting\n\n    # Convert ciphertext to state matrix\n    state = bytes2matrix(ciphertext)\n\n    # Initial add round key step\n    state = add_round_key(state, round_keys[-1])\n    for i in range(N_ROUNDS - 1, 0, -1):\n        inv_shift_rows(state)\n        state = sub_bytes(state, inv_s_box)\n        state = add_round_key(state, round_keys[i])\n        inv_mix_columns(state)\n\n    # Run final round (skips the InvMixColumns step)\n    inv_shift_rows(state)\n    state = sub_bytes(state, inv_s_box)\n    state = add_round_key(state, round_keys[0])\n\n    # Convert state matrix to plaintext\n    return matrix2bytes(state)\n\n\nprint(decrypt(key, ciphertext))\n```\n","source":"_posts/Symmetric Cryptography_How AES Works.md","raw":"---\ntitle: Symmetric Cryptography_How AES Works\ndate: 2022-05-05 23:42:00\ntags: cryptohack\nmathjax: true\n---\n\n第三章好像是做的最迷的\n\n<!--more-->\n\n虽然只需要做 ”How AES Works” 部分。但是——\n\n刚开始第三章：还以为会越来越难，没想到做完数论就柳暗花明了？\n\n第三章最后一题：什么东西啊这是，这怎么比数论那块还复杂。。\n\n# Symmetric Cryptography_How AES Works\n\n## Keyed Permutations\n\n### Description\n\nAES, like all good block ciphers, performs a \"keyed permutation\". This means that it maps every possible input block to a unique output block, with a key determining which permutation to perform.\n\n> A \"block\" just refers to a fixed number of bits or bytes, which may represent any kind of data. AES processes a block and outputs another block. We'll be specifically talking the variant of AES which works on 128 bit (16 byte) blocks and a 128 bit key, known as AES-128.\n\nUsing the same key, the permutation can be performed in reverse, mapping the output block back to the original input block. It is important that there is a one-to-one correspondence between input and output blocks, otherwise we wouldn't be able to rely on the ciphertext to decrypt back to the same plaintext we started with.\n\nWhat is the mathematical term for a one-to-one correspondence?\n\n###  Analyze\n\n喔这题简单，我不知道但 Google 知道，浅搜一下”一一对应的数学术语“，知道叫双射函数，浅浅上个百科，就知道英语咯。\n\n## Resisting Bruteforce\n\n### Description\n\nIf a block cipher is secure, there should be no way for an attacker to distinguish the output of AES from a [random permutation](https://en.wikipedia.org/wiki/Pseudorandom_permutation) of bits. Furthermore, there should be no better way to undo the permutation than simply bruteforcing every possible key. That's why academics consider a cipher theoretically \"broken\" if they can find an attack that takes fewer steps to perform than bruteforcing the key, even if that attack is practically infeasible.\n\n> How difficult is it to bruteforce a 128-bit keyspace? [Somebody estimated](https://crypto.stackexchange.com/a/48669) that if you turned the power of the entire Bitcoin mining network against an AES-128 key, it would take over a hundred times the age of the universe to crack the key.\n\nIt turns out that there is [an attack](https://en.wikipedia.org/wiki/Biclique_attack) on AES that's better than bruteforce, but only slightly – it lowers the security level of AES-128 down to 126.1 bits, and hasn't been improved on for over 8 years. Given the large \"security margin\" provided by 128 bits, and the lack of improvements despite extensive study, it's not considered a credible risk to the security of AES. But yes, in a very narrow sense, it \"breaks\" AES.\n\nFinally, while quantum computers have the potential to completely break popular public-key cryptosystems like RSA via [Shor's algorithm](https://en.wikipedia.org/wiki/Shor's_algorithm), they are thought to only cut in half the security level of symmetric cryptosystems via [Grover's algorithm](https://en.wikipedia.org/wiki/Grover's_algorithm). This is one reason why people recommend using AES-256, despite it being less performant, as it would still provide a very adequate 128 bits of security in a quantum future.\n\nWhat is the name for the best single-key attack against AES?\n\n###  Analyze\n\n虽然但是，依然去查了 Google，靠谱！\n\n不过发现网上搜 biclique 的结果居然不是很多，我打开方式有问题吗是，后面再看看。\n\n## Structure of AES\n\n### Description\n\nTo achieve a keyed permutation that is infeasible to invert without the key, AES applies a large number of ad-hoc mixing operations on the input. This is in stark contrast to public-key cryptosystems like RSA, which are based on elegant individual mathematical problems. AES is much less elegant, but it's very fast.\n\nAt a high level, AES-128 begins with a \"key schedule\" and then runs 10 rounds over a state. The starting state is just the plaintext block that we want to encrypt, represented as a 4x4 matrix of bytes. Over the course of the 10 rounds, the state is repeatedly modified by a number of invertible transformations.\n\n> Each transformation step has a defined purpose based on theoretical properties of secure ciphers established by Claude Shannon in the 1940s. We'll look closer at each of these in the following challenges.\n\nHere's an overview of the phases of AES encryption:\n\n![diagram showing AES rounds](https://cryptohack.org/static/img/aes/Structure.png)\n\n1. **KeyExpansion** or Key Schedule\n\n From the 128 bit key, 11 separate 128 bit \"round keys\" are derived: one to be used in each AddRoundKey step.\n\n2. **Initial key addition**\n\n *AddRoundKey* - the bytes of the first round key are XOR'd with the bytes of the state.\n\n3. **Round** - this phase is looped 10 times, for 9 main rounds plus one \"final round\"\n\n \ta) *SubBytes* - each byte of the state is substituted for a different byte according to a lookup table (\"S-box\").\n\n​\t b) *ShiftRows* - the last three rows of the state matrix are transposed—shifted over a column or two or three.\n\n​\t c) *MixColumns* - matrix multiplication is performed on the columns of the state, combining the four bytes in each column. This is skipped in the final round.\n\n​\t d) *AddRoundKey* - the bytes of the current round key are XOR'd with the bytes of the state.\n\nIncluded is a `bytes2matrix` function for converting our initial plaintext block into a state matrix. Write a `matrix2bytes` function to turn that matrix back into bytes, and submit the resulting plaintext as the flag.\n\n###  Analyze\n\n这题我会！\n\n补全 matrix2bytes()，直接用 sum() 把矩阵压缩成一维列表，然后转字节输出。\n\n补全函数的题比自己写代码的简单多了（bushi\n\n### Code\n\n```python\ndef bytes2matrix(text):\n    \"\"\" Converts a 16-byte array into a 4x4 matrix.  \"\"\"\n    return [list(text[i:i+4]) for i in range(0, len(text), 4)]\n\n\ndef matrix2bytes(matrix):\n    \"\"\" Converts a 4x4 matrix into a 16-byte array.  \"\"\"\n    return bytes(sum(matrix, []))\n\n\nmatrix = [\n    [99, 114, 121, 112],\n    [116, 111, 123, 105],\n    [110, 109, 97, 116],\n    [114, 105, 120, 125],\n]\n\nprint(matrix2bytes(matrix))\n```\n\n### SumUp\n\n```python\n# function\nsum()  # 把迭代对象里的每一个元素相加。（当元素是列表，就有压平的效果咯）\n```\n\n## Round Keys\n\n### Description\n\nWe're going to skip over the finer details of the **KeyExpansion** phase for now. The main point is that it takes in our 16 byte key and produces 11 4x4 matrices called \"round keys\" derived from our initial key. These round keys allow AES to get extra mileage out of the single key that we provided.\n\nThe **initial key addition** phase, which is next, has a single *AddRoundKey* step. The *AddRoundKey* step is straightforward: it XORs the current state with the current round key.\n\n![diagram showing AddRoundKey](https://cryptohack.org/static/img/aes/AddRoundKey.png)\n\n*AddRoundKey* also occurs as the final step of each round. *AddRoundKey* is what makes AES a \"keyed permutation\" rather than just a permutation. It's the only part of AES where the key is mixed into the state, but is crucial for determining the permutation that occurs.\n\nAs you've seen in previous challenges, XOR is an easily invertible operation if you know the key, but tough to undo if you don't. Now imagine trying to recover plaintext which has been XOR'd with 11 different keys, and heavily jumbled between each XOR operation with a series of substitution and transposition ciphers. That's kinda what AES does! And we'll see just how effective the jumbling is in the next few challenges.\n\nComplete the `add_round_key` function, then use the `matrix2bytes` function to get your next flag.\n\n###  Analyze\n\n遇到异或就搬 pwn.xor()！\n\n明文经过了 11 个不同的密钥进行异或，再异或回去就可以得到原文。\n\n返回异或值就 ok。\n\n感觉异或还是蛮有意思的。\n\n### Code\n\n```python\nfrom pwn import xor\nstate = [\n    [206, 243, 61, 34],\n    [171, 11, 93, 31],\n    [16, 200, 91, 108],\n    [150, 3, 194, 51],\n]\n\nround_key = [\n    [173, 129, 68, 82],\n    [223, 100, 38, 109],\n    [32, 189, 53, 8],\n    [253, 48, 187, 78],\n]\n\n\ndef add_round_key(s, k):\n    return xor(s, k)\n\n\nprint(add_round_key(state, round_key))\n```\n\n## Confusion through Substitution\n\n### Description\n\nThe first step of each AES round is *SubBytes*. This involves taking each byte of the state matrix and substituting it for a different byte in a preset 16x16 lookup table. The lookup table is called a \"Substitution box\" or \"S-box\" for short, and can be perplexing at first sight. Let's break it down.\n\n![diagram showing Substitution](https://cryptohack.org/static/img/aes/Substitution.png)\n\nIn 1945 American mathematician Claude Shannon published a groundbreaking paper on Information Theory. It identified \"confusion\" as an essential property of a secure cipher. \"Confusion\" means that the relationship between the ciphertext and the key should be as complex as possible. Given just a ciphertext, there should be no way to learn anything about the key.\n\nIf a cipher has poor confusion, it is possible to express a relationship between ciphertext, key, and plaintext as a linear function. For instance, in a Caesar cipher, `ciphertext = plaintext + key`. That's an obvious relation, which is easy to reverse. More complicated linear transformations can be solved using techniques like Gaussian elimination. Even low-degree polynomials, e.g. an equation like `x^4 + 51x^3 + x`, can be solved efficiently using [algebraic methods](https://math.stackexchange.com/a/1078515). However, the higher the degree of a polynomial, generally the harder it becomes to solve – it can only be approximated by a larger and larger amount of linear functions.\n\nThe main purpose of the S-box is to transform the input in a way that is resistant to being approximated by linear functions. S-boxes are aiming for high *non-linearity*, and while AES's one is not perfect, it's pretty close. The fast lookup in an S-box is a shortcut for performing a very nonlinear function on the input bytes. This function involves taking the modular inverse in the [Galois field 2**8](https://www.samiam.org/galois.html) and then applying an affine transformation which has been tweaked for maximum confusion. The simplest way to express the function is through the following high-degree polynomial:\n\n![diagram showing S-Box equation](https://cryptohack.org/static/img/aes/SBoxEq.png)\n\nTo make the S-box, the function has been calculated on all input values from 0x00 to 0xff and the outputs put in the lookup table.\n\nImplement `sub_bytes`, send the state matrix through the inverse S-box and then convert it to bytes to get the flag.\n\n###  Analyze\n\n意思就是让补全 sub_bytes 函数，然后转换成字节得到 flag。\n\n其实 state 里面的存的是它每个位置上本来的数据在查找库 sbox 中的序号，所以遍历 state，按序号取出对应的原数据，然后返回字节就好咯。\n\n### Code\n\n```python\n# 写法一\ndef sub_bytes(s, sbox=s_box):\n    for i in range(4):\n        for j in range(4):\n            s[i][j] = sbox[s[i][j]]\n    return bytes(sum(s, []))\n\n\nprint(sub_bytes(state, sbox=inv_s_box))\n\n# 写法二\ndef matrix2bytes(matrix):\n    \"\"\" Converts a 4x4 matrix into a 16-byte array.  \"\"\"\n    return bytes(sum(matrix, []))\ndef sub_bytes(s, sbox=s_box):\n    for i in range(4):\n        for j in range(4):\n            s[i][j] = sbox[s[i][j]]\n    return s\n\n\nprint(matrix2bytes(sub_bytes(state, sbox=inv_s_box)))\n```\n\n### SumUp\n\n两种写法怎么说呢，第一种更简洁明了，看起来好像也更优雅。\n\n第二种虽然搬过来了 matrix2bytes() 函数（也可以不搬函数直接一行搞定，不过读起来费劲点），看起来更繁琐，不过这种写法更不容易吃亏（在最后一题已经深刻体会过了）。所以本来是喜欢第一种写法的，做完最后一题之后还是喜欢第二种了。\n\n（呜呜呜我也不想被钓啊，可是它解题更好用诶）。\n\n## Diffusion through Permutation\n\n### Description\n\nWe've seen how S-box substitution provides confusion. The other crucial property described by Shannon is \"diffusion\". This relates to how every part of a cipher's input should spread to every part of the output.\n\nSubstitution on its own creates non-linearity, however it doesn't distribute it over the entire state. Without diffusion, the same byte in the same position would get the same transformations applied to it each round. This would allow cryptanalysts to attack each byte position in the state matrix separately. We need to alternate substitutions by scrambling the state (in an invertible way) so that substitutions applied on one byte influence all other bytes in the state. Each input into the next S-box then becomes a function of multiple bytes, meaning that with every round the algebraic complexity of the system increases enormously.\n\n> An ideal amount of diffusion causes a change of one bit in the plaintext to lead to a change in statistically half the bits of the ciphertext. This desirable outcome is called the [Avalanche effect](https://en.wikipedia.org/wiki/Avalanche_effect).\n\nThe *ShiftRows* and *MixColumns* steps combine to achieve this. They work together to ensure every byte affects every other byte in the state within just two rounds.\n\n*ShiftRows* is the most simple transformation in AES. It keeps the first row of the state matrix the same. The second row is shifted over one column to the left, wrapping around. The third row is shifted two columns, the fourth row by three. Wikipedia puts it nicely: \"the importance of this step is to avoid the columns being encrypted independently, in which case AES degenerates into four independent block ciphers.\"\n\n![diagram showing ShiftRows](https://cryptohack.org/static/img/aes/ShiftRows.png)\n\n*MixColumns* is more complex. It performs Matrix multiplication in Rijndael's Galois field between the columns of the state matrix and a preset matrix. Each single byte of each column therefore affects all the bytes of the resulting column. The implementation details are nuanced; [this page](https://www.samiam.org/mix-column.html) and [Wikipedia](https://en.wikipedia.org/wiki/Rijndael_MixColumns) do a good job of covering them.\n\n![diagram showing MixColumns](https://cryptohack.org/static/img/aes/MixColumns.png)\n\nWe've provided code to perform MixColumns and the forward ShiftRows operation. After implementing `inv_shift_rows`, take the state, run `inv_mix_columns` on it, then `inv_shift_rows`, convert to bytes and you will have your flag.\n\n###  Analyze\n\n首先是补全 inv_shift_rows()，参考 shift_rows()，发现是给第 n 行向左移动 n 个单位 ，那 inv_shift_rows 就给第 n 行向右移动 n 个单位。\n\n然后根据 description 依次运行 `inv_mix_columns(state)` `inv_shift_rows(state)`，然后把前面用过的矩阵转字节的函数 matrix2bytes() 搬过来，输出一下。\n\n### Code\n\n```python\ndef inv_shift_rows(s):\n    s[0][1], s[1][1], s[2][1], s[3][1] = s[3][1], s[0][1], s[1][1], s[2][1]\n    s[0][2], s[1][2], s[2][2], s[3][2] = s[2][2], s[3][2], s[0][2], s[1][2]\n    s[0][3], s[1][3], s[2][3], s[3][3] = s[1][3], s[2][3], s[3][3], s[0][3]\n\n\ndef matrix2bytes(matrix):\n    \"\"\" Converts a 4x4 matrix into a 16-byte array.  \"\"\"\n    return bytes(sum(matrix, []))\n\n\ninv_mix_columns(state)\ninv_shift_rows(state)\nprint(matrix2bytes(state))\n```\n\n## Bringing It All Together\n\n### Description\n\nApart from the **KeyExpansion** phase, we've sketched out all the components of AES. We've shown how *SubBytes* provides confusion and *ShiftRows* and *MixColumns* provide diffusion, and how these two properties work together to repeatedly circulate non-linear transformations over the state. Finally, *AddRoundKey* seeds the key into this substitution-permutation network, making the cipher a keyed permutation.\n\nDecryption involves performing the steps described in the \"Structure of AES\" challenge in reverse, applying the inverse operations. Note that the KeyExpansion still needs to be run first, and the round keys will be used in reverse order. *AddRoundKey* and its inverse are identical as XOR has the self-inverse property.\n\n![diagram showing AES decryption](https://cryptohack.org/static/img/aes/Structure2.png)\n\nWe've provided the key expansion code, and ciphertext that's been properly encrypted by AES-128. Copy in all the building blocks you've coded so far, and complete the `decrypt` function that implements the steps shown in the diagram. The decrypted plaintext is the flag.\n\nYes, you can cheat on this challenge, but where's the fun in that?\n\nThe code used in these exercises has been taken from Bo Zhu's super simple Python AES implementation, so we've reproduced the license here.\n\n###  Analyze\n\n这题最头疼了，开始没明白到底要啥，看了半天发现是要补全好几处代码，而且给的 .py 文件还各种报错，很烦反正。\n\n后面发现这是 AES 基础的最后一道相当于总结的题，就直接把前面几道题用到的函数和矩阵啥的全粘过来了，然后看了看有注释但没代码的地方，几乎是把前几个文件的代码拼到一起咯。然后基本就是一个完整的 AES。\n\n还有，前面有一道题提到用了 pwn 库的 xor() 函数，现在想给自己埋咯。\n\n最后代码一直报错，看了看日志，手写了一下 xor，居然就很顺利了？\n\n把 pwn 库埋咯！\n\n（因为这题需要自己写的代码分布比较零散，找起来也比较麻烦，所以干脆把全部代码贴上来。）\n\n### Code\n\n```python\nN_ROUNDS = 10\n\nkey = b'\\xc3,\\\\\\xa6\\xb5\\x80^\\x0c\\xdb\\x8d\\xa5z*\\xb6\\xfe\\\\'\nciphertext = b'\\xd1O\\x14j\\xa4+O\\xb6\\xa1\\xc4\\x08B)\\x8f\\x12\\xdd'\ns_box = (\n    0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76,\n    0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0,\n    0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15,\n    0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75,\n    0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84,\n    0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF,\n    0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8,\n    0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2,\n    0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73,\n    0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB,\n    0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79,\n    0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08,\n    0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A,\n    0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E,\n    0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF,\n    0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16,\n)\ninv_s_box = (\n    0x52, 0x09, 0x6A, 0xD5, 0x30, 0x36, 0xA5, 0x38, 0xBF, 0x40, 0xA3, 0x9E, 0x81, 0xF3, 0xD7, 0xFB,\n    0x7C, 0xE3, 0x39, 0x82, 0x9B, 0x2F, 0xFF, 0x87, 0x34, 0x8E, 0x43, 0x44, 0xC4, 0xDE, 0xE9, 0xCB,\n    0x54, 0x7B, 0x94, 0x32, 0xA6, 0xC2, 0x23, 0x3D, 0xEE, 0x4C, 0x95, 0x0B, 0x42, 0xFA, 0xC3, 0x4E,\n    0x08, 0x2E, 0xA1, 0x66, 0x28, 0xD9, 0x24, 0xB2, 0x76, 0x5B, 0xA2, 0x49, 0x6D, 0x8B, 0xD1, 0x25,\n    0x72, 0xF8, 0xF6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xD4, 0xA4, 0x5C, 0xCC, 0x5D, 0x65, 0xB6, 0x92,\n    0x6C, 0x70, 0x48, 0x50, 0xFD, 0xED, 0xB9, 0xDA, 0x5E, 0x15, 0x46, 0x57, 0xA7, 0x8D, 0x9D, 0x84,\n    0x90, 0xD8, 0xAB, 0x00, 0x8C, 0xBC, 0xD3, 0x0A, 0xF7, 0xE4, 0x58, 0x05, 0xB8, 0xB3, 0x45, 0x06,\n    0xD0, 0x2C, 0x1E, 0x8F, 0xCA, 0x3F, 0x0F, 0x02, 0xC1, 0xAF, 0xBD, 0x03, 0x01, 0x13, 0x8A, 0x6B,\n    0x3A, 0x91, 0x11, 0x41, 0x4F, 0x67, 0xDC, 0xEA, 0x97, 0xF2, 0xCF, 0xCE, 0xF0, 0xB4, 0xE6, 0x73,\n    0x96, 0xAC, 0x74, 0x22, 0xE7, 0xAD, 0x35, 0x85, 0xE2, 0xF9, 0x37, 0xE8, 0x1C, 0x75, 0xDF, 0x6E,\n    0x47, 0xF1, 0x1A, 0x71, 0x1D, 0x29, 0xC5, 0x89, 0x6F, 0xB7, 0x62, 0x0E, 0xAA, 0x18, 0xBE, 0x1B,\n    0xFC, 0x56, 0x3E, 0x4B, 0xC6, 0xD2, 0x79, 0x20, 0x9A, 0xDB, 0xC0, 0xFE, 0x78, 0xCD, 0x5A, 0xF4,\n    0x1F, 0xDD, 0xA8, 0x33, 0x88, 0x07, 0xC7, 0x31, 0xB1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xEC, 0x5F,\n    0x60, 0x51, 0x7F, 0xA9, 0x19, 0xB5, 0x4A, 0x0D, 0x2D, 0xE5, 0x7A, 0x9F, 0x93, 0xC9, 0x9C, 0xEF,\n    0xA0, 0xE0, 0x3B, 0x4D, 0xAE, 0x2A, 0xF5, 0xB0, 0xC8, 0xEB, 0xBB, 0x3C, 0x83, 0x53, 0x99, 0x61,\n    0x17, 0x2B, 0x04, 0x7E, 0xBA, 0x77, 0xD6, 0x26, 0xE1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0C, 0x7D,\n)\n\n\ndef bytes2matrix(text):\n    \"\"\" Converts a 16-byte array into a 4x4 matrix.  \"\"\"\n    return [list(text[i:i+4]) for i in range(0, len(text), 4)]\n\n\ndef matrix2bytes(matrix):\n    \"\"\" Converts a 4x4 matrix into a 16-byte array.  \"\"\"\n    return bytes(sum(matrix, []))\n\n\ndef add_round_key(s, k):\n    return [\n        [s[i][j] ^ k[i][j] for j in range(4)]\n        for i in range(4)\n    ]\n\n\ndef sub_bytes(s, sbox=s_box):\n    for i in range(4):\n        for j in range(4):\n            s[i][j] = sbox[s[i][j]]\n    return s\n\n\ndef shift_rows(s):\n    s[0][1], s[1][1], s[2][1], s[3][1] = s[1][1], s[2][1], s[3][1], s[0][1]\n    s[0][2], s[1][2], s[2][2], s[3][2] = s[2][2], s[3][2], s[0][2], s[1][2]\n    s[0][3], s[1][3], s[2][3], s[3][3] = s[3][3], s[0][3], s[1][3], s[2][3]\n\n\ndef inv_shift_rows(s):\n    s[0][1], s[1][1], s[2][1], s[3][1] = s[3][1], s[0][1], s[1][1], s[2][1]\n    s[0][2], s[1][2], s[2][2], s[3][2] = s[2][2], s[3][2], s[0][2], s[1][2]\n    s[0][3], s[1][3], s[2][3], s[3][3] = s[1][3], s[2][3], s[3][3], s[0][3]\n\n\n# learned from http://cs.ucsb.edu/~koc/cs178/projects/JT/aes.c\nxtime = lambda a: (((a << 1) ^ 0x1B) & 0xFF) if (a & 0x80) else (a << 1)\n\n\ndef mix_single_column(a):\n    # see Sec 4.1.2 in The Design of Rijndael\n    t = a[0] ^ a[1] ^ a[2] ^ a[3]\n    u = a[0]\n    a[0] ^= t ^ xtime(a[0] ^ a[1])\n    a[1] ^= t ^ xtime(a[1] ^ a[2])\n    a[2] ^= t ^ xtime(a[2] ^ a[3])\n    a[3] ^= t ^ xtime(a[3] ^ u)\n\n\ndef mix_columns(s):\n    for i in range(4):\n        mix_single_column(s[i])\n\n\ndef inv_mix_columns(s):\n    # see Sec 4.1.3 in The Design of Rijndael\n    for i in range(4):\n        u = xtime(xtime(s[i][0] ^ s[i][2]))\n        v = xtime(xtime(s[i][1] ^ s[i][3]))\n        s[i][0] ^= u\n        s[i][1] ^= v\n        s[i][2] ^= u\n        s[i][3] ^= v\n\n    mix_columns(s)\n\n\ndef expand_key(master_key):\n    \"\"\"\n    Expands and returns a list of key matrices for the given master_key.\n    \"\"\"\n\n    # Round constants https://en.wikipedia.org/wiki/AES_key_schedule#Round_constants\n    r_con = (\n        0x00, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40,\n        0x80, 0x1B, 0x36, 0x6C, 0xD8, 0xAB, 0x4D, 0x9A,\n        0x2F, 0x5E, 0xBC, 0x63, 0xC6, 0x97, 0x35, 0x6A,\n        0xD4, 0xB3, 0x7D, 0xFA, 0xEF, 0xC5, 0x91, 0x39,\n    )\n\n    # Initialize round keys with raw key material.\n    key_columns = bytes2matrix(master_key)\n    iteration_size = len(master_key) // 4\n\n    # Each iteration has exactly as many columns as the key material.\n    i = 1\n    while len(key_columns) < (N_ROUNDS + 1) * 4:\n        # Copy previous word.\n        word = list(key_columns[-1])\n\n        # Perform schedule_core once every \"row\".\n        if len(key_columns) % iteration_size == 0:\n            # Circular shift.\n            word.append(word.pop(0))\n            # Map to S-BOX.\n            word = [s_box[b] for b in word]\n            # XOR with first byte of R-CON, since the others bytes of R-CON are 0.\n            word[0] ^= r_con[i]\n            i += 1\n        elif len(master_key) == 32 and len(key_columns) % iteration_size == 4:\n            # Run word through S-box in the fourth iteration when using a\n            # 256-bit key.\n            word = [s_box[b] for b in word]\n\n        # XOR with equivalent word from previous iteration.\n        word = bytes(i ^ j for i, j in zip(word, key_columns[-iteration_size]))\n        key_columns.append(word)\n\n    # Group key words in 4x4 byte matrices.\n    return [key_columns[4 * i: 4*(i+1)] for i in range(len(key_columns) // 4)]\n\n\ndef decrypt(key, ciphertext):\n    round_keys = expand_key(key)  # Remember to start from the last round key and work backwards through them when decrypting\n\n    # Convert ciphertext to state matrix\n    state = bytes2matrix(ciphertext)\n\n    # Initial add round key step\n    state = add_round_key(state, round_keys[-1])\n    for i in range(N_ROUNDS - 1, 0, -1):\n        inv_shift_rows(state)\n        state = sub_bytes(state, inv_s_box)\n        state = add_round_key(state, round_keys[i])\n        inv_mix_columns(state)\n\n    # Run final round (skips the InvMixColumns step)\n    inv_shift_rows(state)\n    state = sub_bytes(state, inv_s_box)\n    state = add_round_key(state, round_keys[0])\n\n    # Convert state matrix to plaintext\n    return matrix2bytes(state)\n\n\nprint(decrypt(key, ciphertext))\n```\n","slug":"Symmetric Cryptography_How AES Works","published":1,"updated":"2022-05-06T18:19:37.564Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl37evny100019wfs00260g8e","content":"<p>第三章好像是做的最迷的</p>\n<span id=\"more\"></span>\n\n<p>虽然只需要做 ”How AES Works” 部分。但是——</p>\n<p>刚开始第三章：还以为会越来越难，没想到做完数论就柳暗花明了？</p>\n<p>第三章最后一题：什么东西啊这是，这怎么比数论那块还复杂。。</p>\n<h1 id=\"Symmetric-Cryptography-How-AES-Works\"><a href=\"#Symmetric-Cryptography-How-AES-Works\" class=\"headerlink\" title=\"Symmetric Cryptography_How AES Works\"></a>Symmetric Cryptography_How AES Works</h1><h2 id=\"Keyed-Permutations\"><a href=\"#Keyed-Permutations\" class=\"headerlink\" title=\"Keyed Permutations\"></a>Keyed Permutations</h2><h3 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>AES, like all good block ciphers, performs a “keyed permutation”. This means that it maps every possible input block to a unique output block, with a key determining which permutation to perform.</p>\n<blockquote>\n<p>A “block” just refers to a fixed number of bits or bytes, which may represent any kind of data. AES processes a block and outputs another block. We’ll be specifically talking the variant of AES which works on 128 bit (16 byte) blocks and a 128 bit key, known as AES-128.</p>\n</blockquote>\n<p>Using the same key, the permutation can be performed in reverse, mapping the output block back to the original input block. It is important that there is a one-to-one correspondence between input and output blocks, otherwise we wouldn’t be able to rely on the ciphertext to decrypt back to the same plaintext we started with.</p>\n<p>What is the mathematical term for a one-to-one correspondence?</p>\n<h3 id=\"Analyze\"><a href=\"#Analyze\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>喔这题简单，我不知道但 Google 知道，浅搜一下”一一对应的数学术语“，知道叫双射函数，浅浅上个百科，就知道英语咯。</p>\n<h2 id=\"Resisting-Bruteforce\"><a href=\"#Resisting-Bruteforce\" class=\"headerlink\" title=\"Resisting Bruteforce\"></a>Resisting Bruteforce</h2><h3 id=\"Description-1\"><a href=\"#Description-1\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>If a block cipher is secure, there should be no way for an attacker to distinguish the output of AES from a <a href=\"https://en.wikipedia.org/wiki/Pseudorandom_permutation\">random permutation</a> of bits. Furthermore, there should be no better way to undo the permutation than simply bruteforcing every possible key. That’s why academics consider a cipher theoretically “broken” if they can find an attack that takes fewer steps to perform than bruteforcing the key, even if that attack is practically infeasible.</p>\n<blockquote>\n<p>How difficult is it to bruteforce a 128-bit keyspace? <a href=\"https://crypto.stackexchange.com/a/48669\">Somebody estimated</a> that if you turned the power of the entire Bitcoin mining network against an AES-128 key, it would take over a hundred times the age of the universe to crack the key.</p>\n</blockquote>\n<p>It turns out that there is <a href=\"https://en.wikipedia.org/wiki/Biclique_attack\">an attack</a> on AES that’s better than bruteforce, but only slightly – it lowers the security level of AES-128 down to 126.1 bits, and hasn’t been improved on for over 8 years. Given the large “security margin” provided by 128 bits, and the lack of improvements despite extensive study, it’s not considered a credible risk to the security of AES. But yes, in a very narrow sense, it “breaks” AES.</p>\n<p>Finally, while quantum computers have the potential to completely break popular public-key cryptosystems like RSA via <a href=\"https://en.wikipedia.org/wiki/Shor's_algorithm\">Shor’s algorithm</a>, they are thought to only cut in half the security level of symmetric cryptosystems via <a href=\"https://en.wikipedia.org/wiki/Grover's_algorithm\">Grover’s algorithm</a>. This is one reason why people recommend using AES-256, despite it being less performant, as it would still provide a very adequate 128 bits of security in a quantum future.</p>\n<p>What is the name for the best single-key attack against AES?</p>\n<h3 id=\"Analyze-1\"><a href=\"#Analyze-1\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>虽然但是，依然去查了 Google，靠谱！</p>\n<p>不过发现网上搜 biclique 的结果居然不是很多，我打开方式有问题吗是，后面再看看。</p>\n<h2 id=\"Structure-of-AES\"><a href=\"#Structure-of-AES\" class=\"headerlink\" title=\"Structure of AES\"></a>Structure of AES</h2><h3 id=\"Description-2\"><a href=\"#Description-2\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>To achieve a keyed permutation that is infeasible to invert without the key, AES applies a large number of ad-hoc mixing operations on the input. This is in stark contrast to public-key cryptosystems like RSA, which are based on elegant individual mathematical problems. AES is much less elegant, but it’s very fast.</p>\n<p>At a high level, AES-128 begins with a “key schedule” and then runs 10 rounds over a state. The starting state is just the plaintext block that we want to encrypt, represented as a 4x4 matrix of bytes. Over the course of the 10 rounds, the state is repeatedly modified by a number of invertible transformations.</p>\n<blockquote>\n<p>Each transformation step has a defined purpose based on theoretical properties of secure ciphers established by Claude Shannon in the 1940s. We’ll look closer at each of these in the following challenges.</p>\n</blockquote>\n<p>Here’s an overview of the phases of AES encryption:</p>\n<p><img src=\"https://cryptohack.org/static/img/aes/Structure.png\" alt=\"diagram showing AES rounds\"></p>\n<ol>\n<li><strong>KeyExpansion</strong> or Key Schedule</li>\n</ol>\n<p> From the 128 bit key, 11 separate 128 bit “round keys” are derived: one to be used in each AddRoundKey step.</p>\n<ol start=\"2\">\n<li><strong>Initial key addition</strong></li>\n</ol>\n<p> <em>AddRoundKey</em> - the bytes of the first round key are XOR’d with the bytes of the state.</p>\n<ol start=\"3\">\n<li><strong>Round</strong> - this phase is looped 10 times, for 9 main rounds plus one “final round”</li>\n</ol>\n<p> \ta) <em>SubBytes</em> - each byte of the state is substituted for a different byte according to a lookup table (“S-box”).</p>\n<p>​\t b) <em>ShiftRows</em> - the last three rows of the state matrix are transposed—shifted over a column or two or three.</p>\n<p>​\t c) <em>MixColumns</em> - matrix multiplication is performed on the columns of the state, combining the four bytes in each column. This is skipped in the final round.</p>\n<p>​\t d) <em>AddRoundKey</em> - the bytes of the current round key are XOR’d with the bytes of the state.</p>\n<p>Included is a <code>bytes2matrix</code> function for converting our initial plaintext block into a state matrix. Write a <code>matrix2bytes</code> function to turn that matrix back into bytes, and submit the resulting plaintext as the flag.</p>\n<h3 id=\"Analyze-2\"><a href=\"#Analyze-2\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>这题我会！</p>\n<p>补全 matrix2bytes()，直接用 sum() 把矩阵压缩成一维列表，然后转字节输出。</p>\n<p>补全函数的题比自己写代码的简单多了（bushi</p>\n<h3 id=\"Code\"><a href=\"#Code\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">bytes2matrix</span>(<span class=\"params\">text</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot; Converts a 16-byte array into a 4x4 matrix.  &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> [<span class=\"built_in\">list</span>(text[i:i+<span class=\"number\">4</span>]) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(text), <span class=\"number\">4</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">matrix2bytes</span>(<span class=\"params\">matrix</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array.  &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">bytes</span>(<span class=\"built_in\">sum</span>(matrix, []))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">matrix = [</span><br><span class=\"line\">    [<span class=\"number\">99</span>, <span class=\"number\">114</span>, <span class=\"number\">121</span>, <span class=\"number\">112</span>],</span><br><span class=\"line\">    [<span class=\"number\">116</span>, <span class=\"number\">111</span>, <span class=\"number\">123</span>, <span class=\"number\">105</span>],</span><br><span class=\"line\">    [<span class=\"number\">110</span>, <span class=\"number\">109</span>, <span class=\"number\">97</span>, <span class=\"number\">116</span>],</span><br><span class=\"line\">    [<span class=\"number\">114</span>, <span class=\"number\">105</span>, <span class=\"number\">120</span>, <span class=\"number\">125</span>],</span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(matrix2bytes(matrix))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp\"><a href=\"#SumUp\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># function</span></span><br><span class=\"line\"><span class=\"built_in\">sum</span>()  <span class=\"comment\"># 把迭代对象里的每一个元素相加。（当元素是列表，就有压平的效果咯）</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Round-Keys\"><a href=\"#Round-Keys\" class=\"headerlink\" title=\"Round Keys\"></a>Round Keys</h2><h3 id=\"Description-3\"><a href=\"#Description-3\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>We’re going to skip over the finer details of the <strong>KeyExpansion</strong> phase for now. The main point is that it takes in our 16 byte key and produces 11 4x4 matrices called “round keys” derived from our initial key. These round keys allow AES to get extra mileage out of the single key that we provided.</p>\n<p>The <strong>initial key addition</strong> phase, which is next, has a single <em>AddRoundKey</em> step. The <em>AddRoundKey</em> step is straightforward: it XORs the current state with the current round key.</p>\n<p><img src=\"https://cryptohack.org/static/img/aes/AddRoundKey.png\" alt=\"diagram showing AddRoundKey\"></p>\n<p><em>AddRoundKey</em> also occurs as the final step of each round. <em>AddRoundKey</em> is what makes AES a “keyed permutation” rather than just a permutation. It’s the only part of AES where the key is mixed into the state, but is crucial for determining the permutation that occurs.</p>\n<p>As you’ve seen in previous challenges, XOR is an easily invertible operation if you know the key, but tough to undo if you don’t. Now imagine trying to recover plaintext which has been XOR’d with 11 different keys, and heavily jumbled between each XOR operation with a series of substitution and transposition ciphers. That’s kinda what AES does! And we’ll see just how effective the jumbling is in the next few challenges.</p>\n<p>Complete the <code>add_round_key</code> function, then use the <code>matrix2bytes</code> function to get your next flag.</p>\n<h3 id=\"Analyze-3\"><a href=\"#Analyze-3\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>遇到异或就搬 pwn.xor()！</p>\n<p>明文经过了 11 个不同的密钥进行异或，再异或回去就可以得到原文。</p>\n<p>返回异或值就 ok。</p>\n<p>感觉异或还是蛮有意思的。</p>\n<h3 id=\"Code-1\"><a href=\"#Code-1\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> xor</span><br><span class=\"line\">state = [</span><br><span class=\"line\">    [<span class=\"number\">206</span>, <span class=\"number\">243</span>, <span class=\"number\">61</span>, <span class=\"number\">34</span>],</span><br><span class=\"line\">    [<span class=\"number\">171</span>, <span class=\"number\">11</span>, <span class=\"number\">93</span>, <span class=\"number\">31</span>],</span><br><span class=\"line\">    [<span class=\"number\">16</span>, <span class=\"number\">200</span>, <span class=\"number\">91</span>, <span class=\"number\">108</span>],</span><br><span class=\"line\">    [<span class=\"number\">150</span>, <span class=\"number\">3</span>, <span class=\"number\">194</span>, <span class=\"number\">51</span>],</span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\">round_key = [</span><br><span class=\"line\">    [<span class=\"number\">173</span>, <span class=\"number\">129</span>, <span class=\"number\">68</span>, <span class=\"number\">82</span>],</span><br><span class=\"line\">    [<span class=\"number\">223</span>, <span class=\"number\">100</span>, <span class=\"number\">38</span>, <span class=\"number\">109</span>],</span><br><span class=\"line\">    [<span class=\"number\">32</span>, <span class=\"number\">189</span>, <span class=\"number\">53</span>, <span class=\"number\">8</span>],</span><br><span class=\"line\">    [<span class=\"number\">253</span>, <span class=\"number\">48</span>, <span class=\"number\">187</span>, <span class=\"number\">78</span>],</span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">add_round_key</span>(<span class=\"params\">s, k</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> xor(s, k)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(add_round_key(state, round_key))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Confusion-through-Substitution\"><a href=\"#Confusion-through-Substitution\" class=\"headerlink\" title=\"Confusion through Substitution\"></a>Confusion through Substitution</h2><h3 id=\"Description-4\"><a href=\"#Description-4\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>The first step of each AES round is <em>SubBytes</em>. This involves taking each byte of the state matrix and substituting it for a different byte in a preset 16x16 lookup table. The lookup table is called a “Substitution box” or “S-box” for short, and can be perplexing at first sight. Let’s break it down.</p>\n<p><img src=\"https://cryptohack.org/static/img/aes/Substitution.png\" alt=\"diagram showing Substitution\"></p>\n<p>In 1945 American mathematician Claude Shannon published a groundbreaking paper on Information Theory. It identified “confusion” as an essential property of a secure cipher. “Confusion” means that the relationship between the ciphertext and the key should be as complex as possible. Given just a ciphertext, there should be no way to learn anything about the key.</p>\n<p>If a cipher has poor confusion, it is possible to express a relationship between ciphertext, key, and plaintext as a linear function. For instance, in a Caesar cipher, <code>ciphertext = plaintext + key</code>. That’s an obvious relation, which is easy to reverse. More complicated linear transformations can be solved using techniques like Gaussian elimination. Even low-degree polynomials, e.g. an equation like <code>x^4 + 51x^3 + x</code>, can be solved efficiently using <a href=\"https://math.stackexchange.com/a/1078515\">algebraic methods</a>. However, the higher the degree of a polynomial, generally the harder it becomes to solve – it can only be approximated by a larger and larger amount of linear functions.</p>\n<p>The main purpose of the S-box is to transform the input in a way that is resistant to being approximated by linear functions. S-boxes are aiming for high <em>non-linearity</em>, and while AES’s one is not perfect, it’s pretty close. The fast lookup in an S-box is a shortcut for performing a very nonlinear function on the input bytes. This function involves taking the modular inverse in the <a href=\"https://www.samiam.org/galois.html\">Galois field 2**8</a> and then applying an affine transformation which has been tweaked for maximum confusion. The simplest way to express the function is through the following high-degree polynomial:</p>\n<p><img src=\"https://cryptohack.org/static/img/aes/SBoxEq.png\" alt=\"diagram showing S-Box equation\"></p>\n<p>To make the S-box, the function has been calculated on all input values from 0x00 to 0xff and the outputs put in the lookup table.</p>\n<p>Implement <code>sub_bytes</code>, send the state matrix through the inverse S-box and then convert it to bytes to get the flag.</p>\n<h3 id=\"Analyze-4\"><a href=\"#Analyze-4\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>意思就是让补全 sub_bytes 函数，然后转换成字节得到 flag。</p>\n<p>其实 state 里面的存的是它每个位置上本来的数据在查找库 sbox 中的序号，所以遍历 state，按序号取出对应的原数据，然后返回字节就好咯。</p>\n<h3 id=\"Code-2\"><a href=\"#Code-2\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 写法一</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">sub_bytes</span>(<span class=\"params\">s, sbox=s_box</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">            s[i][j] = sbox[s[i][j]]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">bytes</span>(<span class=\"built_in\">sum</span>(s, []))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(sub_bytes(state, sbox=inv_s_box))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 写法二</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">matrix2bytes</span>(<span class=\"params\">matrix</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array.  &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">bytes</span>(<span class=\"built_in\">sum</span>(matrix, []))</span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">sub_bytes</span>(<span class=\"params\">s, sbox=s_box</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">            s[i][j] = sbox[s[i][j]]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> s</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(matrix2bytes(sub_bytes(state, sbox=inv_s_box)))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-1\"><a href=\"#SumUp-1\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><p>两种写法怎么说呢，第一种更简洁明了，看起来好像也更优雅。</p>\n<p>第二种虽然搬过来了 matrix2bytes() 函数（也可以不搬函数直接一行搞定，不过读起来费劲点），看起来更繁琐，不过这种写法更不容易吃亏（在最后一题已经深刻体会过了）。所以本来是喜欢第一种写法的，做完最后一题之后还是喜欢第二种了。</p>\n<p>（呜呜呜我也不想被钓啊，可是它解题更好用诶）。</p>\n<h2 id=\"Diffusion-through-Permutation\"><a href=\"#Diffusion-through-Permutation\" class=\"headerlink\" title=\"Diffusion through Permutation\"></a>Diffusion through Permutation</h2><h3 id=\"Description-5\"><a href=\"#Description-5\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>We’ve seen how S-box substitution provides confusion. The other crucial property described by Shannon is “diffusion”. This relates to how every part of a cipher’s input should spread to every part of the output.</p>\n<p>Substitution on its own creates non-linearity, however it doesn’t distribute it over the entire state. Without diffusion, the same byte in the same position would get the same transformations applied to it each round. This would allow cryptanalysts to attack each byte position in the state matrix separately. We need to alternate substitutions by scrambling the state (in an invertible way) so that substitutions applied on one byte influence all other bytes in the state. Each input into the next S-box then becomes a function of multiple bytes, meaning that with every round the algebraic complexity of the system increases enormously.</p>\n<blockquote>\n<p>An ideal amount of diffusion causes a change of one bit in the plaintext to lead to a change in statistically half the bits of the ciphertext. This desirable outcome is called the <a href=\"https://en.wikipedia.org/wiki/Avalanche_effect\">Avalanche effect</a>.</p>\n</blockquote>\n<p>The <em>ShiftRows</em> and <em>MixColumns</em> steps combine to achieve this. They work together to ensure every byte affects every other byte in the state within just two rounds.</p>\n<p><em>ShiftRows</em> is the most simple transformation in AES. It keeps the first row of the state matrix the same. The second row is shifted over one column to the left, wrapping around. The third row is shifted two columns, the fourth row by three. Wikipedia puts it nicely: “the importance of this step is to avoid the columns being encrypted independently, in which case AES degenerates into four independent block ciphers.”</p>\n<p><img src=\"https://cryptohack.org/static/img/aes/ShiftRows.png\" alt=\"diagram showing ShiftRows\"></p>\n<p><em>MixColumns</em> is more complex. It performs Matrix multiplication in Rijndael’s Galois field between the columns of the state matrix and a preset matrix. Each single byte of each column therefore affects all the bytes of the resulting column. The implementation details are nuanced; <a href=\"https://www.samiam.org/mix-column.html\">this page</a> and <a href=\"https://en.wikipedia.org/wiki/Rijndael_MixColumns\">Wikipedia</a> do a good job of covering them.</p>\n<p><img src=\"https://cryptohack.org/static/img/aes/MixColumns.png\" alt=\"diagram showing MixColumns\"></p>\n<p>We’ve provided code to perform MixColumns and the forward ShiftRows operation. After implementing <code>inv_shift_rows</code>, take the state, run <code>inv_mix_columns</code> on it, then <code>inv_shift_rows</code>, convert to bytes and you will have your flag.</p>\n<h3 id=\"Analyze-5\"><a href=\"#Analyze-5\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>首先是补全 inv_shift_rows()，参考 shift_rows()，发现是给第 n 行向左移动 n 个单位 ，那 inv_shift_rows 就给第 n 行向右移动 n 个单位。</p>\n<p>然后根据 description 依次运行 <code>inv_mix_columns(state)</code> <code>inv_shift_rows(state)</code>，然后把前面用过的矩阵转字节的函数 matrix2bytes() 搬过来，输出一下。</p>\n<h3 id=\"Code-3\"><a href=\"#Code-3\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">inv_shift_rows</span>(<span class=\"params\">s</span>):</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">1</span>], s[<span class=\"number\">1</span>][<span class=\"number\">1</span>], s[<span class=\"number\">2</span>][<span class=\"number\">1</span>], s[<span class=\"number\">3</span>][<span class=\"number\">1</span>] = s[<span class=\"number\">3</span>][<span class=\"number\">1</span>], s[<span class=\"number\">0</span>][<span class=\"number\">1</span>], s[<span class=\"number\">1</span>][<span class=\"number\">1</span>], s[<span class=\"number\">2</span>][<span class=\"number\">1</span>]</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">2</span>], s[<span class=\"number\">1</span>][<span class=\"number\">2</span>], s[<span class=\"number\">2</span>][<span class=\"number\">2</span>], s[<span class=\"number\">3</span>][<span class=\"number\">2</span>] = s[<span class=\"number\">2</span>][<span class=\"number\">2</span>], s[<span class=\"number\">3</span>][<span class=\"number\">2</span>], s[<span class=\"number\">0</span>][<span class=\"number\">2</span>], s[<span class=\"number\">1</span>][<span class=\"number\">2</span>]</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">3</span>], s[<span class=\"number\">1</span>][<span class=\"number\">3</span>], s[<span class=\"number\">2</span>][<span class=\"number\">3</span>], s[<span class=\"number\">3</span>][<span class=\"number\">3</span>] = s[<span class=\"number\">1</span>][<span class=\"number\">3</span>], s[<span class=\"number\">2</span>][<span class=\"number\">3</span>], s[<span class=\"number\">3</span>][<span class=\"number\">3</span>], s[<span class=\"number\">0</span>][<span class=\"number\">3</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">matrix2bytes</span>(<span class=\"params\">matrix</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array.  &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">bytes</span>(<span class=\"built_in\">sum</span>(matrix, []))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">inv_mix_columns(state)</span><br><span class=\"line\">inv_shift_rows(state)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(matrix2bytes(state))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Bringing-It-All-Together\"><a href=\"#Bringing-It-All-Together\" class=\"headerlink\" title=\"Bringing It All Together\"></a>Bringing It All Together</h2><h3 id=\"Description-6\"><a href=\"#Description-6\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Apart from the <strong>KeyExpansion</strong> phase, we’ve sketched out all the components of AES. We’ve shown how <em>SubBytes</em> provides confusion and <em>ShiftRows</em> and <em>MixColumns</em> provide diffusion, and how these two properties work together to repeatedly circulate non-linear transformations over the state. Finally, <em>AddRoundKey</em> seeds the key into this substitution-permutation network, making the cipher a keyed permutation.</p>\n<p>Decryption involves performing the steps described in the “Structure of AES” challenge in reverse, applying the inverse operations. Note that the KeyExpansion still needs to be run first, and the round keys will be used in reverse order. <em>AddRoundKey</em> and its inverse are identical as XOR has the self-inverse property.</p>\n<p><img src=\"https://cryptohack.org/static/img/aes/Structure2.png\" alt=\"diagram showing AES decryption\"></p>\n<p>We’ve provided the key expansion code, and ciphertext that’s been properly encrypted by AES-128. Copy in all the building blocks you’ve coded so far, and complete the <code>decrypt</code> function that implements the steps shown in the diagram. The decrypted plaintext is the flag.</p>\n<p>Yes, you can cheat on this challenge, but where’s the fun in that?</p>\n<p>The code used in these exercises has been taken from Bo Zhu’s super simple Python AES implementation, so we’ve reproduced the license here.</p>\n<h3 id=\"Analyze-6\"><a href=\"#Analyze-6\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>这题最头疼了，开始没明白到底要啥，看了半天发现是要补全好几处代码，而且给的 .py 文件还各种报错，很烦反正。</p>\n<p>后面发现这是 AES 基础的最后一道相当于总结的题，就直接把前面几道题用到的函数和矩阵啥的全粘过来了，然后看了看有注释但没代码的地方，几乎是把前几个文件的代码拼到一起咯。然后基本就是一个完整的 AES。</p>\n<p>还有，前面有一道题提到用了 pwn 库的 xor() 函数，现在想给自己埋咯。</p>\n<p>最后代码一直报错，看了看日志，手写了一下 xor，居然就很顺利了？</p>\n<p>把 pwn 库埋咯！</p>\n<p>（因为这题需要自己写的代码分布比较零散，找起来也比较麻烦，所以干脆把全部代码贴上来。）</p>\n<h3 id=\"Code-4\"><a href=\"#Code-4\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">N_ROUNDS = <span class=\"number\">10</span></span><br><span class=\"line\"></span><br><span class=\"line\">key = <span class=\"string\">b&#x27;\\xc3,\\\\\\xa6\\xb5\\x80^\\x0c\\xdb\\x8d\\xa5z*\\xb6\\xfe\\\\&#x27;</span></span><br><span class=\"line\">ciphertext = <span class=\"string\">b&#x27;\\xd1O\\x14j\\xa4+O\\xb6\\xa1\\xc4\\x08B)\\x8f\\x12\\xdd&#x27;</span></span><br><span class=\"line\">s_box = (</span><br><span class=\"line\">    <span class=\"number\">0x63</span>, <span class=\"number\">0x7C</span>, <span class=\"number\">0x77</span>, <span class=\"number\">0x7B</span>, <span class=\"number\">0xF2</span>, <span class=\"number\">0x6B</span>, <span class=\"number\">0x6F</span>, <span class=\"number\">0xC5</span>, <span class=\"number\">0x30</span>, <span class=\"number\">0x01</span>, <span class=\"number\">0x67</span>, <span class=\"number\">0x2B</span>, <span class=\"number\">0xFE</span>, <span class=\"number\">0xD7</span>, <span class=\"number\">0xAB</span>, <span class=\"number\">0x76</span>,</span><br><span class=\"line\">    <span class=\"number\">0xCA</span>, <span class=\"number\">0x82</span>, <span class=\"number\">0xC9</span>, <span class=\"number\">0x7D</span>, <span class=\"number\">0xFA</span>, <span class=\"number\">0x59</span>, <span class=\"number\">0x47</span>, <span class=\"number\">0xF0</span>, <span class=\"number\">0xAD</span>, <span class=\"number\">0xD4</span>, <span class=\"number\">0xA2</span>, <span class=\"number\">0xAF</span>, <span class=\"number\">0x9C</span>, <span class=\"number\">0xA4</span>, <span class=\"number\">0x72</span>, <span class=\"number\">0xC0</span>,</span><br><span class=\"line\">    <span class=\"number\">0xB7</span>, <span class=\"number\">0xFD</span>, <span class=\"number\">0x93</span>, <span class=\"number\">0x26</span>, <span class=\"number\">0x36</span>, <span class=\"number\">0x3F</span>, <span class=\"number\">0xF7</span>, <span class=\"number\">0xCC</span>, <span class=\"number\">0x34</span>, <span class=\"number\">0xA5</span>, <span class=\"number\">0xE5</span>, <span class=\"number\">0xF1</span>, <span class=\"number\">0x71</span>, <span class=\"number\">0xD8</span>, <span class=\"number\">0x31</span>, <span class=\"number\">0x15</span>,</span><br><span class=\"line\">    <span class=\"number\">0x04</span>, <span class=\"number\">0xC7</span>, <span class=\"number\">0x23</span>, <span class=\"number\">0xC3</span>, <span class=\"number\">0x18</span>, <span class=\"number\">0x96</span>, <span class=\"number\">0x05</span>, <span class=\"number\">0x9A</span>, <span class=\"number\">0x07</span>, <span class=\"number\">0x12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0xE2</span>, <span class=\"number\">0xEB</span>, <span class=\"number\">0x27</span>, <span class=\"number\">0xB2</span>, <span class=\"number\">0x75</span>,</span><br><span class=\"line\">    <span class=\"number\">0x09</span>, <span class=\"number\">0x83</span>, <span class=\"number\">0x2C</span>, <span class=\"number\">0x1A</span>, <span class=\"number\">0x1B</span>, <span class=\"number\">0x6E</span>, <span class=\"number\">0x5A</span>, <span class=\"number\">0xA0</span>, <span class=\"number\">0x52</span>, <span class=\"number\">0x3B</span>, <span class=\"number\">0xD6</span>, <span class=\"number\">0xB3</span>, <span class=\"number\">0x29</span>, <span class=\"number\">0xE3</span>, <span class=\"number\">0x2F</span>, <span class=\"number\">0x84</span>,</span><br><span class=\"line\">    <span class=\"number\">0x53</span>, <span class=\"number\">0xD1</span>, <span class=\"number\">0x00</span>, <span class=\"number\">0xED</span>, <span class=\"number\">0x20</span>, <span class=\"number\">0xFC</span>, <span class=\"number\">0xB1</span>, <span class=\"number\">0x5B</span>, <span class=\"number\">0x6A</span>, <span class=\"number\">0xCB</span>, <span class=\"number\">0xBE</span>, <span class=\"number\">0x39</span>, <span class=\"number\">0x4A</span>, <span class=\"number\">0x4C</span>, <span class=\"number\">0x58</span>, <span class=\"number\">0xCF</span>,</span><br><span class=\"line\">    <span class=\"number\">0xD0</span>, <span class=\"number\">0xEF</span>, <span class=\"number\">0xAA</span>, <span class=\"number\">0xFB</span>, <span class=\"number\">0x43</span>, <span class=\"number\">0x4D</span>, <span class=\"number\">0x33</span>, <span class=\"number\">0x85</span>, <span class=\"number\">0x45</span>, <span class=\"number\">0xF9</span>, <span class=\"number\">0x02</span>, <span class=\"number\">0x7F</span>, <span class=\"number\">0x50</span>, <span class=\"number\">0x3C</span>, <span class=\"number\">0x9F</span>, <span class=\"number\">0xA8</span>,</span><br><span class=\"line\">    <span class=\"number\">0x51</span>, <span class=\"number\">0xA3</span>, <span class=\"number\">0x40</span>, <span class=\"number\">0x8F</span>, <span class=\"number\">0x92</span>, <span class=\"number\">0x9D</span>, <span class=\"number\">0x38</span>, <span class=\"number\">0xF5</span>, <span class=\"number\">0xBC</span>, <span class=\"number\">0xB6</span>, <span class=\"number\">0xDA</span>, <span class=\"number\">0x21</span>, <span class=\"number\">0x10</span>, <span class=\"number\">0xFF</span>, <span class=\"number\">0xF3</span>, <span class=\"number\">0xD2</span>,</span><br><span class=\"line\">    <span class=\"number\">0xCD</span>, <span class=\"number\">0x0C</span>, <span class=\"number\">0x13</span>, <span class=\"number\">0xEC</span>, <span class=\"number\">0x5F</span>, <span class=\"number\">0x97</span>, <span class=\"number\">0x44</span>, <span class=\"number\">0x17</span>, <span class=\"number\">0xC4</span>, <span class=\"number\">0xA7</span>, <span class=\"number\">0x7E</span>, <span class=\"number\">0x3D</span>, <span class=\"number\">0x64</span>, <span class=\"number\">0x5D</span>, <span class=\"number\">0x19</span>, <span class=\"number\">0x73</span>,</span><br><span class=\"line\">    <span class=\"number\">0x60</span>, <span class=\"number\">0x81</span>, <span class=\"number\">0x4F</span>, <span class=\"number\">0xDC</span>, <span class=\"number\">0x22</span>, <span class=\"number\">0x2A</span>, <span class=\"number\">0x90</span>, <span class=\"number\">0x88</span>, <span class=\"number\">0x46</span>, <span class=\"number\">0xEE</span>, <span class=\"number\">0xB8</span>, <span class=\"number\">0x14</span>, <span class=\"number\">0xDE</span>, <span class=\"number\">0x5E</span>, <span class=\"number\">0x0B</span>, <span class=\"number\">0xDB</span>,</span><br><span class=\"line\">    <span class=\"number\">0xE0</span>, <span class=\"number\">0x32</span>, <span class=\"number\">0x3A</span>, <span class=\"number\">0x0A</span>, <span class=\"number\">0x49</span>, <span class=\"number\">0x06</span>, <span class=\"number\">0x24</span>, <span class=\"number\">0x5C</span>, <span class=\"number\">0xC2</span>, <span class=\"number\">0xD3</span>, <span class=\"number\">0xAC</span>, <span class=\"number\">0x62</span>, <span class=\"number\">0x91</span>, <span class=\"number\">0x95</span>, <span class=\"number\">0xE4</span>, <span class=\"number\">0x79</span>,</span><br><span class=\"line\">    <span class=\"number\">0xE7</span>, <span class=\"number\">0xC8</span>, <span class=\"number\">0x37</span>, <span class=\"number\">0x6D</span>, <span class=\"number\">0x8D</span>, <span class=\"number\">0xD5</span>, <span class=\"number\">0x4E</span>, <span class=\"number\">0xA9</span>, <span class=\"number\">0x6C</span>, <span class=\"number\">0x56</span>, <span class=\"number\">0xF4</span>, <span class=\"number\">0xEA</span>, <span class=\"number\">0x65</span>, <span class=\"number\">0x7A</span>, <span class=\"number\">0xAE</span>, <span class=\"number\">0x08</span>,</span><br><span class=\"line\">    <span class=\"number\">0xBA</span>, <span class=\"number\">0x78</span>, <span class=\"number\">0x25</span>, <span class=\"number\">0x2E</span>, <span class=\"number\">0x1C</span>, <span class=\"number\">0xA6</span>, <span class=\"number\">0xB4</span>, <span class=\"number\">0xC6</span>, <span class=\"number\">0xE8</span>, <span class=\"number\">0xDD</span>, <span class=\"number\">0x74</span>, <span class=\"number\">0x1F</span>, <span class=\"number\">0x4B</span>, <span class=\"number\">0xBD</span>, <span class=\"number\">0x8B</span>, <span class=\"number\">0x8A</span>,</span><br><span class=\"line\">    <span class=\"number\">0x70</span>, <span class=\"number\">0x3E</span>, <span class=\"number\">0xB5</span>, <span class=\"number\">0x66</span>, <span class=\"number\">0x48</span>, <span class=\"number\">0x03</span>, <span class=\"number\">0xF6</span>, <span class=\"number\">0x0E</span>, <span class=\"number\">0x61</span>, <span class=\"number\">0x35</span>, <span class=\"number\">0x57</span>, <span class=\"number\">0xB9</span>, <span class=\"number\">0x86</span>, <span class=\"number\">0xC1</span>, <span class=\"number\">0x1D</span>, <span class=\"number\">0x9E</span>,</span><br><span class=\"line\">    <span class=\"number\">0xE1</span>, <span class=\"number\">0xF8</span>, <span class=\"number\">0x98</span>, <span class=\"number\">0x11</span>, <span class=\"number\">0x69</span>, <span class=\"number\">0xD9</span>, <span class=\"number\">0x8E</span>, <span class=\"number\">0x94</span>, <span class=\"number\">0x9B</span>, <span class=\"number\">0x1E</span>, <span class=\"number\">0x87</span>, <span class=\"number\">0xE9</span>, <span class=\"number\">0xCE</span>, <span class=\"number\">0x55</span>, <span class=\"number\">0x28</span>, <span class=\"number\">0xDF</span>,</span><br><span class=\"line\">    <span class=\"number\">0x8C</span>, <span class=\"number\">0xA1</span>, <span class=\"number\">0x89</span>, <span class=\"number\">0x0D</span>, <span class=\"number\">0xBF</span>, <span class=\"number\">0xE6</span>, <span class=\"number\">0x42</span>, <span class=\"number\">0x68</span>, <span class=\"number\">0x41</span>, <span class=\"number\">0x99</span>, <span class=\"number\">0x2D</span>, <span class=\"number\">0x0F</span>, <span class=\"number\">0xB0</span>, <span class=\"number\">0x54</span>, <span class=\"number\">0xBB</span>, <span class=\"number\">0x16</span>,</span><br><span class=\"line\">)</span><br><span class=\"line\">inv_s_box = (</span><br><span class=\"line\">    <span class=\"number\">0x52</span>, <span class=\"number\">0x09</span>, <span class=\"number\">0x6A</span>, <span class=\"number\">0xD5</span>, <span class=\"number\">0x30</span>, <span class=\"number\">0x36</span>, <span class=\"number\">0xA5</span>, <span class=\"number\">0x38</span>, <span class=\"number\">0xBF</span>, <span class=\"number\">0x40</span>, <span class=\"number\">0xA3</span>, <span class=\"number\">0x9E</span>, <span class=\"number\">0x81</span>, <span class=\"number\">0xF3</span>, <span class=\"number\">0xD7</span>, <span class=\"number\">0xFB</span>,</span><br><span class=\"line\">    <span class=\"number\">0x7C</span>, <span class=\"number\">0xE3</span>, <span class=\"number\">0x39</span>, <span class=\"number\">0x82</span>, <span class=\"number\">0x9B</span>, <span class=\"number\">0x2F</span>, <span class=\"number\">0xFF</span>, <span class=\"number\">0x87</span>, <span class=\"number\">0x34</span>, <span class=\"number\">0x8E</span>, <span class=\"number\">0x43</span>, <span class=\"number\">0x44</span>, <span class=\"number\">0xC4</span>, <span class=\"number\">0xDE</span>, <span class=\"number\">0xE9</span>, <span class=\"number\">0xCB</span>,</span><br><span class=\"line\">    <span class=\"number\">0x54</span>, <span class=\"number\">0x7B</span>, <span class=\"number\">0x94</span>, <span class=\"number\">0x32</span>, <span class=\"number\">0xA6</span>, <span class=\"number\">0xC2</span>, <span class=\"number\">0x23</span>, <span class=\"number\">0x3D</span>, <span class=\"number\">0xEE</span>, <span class=\"number\">0x4C</span>, <span class=\"number\">0x95</span>, <span class=\"number\">0x0B</span>, <span class=\"number\">0x42</span>, <span class=\"number\">0xFA</span>, <span class=\"number\">0xC3</span>, <span class=\"number\">0x4E</span>,</span><br><span class=\"line\">    <span class=\"number\">0x08</span>, <span class=\"number\">0x2E</span>, <span class=\"number\">0xA1</span>, <span class=\"number\">0x66</span>, <span class=\"number\">0x28</span>, <span class=\"number\">0xD9</span>, <span class=\"number\">0x24</span>, <span class=\"number\">0xB2</span>, <span class=\"number\">0x76</span>, <span class=\"number\">0x5B</span>, <span class=\"number\">0xA2</span>, <span class=\"number\">0x49</span>, <span class=\"number\">0x6D</span>, <span class=\"number\">0x8B</span>, <span class=\"number\">0xD1</span>, <span class=\"number\">0x25</span>,</span><br><span class=\"line\">    <span class=\"number\">0x72</span>, <span class=\"number\">0xF8</span>, <span class=\"number\">0xF6</span>, <span class=\"number\">0x64</span>, <span class=\"number\">0x86</span>, <span class=\"number\">0x68</span>, <span class=\"number\">0x98</span>, <span class=\"number\">0x16</span>, <span class=\"number\">0xD4</span>, <span class=\"number\">0xA4</span>, <span class=\"number\">0x5C</span>, <span class=\"number\">0xCC</span>, <span class=\"number\">0x5D</span>, <span class=\"number\">0x65</span>, <span class=\"number\">0xB6</span>, <span class=\"number\">0x92</span>,</span><br><span class=\"line\">    <span class=\"number\">0x6C</span>, <span class=\"number\">0x70</span>, <span class=\"number\">0x48</span>, <span class=\"number\">0x50</span>, <span class=\"number\">0xFD</span>, <span class=\"number\">0xED</span>, <span class=\"number\">0xB9</span>, <span class=\"number\">0xDA</span>, <span class=\"number\">0x5E</span>, <span class=\"number\">0x15</span>, <span class=\"number\">0x46</span>, <span class=\"number\">0x57</span>, <span class=\"number\">0xA7</span>, <span class=\"number\">0x8D</span>, <span class=\"number\">0x9D</span>, <span class=\"number\">0x84</span>,</span><br><span class=\"line\">    <span class=\"number\">0x90</span>, <span class=\"number\">0xD8</span>, <span class=\"number\">0xAB</span>, <span class=\"number\">0x00</span>, <span class=\"number\">0x8C</span>, <span class=\"number\">0xBC</span>, <span class=\"number\">0xD3</span>, <span class=\"number\">0x0A</span>, <span class=\"number\">0xF7</span>, <span class=\"number\">0xE4</span>, <span class=\"number\">0x58</span>, <span class=\"number\">0x05</span>, <span class=\"number\">0xB8</span>, <span class=\"number\">0xB3</span>, <span class=\"number\">0x45</span>, <span class=\"number\">0x06</span>,</span><br><span class=\"line\">    <span class=\"number\">0xD0</span>, <span class=\"number\">0x2C</span>, <span class=\"number\">0x1E</span>, <span class=\"number\">0x8F</span>, <span class=\"number\">0xCA</span>, <span class=\"number\">0x3F</span>, <span class=\"number\">0x0F</span>, <span class=\"number\">0x02</span>, <span class=\"number\">0xC1</span>, <span class=\"number\">0xAF</span>, <span class=\"number\">0xBD</span>, <span class=\"number\">0x03</span>, <span class=\"number\">0x01</span>, <span class=\"number\">0x13</span>, <span class=\"number\">0x8A</span>, <span class=\"number\">0x6B</span>,</span><br><span class=\"line\">    <span class=\"number\">0x3A</span>, <span class=\"number\">0x91</span>, <span class=\"number\">0x11</span>, <span class=\"number\">0x41</span>, <span class=\"number\">0x4F</span>, <span class=\"number\">0x67</span>, <span class=\"number\">0xDC</span>, <span class=\"number\">0xEA</span>, <span class=\"number\">0x97</span>, <span class=\"number\">0xF2</span>, <span class=\"number\">0xCF</span>, <span class=\"number\">0xCE</span>, <span class=\"number\">0xF0</span>, <span class=\"number\">0xB4</span>, <span class=\"number\">0xE6</span>, <span class=\"number\">0x73</span>,</span><br><span class=\"line\">    <span class=\"number\">0x96</span>, <span class=\"number\">0xAC</span>, <span class=\"number\">0x74</span>, <span class=\"number\">0x22</span>, <span class=\"number\">0xE7</span>, <span class=\"number\">0xAD</span>, <span class=\"number\">0x35</span>, <span class=\"number\">0x85</span>, <span class=\"number\">0xE2</span>, <span class=\"number\">0xF9</span>, <span class=\"number\">0x37</span>, <span class=\"number\">0xE8</span>, <span class=\"number\">0x1C</span>, <span class=\"number\">0x75</span>, <span class=\"number\">0xDF</span>, <span class=\"number\">0x6E</span>,</span><br><span class=\"line\">    <span class=\"number\">0x47</span>, <span class=\"number\">0xF1</span>, <span class=\"number\">0x1A</span>, <span class=\"number\">0x71</span>, <span class=\"number\">0x1D</span>, <span class=\"number\">0x29</span>, <span class=\"number\">0xC5</span>, <span class=\"number\">0x89</span>, <span class=\"number\">0x6F</span>, <span class=\"number\">0xB7</span>, <span class=\"number\">0x62</span>, <span class=\"number\">0x0E</span>, <span class=\"number\">0xAA</span>, <span class=\"number\">0x18</span>, <span class=\"number\">0xBE</span>, <span class=\"number\">0x1B</span>,</span><br><span class=\"line\">    <span class=\"number\">0xFC</span>, <span class=\"number\">0x56</span>, <span class=\"number\">0x3E</span>, <span class=\"number\">0x4B</span>, <span class=\"number\">0xC6</span>, <span class=\"number\">0xD2</span>, <span class=\"number\">0x79</span>, <span class=\"number\">0x20</span>, <span class=\"number\">0x9A</span>, <span class=\"number\">0xDB</span>, <span class=\"number\">0xC0</span>, <span class=\"number\">0xFE</span>, <span class=\"number\">0x78</span>, <span class=\"number\">0xCD</span>, <span class=\"number\">0x5A</span>, <span class=\"number\">0xF4</span>,</span><br><span class=\"line\">    <span class=\"number\">0x1F</span>, <span class=\"number\">0xDD</span>, <span class=\"number\">0xA8</span>, <span class=\"number\">0x33</span>, <span class=\"number\">0x88</span>, <span class=\"number\">0x07</span>, <span class=\"number\">0xC7</span>, <span class=\"number\">0x31</span>, <span class=\"number\">0xB1</span>, <span class=\"number\">0x12</span>, <span class=\"number\">0x10</span>, <span class=\"number\">0x59</span>, <span class=\"number\">0x27</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0xEC</span>, <span class=\"number\">0x5F</span>,</span><br><span class=\"line\">    <span class=\"number\">0x60</span>, <span class=\"number\">0x51</span>, <span class=\"number\">0x7F</span>, <span class=\"number\">0xA9</span>, <span class=\"number\">0x19</span>, <span class=\"number\">0xB5</span>, <span class=\"number\">0x4A</span>, <span class=\"number\">0x0D</span>, <span class=\"number\">0x2D</span>, <span class=\"number\">0xE5</span>, <span class=\"number\">0x7A</span>, <span class=\"number\">0x9F</span>, <span class=\"number\">0x93</span>, <span class=\"number\">0xC9</span>, <span class=\"number\">0x9C</span>, <span class=\"number\">0xEF</span>,</span><br><span class=\"line\">    <span class=\"number\">0xA0</span>, <span class=\"number\">0xE0</span>, <span class=\"number\">0x3B</span>, <span class=\"number\">0x4D</span>, <span class=\"number\">0xAE</span>, <span class=\"number\">0x2A</span>, <span class=\"number\">0xF5</span>, <span class=\"number\">0xB0</span>, <span class=\"number\">0xC8</span>, <span class=\"number\">0xEB</span>, <span class=\"number\">0xBB</span>, <span class=\"number\">0x3C</span>, <span class=\"number\">0x83</span>, <span class=\"number\">0x53</span>, <span class=\"number\">0x99</span>, <span class=\"number\">0x61</span>,</span><br><span class=\"line\">    <span class=\"number\">0x17</span>, <span class=\"number\">0x2B</span>, <span class=\"number\">0x04</span>, <span class=\"number\">0x7E</span>, <span class=\"number\">0xBA</span>, <span class=\"number\">0x77</span>, <span class=\"number\">0xD6</span>, <span class=\"number\">0x26</span>, <span class=\"number\">0xE1</span>, <span class=\"number\">0x69</span>, <span class=\"number\">0x14</span>, <span class=\"number\">0x63</span>, <span class=\"number\">0x55</span>, <span class=\"number\">0x21</span>, <span class=\"number\">0x0C</span>, <span class=\"number\">0x7D</span>,</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">bytes2matrix</span>(<span class=\"params\">text</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot; Converts a 16-byte array into a 4x4 matrix.  &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> [<span class=\"built_in\">list</span>(text[i:i+<span class=\"number\">4</span>]) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(text), <span class=\"number\">4</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">matrix2bytes</span>(<span class=\"params\">matrix</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array.  &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">bytes</span>(<span class=\"built_in\">sum</span>(matrix, []))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">add_round_key</span>(<span class=\"params\">s, k</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [</span><br><span class=\"line\">        [s[i][j] ^ k[i][j] <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>)]</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>)</span><br><span class=\"line\">    ]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">sub_bytes</span>(<span class=\"params\">s, sbox=s_box</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">            s[i][j] = sbox[s[i][j]]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> s</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">shift_rows</span>(<span class=\"params\">s</span>):</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">1</span>], s[<span class=\"number\">1</span>][<span class=\"number\">1</span>], s[<span class=\"number\">2</span>][<span class=\"number\">1</span>], s[<span class=\"number\">3</span>][<span class=\"number\">1</span>] = s[<span class=\"number\">1</span>][<span class=\"number\">1</span>], s[<span class=\"number\">2</span>][<span class=\"number\">1</span>], s[<span class=\"number\">3</span>][<span class=\"number\">1</span>], s[<span class=\"number\">0</span>][<span class=\"number\">1</span>]</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">2</span>], s[<span class=\"number\">1</span>][<span class=\"number\">2</span>], s[<span class=\"number\">2</span>][<span class=\"number\">2</span>], s[<span class=\"number\">3</span>][<span class=\"number\">2</span>] = s[<span class=\"number\">2</span>][<span class=\"number\">2</span>], s[<span class=\"number\">3</span>][<span class=\"number\">2</span>], s[<span class=\"number\">0</span>][<span class=\"number\">2</span>], s[<span class=\"number\">1</span>][<span class=\"number\">2</span>]</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">3</span>], s[<span class=\"number\">1</span>][<span class=\"number\">3</span>], s[<span class=\"number\">2</span>][<span class=\"number\">3</span>], s[<span class=\"number\">3</span>][<span class=\"number\">3</span>] = s[<span class=\"number\">3</span>][<span class=\"number\">3</span>], s[<span class=\"number\">0</span>][<span class=\"number\">3</span>], s[<span class=\"number\">1</span>][<span class=\"number\">3</span>], s[<span class=\"number\">2</span>][<span class=\"number\">3</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">inv_shift_rows</span>(<span class=\"params\">s</span>):</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">1</span>], s[<span class=\"number\">1</span>][<span class=\"number\">1</span>], s[<span class=\"number\">2</span>][<span class=\"number\">1</span>], s[<span class=\"number\">3</span>][<span class=\"number\">1</span>] = s[<span class=\"number\">3</span>][<span class=\"number\">1</span>], s[<span class=\"number\">0</span>][<span class=\"number\">1</span>], s[<span class=\"number\">1</span>][<span class=\"number\">1</span>], s[<span class=\"number\">2</span>][<span class=\"number\">1</span>]</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">2</span>], s[<span class=\"number\">1</span>][<span class=\"number\">2</span>], s[<span class=\"number\">2</span>][<span class=\"number\">2</span>], s[<span class=\"number\">3</span>][<span class=\"number\">2</span>] = s[<span class=\"number\">2</span>][<span class=\"number\">2</span>], s[<span class=\"number\">3</span>][<span class=\"number\">2</span>], s[<span class=\"number\">0</span>][<span class=\"number\">2</span>], s[<span class=\"number\">1</span>][<span class=\"number\">2</span>]</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">3</span>], s[<span class=\"number\">1</span>][<span class=\"number\">3</span>], s[<span class=\"number\">2</span>][<span class=\"number\">3</span>], s[<span class=\"number\">3</span>][<span class=\"number\">3</span>] = s[<span class=\"number\">1</span>][<span class=\"number\">3</span>], s[<span class=\"number\">2</span>][<span class=\"number\">3</span>], s[<span class=\"number\">3</span>][<span class=\"number\">3</span>], s[<span class=\"number\">0</span>][<span class=\"number\">3</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># learned from http://cs.ucsb.edu/~koc/cs178/projects/JT/aes.c</span></span><br><span class=\"line\">xtime = <span class=\"keyword\">lambda</span> a: (((a &lt;&lt; <span class=\"number\">1</span>) ^ <span class=\"number\">0x1B</span>) &amp; <span class=\"number\">0xFF</span>) <span class=\"keyword\">if</span> (a &amp; <span class=\"number\">0x80</span>) <span class=\"keyword\">else</span> (a &lt;&lt; <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">mix_single_column</span>(<span class=\"params\">a</span>):</span><br><span class=\"line\">    <span class=\"comment\"># see Sec 4.1.2 in The Design of Rijndael</span></span><br><span class=\"line\">    t = a[<span class=\"number\">0</span>] ^ a[<span class=\"number\">1</span>] ^ a[<span class=\"number\">2</span>] ^ a[<span class=\"number\">3</span>]</span><br><span class=\"line\">    u = a[<span class=\"number\">0</span>]</span><br><span class=\"line\">    a[<span class=\"number\">0</span>] ^= t ^ xtime(a[<span class=\"number\">0</span>] ^ a[<span class=\"number\">1</span>])</span><br><span class=\"line\">    a[<span class=\"number\">1</span>] ^= t ^ xtime(a[<span class=\"number\">1</span>] ^ a[<span class=\"number\">2</span>])</span><br><span class=\"line\">    a[<span class=\"number\">2</span>] ^= t ^ xtime(a[<span class=\"number\">2</span>] ^ a[<span class=\"number\">3</span>])</span><br><span class=\"line\">    a[<span class=\"number\">3</span>] ^= t ^ xtime(a[<span class=\"number\">3</span>] ^ u)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">mix_columns</span>(<span class=\"params\">s</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">        mix_single_column(s[i])</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">inv_mix_columns</span>(<span class=\"params\">s</span>):</span><br><span class=\"line\">    <span class=\"comment\"># see Sec 4.1.3 in The Design of Rijndael</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">        u = xtime(xtime(s[i][<span class=\"number\">0</span>] ^ s[i][<span class=\"number\">2</span>]))</span><br><span class=\"line\">        v = xtime(xtime(s[i][<span class=\"number\">1</span>] ^ s[i][<span class=\"number\">3</span>]))</span><br><span class=\"line\">        s[i][<span class=\"number\">0</span>] ^= u</span><br><span class=\"line\">        s[i][<span class=\"number\">1</span>] ^= v</span><br><span class=\"line\">        s[i][<span class=\"number\">2</span>] ^= u</span><br><span class=\"line\">        s[i][<span class=\"number\">3</span>] ^= v</span><br><span class=\"line\"></span><br><span class=\"line\">    mix_columns(s)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">expand_key</span>(<span class=\"params\">master_key</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    Expands and returns a list of key matrices for the given master_key.</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Round constants https://en.wikipedia.org/wiki/AES_key_schedule#Round_constants</span></span><br><span class=\"line\">    r_con = (</span><br><span class=\"line\">        <span class=\"number\">0x00</span>, <span class=\"number\">0x01</span>, <span class=\"number\">0x02</span>, <span class=\"number\">0x04</span>, <span class=\"number\">0x08</span>, <span class=\"number\">0x10</span>, <span class=\"number\">0x20</span>, <span class=\"number\">0x40</span>,</span><br><span class=\"line\">        <span class=\"number\">0x80</span>, <span class=\"number\">0x1B</span>, <span class=\"number\">0x36</span>, <span class=\"number\">0x6C</span>, <span class=\"number\">0xD8</span>, <span class=\"number\">0xAB</span>, <span class=\"number\">0x4D</span>, <span class=\"number\">0x9A</span>,</span><br><span class=\"line\">        <span class=\"number\">0x2F</span>, <span class=\"number\">0x5E</span>, <span class=\"number\">0xBC</span>, <span class=\"number\">0x63</span>, <span class=\"number\">0xC6</span>, <span class=\"number\">0x97</span>, <span class=\"number\">0x35</span>, <span class=\"number\">0x6A</span>,</span><br><span class=\"line\">        <span class=\"number\">0xD4</span>, <span class=\"number\">0xB3</span>, <span class=\"number\">0x7D</span>, <span class=\"number\">0xFA</span>, <span class=\"number\">0xEF</span>, <span class=\"number\">0xC5</span>, <span class=\"number\">0x91</span>, <span class=\"number\">0x39</span>,</span><br><span class=\"line\">    )</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Initialize round keys with raw key material.</span></span><br><span class=\"line\">    key_columns = bytes2matrix(master_key)</span><br><span class=\"line\">    iteration_size = <span class=\"built_in\">len</span>(master_key) // <span class=\"number\">4</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Each iteration has exactly as many columns as the key material.</span></span><br><span class=\"line\">    i = <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> <span class=\"built_in\">len</span>(key_columns) &lt; (N_ROUNDS + <span class=\"number\">1</span>) * <span class=\"number\">4</span>:</span><br><span class=\"line\">        <span class=\"comment\"># Copy previous word.</span></span><br><span class=\"line\">        word = <span class=\"built_in\">list</span>(key_columns[-<span class=\"number\">1</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Perform schedule_core once every &quot;row&quot;.</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(key_columns) % iteration_size == <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"comment\"># Circular shift.</span></span><br><span class=\"line\">            word.append(word.pop(<span class=\"number\">0</span>))</span><br><span class=\"line\">            <span class=\"comment\"># Map to S-BOX.</span></span><br><span class=\"line\">            word = [s_box[b] <span class=\"keyword\">for</span> b <span class=\"keyword\">in</span> word]</span><br><span class=\"line\">            <span class=\"comment\"># XOR with first byte of R-CON, since the others bytes of R-CON are 0.</span></span><br><span class=\"line\">            word[<span class=\"number\">0</span>] ^= r_con[i]</span><br><span class=\"line\">            i += <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">elif</span> <span class=\"built_in\">len</span>(master_key) == <span class=\"number\">32</span> <span class=\"keyword\">and</span> <span class=\"built_in\">len</span>(key_columns) % iteration_size == <span class=\"number\">4</span>:</span><br><span class=\"line\">            <span class=\"comment\"># Run word through S-box in the fourth iteration when using a</span></span><br><span class=\"line\">            <span class=\"comment\"># 256-bit key.</span></span><br><span class=\"line\">            word = [s_box[b] <span class=\"keyword\">for</span> b <span class=\"keyword\">in</span> word]</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># XOR with equivalent word from previous iteration.</span></span><br><span class=\"line\">        word = <span class=\"built_in\">bytes</span>(i ^ j <span class=\"keyword\">for</span> i, j <span class=\"keyword\">in</span> <span class=\"built_in\">zip</span>(word, key_columns[-iteration_size]))</span><br><span class=\"line\">        key_columns.append(word)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Group key words in 4x4 byte matrices.</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> [key_columns[<span class=\"number\">4</span> * i: <span class=\"number\">4</span>*(i+<span class=\"number\">1</span>)] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(key_columns) // <span class=\"number\">4</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">decrypt</span>(<span class=\"params\">key, ciphertext</span>):</span><br><span class=\"line\">    round_keys = expand_key(key)  <span class=\"comment\"># Remember to start from the last round key and work backwards through them when decrypting</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Convert ciphertext to state matrix</span></span><br><span class=\"line\">    state = bytes2matrix(ciphertext)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Initial add round key step</span></span><br><span class=\"line\">    state = add_round_key(state, round_keys[-<span class=\"number\">1</span>])</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(N_ROUNDS - <span class=\"number\">1</span>, <span class=\"number\">0</span>, -<span class=\"number\">1</span>):</span><br><span class=\"line\">        inv_shift_rows(state)</span><br><span class=\"line\">        state = sub_bytes(state, inv_s_box)</span><br><span class=\"line\">        state = add_round_key(state, round_keys[i])</span><br><span class=\"line\">        inv_mix_columns(state)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Run final round (skips the InvMixColumns step)</span></span><br><span class=\"line\">    inv_shift_rows(state)</span><br><span class=\"line\">    state = sub_bytes(state, inv_s_box)</span><br><span class=\"line\">    state = add_round_key(state, round_keys[<span class=\"number\">0</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Convert state matrix to plaintext</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> matrix2bytes(state)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(decrypt(key, ciphertext))</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"<p>第三章好像是做的最迷的</p>","more":"<p>虽然只需要做 ”How AES Works” 部分。但是——</p>\n<p>刚开始第三章：还以为会越来越难，没想到做完数论就柳暗花明了？</p>\n<p>第三章最后一题：什么东西啊这是，这怎么比数论那块还复杂。。</p>\n<h1 id=\"Symmetric-Cryptography-How-AES-Works\"><a href=\"#Symmetric-Cryptography-How-AES-Works\" class=\"headerlink\" title=\"Symmetric Cryptography_How AES Works\"></a>Symmetric Cryptography_How AES Works</h1><h2 id=\"Keyed-Permutations\"><a href=\"#Keyed-Permutations\" class=\"headerlink\" title=\"Keyed Permutations\"></a>Keyed Permutations</h2><h3 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>AES, like all good block ciphers, performs a “keyed permutation”. This means that it maps every possible input block to a unique output block, with a key determining which permutation to perform.</p>\n<blockquote>\n<p>A “block” just refers to a fixed number of bits or bytes, which may represent any kind of data. AES processes a block and outputs another block. We’ll be specifically talking the variant of AES which works on 128 bit (16 byte) blocks and a 128 bit key, known as AES-128.</p>\n</blockquote>\n<p>Using the same key, the permutation can be performed in reverse, mapping the output block back to the original input block. It is important that there is a one-to-one correspondence between input and output blocks, otherwise we wouldn’t be able to rely on the ciphertext to decrypt back to the same plaintext we started with.</p>\n<p>What is the mathematical term for a one-to-one correspondence?</p>\n<h3 id=\"Analyze\"><a href=\"#Analyze\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>喔这题简单，我不知道但 Google 知道，浅搜一下”一一对应的数学术语“，知道叫双射函数，浅浅上个百科，就知道英语咯。</p>\n<h2 id=\"Resisting-Bruteforce\"><a href=\"#Resisting-Bruteforce\" class=\"headerlink\" title=\"Resisting Bruteforce\"></a>Resisting Bruteforce</h2><h3 id=\"Description-1\"><a href=\"#Description-1\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>If a block cipher is secure, there should be no way for an attacker to distinguish the output of AES from a <a href=\"https://en.wikipedia.org/wiki/Pseudorandom_permutation\">random permutation</a> of bits. Furthermore, there should be no better way to undo the permutation than simply bruteforcing every possible key. That’s why academics consider a cipher theoretically “broken” if they can find an attack that takes fewer steps to perform than bruteforcing the key, even if that attack is practically infeasible.</p>\n<blockquote>\n<p>How difficult is it to bruteforce a 128-bit keyspace? <a href=\"https://crypto.stackexchange.com/a/48669\">Somebody estimated</a> that if you turned the power of the entire Bitcoin mining network against an AES-128 key, it would take over a hundred times the age of the universe to crack the key.</p>\n</blockquote>\n<p>It turns out that there is <a href=\"https://en.wikipedia.org/wiki/Biclique_attack\">an attack</a> on AES that’s better than bruteforce, but only slightly – it lowers the security level of AES-128 down to 126.1 bits, and hasn’t been improved on for over 8 years. Given the large “security margin” provided by 128 bits, and the lack of improvements despite extensive study, it’s not considered a credible risk to the security of AES. But yes, in a very narrow sense, it “breaks” AES.</p>\n<p>Finally, while quantum computers have the potential to completely break popular public-key cryptosystems like RSA via <a href=\"https://en.wikipedia.org/wiki/Shor's_algorithm\">Shor’s algorithm</a>, they are thought to only cut in half the security level of symmetric cryptosystems via <a href=\"https://en.wikipedia.org/wiki/Grover's_algorithm\">Grover’s algorithm</a>. This is one reason why people recommend using AES-256, despite it being less performant, as it would still provide a very adequate 128 bits of security in a quantum future.</p>\n<p>What is the name for the best single-key attack against AES?</p>\n<h3 id=\"Analyze-1\"><a href=\"#Analyze-1\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>虽然但是，依然去查了 Google，靠谱！</p>\n<p>不过发现网上搜 biclique 的结果居然不是很多，我打开方式有问题吗是，后面再看看。</p>\n<h2 id=\"Structure-of-AES\"><a href=\"#Structure-of-AES\" class=\"headerlink\" title=\"Structure of AES\"></a>Structure of AES</h2><h3 id=\"Description-2\"><a href=\"#Description-2\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>To achieve a keyed permutation that is infeasible to invert without the key, AES applies a large number of ad-hoc mixing operations on the input. This is in stark contrast to public-key cryptosystems like RSA, which are based on elegant individual mathematical problems. AES is much less elegant, but it’s very fast.</p>\n<p>At a high level, AES-128 begins with a “key schedule” and then runs 10 rounds over a state. The starting state is just the plaintext block that we want to encrypt, represented as a 4x4 matrix of bytes. Over the course of the 10 rounds, the state is repeatedly modified by a number of invertible transformations.</p>\n<blockquote>\n<p>Each transformation step has a defined purpose based on theoretical properties of secure ciphers established by Claude Shannon in the 1940s. We’ll look closer at each of these in the following challenges.</p>\n</blockquote>\n<p>Here’s an overview of the phases of AES encryption:</p>\n<p><img src=\"https://cryptohack.org/static/img/aes/Structure.png\" alt=\"diagram showing AES rounds\"></p>\n<ol>\n<li><strong>KeyExpansion</strong> or Key Schedule</li>\n</ol>\n<p> From the 128 bit key, 11 separate 128 bit “round keys” are derived: one to be used in each AddRoundKey step.</p>\n<ol start=\"2\">\n<li><strong>Initial key addition</strong></li>\n</ol>\n<p> <em>AddRoundKey</em> - the bytes of the first round key are XOR’d with the bytes of the state.</p>\n<ol start=\"3\">\n<li><strong>Round</strong> - this phase is looped 10 times, for 9 main rounds plus one “final round”</li>\n</ol>\n<p> \ta) <em>SubBytes</em> - each byte of the state is substituted for a different byte according to a lookup table (“S-box”).</p>\n<p>​\t b) <em>ShiftRows</em> - the last three rows of the state matrix are transposed—shifted over a column or two or three.</p>\n<p>​\t c) <em>MixColumns</em> - matrix multiplication is performed on the columns of the state, combining the four bytes in each column. This is skipped in the final round.</p>\n<p>​\t d) <em>AddRoundKey</em> - the bytes of the current round key are XOR’d with the bytes of the state.</p>\n<p>Included is a <code>bytes2matrix</code> function for converting our initial plaintext block into a state matrix. Write a <code>matrix2bytes</code> function to turn that matrix back into bytes, and submit the resulting plaintext as the flag.</p>\n<h3 id=\"Analyze-2\"><a href=\"#Analyze-2\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>这题我会！</p>\n<p>补全 matrix2bytes()，直接用 sum() 把矩阵压缩成一维列表，然后转字节输出。</p>\n<p>补全函数的题比自己写代码的简单多了（bushi</p>\n<h3 id=\"Code\"><a href=\"#Code\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">bytes2matrix</span>(<span class=\"params\">text</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot; Converts a 16-byte array into a 4x4 matrix.  &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> [<span class=\"built_in\">list</span>(text[i:i+<span class=\"number\">4</span>]) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(text), <span class=\"number\">4</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">matrix2bytes</span>(<span class=\"params\">matrix</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array.  &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">bytes</span>(<span class=\"built_in\">sum</span>(matrix, []))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">matrix = [</span><br><span class=\"line\">    [<span class=\"number\">99</span>, <span class=\"number\">114</span>, <span class=\"number\">121</span>, <span class=\"number\">112</span>],</span><br><span class=\"line\">    [<span class=\"number\">116</span>, <span class=\"number\">111</span>, <span class=\"number\">123</span>, <span class=\"number\">105</span>],</span><br><span class=\"line\">    [<span class=\"number\">110</span>, <span class=\"number\">109</span>, <span class=\"number\">97</span>, <span class=\"number\">116</span>],</span><br><span class=\"line\">    [<span class=\"number\">114</span>, <span class=\"number\">105</span>, <span class=\"number\">120</span>, <span class=\"number\">125</span>],</span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(matrix2bytes(matrix))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp\"><a href=\"#SumUp\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># function</span></span><br><span class=\"line\"><span class=\"built_in\">sum</span>()  <span class=\"comment\"># 把迭代对象里的每一个元素相加。（当元素是列表，就有压平的效果咯）</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Round-Keys\"><a href=\"#Round-Keys\" class=\"headerlink\" title=\"Round Keys\"></a>Round Keys</h2><h3 id=\"Description-3\"><a href=\"#Description-3\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>We’re going to skip over the finer details of the <strong>KeyExpansion</strong> phase for now. The main point is that it takes in our 16 byte key and produces 11 4x4 matrices called “round keys” derived from our initial key. These round keys allow AES to get extra mileage out of the single key that we provided.</p>\n<p>The <strong>initial key addition</strong> phase, which is next, has a single <em>AddRoundKey</em> step. The <em>AddRoundKey</em> step is straightforward: it XORs the current state with the current round key.</p>\n<p><img src=\"https://cryptohack.org/static/img/aes/AddRoundKey.png\" alt=\"diagram showing AddRoundKey\"></p>\n<p><em>AddRoundKey</em> also occurs as the final step of each round. <em>AddRoundKey</em> is what makes AES a “keyed permutation” rather than just a permutation. It’s the only part of AES where the key is mixed into the state, but is crucial for determining the permutation that occurs.</p>\n<p>As you’ve seen in previous challenges, XOR is an easily invertible operation if you know the key, but tough to undo if you don’t. Now imagine trying to recover plaintext which has been XOR’d with 11 different keys, and heavily jumbled between each XOR operation with a series of substitution and transposition ciphers. That’s kinda what AES does! And we’ll see just how effective the jumbling is in the next few challenges.</p>\n<p>Complete the <code>add_round_key</code> function, then use the <code>matrix2bytes</code> function to get your next flag.</p>\n<h3 id=\"Analyze-3\"><a href=\"#Analyze-3\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>遇到异或就搬 pwn.xor()！</p>\n<p>明文经过了 11 个不同的密钥进行异或，再异或回去就可以得到原文。</p>\n<p>返回异或值就 ok。</p>\n<p>感觉异或还是蛮有意思的。</p>\n<h3 id=\"Code-1\"><a href=\"#Code-1\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> xor</span><br><span class=\"line\">state = [</span><br><span class=\"line\">    [<span class=\"number\">206</span>, <span class=\"number\">243</span>, <span class=\"number\">61</span>, <span class=\"number\">34</span>],</span><br><span class=\"line\">    [<span class=\"number\">171</span>, <span class=\"number\">11</span>, <span class=\"number\">93</span>, <span class=\"number\">31</span>],</span><br><span class=\"line\">    [<span class=\"number\">16</span>, <span class=\"number\">200</span>, <span class=\"number\">91</span>, <span class=\"number\">108</span>],</span><br><span class=\"line\">    [<span class=\"number\">150</span>, <span class=\"number\">3</span>, <span class=\"number\">194</span>, <span class=\"number\">51</span>],</span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\">round_key = [</span><br><span class=\"line\">    [<span class=\"number\">173</span>, <span class=\"number\">129</span>, <span class=\"number\">68</span>, <span class=\"number\">82</span>],</span><br><span class=\"line\">    [<span class=\"number\">223</span>, <span class=\"number\">100</span>, <span class=\"number\">38</span>, <span class=\"number\">109</span>],</span><br><span class=\"line\">    [<span class=\"number\">32</span>, <span class=\"number\">189</span>, <span class=\"number\">53</span>, <span class=\"number\">8</span>],</span><br><span class=\"line\">    [<span class=\"number\">253</span>, <span class=\"number\">48</span>, <span class=\"number\">187</span>, <span class=\"number\">78</span>],</span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">add_round_key</span>(<span class=\"params\">s, k</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> xor(s, k)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(add_round_key(state, round_key))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Confusion-through-Substitution\"><a href=\"#Confusion-through-Substitution\" class=\"headerlink\" title=\"Confusion through Substitution\"></a>Confusion through Substitution</h2><h3 id=\"Description-4\"><a href=\"#Description-4\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>The first step of each AES round is <em>SubBytes</em>. This involves taking each byte of the state matrix and substituting it for a different byte in a preset 16x16 lookup table. The lookup table is called a “Substitution box” or “S-box” for short, and can be perplexing at first sight. Let’s break it down.</p>\n<p><img src=\"https://cryptohack.org/static/img/aes/Substitution.png\" alt=\"diagram showing Substitution\"></p>\n<p>In 1945 American mathematician Claude Shannon published a groundbreaking paper on Information Theory. It identified “confusion” as an essential property of a secure cipher. “Confusion” means that the relationship between the ciphertext and the key should be as complex as possible. Given just a ciphertext, there should be no way to learn anything about the key.</p>\n<p>If a cipher has poor confusion, it is possible to express a relationship between ciphertext, key, and plaintext as a linear function. For instance, in a Caesar cipher, <code>ciphertext = plaintext + key</code>. That’s an obvious relation, which is easy to reverse. More complicated linear transformations can be solved using techniques like Gaussian elimination. Even low-degree polynomials, e.g. an equation like <code>x^4 + 51x^3 + x</code>, can be solved efficiently using <a href=\"https://math.stackexchange.com/a/1078515\">algebraic methods</a>. However, the higher the degree of a polynomial, generally the harder it becomes to solve – it can only be approximated by a larger and larger amount of linear functions.</p>\n<p>The main purpose of the S-box is to transform the input in a way that is resistant to being approximated by linear functions. S-boxes are aiming for high <em>non-linearity</em>, and while AES’s one is not perfect, it’s pretty close. The fast lookup in an S-box is a shortcut for performing a very nonlinear function on the input bytes. This function involves taking the modular inverse in the <a href=\"https://www.samiam.org/galois.html\">Galois field 2**8</a> and then applying an affine transformation which has been tweaked for maximum confusion. The simplest way to express the function is through the following high-degree polynomial:</p>\n<p><img src=\"https://cryptohack.org/static/img/aes/SBoxEq.png\" alt=\"diagram showing S-Box equation\"></p>\n<p>To make the S-box, the function has been calculated on all input values from 0x00 to 0xff and the outputs put in the lookup table.</p>\n<p>Implement <code>sub_bytes</code>, send the state matrix through the inverse S-box and then convert it to bytes to get the flag.</p>\n<h3 id=\"Analyze-4\"><a href=\"#Analyze-4\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>意思就是让补全 sub_bytes 函数，然后转换成字节得到 flag。</p>\n<p>其实 state 里面的存的是它每个位置上本来的数据在查找库 sbox 中的序号，所以遍历 state，按序号取出对应的原数据，然后返回字节就好咯。</p>\n<h3 id=\"Code-2\"><a href=\"#Code-2\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 写法一</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">sub_bytes</span>(<span class=\"params\">s, sbox=s_box</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">            s[i][j] = sbox[s[i][j]]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">bytes</span>(<span class=\"built_in\">sum</span>(s, []))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(sub_bytes(state, sbox=inv_s_box))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 写法二</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">matrix2bytes</span>(<span class=\"params\">matrix</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array.  &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">bytes</span>(<span class=\"built_in\">sum</span>(matrix, []))</span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">sub_bytes</span>(<span class=\"params\">s, sbox=s_box</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">            s[i][j] = sbox[s[i][j]]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> s</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(matrix2bytes(sub_bytes(state, sbox=inv_s_box)))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SumUp-1\"><a href=\"#SumUp-1\" class=\"headerlink\" title=\"SumUp\"></a>SumUp</h3><p>两种写法怎么说呢，第一种更简洁明了，看起来好像也更优雅。</p>\n<p>第二种虽然搬过来了 matrix2bytes() 函数（也可以不搬函数直接一行搞定，不过读起来费劲点），看起来更繁琐，不过这种写法更不容易吃亏（在最后一题已经深刻体会过了）。所以本来是喜欢第一种写法的，做完最后一题之后还是喜欢第二种了。</p>\n<p>（呜呜呜我也不想被钓啊，可是它解题更好用诶）。</p>\n<h2 id=\"Diffusion-through-Permutation\"><a href=\"#Diffusion-through-Permutation\" class=\"headerlink\" title=\"Diffusion through Permutation\"></a>Diffusion through Permutation</h2><h3 id=\"Description-5\"><a href=\"#Description-5\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>We’ve seen how S-box substitution provides confusion. The other crucial property described by Shannon is “diffusion”. This relates to how every part of a cipher’s input should spread to every part of the output.</p>\n<p>Substitution on its own creates non-linearity, however it doesn’t distribute it over the entire state. Without diffusion, the same byte in the same position would get the same transformations applied to it each round. This would allow cryptanalysts to attack each byte position in the state matrix separately. We need to alternate substitutions by scrambling the state (in an invertible way) so that substitutions applied on one byte influence all other bytes in the state. Each input into the next S-box then becomes a function of multiple bytes, meaning that with every round the algebraic complexity of the system increases enormously.</p>\n<blockquote>\n<p>An ideal amount of diffusion causes a change of one bit in the plaintext to lead to a change in statistically half the bits of the ciphertext. This desirable outcome is called the <a href=\"https://en.wikipedia.org/wiki/Avalanche_effect\">Avalanche effect</a>.</p>\n</blockquote>\n<p>The <em>ShiftRows</em> and <em>MixColumns</em> steps combine to achieve this. They work together to ensure every byte affects every other byte in the state within just two rounds.</p>\n<p><em>ShiftRows</em> is the most simple transformation in AES. It keeps the first row of the state matrix the same. The second row is shifted over one column to the left, wrapping around. The third row is shifted two columns, the fourth row by three. Wikipedia puts it nicely: “the importance of this step is to avoid the columns being encrypted independently, in which case AES degenerates into four independent block ciphers.”</p>\n<p><img src=\"https://cryptohack.org/static/img/aes/ShiftRows.png\" alt=\"diagram showing ShiftRows\"></p>\n<p><em>MixColumns</em> is more complex. It performs Matrix multiplication in Rijndael’s Galois field between the columns of the state matrix and a preset matrix. Each single byte of each column therefore affects all the bytes of the resulting column. The implementation details are nuanced; <a href=\"https://www.samiam.org/mix-column.html\">this page</a> and <a href=\"https://en.wikipedia.org/wiki/Rijndael_MixColumns\">Wikipedia</a> do a good job of covering them.</p>\n<p><img src=\"https://cryptohack.org/static/img/aes/MixColumns.png\" alt=\"diagram showing MixColumns\"></p>\n<p>We’ve provided code to perform MixColumns and the forward ShiftRows operation. After implementing <code>inv_shift_rows</code>, take the state, run <code>inv_mix_columns</code> on it, then <code>inv_shift_rows</code>, convert to bytes and you will have your flag.</p>\n<h3 id=\"Analyze-5\"><a href=\"#Analyze-5\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>首先是补全 inv_shift_rows()，参考 shift_rows()，发现是给第 n 行向左移动 n 个单位 ，那 inv_shift_rows 就给第 n 行向右移动 n 个单位。</p>\n<p>然后根据 description 依次运行 <code>inv_mix_columns(state)</code> <code>inv_shift_rows(state)</code>，然后把前面用过的矩阵转字节的函数 matrix2bytes() 搬过来，输出一下。</p>\n<h3 id=\"Code-3\"><a href=\"#Code-3\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">inv_shift_rows</span>(<span class=\"params\">s</span>):</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">1</span>], s[<span class=\"number\">1</span>][<span class=\"number\">1</span>], s[<span class=\"number\">2</span>][<span class=\"number\">1</span>], s[<span class=\"number\">3</span>][<span class=\"number\">1</span>] = s[<span class=\"number\">3</span>][<span class=\"number\">1</span>], s[<span class=\"number\">0</span>][<span class=\"number\">1</span>], s[<span class=\"number\">1</span>][<span class=\"number\">1</span>], s[<span class=\"number\">2</span>][<span class=\"number\">1</span>]</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">2</span>], s[<span class=\"number\">1</span>][<span class=\"number\">2</span>], s[<span class=\"number\">2</span>][<span class=\"number\">2</span>], s[<span class=\"number\">3</span>][<span class=\"number\">2</span>] = s[<span class=\"number\">2</span>][<span class=\"number\">2</span>], s[<span class=\"number\">3</span>][<span class=\"number\">2</span>], s[<span class=\"number\">0</span>][<span class=\"number\">2</span>], s[<span class=\"number\">1</span>][<span class=\"number\">2</span>]</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">3</span>], s[<span class=\"number\">1</span>][<span class=\"number\">3</span>], s[<span class=\"number\">2</span>][<span class=\"number\">3</span>], s[<span class=\"number\">3</span>][<span class=\"number\">3</span>] = s[<span class=\"number\">1</span>][<span class=\"number\">3</span>], s[<span class=\"number\">2</span>][<span class=\"number\">3</span>], s[<span class=\"number\">3</span>][<span class=\"number\">3</span>], s[<span class=\"number\">0</span>][<span class=\"number\">3</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">matrix2bytes</span>(<span class=\"params\">matrix</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array.  &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">bytes</span>(<span class=\"built_in\">sum</span>(matrix, []))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">inv_mix_columns(state)</span><br><span class=\"line\">inv_shift_rows(state)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(matrix2bytes(state))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Bringing-It-All-Together\"><a href=\"#Bringing-It-All-Together\" class=\"headerlink\" title=\"Bringing It All Together\"></a>Bringing It All Together</h2><h3 id=\"Description-6\"><a href=\"#Description-6\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Apart from the <strong>KeyExpansion</strong> phase, we’ve sketched out all the components of AES. We’ve shown how <em>SubBytes</em> provides confusion and <em>ShiftRows</em> and <em>MixColumns</em> provide diffusion, and how these two properties work together to repeatedly circulate non-linear transformations over the state. Finally, <em>AddRoundKey</em> seeds the key into this substitution-permutation network, making the cipher a keyed permutation.</p>\n<p>Decryption involves performing the steps described in the “Structure of AES” challenge in reverse, applying the inverse operations. Note that the KeyExpansion still needs to be run first, and the round keys will be used in reverse order. <em>AddRoundKey</em> and its inverse are identical as XOR has the self-inverse property.</p>\n<p><img src=\"https://cryptohack.org/static/img/aes/Structure2.png\" alt=\"diagram showing AES decryption\"></p>\n<p>We’ve provided the key expansion code, and ciphertext that’s been properly encrypted by AES-128. Copy in all the building blocks you’ve coded so far, and complete the <code>decrypt</code> function that implements the steps shown in the diagram. The decrypted plaintext is the flag.</p>\n<p>Yes, you can cheat on this challenge, but where’s the fun in that?</p>\n<p>The code used in these exercises has been taken from Bo Zhu’s super simple Python AES implementation, so we’ve reproduced the license here.</p>\n<h3 id=\"Analyze-6\"><a href=\"#Analyze-6\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>这题最头疼了，开始没明白到底要啥，看了半天发现是要补全好几处代码，而且给的 .py 文件还各种报错，很烦反正。</p>\n<p>后面发现这是 AES 基础的最后一道相当于总结的题，就直接把前面几道题用到的函数和矩阵啥的全粘过来了，然后看了看有注释但没代码的地方，几乎是把前几个文件的代码拼到一起咯。然后基本就是一个完整的 AES。</p>\n<p>还有，前面有一道题提到用了 pwn 库的 xor() 函数，现在想给自己埋咯。</p>\n<p>最后代码一直报错，看了看日志，手写了一下 xor，居然就很顺利了？</p>\n<p>把 pwn 库埋咯！</p>\n<p>（因为这题需要自己写的代码分布比较零散，找起来也比较麻烦，所以干脆把全部代码贴上来。）</p>\n<h3 id=\"Code-4\"><a href=\"#Code-4\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">N_ROUNDS = <span class=\"number\">10</span></span><br><span class=\"line\"></span><br><span class=\"line\">key = <span class=\"string\">b&#x27;\\xc3,\\\\\\xa6\\xb5\\x80^\\x0c\\xdb\\x8d\\xa5z*\\xb6\\xfe\\\\&#x27;</span></span><br><span class=\"line\">ciphertext = <span class=\"string\">b&#x27;\\xd1O\\x14j\\xa4+O\\xb6\\xa1\\xc4\\x08B)\\x8f\\x12\\xdd&#x27;</span></span><br><span class=\"line\">s_box = (</span><br><span class=\"line\">    <span class=\"number\">0x63</span>, <span class=\"number\">0x7C</span>, <span class=\"number\">0x77</span>, <span class=\"number\">0x7B</span>, <span class=\"number\">0xF2</span>, <span class=\"number\">0x6B</span>, <span class=\"number\">0x6F</span>, <span class=\"number\">0xC5</span>, <span class=\"number\">0x30</span>, <span class=\"number\">0x01</span>, <span class=\"number\">0x67</span>, <span class=\"number\">0x2B</span>, <span class=\"number\">0xFE</span>, <span class=\"number\">0xD7</span>, <span class=\"number\">0xAB</span>, <span class=\"number\">0x76</span>,</span><br><span class=\"line\">    <span class=\"number\">0xCA</span>, <span class=\"number\">0x82</span>, <span class=\"number\">0xC9</span>, <span class=\"number\">0x7D</span>, <span class=\"number\">0xFA</span>, <span class=\"number\">0x59</span>, <span class=\"number\">0x47</span>, <span class=\"number\">0xF0</span>, <span class=\"number\">0xAD</span>, <span class=\"number\">0xD4</span>, <span class=\"number\">0xA2</span>, <span class=\"number\">0xAF</span>, <span class=\"number\">0x9C</span>, <span class=\"number\">0xA4</span>, <span class=\"number\">0x72</span>, <span class=\"number\">0xC0</span>,</span><br><span class=\"line\">    <span class=\"number\">0xB7</span>, <span class=\"number\">0xFD</span>, <span class=\"number\">0x93</span>, <span class=\"number\">0x26</span>, <span class=\"number\">0x36</span>, <span class=\"number\">0x3F</span>, <span class=\"number\">0xF7</span>, <span class=\"number\">0xCC</span>, <span class=\"number\">0x34</span>, <span class=\"number\">0xA5</span>, <span class=\"number\">0xE5</span>, <span class=\"number\">0xF1</span>, <span class=\"number\">0x71</span>, <span class=\"number\">0xD8</span>, <span class=\"number\">0x31</span>, <span class=\"number\">0x15</span>,</span><br><span class=\"line\">    <span class=\"number\">0x04</span>, <span class=\"number\">0xC7</span>, <span class=\"number\">0x23</span>, <span class=\"number\">0xC3</span>, <span class=\"number\">0x18</span>, <span class=\"number\">0x96</span>, <span class=\"number\">0x05</span>, <span class=\"number\">0x9A</span>, <span class=\"number\">0x07</span>, <span class=\"number\">0x12</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0xE2</span>, <span class=\"number\">0xEB</span>, <span class=\"number\">0x27</span>, <span class=\"number\">0xB2</span>, <span class=\"number\">0x75</span>,</span><br><span class=\"line\">    <span class=\"number\">0x09</span>, <span class=\"number\">0x83</span>, <span class=\"number\">0x2C</span>, <span class=\"number\">0x1A</span>, <span class=\"number\">0x1B</span>, <span class=\"number\">0x6E</span>, <span class=\"number\">0x5A</span>, <span class=\"number\">0xA0</span>, <span class=\"number\">0x52</span>, <span class=\"number\">0x3B</span>, <span class=\"number\">0xD6</span>, <span class=\"number\">0xB3</span>, <span class=\"number\">0x29</span>, <span class=\"number\">0xE3</span>, <span class=\"number\">0x2F</span>, <span class=\"number\">0x84</span>,</span><br><span class=\"line\">    <span class=\"number\">0x53</span>, <span class=\"number\">0xD1</span>, <span class=\"number\">0x00</span>, <span class=\"number\">0xED</span>, <span class=\"number\">0x20</span>, <span class=\"number\">0xFC</span>, <span class=\"number\">0xB1</span>, <span class=\"number\">0x5B</span>, <span class=\"number\">0x6A</span>, <span class=\"number\">0xCB</span>, <span class=\"number\">0xBE</span>, <span class=\"number\">0x39</span>, <span class=\"number\">0x4A</span>, <span class=\"number\">0x4C</span>, <span class=\"number\">0x58</span>, <span class=\"number\">0xCF</span>,</span><br><span class=\"line\">    <span class=\"number\">0xD0</span>, <span class=\"number\">0xEF</span>, <span class=\"number\">0xAA</span>, <span class=\"number\">0xFB</span>, <span class=\"number\">0x43</span>, <span class=\"number\">0x4D</span>, <span class=\"number\">0x33</span>, <span class=\"number\">0x85</span>, <span class=\"number\">0x45</span>, <span class=\"number\">0xF9</span>, <span class=\"number\">0x02</span>, <span class=\"number\">0x7F</span>, <span class=\"number\">0x50</span>, <span class=\"number\">0x3C</span>, <span class=\"number\">0x9F</span>, <span class=\"number\">0xA8</span>,</span><br><span class=\"line\">    <span class=\"number\">0x51</span>, <span class=\"number\">0xA3</span>, <span class=\"number\">0x40</span>, <span class=\"number\">0x8F</span>, <span class=\"number\">0x92</span>, <span class=\"number\">0x9D</span>, <span class=\"number\">0x38</span>, <span class=\"number\">0xF5</span>, <span class=\"number\">0xBC</span>, <span class=\"number\">0xB6</span>, <span class=\"number\">0xDA</span>, <span class=\"number\">0x21</span>, <span class=\"number\">0x10</span>, <span class=\"number\">0xFF</span>, <span class=\"number\">0xF3</span>, <span class=\"number\">0xD2</span>,</span><br><span class=\"line\">    <span class=\"number\">0xCD</span>, <span class=\"number\">0x0C</span>, <span class=\"number\">0x13</span>, <span class=\"number\">0xEC</span>, <span class=\"number\">0x5F</span>, <span class=\"number\">0x97</span>, <span class=\"number\">0x44</span>, <span class=\"number\">0x17</span>, <span class=\"number\">0xC4</span>, <span class=\"number\">0xA7</span>, <span class=\"number\">0x7E</span>, <span class=\"number\">0x3D</span>, <span class=\"number\">0x64</span>, <span class=\"number\">0x5D</span>, <span class=\"number\">0x19</span>, <span class=\"number\">0x73</span>,</span><br><span class=\"line\">    <span class=\"number\">0x60</span>, <span class=\"number\">0x81</span>, <span class=\"number\">0x4F</span>, <span class=\"number\">0xDC</span>, <span class=\"number\">0x22</span>, <span class=\"number\">0x2A</span>, <span class=\"number\">0x90</span>, <span class=\"number\">0x88</span>, <span class=\"number\">0x46</span>, <span class=\"number\">0xEE</span>, <span class=\"number\">0xB8</span>, <span class=\"number\">0x14</span>, <span class=\"number\">0xDE</span>, <span class=\"number\">0x5E</span>, <span class=\"number\">0x0B</span>, <span class=\"number\">0xDB</span>,</span><br><span class=\"line\">    <span class=\"number\">0xE0</span>, <span class=\"number\">0x32</span>, <span class=\"number\">0x3A</span>, <span class=\"number\">0x0A</span>, <span class=\"number\">0x49</span>, <span class=\"number\">0x06</span>, <span class=\"number\">0x24</span>, <span class=\"number\">0x5C</span>, <span class=\"number\">0xC2</span>, <span class=\"number\">0xD3</span>, <span class=\"number\">0xAC</span>, <span class=\"number\">0x62</span>, <span class=\"number\">0x91</span>, <span class=\"number\">0x95</span>, <span class=\"number\">0xE4</span>, <span class=\"number\">0x79</span>,</span><br><span class=\"line\">    <span class=\"number\">0xE7</span>, <span class=\"number\">0xC8</span>, <span class=\"number\">0x37</span>, <span class=\"number\">0x6D</span>, <span class=\"number\">0x8D</span>, <span class=\"number\">0xD5</span>, <span class=\"number\">0x4E</span>, <span class=\"number\">0xA9</span>, <span class=\"number\">0x6C</span>, <span class=\"number\">0x56</span>, <span class=\"number\">0xF4</span>, <span class=\"number\">0xEA</span>, <span class=\"number\">0x65</span>, <span class=\"number\">0x7A</span>, <span class=\"number\">0xAE</span>, <span class=\"number\">0x08</span>,</span><br><span class=\"line\">    <span class=\"number\">0xBA</span>, <span class=\"number\">0x78</span>, <span class=\"number\">0x25</span>, <span class=\"number\">0x2E</span>, <span class=\"number\">0x1C</span>, <span class=\"number\">0xA6</span>, <span class=\"number\">0xB4</span>, <span class=\"number\">0xC6</span>, <span class=\"number\">0xE8</span>, <span class=\"number\">0xDD</span>, <span class=\"number\">0x74</span>, <span class=\"number\">0x1F</span>, <span class=\"number\">0x4B</span>, <span class=\"number\">0xBD</span>, <span class=\"number\">0x8B</span>, <span class=\"number\">0x8A</span>,</span><br><span class=\"line\">    <span class=\"number\">0x70</span>, <span class=\"number\">0x3E</span>, <span class=\"number\">0xB5</span>, <span class=\"number\">0x66</span>, <span class=\"number\">0x48</span>, <span class=\"number\">0x03</span>, <span class=\"number\">0xF6</span>, <span class=\"number\">0x0E</span>, <span class=\"number\">0x61</span>, <span class=\"number\">0x35</span>, <span class=\"number\">0x57</span>, <span class=\"number\">0xB9</span>, <span class=\"number\">0x86</span>, <span class=\"number\">0xC1</span>, <span class=\"number\">0x1D</span>, <span class=\"number\">0x9E</span>,</span><br><span class=\"line\">    <span class=\"number\">0xE1</span>, <span class=\"number\">0xF8</span>, <span class=\"number\">0x98</span>, <span class=\"number\">0x11</span>, <span class=\"number\">0x69</span>, <span class=\"number\">0xD9</span>, <span class=\"number\">0x8E</span>, <span class=\"number\">0x94</span>, <span class=\"number\">0x9B</span>, <span class=\"number\">0x1E</span>, <span class=\"number\">0x87</span>, <span class=\"number\">0xE9</span>, <span class=\"number\">0xCE</span>, <span class=\"number\">0x55</span>, <span class=\"number\">0x28</span>, <span class=\"number\">0xDF</span>,</span><br><span class=\"line\">    <span class=\"number\">0x8C</span>, <span class=\"number\">0xA1</span>, <span class=\"number\">0x89</span>, <span class=\"number\">0x0D</span>, <span class=\"number\">0xBF</span>, <span class=\"number\">0xE6</span>, <span class=\"number\">0x42</span>, <span class=\"number\">0x68</span>, <span class=\"number\">0x41</span>, <span class=\"number\">0x99</span>, <span class=\"number\">0x2D</span>, <span class=\"number\">0x0F</span>, <span class=\"number\">0xB0</span>, <span class=\"number\">0x54</span>, <span class=\"number\">0xBB</span>, <span class=\"number\">0x16</span>,</span><br><span class=\"line\">)</span><br><span class=\"line\">inv_s_box = (</span><br><span class=\"line\">    <span class=\"number\">0x52</span>, <span class=\"number\">0x09</span>, <span class=\"number\">0x6A</span>, <span class=\"number\">0xD5</span>, <span class=\"number\">0x30</span>, <span class=\"number\">0x36</span>, <span class=\"number\">0xA5</span>, <span class=\"number\">0x38</span>, <span class=\"number\">0xBF</span>, <span class=\"number\">0x40</span>, <span class=\"number\">0xA3</span>, <span class=\"number\">0x9E</span>, <span class=\"number\">0x81</span>, <span class=\"number\">0xF3</span>, <span class=\"number\">0xD7</span>, <span class=\"number\">0xFB</span>,</span><br><span class=\"line\">    <span class=\"number\">0x7C</span>, <span class=\"number\">0xE3</span>, <span class=\"number\">0x39</span>, <span class=\"number\">0x82</span>, <span class=\"number\">0x9B</span>, <span class=\"number\">0x2F</span>, <span class=\"number\">0xFF</span>, <span class=\"number\">0x87</span>, <span class=\"number\">0x34</span>, <span class=\"number\">0x8E</span>, <span class=\"number\">0x43</span>, <span class=\"number\">0x44</span>, <span class=\"number\">0xC4</span>, <span class=\"number\">0xDE</span>, <span class=\"number\">0xE9</span>, <span class=\"number\">0xCB</span>,</span><br><span class=\"line\">    <span class=\"number\">0x54</span>, <span class=\"number\">0x7B</span>, <span class=\"number\">0x94</span>, <span class=\"number\">0x32</span>, <span class=\"number\">0xA6</span>, <span class=\"number\">0xC2</span>, <span class=\"number\">0x23</span>, <span class=\"number\">0x3D</span>, <span class=\"number\">0xEE</span>, <span class=\"number\">0x4C</span>, <span class=\"number\">0x95</span>, <span class=\"number\">0x0B</span>, <span class=\"number\">0x42</span>, <span class=\"number\">0xFA</span>, <span class=\"number\">0xC3</span>, <span class=\"number\">0x4E</span>,</span><br><span class=\"line\">    <span class=\"number\">0x08</span>, <span class=\"number\">0x2E</span>, <span class=\"number\">0xA1</span>, <span class=\"number\">0x66</span>, <span class=\"number\">0x28</span>, <span class=\"number\">0xD9</span>, <span class=\"number\">0x24</span>, <span class=\"number\">0xB2</span>, <span class=\"number\">0x76</span>, <span class=\"number\">0x5B</span>, <span class=\"number\">0xA2</span>, <span class=\"number\">0x49</span>, <span class=\"number\">0x6D</span>, <span class=\"number\">0x8B</span>, <span class=\"number\">0xD1</span>, <span class=\"number\">0x25</span>,</span><br><span class=\"line\">    <span class=\"number\">0x72</span>, <span class=\"number\">0xF8</span>, <span class=\"number\">0xF6</span>, <span class=\"number\">0x64</span>, <span class=\"number\">0x86</span>, <span class=\"number\">0x68</span>, <span class=\"number\">0x98</span>, <span class=\"number\">0x16</span>, <span class=\"number\">0xD4</span>, <span class=\"number\">0xA4</span>, <span class=\"number\">0x5C</span>, <span class=\"number\">0xCC</span>, <span class=\"number\">0x5D</span>, <span class=\"number\">0x65</span>, <span class=\"number\">0xB6</span>, <span class=\"number\">0x92</span>,</span><br><span class=\"line\">    <span class=\"number\">0x6C</span>, <span class=\"number\">0x70</span>, <span class=\"number\">0x48</span>, <span class=\"number\">0x50</span>, <span class=\"number\">0xFD</span>, <span class=\"number\">0xED</span>, <span class=\"number\">0xB9</span>, <span class=\"number\">0xDA</span>, <span class=\"number\">0x5E</span>, <span class=\"number\">0x15</span>, <span class=\"number\">0x46</span>, <span class=\"number\">0x57</span>, <span class=\"number\">0xA7</span>, <span class=\"number\">0x8D</span>, <span class=\"number\">0x9D</span>, <span class=\"number\">0x84</span>,</span><br><span class=\"line\">    <span class=\"number\">0x90</span>, <span class=\"number\">0xD8</span>, <span class=\"number\">0xAB</span>, <span class=\"number\">0x00</span>, <span class=\"number\">0x8C</span>, <span class=\"number\">0xBC</span>, <span class=\"number\">0xD3</span>, <span class=\"number\">0x0A</span>, <span class=\"number\">0xF7</span>, <span class=\"number\">0xE4</span>, <span class=\"number\">0x58</span>, <span class=\"number\">0x05</span>, <span class=\"number\">0xB8</span>, <span class=\"number\">0xB3</span>, <span class=\"number\">0x45</span>, <span class=\"number\">0x06</span>,</span><br><span class=\"line\">    <span class=\"number\">0xD0</span>, <span class=\"number\">0x2C</span>, <span class=\"number\">0x1E</span>, <span class=\"number\">0x8F</span>, <span class=\"number\">0xCA</span>, <span class=\"number\">0x3F</span>, <span class=\"number\">0x0F</span>, <span class=\"number\">0x02</span>, <span class=\"number\">0xC1</span>, <span class=\"number\">0xAF</span>, <span class=\"number\">0xBD</span>, <span class=\"number\">0x03</span>, <span class=\"number\">0x01</span>, <span class=\"number\">0x13</span>, <span class=\"number\">0x8A</span>, <span class=\"number\">0x6B</span>,</span><br><span class=\"line\">    <span class=\"number\">0x3A</span>, <span class=\"number\">0x91</span>, <span class=\"number\">0x11</span>, <span class=\"number\">0x41</span>, <span class=\"number\">0x4F</span>, <span class=\"number\">0x67</span>, <span class=\"number\">0xDC</span>, <span class=\"number\">0xEA</span>, <span class=\"number\">0x97</span>, <span class=\"number\">0xF2</span>, <span class=\"number\">0xCF</span>, <span class=\"number\">0xCE</span>, <span class=\"number\">0xF0</span>, <span class=\"number\">0xB4</span>, <span class=\"number\">0xE6</span>, <span class=\"number\">0x73</span>,</span><br><span class=\"line\">    <span class=\"number\">0x96</span>, <span class=\"number\">0xAC</span>, <span class=\"number\">0x74</span>, <span class=\"number\">0x22</span>, <span class=\"number\">0xE7</span>, <span class=\"number\">0xAD</span>, <span class=\"number\">0x35</span>, <span class=\"number\">0x85</span>, <span class=\"number\">0xE2</span>, <span class=\"number\">0xF9</span>, <span class=\"number\">0x37</span>, <span class=\"number\">0xE8</span>, <span class=\"number\">0x1C</span>, <span class=\"number\">0x75</span>, <span class=\"number\">0xDF</span>, <span class=\"number\">0x6E</span>,</span><br><span class=\"line\">    <span class=\"number\">0x47</span>, <span class=\"number\">0xF1</span>, <span class=\"number\">0x1A</span>, <span class=\"number\">0x71</span>, <span class=\"number\">0x1D</span>, <span class=\"number\">0x29</span>, <span class=\"number\">0xC5</span>, <span class=\"number\">0x89</span>, <span class=\"number\">0x6F</span>, <span class=\"number\">0xB7</span>, <span class=\"number\">0x62</span>, <span class=\"number\">0x0E</span>, <span class=\"number\">0xAA</span>, <span class=\"number\">0x18</span>, <span class=\"number\">0xBE</span>, <span class=\"number\">0x1B</span>,</span><br><span class=\"line\">    <span class=\"number\">0xFC</span>, <span class=\"number\">0x56</span>, <span class=\"number\">0x3E</span>, <span class=\"number\">0x4B</span>, <span class=\"number\">0xC6</span>, <span class=\"number\">0xD2</span>, <span class=\"number\">0x79</span>, <span class=\"number\">0x20</span>, <span class=\"number\">0x9A</span>, <span class=\"number\">0xDB</span>, <span class=\"number\">0xC0</span>, <span class=\"number\">0xFE</span>, <span class=\"number\">0x78</span>, <span class=\"number\">0xCD</span>, <span class=\"number\">0x5A</span>, <span class=\"number\">0xF4</span>,</span><br><span class=\"line\">    <span class=\"number\">0x1F</span>, <span class=\"number\">0xDD</span>, <span class=\"number\">0xA8</span>, <span class=\"number\">0x33</span>, <span class=\"number\">0x88</span>, <span class=\"number\">0x07</span>, <span class=\"number\">0xC7</span>, <span class=\"number\">0x31</span>, <span class=\"number\">0xB1</span>, <span class=\"number\">0x12</span>, <span class=\"number\">0x10</span>, <span class=\"number\">0x59</span>, <span class=\"number\">0x27</span>, <span class=\"number\">0x80</span>, <span class=\"number\">0xEC</span>, <span class=\"number\">0x5F</span>,</span><br><span class=\"line\">    <span class=\"number\">0x60</span>, <span class=\"number\">0x51</span>, <span class=\"number\">0x7F</span>, <span class=\"number\">0xA9</span>, <span class=\"number\">0x19</span>, <span class=\"number\">0xB5</span>, <span class=\"number\">0x4A</span>, <span class=\"number\">0x0D</span>, <span class=\"number\">0x2D</span>, <span class=\"number\">0xE5</span>, <span class=\"number\">0x7A</span>, <span class=\"number\">0x9F</span>, <span class=\"number\">0x93</span>, <span class=\"number\">0xC9</span>, <span class=\"number\">0x9C</span>, <span class=\"number\">0xEF</span>,</span><br><span class=\"line\">    <span class=\"number\">0xA0</span>, <span class=\"number\">0xE0</span>, <span class=\"number\">0x3B</span>, <span class=\"number\">0x4D</span>, <span class=\"number\">0xAE</span>, <span class=\"number\">0x2A</span>, <span class=\"number\">0xF5</span>, <span class=\"number\">0xB0</span>, <span class=\"number\">0xC8</span>, <span class=\"number\">0xEB</span>, <span class=\"number\">0xBB</span>, <span class=\"number\">0x3C</span>, <span class=\"number\">0x83</span>, <span class=\"number\">0x53</span>, <span class=\"number\">0x99</span>, <span class=\"number\">0x61</span>,</span><br><span class=\"line\">    <span class=\"number\">0x17</span>, <span class=\"number\">0x2B</span>, <span class=\"number\">0x04</span>, <span class=\"number\">0x7E</span>, <span class=\"number\">0xBA</span>, <span class=\"number\">0x77</span>, <span class=\"number\">0xD6</span>, <span class=\"number\">0x26</span>, <span class=\"number\">0xE1</span>, <span class=\"number\">0x69</span>, <span class=\"number\">0x14</span>, <span class=\"number\">0x63</span>, <span class=\"number\">0x55</span>, <span class=\"number\">0x21</span>, <span class=\"number\">0x0C</span>, <span class=\"number\">0x7D</span>,</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">bytes2matrix</span>(<span class=\"params\">text</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot; Converts a 16-byte array into a 4x4 matrix.  &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> [<span class=\"built_in\">list</span>(text[i:i+<span class=\"number\">4</span>]) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(text), <span class=\"number\">4</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">matrix2bytes</span>(<span class=\"params\">matrix</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array.  &quot;&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">bytes</span>(<span class=\"built_in\">sum</span>(matrix, []))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">add_round_key</span>(<span class=\"params\">s, k</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [</span><br><span class=\"line\">        [s[i][j] ^ k[i][j] <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>)]</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>)</span><br><span class=\"line\">    ]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">sub_bytes</span>(<span class=\"params\">s, sbox=s_box</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">            s[i][j] = sbox[s[i][j]]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> s</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">shift_rows</span>(<span class=\"params\">s</span>):</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">1</span>], s[<span class=\"number\">1</span>][<span class=\"number\">1</span>], s[<span class=\"number\">2</span>][<span class=\"number\">1</span>], s[<span class=\"number\">3</span>][<span class=\"number\">1</span>] = s[<span class=\"number\">1</span>][<span class=\"number\">1</span>], s[<span class=\"number\">2</span>][<span class=\"number\">1</span>], s[<span class=\"number\">3</span>][<span class=\"number\">1</span>], s[<span class=\"number\">0</span>][<span class=\"number\">1</span>]</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">2</span>], s[<span class=\"number\">1</span>][<span class=\"number\">2</span>], s[<span class=\"number\">2</span>][<span class=\"number\">2</span>], s[<span class=\"number\">3</span>][<span class=\"number\">2</span>] = s[<span class=\"number\">2</span>][<span class=\"number\">2</span>], s[<span class=\"number\">3</span>][<span class=\"number\">2</span>], s[<span class=\"number\">0</span>][<span class=\"number\">2</span>], s[<span class=\"number\">1</span>][<span class=\"number\">2</span>]</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">3</span>], s[<span class=\"number\">1</span>][<span class=\"number\">3</span>], s[<span class=\"number\">2</span>][<span class=\"number\">3</span>], s[<span class=\"number\">3</span>][<span class=\"number\">3</span>] = s[<span class=\"number\">3</span>][<span class=\"number\">3</span>], s[<span class=\"number\">0</span>][<span class=\"number\">3</span>], s[<span class=\"number\">1</span>][<span class=\"number\">3</span>], s[<span class=\"number\">2</span>][<span class=\"number\">3</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">inv_shift_rows</span>(<span class=\"params\">s</span>):</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">1</span>], s[<span class=\"number\">1</span>][<span class=\"number\">1</span>], s[<span class=\"number\">2</span>][<span class=\"number\">1</span>], s[<span class=\"number\">3</span>][<span class=\"number\">1</span>] = s[<span class=\"number\">3</span>][<span class=\"number\">1</span>], s[<span class=\"number\">0</span>][<span class=\"number\">1</span>], s[<span class=\"number\">1</span>][<span class=\"number\">1</span>], s[<span class=\"number\">2</span>][<span class=\"number\">1</span>]</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">2</span>], s[<span class=\"number\">1</span>][<span class=\"number\">2</span>], s[<span class=\"number\">2</span>][<span class=\"number\">2</span>], s[<span class=\"number\">3</span>][<span class=\"number\">2</span>] = s[<span class=\"number\">2</span>][<span class=\"number\">2</span>], s[<span class=\"number\">3</span>][<span class=\"number\">2</span>], s[<span class=\"number\">0</span>][<span class=\"number\">2</span>], s[<span class=\"number\">1</span>][<span class=\"number\">2</span>]</span><br><span class=\"line\">    s[<span class=\"number\">0</span>][<span class=\"number\">3</span>], s[<span class=\"number\">1</span>][<span class=\"number\">3</span>], s[<span class=\"number\">2</span>][<span class=\"number\">3</span>], s[<span class=\"number\">3</span>][<span class=\"number\">3</span>] = s[<span class=\"number\">1</span>][<span class=\"number\">3</span>], s[<span class=\"number\">2</span>][<span class=\"number\">3</span>], s[<span class=\"number\">3</span>][<span class=\"number\">3</span>], s[<span class=\"number\">0</span>][<span class=\"number\">3</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># learned from http://cs.ucsb.edu/~koc/cs178/projects/JT/aes.c</span></span><br><span class=\"line\">xtime = <span class=\"keyword\">lambda</span> a: (((a &lt;&lt; <span class=\"number\">1</span>) ^ <span class=\"number\">0x1B</span>) &amp; <span class=\"number\">0xFF</span>) <span class=\"keyword\">if</span> (a &amp; <span class=\"number\">0x80</span>) <span class=\"keyword\">else</span> (a &lt;&lt; <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">mix_single_column</span>(<span class=\"params\">a</span>):</span><br><span class=\"line\">    <span class=\"comment\"># see Sec 4.1.2 in The Design of Rijndael</span></span><br><span class=\"line\">    t = a[<span class=\"number\">0</span>] ^ a[<span class=\"number\">1</span>] ^ a[<span class=\"number\">2</span>] ^ a[<span class=\"number\">3</span>]</span><br><span class=\"line\">    u = a[<span class=\"number\">0</span>]</span><br><span class=\"line\">    a[<span class=\"number\">0</span>] ^= t ^ xtime(a[<span class=\"number\">0</span>] ^ a[<span class=\"number\">1</span>])</span><br><span class=\"line\">    a[<span class=\"number\">1</span>] ^= t ^ xtime(a[<span class=\"number\">1</span>] ^ a[<span class=\"number\">2</span>])</span><br><span class=\"line\">    a[<span class=\"number\">2</span>] ^= t ^ xtime(a[<span class=\"number\">2</span>] ^ a[<span class=\"number\">3</span>])</span><br><span class=\"line\">    a[<span class=\"number\">3</span>] ^= t ^ xtime(a[<span class=\"number\">3</span>] ^ u)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">mix_columns</span>(<span class=\"params\">s</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">        mix_single_column(s[i])</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">inv_mix_columns</span>(<span class=\"params\">s</span>):</span><br><span class=\"line\">    <span class=\"comment\"># see Sec 4.1.3 in The Design of Rijndael</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">        u = xtime(xtime(s[i][<span class=\"number\">0</span>] ^ s[i][<span class=\"number\">2</span>]))</span><br><span class=\"line\">        v = xtime(xtime(s[i][<span class=\"number\">1</span>] ^ s[i][<span class=\"number\">3</span>]))</span><br><span class=\"line\">        s[i][<span class=\"number\">0</span>] ^= u</span><br><span class=\"line\">        s[i][<span class=\"number\">1</span>] ^= v</span><br><span class=\"line\">        s[i][<span class=\"number\">2</span>] ^= u</span><br><span class=\"line\">        s[i][<span class=\"number\">3</span>] ^= v</span><br><span class=\"line\"></span><br><span class=\"line\">    mix_columns(s)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">expand_key</span>(<span class=\"params\">master_key</span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    Expands and returns a list of key matrices for the given master_key.</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Round constants https://en.wikipedia.org/wiki/AES_key_schedule#Round_constants</span></span><br><span class=\"line\">    r_con = (</span><br><span class=\"line\">        <span class=\"number\">0x00</span>, <span class=\"number\">0x01</span>, <span class=\"number\">0x02</span>, <span class=\"number\">0x04</span>, <span class=\"number\">0x08</span>, <span class=\"number\">0x10</span>, <span class=\"number\">0x20</span>, <span class=\"number\">0x40</span>,</span><br><span class=\"line\">        <span class=\"number\">0x80</span>, <span class=\"number\">0x1B</span>, <span class=\"number\">0x36</span>, <span class=\"number\">0x6C</span>, <span class=\"number\">0xD8</span>, <span class=\"number\">0xAB</span>, <span class=\"number\">0x4D</span>, <span class=\"number\">0x9A</span>,</span><br><span class=\"line\">        <span class=\"number\">0x2F</span>, <span class=\"number\">0x5E</span>, <span class=\"number\">0xBC</span>, <span class=\"number\">0x63</span>, <span class=\"number\">0xC6</span>, <span class=\"number\">0x97</span>, <span class=\"number\">0x35</span>, <span class=\"number\">0x6A</span>,</span><br><span class=\"line\">        <span class=\"number\">0xD4</span>, <span class=\"number\">0xB3</span>, <span class=\"number\">0x7D</span>, <span class=\"number\">0xFA</span>, <span class=\"number\">0xEF</span>, <span class=\"number\">0xC5</span>, <span class=\"number\">0x91</span>, <span class=\"number\">0x39</span>,</span><br><span class=\"line\">    )</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Initialize round keys with raw key material.</span></span><br><span class=\"line\">    key_columns = bytes2matrix(master_key)</span><br><span class=\"line\">    iteration_size = <span class=\"built_in\">len</span>(master_key) // <span class=\"number\">4</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Each iteration has exactly as many columns as the key material.</span></span><br><span class=\"line\">    i = <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> <span class=\"built_in\">len</span>(key_columns) &lt; (N_ROUNDS + <span class=\"number\">1</span>) * <span class=\"number\">4</span>:</span><br><span class=\"line\">        <span class=\"comment\"># Copy previous word.</span></span><br><span class=\"line\">        word = <span class=\"built_in\">list</span>(key_columns[-<span class=\"number\">1</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Perform schedule_core once every &quot;row&quot;.</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(key_columns) % iteration_size == <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"comment\"># Circular shift.</span></span><br><span class=\"line\">            word.append(word.pop(<span class=\"number\">0</span>))</span><br><span class=\"line\">            <span class=\"comment\"># Map to S-BOX.</span></span><br><span class=\"line\">            word = [s_box[b] <span class=\"keyword\">for</span> b <span class=\"keyword\">in</span> word]</span><br><span class=\"line\">            <span class=\"comment\"># XOR with first byte of R-CON, since the others bytes of R-CON are 0.</span></span><br><span class=\"line\">            word[<span class=\"number\">0</span>] ^= r_con[i]</span><br><span class=\"line\">            i += <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">elif</span> <span class=\"built_in\">len</span>(master_key) == <span class=\"number\">32</span> <span class=\"keyword\">and</span> <span class=\"built_in\">len</span>(key_columns) % iteration_size == <span class=\"number\">4</span>:</span><br><span class=\"line\">            <span class=\"comment\"># Run word through S-box in the fourth iteration when using a</span></span><br><span class=\"line\">            <span class=\"comment\"># 256-bit key.</span></span><br><span class=\"line\">            word = [s_box[b] <span class=\"keyword\">for</span> b <span class=\"keyword\">in</span> word]</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># XOR with equivalent word from previous iteration.</span></span><br><span class=\"line\">        word = <span class=\"built_in\">bytes</span>(i ^ j <span class=\"keyword\">for</span> i, j <span class=\"keyword\">in</span> <span class=\"built_in\">zip</span>(word, key_columns[-iteration_size]))</span><br><span class=\"line\">        key_columns.append(word)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Group key words in 4x4 byte matrices.</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> [key_columns[<span class=\"number\">4</span> * i: <span class=\"number\">4</span>*(i+<span class=\"number\">1</span>)] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(key_columns) // <span class=\"number\">4</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">decrypt</span>(<span class=\"params\">key, ciphertext</span>):</span><br><span class=\"line\">    round_keys = expand_key(key)  <span class=\"comment\"># Remember to start from the last round key and work backwards through them when decrypting</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Convert ciphertext to state matrix</span></span><br><span class=\"line\">    state = bytes2matrix(ciphertext)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Initial add round key step</span></span><br><span class=\"line\">    state = add_round_key(state, round_keys[-<span class=\"number\">1</span>])</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(N_ROUNDS - <span class=\"number\">1</span>, <span class=\"number\">0</span>, -<span class=\"number\">1</span>):</span><br><span class=\"line\">        inv_shift_rows(state)</span><br><span class=\"line\">        state = sub_bytes(state, inv_s_box)</span><br><span class=\"line\">        state = add_round_key(state, round_keys[i])</span><br><span class=\"line\">        inv_mix_columns(state)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Run final round (skips the InvMixColumns step)</span></span><br><span class=\"line\">    inv_shift_rows(state)</span><br><span class=\"line\">    state = sub_bytes(state, inv_s_box)</span><br><span class=\"line\">    state = add_round_key(state, round_keys[<span class=\"number\">0</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># Convert state matrix to plaintext</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> matrix2bytes(state)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(decrypt(key, ciphertext))</span><br></pre></td></tr></table></figure>"},{"title":"前三章补充","date":"2022-05-08T07:29:00.000Z","mathjax":true,"_content":"\n之前竟然做错模块了？寄！\n\n<!--more-->\n\n我真的谢。\n\n7 号凌晨和面试师傅抱怨 Courses 第五章的 ECC 难学，师傅震惊：“你怎么去学 ECC 了？”，然后发现面试任务竟然是 Challenge 的那些章节，当时就心态大崩，我就说 ECC 怎么会是我现在可以染指的东西啊（麻。。\n\n不过还好师傅把二面时间延迟到 10 号了，7 号调休 9 号满课，算下来其实也就多了 8 号的周日可以做题，所以 8 号我必早起！\n\n这篇先补一下 Challenge 前三章没做的题，第五章后面再单独写吧。\n\n# Introduction\n\n## Network Attacks\n\n### Description\n\nSeveral of the challenges are dynamic and require you to talk to our challenge servers over the network. This allows you to perform man-in-the-middle attacks on people trying to communicate, or directly attack a vulnerable service. To keep things consistent, our interactive servers always send and receive JSON objects.\n\nPython makes such network communication easy with the `telnetlib` module. Conveniently, it's part of Python's standard library, so let's use it for now.\n\nFor this challenge, connect to `socket.cryptohack.org` on port `11112`. Send a JSON object with the key `buy` and value `flag`.\n\nThe example script below contains the beginnings of a solution for you to modify, and you can reuse it for later challenges.\n\nConnect at `nc socket.cryptohack.org 11112`.\n\n###  Analyze\n\n使用中间人攻击的方式获取 flag 。\n\n使用 telnetlib 库对 socket.cryptohack.org 11112端口以  JSON 对象的方式进行请求。\n\n题目说的很明确，就把 buy 的值改成 flag，运行代码就能出结果。\n\n### Code\n\n```python\n# 部分代码\nrequest = {\n    \"buy\": \"flag\"\n}\n```\n\n# General\n\n## ENCODING_Encoding Challenge\n\n### Description\n\nNow you've got the hang of the various encodings you'll be encountering, let's have a look at automating it.\n\nCan you pass all 100 levels to get the flag?\n\nThe *13377.py* file attached below is the source code for what's running on the server. The *pwntools_example.py* file provides the start of a solution using the incredibly convenient pwntools library. which we recommend. If you'd prefer to use Python's in-built telnetlib, *telnetlib_example.py* is also provided.\n\nFor more information about connecting to interactive challenges, see the [FAQ](https://cryptohack.org/faq#netcat). Feel free to skip ahead to the cryptography if you aren't in the mood for a coding challenge!\n\nConnect at `nc socket.cryptohack.org 13377`.\n\n###  Analyze\n\n刚开始看题是真没搞明白他要干啥，甚至以为这不是密码题。。（可能我阅读能力有问题？\n\n阅读服务端的代码，第一次连接服务器会返回编码方式以及编码后的字符串，这时候需要提交解码后的字符串，正确解码后服务器会发来下一个。100 次之后服务器主动终止连接，解码之后得到的就是 flag。\n\n解码函数看着他的加密代码倒是蛮容易写的，但是确实不喜欢做这类题。\n\n### Code\n\n```python\nimport codecs\nfrom pwn import *\nfrom Crypto.Util.number import *\nimport json\n\nr = remote('socket.cryptohack.org', 13377, level='debug')\n\n\ndef json_recv() -> dict:\n    line = r.recvline()\n    return json.loads(line.decode())\n\n\ndef json_send(hsh: dict) -> None:\n    request = json.dumps(hsh).encode()\n    r.sendline(request)\n\n\ndef decode(encoded: str, type: str) -> str:\n    if type == \"base64\":\n        return base64.b64decode(encoded).decode()\n    elif type == \"hex\":\n        return codecs.decode(encoded, 'hex').decode()\n    elif type == \"rot13\":\n        return codecs.decode(encoded, 'rot_13')\n    elif type == \"bigint\":\n        return long_to_bytes(int(encoded, 16)).decode()\n    elif type == \"utf-8\":\n        return \"\".join(chr(i) for i in encoded)\n    else:\n        return \"Unknown encoding\"\n\n\n# 第一次接收\nreceived = json_recv()\n\nfor i in range(100):\n    plain_text = decode(received[\"encoded\"], received[\"type\"])\n    to_send = {\n        \"decoded\": plain_text\n    }\n    json_send(to_send)\n    received = json_recv()\n```\n\n## XOR_Lemur XOR\n\n### Description\n\nI've hidden two cool images by XOR with the same secret key so you can't see them!\n\n###  Analyze\n\n题目描述倒是挺短。\n\n直接二进制异或不行，然后试试像素点异或。\n\n对图片操作很陌生诶。还是菜。\n\n### Code\n\n```python\nfrom PIL import Image\n\nflagImg = Image.open('D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/flag.png')\nflag = flagImg.load()\n\nlemurImg = Image.open('D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/lemur.png')\nlemur = lemurImg.load()\nwidth, height = flagImg.size\n\nnewImg = Image.new('RGB', (width, height))\nnew = newImg.load()\n\nfor i in range(width):\n    for j in range(height):\n        r1, g1, b1 = flag[i, j]\n        r2, g2, b2 = lemur[i, j]\n        new[i, j] = (r1 ^ r2, g1 ^ g2, b1 ^ b2)\n\nnewImg.save('D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/xorimage.png')\n```\n\n## DATA FORMATS_Privacy-Enhanced Mail?\n\n### Description\n\nAs we've seen in the encoding section, cryptography involves dealing with data in a wide variety of formats: big integers, raw bytes, hex strings and more. A few structured formats have been standardised to help send and receive cryptographic data. It helps to be able to recognise and manipulate these common data formats.\n\nPEM is a popular format for sending keys, certificates, and other cryptographic material. It looks like:\n\n```\n-----BEGIN RSA PUBLIC KEY-----\nMIIBCgKC... *(a whole bunch of base64)*\n-----END RSA PUBLIC KEY-----\n```\n\nIt wraps base64-encoded data by a one-line header and footer to indicate how to parse the data within. Perhaps unexpectedly, it's important for there to be the correct number of hyphens in the header and footer, otherwise cryptographic tools won't be able to recognise the file.\n\nThe data that gets base64-encoded is DER-encoded ASN.1 values. Confused? [Here](https://www.cryptologie.net/article/260/asn1-vs-der-vs-pem-vs-x509-vs-pkcs7-vs/) is more information about what these acronyms mean but the complexity is there for historical reasons and going too deep into the details may drive you insane.\n\nExtract the private key *d* as a decimal integer from this PEM-formatted RSA key.\n\n> There are two main approaches for solving this challenge. The data in the certificate can be read with the openssl command line tool, or in Python using PyCryptodome. We recommend using PyCryptodome: first import the RSA module with `from Crypto.PublicKey import RSA` and you can read the key data using `RSA.importKey()`.\n\n###  Analyze\n\n.pem 文件诶，看起来好酷的样子。\n\n用给出的库和函数转换一下直接出。\n\n###  Code\n\n```python\nfrom Crypto.PublicKey import RSA\n\nc = open(r\"./privacy_enhanced_mail.pem\").read()\np = RSA.import_key(c)\nprint(p.d)\n```\n\n## DATA FORMATS_CERTainly not\n\n### Description\n\nAs mentioned in the previous challenge, PEM is just a nice wrapper above DER encoded ASN.1. In some cases you may come across DER files directly; for instance many Windows utilities prefer to work with DER files by default. However, other tools expect PEM format and have difficulty importing a DER file, so it's good to know how to convert one format to another.\n\nAn SSL certificate is a crucial part of the modern web, binding a cryptographic key to details about an organisation. We'll cover more about these and PKI in the TLS category. Presented here is a DER-encoded x509 RSA certificate. Find the modulus of the certificate, giving your answer as a decimal.\n\n###  Analyze\n\n.der 文件，看起来依然很牛。\n\n和上一题基本就改了个文件名。\n\n### Code\n\n```python\nfrom Crypto.PublicKey import RSA\n\nc = open(r\"./CERTainly not_2048b-rsa-example-cert.der\", 'rb').read()\np = RSA.import_key(c)\nprint(p.n)\n```\n\n## DATA FORMATS_SSH Keys\n\n### Description\n\nSecure Shell Protocol (SSH) is a network protocol that uses cryptography to establish a secure channel over an insecure network (i.e. the internet). SSH enables developers and system administrators to run commands on servers from the other side of the world, without their password being sniffed or data being stolen. It is therefore critical to the security of the web.\n\nIn the old days, system administrators used to logon to their servers using telnet. This works similarly to our interactive challenges that involve connecting to `socket.cryptohack.org` - data is sent to a remote server, which performs actions based on what is sent. There is no transport encryption, so anyone listening in on the network (such as the WiFi access point owner, your ISP, or the NSA) can see all the telnet traffic.\n\nAs the internet became increasingly hostile, people realised the need for both authentication and encryption for administrative network traffic. SSH, first released in 1995, achieves these goals and much more, with advanced functionality built into the software like port forwarding, X11 forwarding, and SFTP (Secure File Transfer Protocol). SSH uses a client-server architecture, meaning the server runs SSH as a service daemon which is always online and waiting to receive connections, and the user runs an SSH client to make a connection to it.\n\nMost commonly, SSH is configured to use public-private key pairs for authentication. On the server, a copy of the user's public key is stored. The user's private key is stored locally on their laptop.\n\nNow let's say Bruce wants to connect as his user account `bschneier` to his server `bruces-server`. From his laptop he runs `ssh bschneier@bruces-server`. His SSH client opens a connection to the server on port 22 where the SSH daemon listens. First, the ciphers that will be used are agreed upon, then a session key to encrypt the connection is established using Diffie-Hellman Key exchange, but we won't go into the details on that here. Then, the server sends a random challenge message encrypted with Bruce's public key. Bruce uses his private key to decrypt the challenge and send a hash of the random challenge message back, proving that he owns the correct private key and he therefore authenticates himself to the server as `bschneier`. Now, the server gives Bruce a shell to run commands. If public-private key cryptography doesn't make sense to you yet, don't worry - we'll cover it extensively in the RSA category.\n\nAn SSH private key is stored in the PEM format, which we discussed in the \"Privacy-Enhanced Mail\" challenge. So it looks like this and is stored on Bruce's laptop at `/home/bschneier/.ssh/id_rsa`:\n\n```\n-----BEGIN RSA PRIVATE KEY-----\nMIIBCgKC... *(a whole bunch of base64)*\n-----END RSA PRIVATE KEY-----\n```\n\nSSH public keys, however, use a different format:\n\n```\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCtPLqba+GFvDHdFVs1Vvdk56cKqqw5cdomlu034666UsoFIqkig8H5kNsNefSpaR/iU7G0ZKCiWRRuAbTsuHN+Cz526XhQvzgKTBkTGYXdF/WdG/6/umou3Z0+wJvTZgvEmeEclvitBrPZkzhAK1M5ypgNR4p8scJplTgSSb84Ckqul/Dj/Sh+fwo6sU3S3j92qc27BVGChpQiGwjjut4CkHauzQA/gKCBIiLyzoFcLEHhjOBOEErnvrRPWCIAJhALkwV2rUbD4g1IWa7QI2q3nB0nlnjPnjjwaR7TpH4gy2NSIYNDdC1PZ8reBaFnGTXgzhQ2t0ROBNb+ZDgH8Fy+KTG+gEakpu20bRqB86NN6frDLOkZ9x3w32tJtqqrJTALy4Oi3MW0XPO61UBT133VNqAbNYGE2gx+mXBVOezbsY46C/V2fmxBJJKY/SFNs8wOVOHKwqRH0GI5VsG1YZClX3fqk8GDJYREaoyoL3HKQt1Ue/ZW7TlPRYzAoIB62C0= bschneier@facts\n```\n\nThis format makes it easier for these public keys to be added as lines to the file `/home/bschneier/.ssh/authorized_keys` on the server. Adding the public key to this file allows the corresponding private key to be used to authenticate on the server.\n\nThe `ssh-keygen` command is used to produce these public-private keypairs.\n\nExtract the modulus *n* as a decimal integer from Bruce's SSH public key.\n\n###  Analyze\n\n.pub 后缀更酷了。\n\n不过和第一题解法没区别，只能说函数真的强大。\n\n### Code\n\n```python\nfrom Crypto.PublicKey import RSA\n\nc = open(r\"./SSH Keys_bruce_rsa.pub\").read()\np = RSA.import_key(c)\nprint(p.n)\n```\n\n## DATA FORMATS_Transparency\n\n### Description\n\nWhen you connect to a website over HTTPS, the first TLS message sent by the server is the ServerHello containing the server TLS certificate. Your browser verifies that the TLS certificate is valid, and if not, will terminate the TLS handshake. Verification includes ensuring that:\n\n\\- the name on the certificate matches the domain\n\n\\- the certificate has not expired\n\n\\- the certificate is ultimately signed (via a \"chain of trust\") by a root key of a Certificate Authority (CA) that's trusted by your browser or operating system\n\nSince CAs have the power to sign any certificate, the security of the internet depends upon these organisations to issue TLS certificates to the correct people: they must only issue certificates to the real domain owners. However with Windows trusting root certificates from over 100 organisations by default, there's a number of opportunities for hackers, politics, or incompetence to break the whole model. If you could trick just a single CA to issue you a certificate for microsoft.com, you could use the corresponding private key to sign malware and bypass trust controls on Windows. CAs are strongly incentivised to be careful since their business depends upon people trusting them, however in practice they have failed several times.\n\nIn 2011 [Comodo CA was compromised](https://arstechnica.com/information-technology/2011/03/independent-iranian-hacker-claims-responsibility-for-comodo-hack/) and the hacker was able to issue certificates for Gmail and other services. In 2016, [Symantec was found](https://security.googleblog.com/2015/10/sustaining-digital-certificate-security.html) to have issued over 150 certificates without the domain owner's knowledge, as well as 2400 certificates for domains that were never registered.\n\nDue to such events, together with the fact that fraudulent certificates can take a long time to be discovered, since 2018 Certificate Transparency has been enforced by Google Chrome. Every CA must publish all certificates that they issue to a log, which anyone can search.\n\nAttached is an RSA public key in PEM format. Find the subdomain of cryptohack.org which uses these parameters in its TLS certificate, and visit that subdomain to obtain the flag.\n\n###  Analyze\n\n这题怎么说呢，一言难尽。\n\n倒是能解出来 n，但是怎么找到包含 n 的证书对应的域名呢，搜了很久也没找到。\n\n最后是直接去爆破，找到 url 里包含 flag 的子域名，访问得到 flag。\n\n也可以用 [crt.sh](https://crt.sh/) 搜指纹，查日志记录，不过也没用到公钥。\n\n最后还是不知道怎么用公钥推域名，怪捏。\n\n# Mathematics\n\n虽然之前做数学做了很久，不过值得欣慰的是 Challenge 第三章第一部分全都做完了。具体[点这里](http://smilin9.com/2022/05/03/Modular%20Arithmetic/) 。\n\n\n\n","source":"_posts/前三章补充.md","raw":"---\ntitle: 前三章补充\ndate: 2022-05-08 15:29:00\ntags: cryptohack\nmathjax: true\n---\n\n之前竟然做错模块了？寄！\n\n<!--more-->\n\n我真的谢。\n\n7 号凌晨和面试师傅抱怨 Courses 第五章的 ECC 难学，师傅震惊：“你怎么去学 ECC 了？”，然后发现面试任务竟然是 Challenge 的那些章节，当时就心态大崩，我就说 ECC 怎么会是我现在可以染指的东西啊（麻。。\n\n不过还好师傅把二面时间延迟到 10 号了，7 号调休 9 号满课，算下来其实也就多了 8 号的周日可以做题，所以 8 号我必早起！\n\n这篇先补一下 Challenge 前三章没做的题，第五章后面再单独写吧。\n\n# Introduction\n\n## Network Attacks\n\n### Description\n\nSeveral of the challenges are dynamic and require you to talk to our challenge servers over the network. This allows you to perform man-in-the-middle attacks on people trying to communicate, or directly attack a vulnerable service. To keep things consistent, our interactive servers always send and receive JSON objects.\n\nPython makes such network communication easy with the `telnetlib` module. Conveniently, it's part of Python's standard library, so let's use it for now.\n\nFor this challenge, connect to `socket.cryptohack.org` on port `11112`. Send a JSON object with the key `buy` and value `flag`.\n\nThe example script below contains the beginnings of a solution for you to modify, and you can reuse it for later challenges.\n\nConnect at `nc socket.cryptohack.org 11112`.\n\n###  Analyze\n\n使用中间人攻击的方式获取 flag 。\n\n使用 telnetlib 库对 socket.cryptohack.org 11112端口以  JSON 对象的方式进行请求。\n\n题目说的很明确，就把 buy 的值改成 flag，运行代码就能出结果。\n\n### Code\n\n```python\n# 部分代码\nrequest = {\n    \"buy\": \"flag\"\n}\n```\n\n# General\n\n## ENCODING_Encoding Challenge\n\n### Description\n\nNow you've got the hang of the various encodings you'll be encountering, let's have a look at automating it.\n\nCan you pass all 100 levels to get the flag?\n\nThe *13377.py* file attached below is the source code for what's running on the server. The *pwntools_example.py* file provides the start of a solution using the incredibly convenient pwntools library. which we recommend. If you'd prefer to use Python's in-built telnetlib, *telnetlib_example.py* is also provided.\n\nFor more information about connecting to interactive challenges, see the [FAQ](https://cryptohack.org/faq#netcat). Feel free to skip ahead to the cryptography if you aren't in the mood for a coding challenge!\n\nConnect at `nc socket.cryptohack.org 13377`.\n\n###  Analyze\n\n刚开始看题是真没搞明白他要干啥，甚至以为这不是密码题。。（可能我阅读能力有问题？\n\n阅读服务端的代码，第一次连接服务器会返回编码方式以及编码后的字符串，这时候需要提交解码后的字符串，正确解码后服务器会发来下一个。100 次之后服务器主动终止连接，解码之后得到的就是 flag。\n\n解码函数看着他的加密代码倒是蛮容易写的，但是确实不喜欢做这类题。\n\n### Code\n\n```python\nimport codecs\nfrom pwn import *\nfrom Crypto.Util.number import *\nimport json\n\nr = remote('socket.cryptohack.org', 13377, level='debug')\n\n\ndef json_recv() -> dict:\n    line = r.recvline()\n    return json.loads(line.decode())\n\n\ndef json_send(hsh: dict) -> None:\n    request = json.dumps(hsh).encode()\n    r.sendline(request)\n\n\ndef decode(encoded: str, type: str) -> str:\n    if type == \"base64\":\n        return base64.b64decode(encoded).decode()\n    elif type == \"hex\":\n        return codecs.decode(encoded, 'hex').decode()\n    elif type == \"rot13\":\n        return codecs.decode(encoded, 'rot_13')\n    elif type == \"bigint\":\n        return long_to_bytes(int(encoded, 16)).decode()\n    elif type == \"utf-8\":\n        return \"\".join(chr(i) for i in encoded)\n    else:\n        return \"Unknown encoding\"\n\n\n# 第一次接收\nreceived = json_recv()\n\nfor i in range(100):\n    plain_text = decode(received[\"encoded\"], received[\"type\"])\n    to_send = {\n        \"decoded\": plain_text\n    }\n    json_send(to_send)\n    received = json_recv()\n```\n\n## XOR_Lemur XOR\n\n### Description\n\nI've hidden two cool images by XOR with the same secret key so you can't see them!\n\n###  Analyze\n\n题目描述倒是挺短。\n\n直接二进制异或不行，然后试试像素点异或。\n\n对图片操作很陌生诶。还是菜。\n\n### Code\n\n```python\nfrom PIL import Image\n\nflagImg = Image.open('D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/flag.png')\nflag = flagImg.load()\n\nlemurImg = Image.open('D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/lemur.png')\nlemur = lemurImg.load()\nwidth, height = flagImg.size\n\nnewImg = Image.new('RGB', (width, height))\nnew = newImg.load()\n\nfor i in range(width):\n    for j in range(height):\n        r1, g1, b1 = flag[i, j]\n        r2, g2, b2 = lemur[i, j]\n        new[i, j] = (r1 ^ r2, g1 ^ g2, b1 ^ b2)\n\nnewImg.save('D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/xorimage.png')\n```\n\n## DATA FORMATS_Privacy-Enhanced Mail?\n\n### Description\n\nAs we've seen in the encoding section, cryptography involves dealing with data in a wide variety of formats: big integers, raw bytes, hex strings and more. A few structured formats have been standardised to help send and receive cryptographic data. It helps to be able to recognise and manipulate these common data formats.\n\nPEM is a popular format for sending keys, certificates, and other cryptographic material. It looks like:\n\n```\n-----BEGIN RSA PUBLIC KEY-----\nMIIBCgKC... *(a whole bunch of base64)*\n-----END RSA PUBLIC KEY-----\n```\n\nIt wraps base64-encoded data by a one-line header and footer to indicate how to parse the data within. Perhaps unexpectedly, it's important for there to be the correct number of hyphens in the header and footer, otherwise cryptographic tools won't be able to recognise the file.\n\nThe data that gets base64-encoded is DER-encoded ASN.1 values. Confused? [Here](https://www.cryptologie.net/article/260/asn1-vs-der-vs-pem-vs-x509-vs-pkcs7-vs/) is more information about what these acronyms mean but the complexity is there for historical reasons and going too deep into the details may drive you insane.\n\nExtract the private key *d* as a decimal integer from this PEM-formatted RSA key.\n\n> There are two main approaches for solving this challenge. The data in the certificate can be read with the openssl command line tool, or in Python using PyCryptodome. We recommend using PyCryptodome: first import the RSA module with `from Crypto.PublicKey import RSA` and you can read the key data using `RSA.importKey()`.\n\n###  Analyze\n\n.pem 文件诶，看起来好酷的样子。\n\n用给出的库和函数转换一下直接出。\n\n###  Code\n\n```python\nfrom Crypto.PublicKey import RSA\n\nc = open(r\"./privacy_enhanced_mail.pem\").read()\np = RSA.import_key(c)\nprint(p.d)\n```\n\n## DATA FORMATS_CERTainly not\n\n### Description\n\nAs mentioned in the previous challenge, PEM is just a nice wrapper above DER encoded ASN.1. In some cases you may come across DER files directly; for instance many Windows utilities prefer to work with DER files by default. However, other tools expect PEM format and have difficulty importing a DER file, so it's good to know how to convert one format to another.\n\nAn SSL certificate is a crucial part of the modern web, binding a cryptographic key to details about an organisation. We'll cover more about these and PKI in the TLS category. Presented here is a DER-encoded x509 RSA certificate. Find the modulus of the certificate, giving your answer as a decimal.\n\n###  Analyze\n\n.der 文件，看起来依然很牛。\n\n和上一题基本就改了个文件名。\n\n### Code\n\n```python\nfrom Crypto.PublicKey import RSA\n\nc = open(r\"./CERTainly not_2048b-rsa-example-cert.der\", 'rb').read()\np = RSA.import_key(c)\nprint(p.n)\n```\n\n## DATA FORMATS_SSH Keys\n\n### Description\n\nSecure Shell Protocol (SSH) is a network protocol that uses cryptography to establish a secure channel over an insecure network (i.e. the internet). SSH enables developers and system administrators to run commands on servers from the other side of the world, without their password being sniffed or data being stolen. It is therefore critical to the security of the web.\n\nIn the old days, system administrators used to logon to their servers using telnet. This works similarly to our interactive challenges that involve connecting to `socket.cryptohack.org` - data is sent to a remote server, which performs actions based on what is sent. There is no transport encryption, so anyone listening in on the network (such as the WiFi access point owner, your ISP, or the NSA) can see all the telnet traffic.\n\nAs the internet became increasingly hostile, people realised the need for both authentication and encryption for administrative network traffic. SSH, first released in 1995, achieves these goals and much more, with advanced functionality built into the software like port forwarding, X11 forwarding, and SFTP (Secure File Transfer Protocol). SSH uses a client-server architecture, meaning the server runs SSH as a service daemon which is always online and waiting to receive connections, and the user runs an SSH client to make a connection to it.\n\nMost commonly, SSH is configured to use public-private key pairs for authentication. On the server, a copy of the user's public key is stored. The user's private key is stored locally on their laptop.\n\nNow let's say Bruce wants to connect as his user account `bschneier` to his server `bruces-server`. From his laptop he runs `ssh bschneier@bruces-server`. His SSH client opens a connection to the server on port 22 where the SSH daemon listens. First, the ciphers that will be used are agreed upon, then a session key to encrypt the connection is established using Diffie-Hellman Key exchange, but we won't go into the details on that here. Then, the server sends a random challenge message encrypted with Bruce's public key. Bruce uses his private key to decrypt the challenge and send a hash of the random challenge message back, proving that he owns the correct private key and he therefore authenticates himself to the server as `bschneier`. Now, the server gives Bruce a shell to run commands. If public-private key cryptography doesn't make sense to you yet, don't worry - we'll cover it extensively in the RSA category.\n\nAn SSH private key is stored in the PEM format, which we discussed in the \"Privacy-Enhanced Mail\" challenge. So it looks like this and is stored on Bruce's laptop at `/home/bschneier/.ssh/id_rsa`:\n\n```\n-----BEGIN RSA PRIVATE KEY-----\nMIIBCgKC... *(a whole bunch of base64)*\n-----END RSA PRIVATE KEY-----\n```\n\nSSH public keys, however, use a different format:\n\n```\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCtPLqba+GFvDHdFVs1Vvdk56cKqqw5cdomlu034666UsoFIqkig8H5kNsNefSpaR/iU7G0ZKCiWRRuAbTsuHN+Cz526XhQvzgKTBkTGYXdF/WdG/6/umou3Z0+wJvTZgvEmeEclvitBrPZkzhAK1M5ypgNR4p8scJplTgSSb84Ckqul/Dj/Sh+fwo6sU3S3j92qc27BVGChpQiGwjjut4CkHauzQA/gKCBIiLyzoFcLEHhjOBOEErnvrRPWCIAJhALkwV2rUbD4g1IWa7QI2q3nB0nlnjPnjjwaR7TpH4gy2NSIYNDdC1PZ8reBaFnGTXgzhQ2t0ROBNb+ZDgH8Fy+KTG+gEakpu20bRqB86NN6frDLOkZ9x3w32tJtqqrJTALy4Oi3MW0XPO61UBT133VNqAbNYGE2gx+mXBVOezbsY46C/V2fmxBJJKY/SFNs8wOVOHKwqRH0GI5VsG1YZClX3fqk8GDJYREaoyoL3HKQt1Ue/ZW7TlPRYzAoIB62C0= bschneier@facts\n```\n\nThis format makes it easier for these public keys to be added as lines to the file `/home/bschneier/.ssh/authorized_keys` on the server. Adding the public key to this file allows the corresponding private key to be used to authenticate on the server.\n\nThe `ssh-keygen` command is used to produce these public-private keypairs.\n\nExtract the modulus *n* as a decimal integer from Bruce's SSH public key.\n\n###  Analyze\n\n.pub 后缀更酷了。\n\n不过和第一题解法没区别，只能说函数真的强大。\n\n### Code\n\n```python\nfrom Crypto.PublicKey import RSA\n\nc = open(r\"./SSH Keys_bruce_rsa.pub\").read()\np = RSA.import_key(c)\nprint(p.n)\n```\n\n## DATA FORMATS_Transparency\n\n### Description\n\nWhen you connect to a website over HTTPS, the first TLS message sent by the server is the ServerHello containing the server TLS certificate. Your browser verifies that the TLS certificate is valid, and if not, will terminate the TLS handshake. Verification includes ensuring that:\n\n\\- the name on the certificate matches the domain\n\n\\- the certificate has not expired\n\n\\- the certificate is ultimately signed (via a \"chain of trust\") by a root key of a Certificate Authority (CA) that's trusted by your browser or operating system\n\nSince CAs have the power to sign any certificate, the security of the internet depends upon these organisations to issue TLS certificates to the correct people: they must only issue certificates to the real domain owners. However with Windows trusting root certificates from over 100 organisations by default, there's a number of opportunities for hackers, politics, or incompetence to break the whole model. If you could trick just a single CA to issue you a certificate for microsoft.com, you could use the corresponding private key to sign malware and bypass trust controls on Windows. CAs are strongly incentivised to be careful since their business depends upon people trusting them, however in practice they have failed several times.\n\nIn 2011 [Comodo CA was compromised](https://arstechnica.com/information-technology/2011/03/independent-iranian-hacker-claims-responsibility-for-comodo-hack/) and the hacker was able to issue certificates for Gmail and other services. In 2016, [Symantec was found](https://security.googleblog.com/2015/10/sustaining-digital-certificate-security.html) to have issued over 150 certificates without the domain owner's knowledge, as well as 2400 certificates for domains that were never registered.\n\nDue to such events, together with the fact that fraudulent certificates can take a long time to be discovered, since 2018 Certificate Transparency has been enforced by Google Chrome. Every CA must publish all certificates that they issue to a log, which anyone can search.\n\nAttached is an RSA public key in PEM format. Find the subdomain of cryptohack.org which uses these parameters in its TLS certificate, and visit that subdomain to obtain the flag.\n\n###  Analyze\n\n这题怎么说呢，一言难尽。\n\n倒是能解出来 n，但是怎么找到包含 n 的证书对应的域名呢，搜了很久也没找到。\n\n最后是直接去爆破，找到 url 里包含 flag 的子域名，访问得到 flag。\n\n也可以用 [crt.sh](https://crt.sh/) 搜指纹，查日志记录，不过也没用到公钥。\n\n最后还是不知道怎么用公钥推域名，怪捏。\n\n# Mathematics\n\n虽然之前做数学做了很久，不过值得欣慰的是 Challenge 第三章第一部分全都做完了。具体[点这里](http://smilin9.com/2022/05/03/Modular%20Arithmetic/) 。\n\n\n\n","slug":"前三章补充","published":1,"updated":"2022-05-08T18:49:34.786Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl37evny400059wfs99fvajgy","content":"<p>之前竟然做错模块了？寄！</p>\n<span id=\"more\"></span>\n\n<p>我真的谢。</p>\n<p>7 号凌晨和面试师傅抱怨 Courses 第五章的 ECC 难学，师傅震惊：“你怎么去学 ECC 了？”，然后发现面试任务竟然是 Challenge 的那些章节，当时就心态大崩，我就说 ECC 怎么会是我现在可以染指的东西啊（麻。。</p>\n<p>不过还好师傅把二面时间延迟到 10 号了，7 号调休 9 号满课，算下来其实也就多了 8 号的周日可以做题，所以 8 号我必早起！</p>\n<p>这篇先补一下 Challenge 前三章没做的题，第五章后面再单独写吧。</p>\n<h1 id=\"Introduction\"><a href=\"#Introduction\" class=\"headerlink\" title=\"Introduction\"></a>Introduction</h1><h2 id=\"Network-Attacks\"><a href=\"#Network-Attacks\" class=\"headerlink\" title=\"Network Attacks\"></a>Network Attacks</h2><h3 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Several of the challenges are dynamic and require you to talk to our challenge servers over the network. This allows you to perform man-in-the-middle attacks on people trying to communicate, or directly attack a vulnerable service. To keep things consistent, our interactive servers always send and receive JSON objects.</p>\n<p>Python makes such network communication easy with the <code>telnetlib</code> module. Conveniently, it’s part of Python’s standard library, so let’s use it for now.</p>\n<p>For this challenge, connect to <code>socket.cryptohack.org</code> on port <code>11112</code>. Send a JSON object with the key <code>buy</code> and value <code>flag</code>.</p>\n<p>The example script below contains the beginnings of a solution for you to modify, and you can reuse it for later challenges.</p>\n<p>Connect at <code>nc socket.cryptohack.org 11112</code>.</p>\n<h3 id=\"Analyze\"><a href=\"#Analyze\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>使用中间人攻击的方式获取 flag 。</p>\n<p>使用 telnetlib 库对 socket.cryptohack.org 11112端口以  JSON 对象的方式进行请求。</p>\n<p>题目说的很明确，就把 buy 的值改成 flag，运行代码就能出结果。</p>\n<h3 id=\"Code\"><a href=\"#Code\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 部分代码</span></span><br><span class=\"line\">request = &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;buy&quot;</span>: <span class=\"string\">&quot;flag&quot;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"General\"><a href=\"#General\" class=\"headerlink\" title=\"General\"></a>General</h1><h2 id=\"ENCODING-Encoding-Challenge\"><a href=\"#ENCODING-Encoding-Challenge\" class=\"headerlink\" title=\"ENCODING_Encoding Challenge\"></a>ENCODING_Encoding Challenge</h2><h3 id=\"Description-1\"><a href=\"#Description-1\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Now you’ve got the hang of the various encodings you’ll be encountering, let’s have a look at automating it.</p>\n<p>Can you pass all 100 levels to get the flag?</p>\n<p>The <em>13377.py</em> file attached below is the source code for what’s running on the server. The <em>pwntools_example.py</em> file provides the start of a solution using the incredibly convenient pwntools library. which we recommend. If you’d prefer to use Python’s in-built telnetlib, <em>telnetlib_example.py</em> is also provided.</p>\n<p>For more information about connecting to interactive challenges, see the <a href=\"https://cryptohack.org/faq#netcat\">FAQ</a>. Feel free to skip ahead to the cryptography if you aren’t in the mood for a coding challenge!</p>\n<p>Connect at <code>nc socket.cryptohack.org 13377</code>.</p>\n<h3 id=\"Analyze-1\"><a href=\"#Analyze-1\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>刚开始看题是真没搞明白他要干啥，甚至以为这不是密码题。。（可能我阅读能力有问题？</p>\n<p>阅读服务端的代码，第一次连接服务器会返回编码方式以及编码后的字符串，这时候需要提交解码后的字符串，正确解码后服务器会发来下一个。100 次之后服务器主动终止连接，解码之后得到的就是 flag。</p>\n<p>解码函数看着他的加密代码倒是蛮容易写的，但是确实不喜欢做这类题。</p>\n<h3 id=\"Code-1\"><a href=\"#Code-1\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> codecs</span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> Crypto.Util.number <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">&#x27;socket.cryptohack.org&#x27;</span>, <span class=\"number\">13377</span>, level=<span class=\"string\">&#x27;debug&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">json_recv</span>() -&gt; <span class=\"built_in\">dict</span>:</span><br><span class=\"line\">    line = r.recvline()</span><br><span class=\"line\">    <span class=\"keyword\">return</span> json.loads(line.decode())</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">json_send</span>(<span class=\"params\">hsh: <span class=\"built_in\">dict</span></span>) -&gt; <span class=\"literal\">None</span>:</span><br><span class=\"line\">    request = json.dumps(hsh).encode()</span><br><span class=\"line\">    r.sendline(request)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">decode</span>(<span class=\"params\">encoded: <span class=\"built_in\">str</span>, <span class=\"built_in\">type</span>: <span class=\"built_in\">str</span></span>) -&gt; <span class=\"built_in\">str</span>:</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"built_in\">type</span> == <span class=\"string\">&quot;base64&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> base64.b64decode(encoded).decode()</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"built_in\">type</span> == <span class=\"string\">&quot;hex&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> codecs.decode(encoded, <span class=\"string\">&#x27;hex&#x27;</span>).decode()</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"built_in\">type</span> == <span class=\"string\">&quot;rot13&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> codecs.decode(encoded, <span class=\"string\">&#x27;rot_13&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"built_in\">type</span> == <span class=\"string\">&quot;bigint&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> long_to_bytes(<span class=\"built_in\">int</span>(encoded, <span class=\"number\">16</span>)).decode()</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"built_in\">type</span> == <span class=\"string\">&quot;utf-8&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;&quot;</span>.join(<span class=\"built_in\">chr</span>(i) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> encoded)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;Unknown encoding&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 第一次接收</span></span><br><span class=\"line\">received = json_recv()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">100</span>):</span><br><span class=\"line\">    plain_text = decode(received[<span class=\"string\">&quot;encoded&quot;</span>], received[<span class=\"string\">&quot;type&quot;</span>])</span><br><span class=\"line\">    to_send = &#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;decoded&quot;</span>: plain_text</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    json_send(to_send)</span><br><span class=\"line\">    received = json_recv()</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"XOR-Lemur-XOR\"><a href=\"#XOR-Lemur-XOR\" class=\"headerlink\" title=\"XOR_Lemur XOR\"></a>XOR_Lemur XOR</h2><h3 id=\"Description-2\"><a href=\"#Description-2\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>I’ve hidden two cool images by XOR with the same secret key so you can’t see them!</p>\n<h3 id=\"Analyze-2\"><a href=\"#Analyze-2\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>题目描述倒是挺短。</p>\n<p>直接二进制异或不行，然后试试像素点异或。</p>\n<p>对图片操作很陌生诶。还是菜。</p>\n<h3 id=\"Code-2\"><a href=\"#Code-2\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> PIL <span class=\"keyword\">import</span> Image</span><br><span class=\"line\"></span><br><span class=\"line\">flagImg = Image.<span class=\"built_in\">open</span>(<span class=\"string\">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/flag.png&#x27;</span>)</span><br><span class=\"line\">flag = flagImg.load()</span><br><span class=\"line\"></span><br><span class=\"line\">lemurImg = Image.<span class=\"built_in\">open</span>(<span class=\"string\">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/lemur.png&#x27;</span>)</span><br><span class=\"line\">lemur = lemurImg.load()</span><br><span class=\"line\">width, height = flagImg.size</span><br><span class=\"line\"></span><br><span class=\"line\">newImg = Image.new(<span class=\"string\">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class=\"line\">new = newImg.load()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(width):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(height):</span><br><span class=\"line\">        r1, g1, b1 = flag[i, j]</span><br><span class=\"line\">        r2, g2, b2 = lemur[i, j]</span><br><span class=\"line\">        new[i, j] = (r1 ^ r2, g1 ^ g2, b1 ^ b2)</span><br><span class=\"line\"></span><br><span class=\"line\">newImg.save(<span class=\"string\">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/xorimage.png&#x27;</span>)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"DATA-FORMATS-Privacy-Enhanced-Mail\"><a href=\"#DATA-FORMATS-Privacy-Enhanced-Mail\" class=\"headerlink\" title=\"DATA FORMATS_Privacy-Enhanced Mail?\"></a>DATA FORMATS_Privacy-Enhanced Mail?</h2><h3 id=\"Description-3\"><a href=\"#Description-3\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>As we’ve seen in the encoding section, cryptography involves dealing with data in a wide variety of formats: big integers, raw bytes, hex strings and more. A few structured formats have been standardised to help send and receive cryptographic data. It helps to be able to recognise and manipulate these common data formats.</p>\n<p>PEM is a popular format for sending keys, certificates, and other cryptographic material. It looks like:</p>\n<figure class=\"highlight jboss-cli\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"params\">-----BEGIN</span> RSA PUBLIC KEY<span class=\"params\">-----</span></span><br><span class=\"line\">MIIBCgKC.<span class=\"string\">..</span> *<span class=\"params\">(a whole bunch of base64)</span>*</span><br><span class=\"line\"><span class=\"params\">-----END</span> RSA PUBLIC KEY<span class=\"params\">-----</span></span><br></pre></td></tr></table></figure>\n\n<p>It wraps base64-encoded data by a one-line header and footer to indicate how to parse the data within. Perhaps unexpectedly, it’s important for there to be the correct number of hyphens in the header and footer, otherwise cryptographic tools won’t be able to recognise the file.</p>\n<p>The data that gets base64-encoded is DER-encoded ASN.1 values. Confused? <a href=\"https://www.cryptologie.net/article/260/asn1-vs-der-vs-pem-vs-x509-vs-pkcs7-vs/\">Here</a> is more information about what these acronyms mean but the complexity is there for historical reasons and going too deep into the details may drive you insane.</p>\n<p>Extract the private key <em>d</em> as a decimal integer from this PEM-formatted RSA key.</p>\n<blockquote>\n<p>There are two main approaches for solving this challenge. The data in the certificate can be read with the openssl command line tool, or in Python using PyCryptodome. We recommend using PyCryptodome: first import the RSA module with <code>from Crypto.PublicKey import RSA</code> and you can read the key data using <code>RSA.importKey()</code>.</p>\n</blockquote>\n<h3 id=\"Analyze-3\"><a href=\"#Analyze-3\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>.pem 文件诶，看起来好酷的样子。</p>\n<p>用给出的库和函数转换一下直接出。</p>\n<h3 id=\"Code-3\"><a href=\"#Code-3\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> Crypto.PublicKey <span class=\"keyword\">import</span> RSA</span><br><span class=\"line\"></span><br><span class=\"line\">c = <span class=\"built_in\">open</span>(<span class=\"string\">r&quot;./privacy_enhanced_mail.pem&quot;</span>).read()</span><br><span class=\"line\">p = RSA.import_key(c)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(p.d)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"DATA-FORMATS-CERTainly-not\"><a href=\"#DATA-FORMATS-CERTainly-not\" class=\"headerlink\" title=\"DATA FORMATS_CERTainly not\"></a>DATA FORMATS_CERTainly not</h2><h3 id=\"Description-4\"><a href=\"#Description-4\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>As mentioned in the previous challenge, PEM is just a nice wrapper above DER encoded ASN.1. In some cases you may come across DER files directly; for instance many Windows utilities prefer to work with DER files by default. However, other tools expect PEM format and have difficulty importing a DER file, so it’s good to know how to convert one format to another.</p>\n<p>An SSL certificate is a crucial part of the modern web, binding a cryptographic key to details about an organisation. We’ll cover more about these and PKI in the TLS category. Presented here is a DER-encoded x509 RSA certificate. Find the modulus of the certificate, giving your answer as a decimal.</p>\n<h3 id=\"Analyze-4\"><a href=\"#Analyze-4\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>.der 文件，看起来依然很牛。</p>\n<p>和上一题基本就改了个文件名。</p>\n<h3 id=\"Code-4\"><a href=\"#Code-4\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> Crypto.PublicKey <span class=\"keyword\">import</span> RSA</span><br><span class=\"line\"></span><br><span class=\"line\">c = <span class=\"built_in\">open</span>(<span class=\"string\">r&quot;./CERTainly not_2048b-rsa-example-cert.der&quot;</span>, <span class=\"string\">&#x27;rb&#x27;</span>).read()</span><br><span class=\"line\">p = RSA.import_key(c)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(p.n)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"DATA-FORMATS-SSH-Keys\"><a href=\"#DATA-FORMATS-SSH-Keys\" class=\"headerlink\" title=\"DATA FORMATS_SSH Keys\"></a>DATA FORMATS_SSH Keys</h2><h3 id=\"Description-5\"><a href=\"#Description-5\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Secure Shell Protocol (SSH) is a network protocol that uses cryptography to establish a secure channel over an insecure network (i.e. the internet). SSH enables developers and system administrators to run commands on servers from the other side of the world, without their password being sniffed or data being stolen. It is therefore critical to the security of the web.</p>\n<p>In the old days, system administrators used to logon to their servers using telnet. This works similarly to our interactive challenges that involve connecting to <code>socket.cryptohack.org</code> - data is sent to a remote server, which performs actions based on what is sent. There is no transport encryption, so anyone listening in on the network (such as the WiFi access point owner, your ISP, or the NSA) can see all the telnet traffic.</p>\n<p>As the internet became increasingly hostile, people realised the need for both authentication and encryption for administrative network traffic. SSH, first released in 1995, achieves these goals and much more, with advanced functionality built into the software like port forwarding, X11 forwarding, and SFTP (Secure File Transfer Protocol). SSH uses a client-server architecture, meaning the server runs SSH as a service daemon which is always online and waiting to receive connections, and the user runs an SSH client to make a connection to it.</p>\n<p>Most commonly, SSH is configured to use public-private key pairs for authentication. On the server, a copy of the user’s public key is stored. The user’s private key is stored locally on their laptop.</p>\n<p>Now let’s say Bruce wants to connect as his user account <code>bschneier</code> to his server <code>bruces-server</code>. From his laptop he runs <code>ssh bschneier@bruces-server</code>. His SSH client opens a connection to the server on port 22 where the SSH daemon listens. First, the ciphers that will be used are agreed upon, then a session key to encrypt the connection is established using Diffie-Hellman Key exchange, but we won’t go into the details on that here. Then, the server sends a random challenge message encrypted with Bruce’s public key. Bruce uses his private key to decrypt the challenge and send a hash of the random challenge message back, proving that he owns the correct private key and he therefore authenticates himself to the server as <code>bschneier</code>. Now, the server gives Bruce a shell to run commands. If public-private key cryptography doesn’t make sense to you yet, don’t worry - we’ll cover it extensively in the RSA category.</p>\n<p>An SSH private key is stored in the PEM format, which we discussed in the “Privacy-Enhanced Mail” challenge. So it looks like this and is stored on Bruce’s laptop at <code>/home/bschneier/.ssh/id_rsa</code>:</p>\n<figure class=\"highlight jboss-cli\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"params\">-----BEGIN</span> RSA PRIVATE KEY<span class=\"params\">-----</span></span><br><span class=\"line\">MIIBCgKC.<span class=\"string\">..</span> *<span class=\"params\">(a whole bunch of base64)</span>*</span><br><span class=\"line\"><span class=\"params\">-----END</span> RSA PRIVATE KEY<span class=\"params\">-----</span></span><br></pre></td></tr></table></figure>\n\n<p>SSH public keys, however, use a different format:</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCtPLqba+GFvDHdFVs1Vvdk56cKqqw5cdomlu034666UsoFIqkig8H5kNsNefSpaR<span class=\"regexp\">/iU7G0ZKCiWRRuAbTsuHN+Cz526XhQvzgKTBkTGYXdF/</span>WdG<span class=\"regexp\">/6/um</span>ou3Z0+wJvTZgvEmeEclvitBrPZkzhAK1M5ypgNR4p8scJplTgSSb84Ckqul<span class=\"regexp\">/Dj/</span>Sh+fwo6sU3S3j92qc27BVGChpQiGwjjut4CkHauzQA<span class=\"regexp\">/gKCBIiLyzoFcLEHhjOBOEErnvrRPWCIAJhALkwV2rUbD4g1IWa7QI2q3nB0nlnjPnjjwaR7TpH4gy2NSIYNDdC1PZ8reBaFnGTXgzhQ2t0ROBNb+ZDgH8Fy+KTG+gEakpu20bRqB86NN6frDLOkZ9x3w32tJtqqrJTALy4Oi3MW0XPO61UBT133VNqAbNYGE2gx+mXBVOezbsY46C/</span>V2fmxBJJKY<span class=\"regexp\">/SFNs8wOVOHKwqRH0GI5VsG1YZClX3fqk8GDJYREaoyoL3HKQt1Ue/</span>ZW7TlPRYzAoIB62C0= bschneier@facts</span><br></pre></td></tr></table></figure>\n\n<p>This format makes it easier for these public keys to be added as lines to the file <code>/home/bschneier/.ssh/authorized_keys</code> on the server. Adding the public key to this file allows the corresponding private key to be used to authenticate on the server.</p>\n<p>The <code>ssh-keygen</code> command is used to produce these public-private keypairs.</p>\n<p>Extract the modulus <em>n</em> as a decimal integer from Bruce’s SSH public key.</p>\n<h3 id=\"Analyze-5\"><a href=\"#Analyze-5\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>.pub 后缀更酷了。</p>\n<p>不过和第一题解法没区别，只能说函数真的强大。</p>\n<h3 id=\"Code-5\"><a href=\"#Code-5\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> Crypto.PublicKey <span class=\"keyword\">import</span> RSA</span><br><span class=\"line\"></span><br><span class=\"line\">c = <span class=\"built_in\">open</span>(<span class=\"string\">r&quot;./SSH Keys_bruce_rsa.pub&quot;</span>).read()</span><br><span class=\"line\">p = RSA.import_key(c)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(p.n)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"DATA-FORMATS-Transparency\"><a href=\"#DATA-FORMATS-Transparency\" class=\"headerlink\" title=\"DATA FORMATS_Transparency\"></a>DATA FORMATS_Transparency</h2><h3 id=\"Description-6\"><a href=\"#Description-6\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>When you connect to a website over HTTPS, the first TLS message sent by the server is the ServerHello containing the server TLS certificate. Your browser verifies that the TLS certificate is valid, and if not, will terminate the TLS handshake. Verification includes ensuring that:</p>\n<p>- the name on the certificate matches the domain</p>\n<p>- the certificate has not expired</p>\n<p>- the certificate is ultimately signed (via a “chain of trust”) by a root key of a Certificate Authority (CA) that’s trusted by your browser or operating system</p>\n<p>Since CAs have the power to sign any certificate, the security of the internet depends upon these organisations to issue TLS certificates to the correct people: they must only issue certificates to the real domain owners. However with Windows trusting root certificates from over 100 organisations by default, there’s a number of opportunities for hackers, politics, or incompetence to break the whole model. If you could trick just a single CA to issue you a certificate for microsoft.com, you could use the corresponding private key to sign malware and bypass trust controls on Windows. CAs are strongly incentivised to be careful since their business depends upon people trusting them, however in practice they have failed several times.</p>\n<p>In 2011 <a href=\"https://arstechnica.com/information-technology/2011/03/independent-iranian-hacker-claims-responsibility-for-comodo-hack/\">Comodo CA was compromised</a> and the hacker was able to issue certificates for Gmail and other services. In 2016, <a href=\"https://security.googleblog.com/2015/10/sustaining-digital-certificate-security.html\">Symantec was found</a> to have issued over 150 certificates without the domain owner’s knowledge, as well as 2400 certificates for domains that were never registered.</p>\n<p>Due to such events, together with the fact that fraudulent certificates can take a long time to be discovered, since 2018 Certificate Transparency has been enforced by Google Chrome. Every CA must publish all certificates that they issue to a log, which anyone can search.</p>\n<p>Attached is an RSA public key in PEM format. Find the subdomain of cryptohack.org which uses these parameters in its TLS certificate, and visit that subdomain to obtain the flag.</p>\n<h3 id=\"Analyze-6\"><a href=\"#Analyze-6\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>这题怎么说呢，一言难尽。</p>\n<p>倒是能解出来 n，但是怎么找到包含 n 的证书对应的域名呢，搜了很久也没找到。</p>\n<p>最后是直接去爆破，找到 url 里包含 flag 的子域名，访问得到 flag。</p>\n<p>也可以用 <a href=\"https://crt.sh/\">crt.sh</a> 搜指纹，查日志记录，不过也没用到公钥。</p>\n<p>最后还是不知道怎么用公钥推域名，怪捏。</p>\n<h1 id=\"Mathematics\"><a href=\"#Mathematics\" class=\"headerlink\" title=\"Mathematics\"></a>Mathematics</h1><p>虽然之前做数学做了很久，不过值得欣慰的是 Challenge 第三章第一部分全都做完了。具体<a href=\"http://smilin9.com/2022/05/03/Modular%20Arithmetic/\">点这里</a> 。</p>\n","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"<p>之前竟然做错模块了？寄！</p>","more":"<p>我真的谢。</p>\n<p>7 号凌晨和面试师傅抱怨 Courses 第五章的 ECC 难学，师傅震惊：“你怎么去学 ECC 了？”，然后发现面试任务竟然是 Challenge 的那些章节，当时就心态大崩，我就说 ECC 怎么会是我现在可以染指的东西啊（麻。。</p>\n<p>不过还好师傅把二面时间延迟到 10 号了，7 号调休 9 号满课，算下来其实也就多了 8 号的周日可以做题，所以 8 号我必早起！</p>\n<p>这篇先补一下 Challenge 前三章没做的题，第五章后面再单独写吧。</p>\n<h1 id=\"Introduction\"><a href=\"#Introduction\" class=\"headerlink\" title=\"Introduction\"></a>Introduction</h1><h2 id=\"Network-Attacks\"><a href=\"#Network-Attacks\" class=\"headerlink\" title=\"Network Attacks\"></a>Network Attacks</h2><h3 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Several of the challenges are dynamic and require you to talk to our challenge servers over the network. This allows you to perform man-in-the-middle attacks on people trying to communicate, or directly attack a vulnerable service. To keep things consistent, our interactive servers always send and receive JSON objects.</p>\n<p>Python makes such network communication easy with the <code>telnetlib</code> module. Conveniently, it’s part of Python’s standard library, so let’s use it for now.</p>\n<p>For this challenge, connect to <code>socket.cryptohack.org</code> on port <code>11112</code>. Send a JSON object with the key <code>buy</code> and value <code>flag</code>.</p>\n<p>The example script below contains the beginnings of a solution for you to modify, and you can reuse it for later challenges.</p>\n<p>Connect at <code>nc socket.cryptohack.org 11112</code>.</p>\n<h3 id=\"Analyze\"><a href=\"#Analyze\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>使用中间人攻击的方式获取 flag 。</p>\n<p>使用 telnetlib 库对 socket.cryptohack.org 11112端口以  JSON 对象的方式进行请求。</p>\n<p>题目说的很明确，就把 buy 的值改成 flag，运行代码就能出结果。</p>\n<h3 id=\"Code\"><a href=\"#Code\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 部分代码</span></span><br><span class=\"line\">request = &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;buy&quot;</span>: <span class=\"string\">&quot;flag&quot;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"General\"><a href=\"#General\" class=\"headerlink\" title=\"General\"></a>General</h1><h2 id=\"ENCODING-Encoding-Challenge\"><a href=\"#ENCODING-Encoding-Challenge\" class=\"headerlink\" title=\"ENCODING_Encoding Challenge\"></a>ENCODING_Encoding Challenge</h2><h3 id=\"Description-1\"><a href=\"#Description-1\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Now you’ve got the hang of the various encodings you’ll be encountering, let’s have a look at automating it.</p>\n<p>Can you pass all 100 levels to get the flag?</p>\n<p>The <em>13377.py</em> file attached below is the source code for what’s running on the server. The <em>pwntools_example.py</em> file provides the start of a solution using the incredibly convenient pwntools library. which we recommend. If you’d prefer to use Python’s in-built telnetlib, <em>telnetlib_example.py</em> is also provided.</p>\n<p>For more information about connecting to interactive challenges, see the <a href=\"https://cryptohack.org/faq#netcat\">FAQ</a>. Feel free to skip ahead to the cryptography if you aren’t in the mood for a coding challenge!</p>\n<p>Connect at <code>nc socket.cryptohack.org 13377</code>.</p>\n<h3 id=\"Analyze-1\"><a href=\"#Analyze-1\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>刚开始看题是真没搞明白他要干啥，甚至以为这不是密码题。。（可能我阅读能力有问题？</p>\n<p>阅读服务端的代码，第一次连接服务器会返回编码方式以及编码后的字符串，这时候需要提交解码后的字符串，正确解码后服务器会发来下一个。100 次之后服务器主动终止连接，解码之后得到的就是 flag。</p>\n<p>解码函数看着他的加密代码倒是蛮容易写的，但是确实不喜欢做这类题。</p>\n<h3 id=\"Code-1\"><a href=\"#Code-1\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> codecs</span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> Crypto.Util.number <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">&#x27;socket.cryptohack.org&#x27;</span>, <span class=\"number\">13377</span>, level=<span class=\"string\">&#x27;debug&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">json_recv</span>() -&gt; <span class=\"built_in\">dict</span>:</span><br><span class=\"line\">    line = r.recvline()</span><br><span class=\"line\">    <span class=\"keyword\">return</span> json.loads(line.decode())</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">json_send</span>(<span class=\"params\">hsh: <span class=\"built_in\">dict</span></span>) -&gt; <span class=\"literal\">None</span>:</span><br><span class=\"line\">    request = json.dumps(hsh).encode()</span><br><span class=\"line\">    r.sendline(request)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">decode</span>(<span class=\"params\">encoded: <span class=\"built_in\">str</span>, <span class=\"built_in\">type</span>: <span class=\"built_in\">str</span></span>) -&gt; <span class=\"built_in\">str</span>:</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"built_in\">type</span> == <span class=\"string\">&quot;base64&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> base64.b64decode(encoded).decode()</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"built_in\">type</span> == <span class=\"string\">&quot;hex&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> codecs.decode(encoded, <span class=\"string\">&#x27;hex&#x27;</span>).decode()</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"built_in\">type</span> == <span class=\"string\">&quot;rot13&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> codecs.decode(encoded, <span class=\"string\">&#x27;rot_13&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"built_in\">type</span> == <span class=\"string\">&quot;bigint&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> long_to_bytes(<span class=\"built_in\">int</span>(encoded, <span class=\"number\">16</span>)).decode()</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"built_in\">type</span> == <span class=\"string\">&quot;utf-8&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;&quot;</span>.join(<span class=\"built_in\">chr</span>(i) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> encoded)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;Unknown encoding&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 第一次接收</span></span><br><span class=\"line\">received = json_recv()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">100</span>):</span><br><span class=\"line\">    plain_text = decode(received[<span class=\"string\">&quot;encoded&quot;</span>], received[<span class=\"string\">&quot;type&quot;</span>])</span><br><span class=\"line\">    to_send = &#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;decoded&quot;</span>: plain_text</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    json_send(to_send)</span><br><span class=\"line\">    received = json_recv()</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"XOR-Lemur-XOR\"><a href=\"#XOR-Lemur-XOR\" class=\"headerlink\" title=\"XOR_Lemur XOR\"></a>XOR_Lemur XOR</h2><h3 id=\"Description-2\"><a href=\"#Description-2\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>I’ve hidden two cool images by XOR with the same secret key so you can’t see them!</p>\n<h3 id=\"Analyze-2\"><a href=\"#Analyze-2\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>题目描述倒是挺短。</p>\n<p>直接二进制异或不行，然后试试像素点异或。</p>\n<p>对图片操作很陌生诶。还是菜。</p>\n<h3 id=\"Code-2\"><a href=\"#Code-2\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> PIL <span class=\"keyword\">import</span> Image</span><br><span class=\"line\"></span><br><span class=\"line\">flagImg = Image.<span class=\"built_in\">open</span>(<span class=\"string\">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/flag.png&#x27;</span>)</span><br><span class=\"line\">flag = flagImg.load()</span><br><span class=\"line\"></span><br><span class=\"line\">lemurImg = Image.<span class=\"built_in\">open</span>(<span class=\"string\">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/lemur.png&#x27;</span>)</span><br><span class=\"line\">lemur = lemurImg.load()</span><br><span class=\"line\">width, height = flagImg.size</span><br><span class=\"line\"></span><br><span class=\"line\">newImg = Image.new(<span class=\"string\">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class=\"line\">new = newImg.load()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(width):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(height):</span><br><span class=\"line\">        r1, g1, b1 = flag[i, j]</span><br><span class=\"line\">        r2, g2, b2 = lemur[i, j]</span><br><span class=\"line\">        new[i, j] = (r1 ^ r2, g1 ^ g2, b1 ^ b2)</span><br><span class=\"line\"></span><br><span class=\"line\">newImg.save(<span class=\"string\">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/xorimage.png&#x27;</span>)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"DATA-FORMATS-Privacy-Enhanced-Mail\"><a href=\"#DATA-FORMATS-Privacy-Enhanced-Mail\" class=\"headerlink\" title=\"DATA FORMATS_Privacy-Enhanced Mail?\"></a>DATA FORMATS_Privacy-Enhanced Mail?</h2><h3 id=\"Description-3\"><a href=\"#Description-3\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>As we’ve seen in the encoding section, cryptography involves dealing with data in a wide variety of formats: big integers, raw bytes, hex strings and more. A few structured formats have been standardised to help send and receive cryptographic data. It helps to be able to recognise and manipulate these common data formats.</p>\n<p>PEM is a popular format for sending keys, certificates, and other cryptographic material. It looks like:</p>\n<figure class=\"highlight jboss-cli\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"params\">-----BEGIN</span> RSA PUBLIC KEY<span class=\"params\">-----</span></span><br><span class=\"line\">MIIBCgKC.<span class=\"string\">..</span> *<span class=\"params\">(a whole bunch of base64)</span>*</span><br><span class=\"line\"><span class=\"params\">-----END</span> RSA PUBLIC KEY<span class=\"params\">-----</span></span><br></pre></td></tr></table></figure>\n\n<p>It wraps base64-encoded data by a one-line header and footer to indicate how to parse the data within. Perhaps unexpectedly, it’s important for there to be the correct number of hyphens in the header and footer, otherwise cryptographic tools won’t be able to recognise the file.</p>\n<p>The data that gets base64-encoded is DER-encoded ASN.1 values. Confused? <a href=\"https://www.cryptologie.net/article/260/asn1-vs-der-vs-pem-vs-x509-vs-pkcs7-vs/\">Here</a> is more information about what these acronyms mean but the complexity is there for historical reasons and going too deep into the details may drive you insane.</p>\n<p>Extract the private key <em>d</em> as a decimal integer from this PEM-formatted RSA key.</p>\n<blockquote>\n<p>There are two main approaches for solving this challenge. The data in the certificate can be read with the openssl command line tool, or in Python using PyCryptodome. We recommend using PyCryptodome: first import the RSA module with <code>from Crypto.PublicKey import RSA</code> and you can read the key data using <code>RSA.importKey()</code>.</p>\n</blockquote>\n<h3 id=\"Analyze-3\"><a href=\"#Analyze-3\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>.pem 文件诶，看起来好酷的样子。</p>\n<p>用给出的库和函数转换一下直接出。</p>\n<h3 id=\"Code-3\"><a href=\"#Code-3\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> Crypto.PublicKey <span class=\"keyword\">import</span> RSA</span><br><span class=\"line\"></span><br><span class=\"line\">c = <span class=\"built_in\">open</span>(<span class=\"string\">r&quot;./privacy_enhanced_mail.pem&quot;</span>).read()</span><br><span class=\"line\">p = RSA.import_key(c)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(p.d)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"DATA-FORMATS-CERTainly-not\"><a href=\"#DATA-FORMATS-CERTainly-not\" class=\"headerlink\" title=\"DATA FORMATS_CERTainly not\"></a>DATA FORMATS_CERTainly not</h2><h3 id=\"Description-4\"><a href=\"#Description-4\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>As mentioned in the previous challenge, PEM is just a nice wrapper above DER encoded ASN.1. In some cases you may come across DER files directly; for instance many Windows utilities prefer to work with DER files by default. However, other tools expect PEM format and have difficulty importing a DER file, so it’s good to know how to convert one format to another.</p>\n<p>An SSL certificate is a crucial part of the modern web, binding a cryptographic key to details about an organisation. We’ll cover more about these and PKI in the TLS category. Presented here is a DER-encoded x509 RSA certificate. Find the modulus of the certificate, giving your answer as a decimal.</p>\n<h3 id=\"Analyze-4\"><a href=\"#Analyze-4\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>.der 文件，看起来依然很牛。</p>\n<p>和上一题基本就改了个文件名。</p>\n<h3 id=\"Code-4\"><a href=\"#Code-4\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> Crypto.PublicKey <span class=\"keyword\">import</span> RSA</span><br><span class=\"line\"></span><br><span class=\"line\">c = <span class=\"built_in\">open</span>(<span class=\"string\">r&quot;./CERTainly not_2048b-rsa-example-cert.der&quot;</span>, <span class=\"string\">&#x27;rb&#x27;</span>).read()</span><br><span class=\"line\">p = RSA.import_key(c)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(p.n)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"DATA-FORMATS-SSH-Keys\"><a href=\"#DATA-FORMATS-SSH-Keys\" class=\"headerlink\" title=\"DATA FORMATS_SSH Keys\"></a>DATA FORMATS_SSH Keys</h2><h3 id=\"Description-5\"><a href=\"#Description-5\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>Secure Shell Protocol (SSH) is a network protocol that uses cryptography to establish a secure channel over an insecure network (i.e. the internet). SSH enables developers and system administrators to run commands on servers from the other side of the world, without their password being sniffed or data being stolen. It is therefore critical to the security of the web.</p>\n<p>In the old days, system administrators used to logon to their servers using telnet. This works similarly to our interactive challenges that involve connecting to <code>socket.cryptohack.org</code> - data is sent to a remote server, which performs actions based on what is sent. There is no transport encryption, so anyone listening in on the network (such as the WiFi access point owner, your ISP, or the NSA) can see all the telnet traffic.</p>\n<p>As the internet became increasingly hostile, people realised the need for both authentication and encryption for administrative network traffic. SSH, first released in 1995, achieves these goals and much more, with advanced functionality built into the software like port forwarding, X11 forwarding, and SFTP (Secure File Transfer Protocol). SSH uses a client-server architecture, meaning the server runs SSH as a service daemon which is always online and waiting to receive connections, and the user runs an SSH client to make a connection to it.</p>\n<p>Most commonly, SSH is configured to use public-private key pairs for authentication. On the server, a copy of the user’s public key is stored. The user’s private key is stored locally on their laptop.</p>\n<p>Now let’s say Bruce wants to connect as his user account <code>bschneier</code> to his server <code>bruces-server</code>. From his laptop he runs <code>ssh bschneier@bruces-server</code>. His SSH client opens a connection to the server on port 22 where the SSH daemon listens. First, the ciphers that will be used are agreed upon, then a session key to encrypt the connection is established using Diffie-Hellman Key exchange, but we won’t go into the details on that here. Then, the server sends a random challenge message encrypted with Bruce’s public key. Bruce uses his private key to decrypt the challenge and send a hash of the random challenge message back, proving that he owns the correct private key and he therefore authenticates himself to the server as <code>bschneier</code>. Now, the server gives Bruce a shell to run commands. If public-private key cryptography doesn’t make sense to you yet, don’t worry - we’ll cover it extensively in the RSA category.</p>\n<p>An SSH private key is stored in the PEM format, which we discussed in the “Privacy-Enhanced Mail” challenge. So it looks like this and is stored on Bruce’s laptop at <code>/home/bschneier/.ssh/id_rsa</code>:</p>\n<figure class=\"highlight jboss-cli\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"params\">-----BEGIN</span> RSA PRIVATE KEY<span class=\"params\">-----</span></span><br><span class=\"line\">MIIBCgKC.<span class=\"string\">..</span> *<span class=\"params\">(a whole bunch of base64)</span>*</span><br><span class=\"line\"><span class=\"params\">-----END</span> RSA PRIVATE KEY<span class=\"params\">-----</span></span><br></pre></td></tr></table></figure>\n\n<p>SSH public keys, however, use a different format:</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCtPLqba+GFvDHdFVs1Vvdk56cKqqw5cdomlu034666UsoFIqkig8H5kNsNefSpaR<span class=\"regexp\">/iU7G0ZKCiWRRuAbTsuHN+Cz526XhQvzgKTBkTGYXdF/</span>WdG<span class=\"regexp\">/6/um</span>ou3Z0+wJvTZgvEmeEclvitBrPZkzhAK1M5ypgNR4p8scJplTgSSb84Ckqul<span class=\"regexp\">/Dj/</span>Sh+fwo6sU3S3j92qc27BVGChpQiGwjjut4CkHauzQA<span class=\"regexp\">/gKCBIiLyzoFcLEHhjOBOEErnvrRPWCIAJhALkwV2rUbD4g1IWa7QI2q3nB0nlnjPnjjwaR7TpH4gy2NSIYNDdC1PZ8reBaFnGTXgzhQ2t0ROBNb+ZDgH8Fy+KTG+gEakpu20bRqB86NN6frDLOkZ9x3w32tJtqqrJTALy4Oi3MW0XPO61UBT133VNqAbNYGE2gx+mXBVOezbsY46C/</span>V2fmxBJJKY<span class=\"regexp\">/SFNs8wOVOHKwqRH0GI5VsG1YZClX3fqk8GDJYREaoyoL3HKQt1Ue/</span>ZW7TlPRYzAoIB62C0= bschneier@facts</span><br></pre></td></tr></table></figure>\n\n<p>This format makes it easier for these public keys to be added as lines to the file <code>/home/bschneier/.ssh/authorized_keys</code> on the server. Adding the public key to this file allows the corresponding private key to be used to authenticate on the server.</p>\n<p>The <code>ssh-keygen</code> command is used to produce these public-private keypairs.</p>\n<p>Extract the modulus <em>n</em> as a decimal integer from Bruce’s SSH public key.</p>\n<h3 id=\"Analyze-5\"><a href=\"#Analyze-5\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>.pub 后缀更酷了。</p>\n<p>不过和第一题解法没区别，只能说函数真的强大。</p>\n<h3 id=\"Code-5\"><a href=\"#Code-5\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> Crypto.PublicKey <span class=\"keyword\">import</span> RSA</span><br><span class=\"line\"></span><br><span class=\"line\">c = <span class=\"built_in\">open</span>(<span class=\"string\">r&quot;./SSH Keys_bruce_rsa.pub&quot;</span>).read()</span><br><span class=\"line\">p = RSA.import_key(c)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(p.n)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"DATA-FORMATS-Transparency\"><a href=\"#DATA-FORMATS-Transparency\" class=\"headerlink\" title=\"DATA FORMATS_Transparency\"></a>DATA FORMATS_Transparency</h2><h3 id=\"Description-6\"><a href=\"#Description-6\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>When you connect to a website over HTTPS, the first TLS message sent by the server is the ServerHello containing the server TLS certificate. Your browser verifies that the TLS certificate is valid, and if not, will terminate the TLS handshake. Verification includes ensuring that:</p>\n<p>- the name on the certificate matches the domain</p>\n<p>- the certificate has not expired</p>\n<p>- the certificate is ultimately signed (via a “chain of trust”) by a root key of a Certificate Authority (CA) that’s trusted by your browser or operating system</p>\n<p>Since CAs have the power to sign any certificate, the security of the internet depends upon these organisations to issue TLS certificates to the correct people: they must only issue certificates to the real domain owners. However with Windows trusting root certificates from over 100 organisations by default, there’s a number of opportunities for hackers, politics, or incompetence to break the whole model. If you could trick just a single CA to issue you a certificate for microsoft.com, you could use the corresponding private key to sign malware and bypass trust controls on Windows. CAs are strongly incentivised to be careful since their business depends upon people trusting them, however in practice they have failed several times.</p>\n<p>In 2011 <a href=\"https://arstechnica.com/information-technology/2011/03/independent-iranian-hacker-claims-responsibility-for-comodo-hack/\">Comodo CA was compromised</a> and the hacker was able to issue certificates for Gmail and other services. In 2016, <a href=\"https://security.googleblog.com/2015/10/sustaining-digital-certificate-security.html\">Symantec was found</a> to have issued over 150 certificates without the domain owner’s knowledge, as well as 2400 certificates for domains that were never registered.</p>\n<p>Due to such events, together with the fact that fraudulent certificates can take a long time to be discovered, since 2018 Certificate Transparency has been enforced by Google Chrome. Every CA must publish all certificates that they issue to a log, which anyone can search.</p>\n<p>Attached is an RSA public key in PEM format. Find the subdomain of cryptohack.org which uses these parameters in its TLS certificate, and visit that subdomain to obtain the flag.</p>\n<h3 id=\"Analyze-6\"><a href=\"#Analyze-6\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>这题怎么说呢，一言难尽。</p>\n<p>倒是能解出来 n，但是怎么找到包含 n 的证书对应的域名呢，搜了很久也没找到。</p>\n<p>最后是直接去爆破，找到 url 里包含 flag 的子域名，访问得到 flag。</p>\n<p>也可以用 <a href=\"https://crt.sh/\">crt.sh</a> 搜指纹，查日志记录，不过也没用到公钥。</p>\n<p>最后还是不知道怎么用公钥推域名，怪捏。</p>\n<h1 id=\"Mathematics\"><a href=\"#Mathematics\" class=\"headerlink\" title=\"Mathematics\"></a>Mathematics</h1><p>虽然之前做数学做了很久，不过值得欣慰的是 Challenge 第三章第一部分全都做完了。具体<a href=\"http://smilin9.com/2022/05/03/Modular%20Arithmetic/\">点这里</a> 。</p>"},{"title":"RSA_STARTER","date":"2022-05-08T17:42:00.000Z","mathjax":true,"_content":"\n这个超快！\n\n我看谁不是速通（bushi\n\n<!--more-->\n\n最后一块内容，没想到意外地顺利，舒服捏。\n\n# RSA_STARTER\n\n## RSA Starter 1   \n\n### Description\n\nAll operations in RSA involve [modular exponentiation](https://en.wikipedia.org/wiki/Modular_exponentiation).\n\nModular exponentiation is an operation that is used extensively in cryptography and is normally written like: `2¹⁰ mod 17`\n\nYou can think of this as raising some number to a certain power (`2¹⁰ = 1024`), and then taking the remainder of the division by some other number (`1024 mod 17 = 4`). In Python there's a built-in operator for performing this operation: `pow(base, exponent, modulus)`\n\nIn RSA, modular exponentiation, together with the problem of prime factorisation, helps us to build a \"[trapdoor function](https://en.wikipedia.org/wiki/Trapdoor_function)\". This is a function that is easy to compute in one direction, but hard to do in reverse unless you have the right information. It allows us to encrypt a message, and only the person with the key can perform the inverse operation to decrypt it.\n\nFind the solution to `101¹⁷ mod 22663`\n\n###  Analyze\n\n模幂运算？有种回到做数论题的错觉（出戏。\n\n不过 pow() 是之前就用过的东西诶，突然亲切。\n\n无脑填数就行。\n\n### Code\n\n```python\nprint(pow(101, 17, 22663))\n```\n\n## RSA Starter 2\n\n### Description\n\nRSA encryption is modular exponentiation of a message with an exponent `e` and a modulus `N` which is normally a product of two primes: `N = p * q`.\n\nTogether the exponent and modulus form an RSA \"public key\" `(N, e)`. The most common value for `e` is `0x10001` or `65537`.\n\n\"Encrypt\" the number `12` using the exponent `e = 65537` and the primes `p = 17` and `q = 23`. What number do you get as the ciphertext?\n\n###  Analyze\n\n两个素数的乘积为模数。还是无脑填数。\n\n### Code\n\n```python\nb = 12\ne = 65537\np, q = 17, 23\nN = p * q\nprint(pow(b, e, N))\n```\n\n## RSA Starter 3\n\n### Description\n\nRSA relies on the difficulty of the factorisation of the modulus `N`. If the primes can be found then we can calculate the [Euler totient](https://leimao.github.io/article/RSA-Algorithm/) of `N` and thus decrypt the ciphertext.\n\nGiven `N = p*q` and two primes:\n\n```\np = 857504083339712752489993810777\nq = 1029224947942998075080348647219\n```\n\nWhat is the totient of `N`?\n\n###  Analyze\n\n欧拉方程：$φ(mn) = φ(m)φ(n)$\n\n因为 p，q 都是素数，所以 $φ(p) = p - 1$ ，$φ(q) = q - 1$。\n\n在这道题里面是这样\n\n$$\\begin{align}φ(N) &= φ(p*q) \\\\\\ &= φ(p)φ(q) \\\\\\ &= (p-1)(q-1)\\end{align}$$\n\n### Code\n\n```python\np = 857504083339712752489993810777\nq = 1029224947942998075080348647219\nN = (p - 1) * (q - 1)\nprint(N)\n```\n\n## RSA Starter 4\n\n### Description\n\nThe private key `d` is used to decrypt ciphertexts created with the corresponding public key (it's also used to \"sign\" a message but we'll get to that later).\n\nThe private key is the secret piece of information or \"trapdoor\" which allows us to quickly invert the encryption function. If RSA is implemented well, if you do not have the private key the fastest way to decrypt the ciphertext is to first factorise the modulus.\n\nIn RSA the private key is the [modular multiplicative inverse](https://en.wikipedia.org/wiki/Modular_multiplicative_inverse) of the exponent `e` modulo the totient of `N`.\n\nGiven the two primes:\n\n```\np = 857504083339712752489993810777\nq = 1029224947942998075080348647219\n```\n\nand the exponent:\n\n```\ne = 65537\n```\n\nWhat is the private key `d`?\n\n###  Analyze\n\n对 e 求逆元。$d * e= 1 \\mod N$。\n\n第一次用这个库好像？\n\n### Code\n\n```python\nimport gmpy2\n\np = 857504083339712752489993810777\nq = 1029224947942998075080348647219\ne = 65537\nN = (p - 1) * (q - 1)\nd = gmpy2.invert(e, N)\nprint(d)\n```\n\n## RSA Starter 5\n\n### Description\n\nI've encrypted a secret number for your eyes only using your public key parameters:\n\n```\nN = 882564595536224140639625987659416029426239230804614613279163\ne = 65537\n```\n\nUse the private key that you found for these parameters in the previous challenge to decrypt this ciphertext:\n\n```\nc = 77578995801157823671636298847186723593814843845525223303932\n```\n\n###  Analyze\n\n和第一题没区别，无脑填数。\n\n### Code\n\n```python\nN = 882564595536224140639625987659416029426239230804614613279163\nc = 77578995801157823671636298847186723593814843845525223303932\nd = 121832886702415731577073962957377780195510499965398469843281\nflag = pow(c, d, N)\nprint(flag)\n```\n\n## RSA Starter 6\n\n### Description\n\nHow can you ensure that the person receiving your message knows that you wrote it?\n\nYou've been asked out on a date, and you want to send a message telling them that you'd love to go, however a jealous lover isn't so happy about this.\n\nWhen you send your message saying yes, your jealous lover intercepts the message and corrupts it so it now says no!\n\nWe can protect against these attacks by signing the message.\n\nImagine you write a message `M`. You encrypt this message with your **friend's public key**: `C = Mᵉ⁰ mod N₀`.\n\nTo sign this message, you calculate the hash of the message: `H(M)` and \"encrypt\" this with **your private key**: `S = H(M)ᵈ¹ mod N₁`.\n\n> In real cryptosystems, it's [best practice to use separate keys](https://crypto.stackexchange.com/a/12138) for encrypting and signing messages.\n\nYour friend can decrypt the message using **their private key**: `m = Cᵈ⁰ mod N₀`. Using your public key they calculate `s = Sᵉ¹ mod N₁`.\n\nNow by computing `H(m)` and comparing it to `s`: `assert H(m) == s`, they can ensure that the message you sent them, is the message that they received!\n\nSign the flag `crypto{Immut4ble_m3ssag1ng}` using your private key and the SHA256 hash function.\n\n###  Analyze\n\n英文看得有点头大，得浅理一下逻辑。\n\n>Alice 向 Bob 发送消息：\n>\n>1. 用 Bob 的公钥加密得到 C\n>\n>2. 签名\n>\n>   > 签名步骤\n>   >\n>   > 1. 求消息的哈希值 H\n>   > 2. 用 Alice 的私钥“加密”哈希值得到 S\n>\n>Bob 接收 Alice 的消息：\n>\n>1. 用 Bob 的私钥解密得到 m\n>2. 用 Alice 的公钥计算“解密”得到 s\n>3. 计算消息的哈希值 H\n>4. 比较 s 和 H，二者相等就能确定消息是真实的\n\n签名是个蛮好玩的东西捏。\n\n### Code\n\n```python\nfrom hashlib import sha256\n\nN = 15216583654836731327639981224133918855895948374072384050848479908982286890731769486609085918857664046075375253168955058743185664390273058074450390236774324903305663479046566232967297765731625328029814055635316002591227570271271445226094919864475407884459980489638001092788574811554149774028950310695112688723853763743238753349782508121985338746755237819373178699343135091783992299561827389745132880022259873387524273298850340648779897909381979714026837172003953221052431217940632552930880000919436507245150726543040714721553361063311954285289857582079880295199632757829525723874753306371990452491305564061051059885803\nd = 11175901210643014262548222473449533091378848269490518850474399681690547281665059317155831692300453197335735728459259392366823302405685389586883670043744683993709123180805154631088513521456979317628012721881537154107239389466063136007337120599915456659758559300673444689263854921332185562706707573660658164991098457874495054854491474065039621922972671588299315846306069845169959451250821044417886630346229021305410340100401530146135418806544340908355106582089082980533651095594192031411679866134256418292249592135441145384466261279428795408721990564658703903787956958168449841491667690491585550160457893350536334242689\n\nflag = \"crypto{Immut4ble_m3ssag1ng}\"\nflag = flag.encode()\nhash = sha256(flag)\nhash = hash.hexdigest()\nhash = int(hash, 16)\nc = pow(hash, d, N)\nprint(hex(c))\n```\n","source":"_posts/RSA_Starter.md","raw":"---\ntitle: RSA_STARTER\ndate: 2022-05-09 01:42:00\ntags: cryptohack\nmathjax: true\n---\n\n这个超快！\n\n我看谁不是速通（bushi\n\n<!--more-->\n\n最后一块内容，没想到意外地顺利，舒服捏。\n\n# RSA_STARTER\n\n## RSA Starter 1   \n\n### Description\n\nAll operations in RSA involve [modular exponentiation](https://en.wikipedia.org/wiki/Modular_exponentiation).\n\nModular exponentiation is an operation that is used extensively in cryptography and is normally written like: `2¹⁰ mod 17`\n\nYou can think of this as raising some number to a certain power (`2¹⁰ = 1024`), and then taking the remainder of the division by some other number (`1024 mod 17 = 4`). In Python there's a built-in operator for performing this operation: `pow(base, exponent, modulus)`\n\nIn RSA, modular exponentiation, together with the problem of prime factorisation, helps us to build a \"[trapdoor function](https://en.wikipedia.org/wiki/Trapdoor_function)\". This is a function that is easy to compute in one direction, but hard to do in reverse unless you have the right information. It allows us to encrypt a message, and only the person with the key can perform the inverse operation to decrypt it.\n\nFind the solution to `101¹⁷ mod 22663`\n\n###  Analyze\n\n模幂运算？有种回到做数论题的错觉（出戏。\n\n不过 pow() 是之前就用过的东西诶，突然亲切。\n\n无脑填数就行。\n\n### Code\n\n```python\nprint(pow(101, 17, 22663))\n```\n\n## RSA Starter 2\n\n### Description\n\nRSA encryption is modular exponentiation of a message with an exponent `e` and a modulus `N` which is normally a product of two primes: `N = p * q`.\n\nTogether the exponent and modulus form an RSA \"public key\" `(N, e)`. The most common value for `e` is `0x10001` or `65537`.\n\n\"Encrypt\" the number `12` using the exponent `e = 65537` and the primes `p = 17` and `q = 23`. What number do you get as the ciphertext?\n\n###  Analyze\n\n两个素数的乘积为模数。还是无脑填数。\n\n### Code\n\n```python\nb = 12\ne = 65537\np, q = 17, 23\nN = p * q\nprint(pow(b, e, N))\n```\n\n## RSA Starter 3\n\n### Description\n\nRSA relies on the difficulty of the factorisation of the modulus `N`. If the primes can be found then we can calculate the [Euler totient](https://leimao.github.io/article/RSA-Algorithm/) of `N` and thus decrypt the ciphertext.\n\nGiven `N = p*q` and two primes:\n\n```\np = 857504083339712752489993810777\nq = 1029224947942998075080348647219\n```\n\nWhat is the totient of `N`?\n\n###  Analyze\n\n欧拉方程：$φ(mn) = φ(m)φ(n)$\n\n因为 p，q 都是素数，所以 $φ(p) = p - 1$ ，$φ(q) = q - 1$。\n\n在这道题里面是这样\n\n$$\\begin{align}φ(N) &= φ(p*q) \\\\\\ &= φ(p)φ(q) \\\\\\ &= (p-1)(q-1)\\end{align}$$\n\n### Code\n\n```python\np = 857504083339712752489993810777\nq = 1029224947942998075080348647219\nN = (p - 1) * (q - 1)\nprint(N)\n```\n\n## RSA Starter 4\n\n### Description\n\nThe private key `d` is used to decrypt ciphertexts created with the corresponding public key (it's also used to \"sign\" a message but we'll get to that later).\n\nThe private key is the secret piece of information or \"trapdoor\" which allows us to quickly invert the encryption function. If RSA is implemented well, if you do not have the private key the fastest way to decrypt the ciphertext is to first factorise the modulus.\n\nIn RSA the private key is the [modular multiplicative inverse](https://en.wikipedia.org/wiki/Modular_multiplicative_inverse) of the exponent `e` modulo the totient of `N`.\n\nGiven the two primes:\n\n```\np = 857504083339712752489993810777\nq = 1029224947942998075080348647219\n```\n\nand the exponent:\n\n```\ne = 65537\n```\n\nWhat is the private key `d`?\n\n###  Analyze\n\n对 e 求逆元。$d * e= 1 \\mod N$。\n\n第一次用这个库好像？\n\n### Code\n\n```python\nimport gmpy2\n\np = 857504083339712752489993810777\nq = 1029224947942998075080348647219\ne = 65537\nN = (p - 1) * (q - 1)\nd = gmpy2.invert(e, N)\nprint(d)\n```\n\n## RSA Starter 5\n\n### Description\n\nI've encrypted a secret number for your eyes only using your public key parameters:\n\n```\nN = 882564595536224140639625987659416029426239230804614613279163\ne = 65537\n```\n\nUse the private key that you found for these parameters in the previous challenge to decrypt this ciphertext:\n\n```\nc = 77578995801157823671636298847186723593814843845525223303932\n```\n\n###  Analyze\n\n和第一题没区别，无脑填数。\n\n### Code\n\n```python\nN = 882564595536224140639625987659416029426239230804614613279163\nc = 77578995801157823671636298847186723593814843845525223303932\nd = 121832886702415731577073962957377780195510499965398469843281\nflag = pow(c, d, N)\nprint(flag)\n```\n\n## RSA Starter 6\n\n### Description\n\nHow can you ensure that the person receiving your message knows that you wrote it?\n\nYou've been asked out on a date, and you want to send a message telling them that you'd love to go, however a jealous lover isn't so happy about this.\n\nWhen you send your message saying yes, your jealous lover intercepts the message and corrupts it so it now says no!\n\nWe can protect against these attacks by signing the message.\n\nImagine you write a message `M`. You encrypt this message with your **friend's public key**: `C = Mᵉ⁰ mod N₀`.\n\nTo sign this message, you calculate the hash of the message: `H(M)` and \"encrypt\" this with **your private key**: `S = H(M)ᵈ¹ mod N₁`.\n\n> In real cryptosystems, it's [best practice to use separate keys](https://crypto.stackexchange.com/a/12138) for encrypting and signing messages.\n\nYour friend can decrypt the message using **their private key**: `m = Cᵈ⁰ mod N₀`. Using your public key they calculate `s = Sᵉ¹ mod N₁`.\n\nNow by computing `H(m)` and comparing it to `s`: `assert H(m) == s`, they can ensure that the message you sent them, is the message that they received!\n\nSign the flag `crypto{Immut4ble_m3ssag1ng}` using your private key and the SHA256 hash function.\n\n###  Analyze\n\n英文看得有点头大，得浅理一下逻辑。\n\n>Alice 向 Bob 发送消息：\n>\n>1. 用 Bob 的公钥加密得到 C\n>\n>2. 签名\n>\n>   > 签名步骤\n>   >\n>   > 1. 求消息的哈希值 H\n>   > 2. 用 Alice 的私钥“加密”哈希值得到 S\n>\n>Bob 接收 Alice 的消息：\n>\n>1. 用 Bob 的私钥解密得到 m\n>2. 用 Alice 的公钥计算“解密”得到 s\n>3. 计算消息的哈希值 H\n>4. 比较 s 和 H，二者相等就能确定消息是真实的\n\n签名是个蛮好玩的东西捏。\n\n### Code\n\n```python\nfrom hashlib import sha256\n\nN = 15216583654836731327639981224133918855895948374072384050848479908982286890731769486609085918857664046075375253168955058743185664390273058074450390236774324903305663479046566232967297765731625328029814055635316002591227570271271445226094919864475407884459980489638001092788574811554149774028950310695112688723853763743238753349782508121985338746755237819373178699343135091783992299561827389745132880022259873387524273298850340648779897909381979714026837172003953221052431217940632552930880000919436507245150726543040714721553361063311954285289857582079880295199632757829525723874753306371990452491305564061051059885803\nd = 11175901210643014262548222473449533091378848269490518850474399681690547281665059317155831692300453197335735728459259392366823302405685389586883670043744683993709123180805154631088513521456979317628012721881537154107239389466063136007337120599915456659758559300673444689263854921332185562706707573660658164991098457874495054854491474065039621922972671588299315846306069845169959451250821044417886630346229021305410340100401530146135418806544340908355106582089082980533651095594192031411679866134256418292249592135441145384466261279428795408721990564658703903787956958168449841491667690491585550160457893350536334242689\n\nflag = \"crypto{Immut4ble_m3ssag1ng}\"\nflag = flag.encode()\nhash = sha256(flag)\nhash = hash.hexdigest()\nhash = int(hash, 16)\nc = pow(hash, d, N)\nprint(hex(c))\n```\n","slug":"RSA_Starter","published":1,"updated":"2022-05-08T20:14:00.432Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl3pllpda0000i0fshm52hyxo","content":"<p>这个超快！</p>\n<p>我看谁不是速通（bushi</p>\n<span id=\"more\"></span>\n\n<p>最后一块内容，没想到意外地顺利，舒服捏。</p>\n<h1 id=\"RSA-STARTER\"><a href=\"#RSA-STARTER\" class=\"headerlink\" title=\"RSA_STARTER\"></a>RSA_STARTER</h1><h2 id=\"RSA-Starter-1\"><a href=\"#RSA-Starter-1\" class=\"headerlink\" title=\"RSA Starter 1\"></a>RSA Starter 1</h2><h3 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>All operations in RSA involve <a href=\"https://en.wikipedia.org/wiki/Modular_exponentiation\">modular exponentiation</a>.</p>\n<p>Modular exponentiation is an operation that is used extensively in cryptography and is normally written like: <code>2¹⁰ mod 17</code></p>\n<p>You can think of this as raising some number to a certain power (<code>2¹⁰ = 1024</code>), and then taking the remainder of the division by some other number (<code>1024 mod 17 = 4</code>). In Python there’s a built-in operator for performing this operation: <code>pow(base, exponent, modulus)</code></p>\n<p>In RSA, modular exponentiation, together with the problem of prime factorisation, helps us to build a “<a href=\"https://en.wikipedia.org/wiki/Trapdoor_function\">trapdoor function</a>“. This is a function that is easy to compute in one direction, but hard to do in reverse unless you have the right information. It allows us to encrypt a message, and only the person with the key can perform the inverse operation to decrypt it.</p>\n<p>Find the solution to <code>101¹⁷ mod 22663</code></p>\n<h3 id=\"Analyze\"><a href=\"#Analyze\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>模幂运算？有种回到做数论题的错觉（出戏。</p>\n<p>不过 pow() 是之前就用过的东西诶，突然亲切。</p>\n<p>无脑填数就行。</p>\n<h3 id=\"Code\"><a href=\"#Code\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">pow</span>(<span class=\"number\">101</span>, <span class=\"number\">17</span>, <span class=\"number\">22663</span>))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"RSA-Starter-2\"><a href=\"#RSA-Starter-2\" class=\"headerlink\" title=\"RSA Starter 2\"></a>RSA Starter 2</h2><h3 id=\"Description-1\"><a href=\"#Description-1\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>RSA encryption is modular exponentiation of a message with an exponent <code>e</code> and a modulus <code>N</code> which is normally a product of two primes: <code>N = p * q</code>.</p>\n<p>Together the exponent and modulus form an RSA “public key” <code>(N, e)</code>. The most common value for <code>e</code> is <code>0x10001</code> or <code>65537</code>.</p>\n<p>“Encrypt” the number <code>12</code> using the exponent <code>e = 65537</code> and the primes <code>p = 17</code> and <code>q = 23</code>. What number do you get as the ciphertext?</p>\n<h3 id=\"Analyze-1\"><a href=\"#Analyze-1\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>两个素数的乘积为模数。还是无脑填数。</p>\n<h3 id=\"Code-1\"><a href=\"#Code-1\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">b = <span class=\"number\">12</span></span><br><span class=\"line\">e = <span class=\"number\">65537</span></span><br><span class=\"line\">p, q = <span class=\"number\">17</span>, <span class=\"number\">23</span></span><br><span class=\"line\">N = p * q</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">pow</span>(b, e, N))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"RSA-Starter-3\"><a href=\"#RSA-Starter-3\" class=\"headerlink\" title=\"RSA Starter 3\"></a>RSA Starter 3</h2><h3 id=\"Description-2\"><a href=\"#Description-2\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>RSA relies on the difficulty of the factorisation of the modulus <code>N</code>. If the primes can be found then we can calculate the <a href=\"https://leimao.github.io/article/RSA-Algorithm/\">Euler totient</a> of <code>N</code> and thus decrypt the ciphertext.</p>\n<p>Given <code>N = p*q</code> and two primes:</p>\n<figure class=\"highlight abnf\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">p</span> <span class=\"operator\">=</span> <span class=\"number\">857504083339712752489993810777</span></span><br><span class=\"line\"><span class=\"attribute\">q</span> <span class=\"operator\">=</span> <span class=\"number\">1029224947942998075080348647219</span></span><br></pre></td></tr></table></figure>\n\n<p>What is the totient of <code>N</code>?</p>\n<h3 id=\"Analyze-2\"><a href=\"#Analyze-2\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>欧拉方程：$φ(mn) &#x3D; φ(m)φ(n)$</p>\n<p>因为 p，q 都是素数，所以 $φ(p) &#x3D; p - 1$ ，$φ(q) &#x3D; q - 1$。</p>\n<p>在这道题里面是这样</p>\n<p>$$\\begin{align}φ(N) &amp;&#x3D; φ(p*q) \\\\ &amp;&#x3D; φ(p)φ(q) \\\\ &amp;&#x3D; (p-1)(q-1)\\end{align}$$</p>\n<h3 id=\"Code-2\"><a href=\"#Code-2\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">p = <span class=\"number\">857504083339712752489993810777</span></span><br><span class=\"line\">q = <span class=\"number\">1029224947942998075080348647219</span></span><br><span class=\"line\">N = (p - <span class=\"number\">1</span>) * (q - <span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(N)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"RSA-Starter-4\"><a href=\"#RSA-Starter-4\" class=\"headerlink\" title=\"RSA Starter 4\"></a>RSA Starter 4</h2><h3 id=\"Description-3\"><a href=\"#Description-3\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>The private key <code>d</code> is used to decrypt ciphertexts created with the corresponding public key (it’s also used to “sign” a message but we’ll get to that later).</p>\n<p>The private key is the secret piece of information or “trapdoor” which allows us to quickly invert the encryption function. If RSA is implemented well, if you do not have the private key the fastest way to decrypt the ciphertext is to first factorise the modulus.</p>\n<p>In RSA the private key is the <a href=\"https://en.wikipedia.org/wiki/Modular_multiplicative_inverse\">modular multiplicative inverse</a> of the exponent <code>e</code> modulo the totient of <code>N</code>.</p>\n<p>Given the two primes:</p>\n<figure class=\"highlight abnf\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">p</span> <span class=\"operator\">=</span> <span class=\"number\">857504083339712752489993810777</span></span><br><span class=\"line\"><span class=\"attribute\">q</span> <span class=\"operator\">=</span> <span class=\"number\">1029224947942998075080348647219</span></span><br></pre></td></tr></table></figure>\n\n<p>and the exponent:</p>\n<figure class=\"highlight abnf\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">e</span> <span class=\"operator\">=</span> <span class=\"number\">65537</span></span><br></pre></td></tr></table></figure>\n\n<p>What is the private key <code>d</code>?</p>\n<h3 id=\"Analyze-3\"><a href=\"#Analyze-3\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>对 e 求逆元。$d * e&#x3D; 1 \\mod N$。</p>\n<p>第一次用这个库好像？</p>\n<h3 id=\"Code-3\"><a href=\"#Code-3\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> gmpy2</span><br><span class=\"line\"></span><br><span class=\"line\">p = <span class=\"number\">857504083339712752489993810777</span></span><br><span class=\"line\">q = <span class=\"number\">1029224947942998075080348647219</span></span><br><span class=\"line\">e = <span class=\"number\">65537</span></span><br><span class=\"line\">N = (p - <span class=\"number\">1</span>) * (q - <span class=\"number\">1</span>)</span><br><span class=\"line\">d = gmpy2.invert(e, N)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(d)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"RSA-Starter-5\"><a href=\"#RSA-Starter-5\" class=\"headerlink\" title=\"RSA Starter 5\"></a>RSA Starter 5</h2><h3 id=\"Description-4\"><a href=\"#Description-4\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>I’ve encrypted a secret number for your eyes only using your public key parameters:</p>\n<figure class=\"highlight abnf\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">N</span> <span class=\"operator\">=</span> <span class=\"number\">882564595536224140639625987659416029426239230804614613279163</span></span><br><span class=\"line\"><span class=\"attribute\">e</span> <span class=\"operator\">=</span> <span class=\"number\">65537</span></span><br></pre></td></tr></table></figure>\n\n<p>Use the private key that you found for these parameters in the previous challenge to decrypt this ciphertext:</p>\n<figure class=\"highlight abnf\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">c</span> <span class=\"operator\">=</span> <span class=\"number\">77578995801157823671636298847186723593814843845525223303932</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Analyze-4\"><a href=\"#Analyze-4\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>和第一题没区别，无脑填数。</p>\n<h3 id=\"Code-4\"><a href=\"#Code-4\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">N = <span class=\"number\">882564595536224140639625987659416029426239230804614613279163</span></span><br><span class=\"line\">c = <span class=\"number\">77578995801157823671636298847186723593814843845525223303932</span></span><br><span class=\"line\">d = <span class=\"number\">121832886702415731577073962957377780195510499965398469843281</span></span><br><span class=\"line\">flag = <span class=\"built_in\">pow</span>(c, d, N)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(flag)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"RSA-Starter-6\"><a href=\"#RSA-Starter-6\" class=\"headerlink\" title=\"RSA Starter 6\"></a>RSA Starter 6</h2><h3 id=\"Description-5\"><a href=\"#Description-5\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>How can you ensure that the person receiving your message knows that you wrote it?</p>\n<p>You’ve been asked out on a date, and you want to send a message telling them that you’d love to go, however a jealous lover isn’t so happy about this.</p>\n<p>When you send your message saying yes, your jealous lover intercepts the message and corrupts it so it now says no!</p>\n<p>We can protect against these attacks by signing the message.</p>\n<p>Imagine you write a message <code>M</code>. You encrypt this message with your <strong>friend’s public key</strong>: <code>C = Mᵉ⁰ mod N₀</code>.</p>\n<p>To sign this message, you calculate the hash of the message: <code>H(M)</code> and “encrypt” this with <strong>your private key</strong>: <code>S = H(M)ᵈ¹ mod N₁</code>.</p>\n<blockquote>\n<p>In real cryptosystems, it’s <a href=\"https://crypto.stackexchange.com/a/12138\">best practice to use separate keys</a> for encrypting and signing messages.</p>\n</blockquote>\n<p>Your friend can decrypt the message using <strong>their private key</strong>: <code>m = Cᵈ⁰ mod N₀</code>. Using your public key they calculate <code>s = Sᵉ¹ mod N₁</code>.</p>\n<p>Now by computing <code>H(m)</code> and comparing it to <code>s</code>: <code>assert H(m) == s</code>, they can ensure that the message you sent them, is the message that they received!</p>\n<p>Sign the flag <code>crypto&#123;Immut4ble_m3ssag1ng&#125;</code> using your private key and the SHA256 hash function.</p>\n<h3 id=\"Analyze-5\"><a href=\"#Analyze-5\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>英文看得有点头大，得浅理一下逻辑。</p>\n<blockquote>\n<p>Alice 向 Bob 发送消息：</p>\n<ol>\n<li><p>用 Bob 的公钥加密得到 C</p>\n</li>\n<li><p>签名</p>\n</li>\n</ol>\n<blockquote>\n<p>签名步骤</p>\n<ol>\n<li>求消息的哈希值 H</li>\n<li>用 Alice 的私钥“加密”哈希值得到 S</li>\n</ol>\n</blockquote>\n<p>Bob 接收 Alice 的消息：</p>\n<ol>\n<li>用 Bob 的私钥解密得到 m</li>\n<li>用 Alice 的公钥计算“解密”得到 s</li>\n<li>计算消息的哈希值 H</li>\n<li>比较 s 和 H，二者相等就能确定消息是真实的</li>\n</ol>\n</blockquote>\n<p>签名是个蛮好玩的东西捏。</p>\n<h3 id=\"Code-5\"><a href=\"#Code-5\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> hashlib <span class=\"keyword\">import</span> sha256</span><br><span class=\"line\"></span><br><span class=\"line\">N = <span class=\"number\">15216583654836731327639981224133918855895948374072384050848479908982286890731769486609085918857664046075375253168955058743185664390273058074450390236774324903305663479046566232967297765731625328029814055635316002591227570271271445226094919864475407884459980489638001092788574811554149774028950310695112688723853763743238753349782508121985338746755237819373178699343135091783992299561827389745132880022259873387524273298850340648779897909381979714026837172003953221052431217940632552930880000919436507245150726543040714721553361063311954285289857582079880295199632757829525723874753306371990452491305564061051059885803</span></span><br><span class=\"line\">d = <span class=\"number\">11175901210643014262548222473449533091378848269490518850474399681690547281665059317155831692300453197335735728459259392366823302405685389586883670043744683993709123180805154631088513521456979317628012721881537154107239389466063136007337120599915456659758559300673444689263854921332185562706707573660658164991098457874495054854491474065039621922972671588299315846306069845169959451250821044417886630346229021305410340100401530146135418806544340908355106582089082980533651095594192031411679866134256418292249592135441145384466261279428795408721990564658703903787956958168449841491667690491585550160457893350536334242689</span></span><br><span class=\"line\"></span><br><span class=\"line\">flag = <span class=\"string\">&quot;crypto&#123;Immut4ble_m3ssag1ng&#125;&quot;</span></span><br><span class=\"line\">flag = flag.encode()</span><br><span class=\"line\"><span class=\"built_in\">hash</span> = sha256(flag)</span><br><span class=\"line\"><span class=\"built_in\">hash</span> = <span class=\"built_in\">hash</span>.hexdigest()</span><br><span class=\"line\"><span class=\"built_in\">hash</span> = <span class=\"built_in\">int</span>(<span class=\"built_in\">hash</span>, <span class=\"number\">16</span>)</span><br><span class=\"line\">c = <span class=\"built_in\">pow</span>(<span class=\"built_in\">hash</span>, d, N)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">hex</span>(c))</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"<p>这个超快！</p>\n<p>我看谁不是速通（bushi</p>","more":"<p>最后一块内容，没想到意外地顺利，舒服捏。</p>\n<h1 id=\"RSA-STARTER\"><a href=\"#RSA-STARTER\" class=\"headerlink\" title=\"RSA_STARTER\"></a>RSA_STARTER</h1><h2 id=\"RSA-Starter-1\"><a href=\"#RSA-Starter-1\" class=\"headerlink\" title=\"RSA Starter 1\"></a>RSA Starter 1</h2><h3 id=\"Description\"><a href=\"#Description\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>All operations in RSA involve <a href=\"https://en.wikipedia.org/wiki/Modular_exponentiation\">modular exponentiation</a>.</p>\n<p>Modular exponentiation is an operation that is used extensively in cryptography and is normally written like: <code>2¹⁰ mod 17</code></p>\n<p>You can think of this as raising some number to a certain power (<code>2¹⁰ = 1024</code>), and then taking the remainder of the division by some other number (<code>1024 mod 17 = 4</code>). In Python there’s a built-in operator for performing this operation: <code>pow(base, exponent, modulus)</code></p>\n<p>In RSA, modular exponentiation, together with the problem of prime factorisation, helps us to build a “<a href=\"https://en.wikipedia.org/wiki/Trapdoor_function\">trapdoor function</a>“. This is a function that is easy to compute in one direction, but hard to do in reverse unless you have the right information. It allows us to encrypt a message, and only the person with the key can perform the inverse operation to decrypt it.</p>\n<p>Find the solution to <code>101¹⁷ mod 22663</code></p>\n<h3 id=\"Analyze\"><a href=\"#Analyze\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>模幂运算？有种回到做数论题的错觉（出戏。</p>\n<p>不过 pow() 是之前就用过的东西诶，突然亲切。</p>\n<p>无脑填数就行。</p>\n<h3 id=\"Code\"><a href=\"#Code\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">pow</span>(<span class=\"number\">101</span>, <span class=\"number\">17</span>, <span class=\"number\">22663</span>))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"RSA-Starter-2\"><a href=\"#RSA-Starter-2\" class=\"headerlink\" title=\"RSA Starter 2\"></a>RSA Starter 2</h2><h3 id=\"Description-1\"><a href=\"#Description-1\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>RSA encryption is modular exponentiation of a message with an exponent <code>e</code> and a modulus <code>N</code> which is normally a product of two primes: <code>N = p * q</code>.</p>\n<p>Together the exponent and modulus form an RSA “public key” <code>(N, e)</code>. The most common value for <code>e</code> is <code>0x10001</code> or <code>65537</code>.</p>\n<p>“Encrypt” the number <code>12</code> using the exponent <code>e = 65537</code> and the primes <code>p = 17</code> and <code>q = 23</code>. What number do you get as the ciphertext?</p>\n<h3 id=\"Analyze-1\"><a href=\"#Analyze-1\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>两个素数的乘积为模数。还是无脑填数。</p>\n<h3 id=\"Code-1\"><a href=\"#Code-1\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">b = <span class=\"number\">12</span></span><br><span class=\"line\">e = <span class=\"number\">65537</span></span><br><span class=\"line\">p, q = <span class=\"number\">17</span>, <span class=\"number\">23</span></span><br><span class=\"line\">N = p * q</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">pow</span>(b, e, N))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"RSA-Starter-3\"><a href=\"#RSA-Starter-3\" class=\"headerlink\" title=\"RSA Starter 3\"></a>RSA Starter 3</h2><h3 id=\"Description-2\"><a href=\"#Description-2\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>RSA relies on the difficulty of the factorisation of the modulus <code>N</code>. If the primes can be found then we can calculate the <a href=\"https://leimao.github.io/article/RSA-Algorithm/\">Euler totient</a> of <code>N</code> and thus decrypt the ciphertext.</p>\n<p>Given <code>N = p*q</code> and two primes:</p>\n<figure class=\"highlight abnf\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">p</span> <span class=\"operator\">=</span> <span class=\"number\">857504083339712752489993810777</span></span><br><span class=\"line\"><span class=\"attribute\">q</span> <span class=\"operator\">=</span> <span class=\"number\">1029224947942998075080348647219</span></span><br></pre></td></tr></table></figure>\n\n<p>What is the totient of <code>N</code>?</p>\n<h3 id=\"Analyze-2\"><a href=\"#Analyze-2\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>欧拉方程：$φ(mn) &#x3D; φ(m)φ(n)$</p>\n<p>因为 p，q 都是素数，所以 $φ(p) &#x3D; p - 1$ ，$φ(q) &#x3D; q - 1$。</p>\n<p>在这道题里面是这样</p>\n<p>$$\\begin{align}φ(N) &amp;&#x3D; φ(p*q) \\\\ &amp;&#x3D; φ(p)φ(q) \\\\ &amp;&#x3D; (p-1)(q-1)\\end{align}$$</p>\n<h3 id=\"Code-2\"><a href=\"#Code-2\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">p = <span class=\"number\">857504083339712752489993810777</span></span><br><span class=\"line\">q = <span class=\"number\">1029224947942998075080348647219</span></span><br><span class=\"line\">N = (p - <span class=\"number\">1</span>) * (q - <span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(N)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"RSA-Starter-4\"><a href=\"#RSA-Starter-4\" class=\"headerlink\" title=\"RSA Starter 4\"></a>RSA Starter 4</h2><h3 id=\"Description-3\"><a href=\"#Description-3\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>The private key <code>d</code> is used to decrypt ciphertexts created with the corresponding public key (it’s also used to “sign” a message but we’ll get to that later).</p>\n<p>The private key is the secret piece of information or “trapdoor” which allows us to quickly invert the encryption function. If RSA is implemented well, if you do not have the private key the fastest way to decrypt the ciphertext is to first factorise the modulus.</p>\n<p>In RSA the private key is the <a href=\"https://en.wikipedia.org/wiki/Modular_multiplicative_inverse\">modular multiplicative inverse</a> of the exponent <code>e</code> modulo the totient of <code>N</code>.</p>\n<p>Given the two primes:</p>\n<figure class=\"highlight abnf\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">p</span> <span class=\"operator\">=</span> <span class=\"number\">857504083339712752489993810777</span></span><br><span class=\"line\"><span class=\"attribute\">q</span> <span class=\"operator\">=</span> <span class=\"number\">1029224947942998075080348647219</span></span><br></pre></td></tr></table></figure>\n\n<p>and the exponent:</p>\n<figure class=\"highlight abnf\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">e</span> <span class=\"operator\">=</span> <span class=\"number\">65537</span></span><br></pre></td></tr></table></figure>\n\n<p>What is the private key <code>d</code>?</p>\n<h3 id=\"Analyze-3\"><a href=\"#Analyze-3\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>对 e 求逆元。$d * e&#x3D; 1 \\mod N$。</p>\n<p>第一次用这个库好像？</p>\n<h3 id=\"Code-3\"><a href=\"#Code-3\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> gmpy2</span><br><span class=\"line\"></span><br><span class=\"line\">p = <span class=\"number\">857504083339712752489993810777</span></span><br><span class=\"line\">q = <span class=\"number\">1029224947942998075080348647219</span></span><br><span class=\"line\">e = <span class=\"number\">65537</span></span><br><span class=\"line\">N = (p - <span class=\"number\">1</span>) * (q - <span class=\"number\">1</span>)</span><br><span class=\"line\">d = gmpy2.invert(e, N)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(d)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"RSA-Starter-5\"><a href=\"#RSA-Starter-5\" class=\"headerlink\" title=\"RSA Starter 5\"></a>RSA Starter 5</h2><h3 id=\"Description-4\"><a href=\"#Description-4\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>I’ve encrypted a secret number for your eyes only using your public key parameters:</p>\n<figure class=\"highlight abnf\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">N</span> <span class=\"operator\">=</span> <span class=\"number\">882564595536224140639625987659416029426239230804614613279163</span></span><br><span class=\"line\"><span class=\"attribute\">e</span> <span class=\"operator\">=</span> <span class=\"number\">65537</span></span><br></pre></td></tr></table></figure>\n\n<p>Use the private key that you found for these parameters in the previous challenge to decrypt this ciphertext:</p>\n<figure class=\"highlight abnf\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">c</span> <span class=\"operator\">=</span> <span class=\"number\">77578995801157823671636298847186723593814843845525223303932</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Analyze-4\"><a href=\"#Analyze-4\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>和第一题没区别，无脑填数。</p>\n<h3 id=\"Code-4\"><a href=\"#Code-4\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">N = <span class=\"number\">882564595536224140639625987659416029426239230804614613279163</span></span><br><span class=\"line\">c = <span class=\"number\">77578995801157823671636298847186723593814843845525223303932</span></span><br><span class=\"line\">d = <span class=\"number\">121832886702415731577073962957377780195510499965398469843281</span></span><br><span class=\"line\">flag = <span class=\"built_in\">pow</span>(c, d, N)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(flag)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"RSA-Starter-6\"><a href=\"#RSA-Starter-6\" class=\"headerlink\" title=\"RSA Starter 6\"></a>RSA Starter 6</h2><h3 id=\"Description-5\"><a href=\"#Description-5\" class=\"headerlink\" title=\"Description\"></a>Description</h3><p>How can you ensure that the person receiving your message knows that you wrote it?</p>\n<p>You’ve been asked out on a date, and you want to send a message telling them that you’d love to go, however a jealous lover isn’t so happy about this.</p>\n<p>When you send your message saying yes, your jealous lover intercepts the message and corrupts it so it now says no!</p>\n<p>We can protect against these attacks by signing the message.</p>\n<p>Imagine you write a message <code>M</code>. You encrypt this message with your <strong>friend’s public key</strong>: <code>C = Mᵉ⁰ mod N₀</code>.</p>\n<p>To sign this message, you calculate the hash of the message: <code>H(M)</code> and “encrypt” this with <strong>your private key</strong>: <code>S = H(M)ᵈ¹ mod N₁</code>.</p>\n<blockquote>\n<p>In real cryptosystems, it’s <a href=\"https://crypto.stackexchange.com/a/12138\">best practice to use separate keys</a> for encrypting and signing messages.</p>\n</blockquote>\n<p>Your friend can decrypt the message using <strong>their private key</strong>: <code>m = Cᵈ⁰ mod N₀</code>. Using your public key they calculate <code>s = Sᵉ¹ mod N₁</code>.</p>\n<p>Now by computing <code>H(m)</code> and comparing it to <code>s</code>: <code>assert H(m) == s</code>, they can ensure that the message you sent them, is the message that they received!</p>\n<p>Sign the flag <code>crypto&#123;Immut4ble_m3ssag1ng&#125;</code> using your private key and the SHA256 hash function.</p>\n<h3 id=\"Analyze-5\"><a href=\"#Analyze-5\" class=\"headerlink\" title=\"Analyze\"></a>Analyze</h3><p>英文看得有点头大，得浅理一下逻辑。</p>\n<blockquote>\n<p>Alice 向 Bob 发送消息：</p>\n<ol>\n<li><p>用 Bob 的公钥加密得到 C</p>\n</li>\n<li><p>签名</p>\n</li>\n</ol>\n<blockquote>\n<p>签名步骤</p>\n<ol>\n<li>求消息的哈希值 H</li>\n<li>用 Alice 的私钥“加密”哈希值得到 S</li>\n</ol>\n</blockquote>\n<p>Bob 接收 Alice 的消息：</p>\n<ol>\n<li>用 Bob 的私钥解密得到 m</li>\n<li>用 Alice 的公钥计算“解密”得到 s</li>\n<li>计算消息的哈希值 H</li>\n<li>比较 s 和 H，二者相等就能确定消息是真实的</li>\n</ol>\n</blockquote>\n<p>签名是个蛮好玩的东西捏。</p>\n<h3 id=\"Code-5\"><a href=\"#Code-5\" class=\"headerlink\" title=\"Code\"></a>Code</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> hashlib <span class=\"keyword\">import</span> sha256</span><br><span class=\"line\"></span><br><span class=\"line\">N = <span class=\"number\">15216583654836731327639981224133918855895948374072384050848479908982286890731769486609085918857664046075375253168955058743185664390273058074450390236774324903305663479046566232967297765731625328029814055635316002591227570271271445226094919864475407884459980489638001092788574811554149774028950310695112688723853763743238753349782508121985338746755237819373178699343135091783992299561827389745132880022259873387524273298850340648779897909381979714026837172003953221052431217940632552930880000919436507245150726543040714721553361063311954285289857582079880295199632757829525723874753306371990452491305564061051059885803</span></span><br><span class=\"line\">d = <span class=\"number\">11175901210643014262548222473449533091378848269490518850474399681690547281665059317155831692300453197335735728459259392366823302405685389586883670043744683993709123180805154631088513521456979317628012721881537154107239389466063136007337120599915456659758559300673444689263854921332185562706707573660658164991098457874495054854491474065039621922972671588299315846306069845169959451250821044417886630346229021305410340100401530146135418806544340908355106582089082980533651095594192031411679866134256418292249592135441145384466261279428795408721990564658703903787956958168449841491667690491585550160457893350536334242689</span></span><br><span class=\"line\"></span><br><span class=\"line\">flag = <span class=\"string\">&quot;crypto&#123;Immut4ble_m3ssag1ng&#125;&quot;</span></span><br><span class=\"line\">flag = flag.encode()</span><br><span class=\"line\"><span class=\"built_in\">hash</span> = sha256(flag)</span><br><span class=\"line\"><span class=\"built_in\">hash</span> = <span class=\"built_in\">hash</span>.hexdigest()</span><br><span class=\"line\"><span class=\"built_in\">hash</span> = <span class=\"built_in\">int</span>(<span class=\"built_in\">hash</span>, <span class=\"number\">16</span>)</span><br><span class=\"line\">c = <span class=\"built_in\">pow</span>(<span class=\"built_in\">hash</span>, d, N)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">hex</span>(c))</span><br></pre></td></tr></table></figure>"},{"title":"开始cryptohack","date":"2022-04-30T20:04:32.000Z","_content":"\n刚刚搭好博客，来水第一篇文章咯！（bushi\n\n<!--more-->\n\n今天去面试 xdsec 咯，虽然很紧张也磕磕绊绊，但总算是结束咯。只是最后惊闻噩耗，面试任务 5.7 截止，所以整个五一假期都要用来做面试任务，那我当然心甘情愿 ~~很不乐意~~ 。又因为想要快点充实自己的博客然后拿去和朋友们分享，所以想到可以用这个博客浅（shen）浅（shen）记录一下学习过程。（和解题思路？虽然面试师傅说布置的都是简单基础题，但是可能对小白 ~~指我~~ 来说还是需要一些思考的吧\n\n说到这个，想起去年鸽掉了二面，当时虽然想进协会但是自己是个懒狗~~（可能现在也是）~~，后来面试师傅刚好是好朋友，一直在催我学相关知识，也很感谢师傅的操心（bushi），如果只是自己一个人的话，很可能就不会再去试着学习这方面的东西提升自己了。\n\n不管结果怎么样，就是说希望自己这次可以好好学几天东西，算是给自己一个交代吧。\n\n对咯，接下来 tag:cryptohack 底下的文章都会是 [cryptohack](https://cryptohack.org/) 上的题，如果你也是和我一样的小白，也许可以通过这些文章和我一起学习喔。\n","source":"_posts/开始cryptohack.md","raw":"---\ntitle: 开始cryptohack\ndate: 2022-05-01 04:04:32\ntags:\n- 垃圾桶\n- cryptohack\n---\n\n刚刚搭好博客，来水第一篇文章咯！（bushi\n\n<!--more-->\n\n今天去面试 xdsec 咯，虽然很紧张也磕磕绊绊，但总算是结束咯。只是最后惊闻噩耗，面试任务 5.7 截止，所以整个五一假期都要用来做面试任务，那我当然心甘情愿 ~~很不乐意~~ 。又因为想要快点充实自己的博客然后拿去和朋友们分享，所以想到可以用这个博客浅（shen）浅（shen）记录一下学习过程。（和解题思路？虽然面试师傅说布置的都是简单基础题，但是可能对小白 ~~指我~~ 来说还是需要一些思考的吧\n\n说到这个，想起去年鸽掉了二面，当时虽然想进协会但是自己是个懒狗~~（可能现在也是）~~，后来面试师傅刚好是好朋友，一直在催我学相关知识，也很感谢师傅的操心（bushi），如果只是自己一个人的话，很可能就不会再去试着学习这方面的东西提升自己了。\n\n不管结果怎么样，就是说希望自己这次可以好好学几天东西，算是给自己一个交代吧。\n\n对咯，接下来 tag:cryptohack 底下的文章都会是 [cryptohack](https://cryptohack.org/) 上的题，如果你也是和我一样的小白，也许可以通过这些文章和我一起学习喔。\n","slug":"开始cryptohack","published":1,"updated":"2022-05-28T08:19:22.108Z","_id":"cl3plql9800030kfsc9n40prb","comments":1,"layout":"post","photos":[],"link":"","content":"<p>刚刚搭好博客，来水第一篇文章咯！（bushi</p>\n<span id=\"more\"></span>\n\n<p>今天去面试 xdsec 咯，虽然很紧张也磕磕绊绊，但总算是结束咯。只是最后惊闻噩耗，面试任务 5.7 截止，所以整个五一假期都要用来做面试任务，那我当然心甘情愿 <del>很不乐意</del> 。又因为想要快点充实自己的博客然后拿去和朋友们分享，所以想到可以用这个博客浅（shen）浅（shen）记录一下学习过程。（和解题思路？虽然面试师傅说布置的都是简单基础题，但是可能对小白 <del>指我</del> 来说还是需要一些思考的吧</p>\n<p>说到这个，想起去年鸽掉了二面，当时虽然想进协会但是自己是个懒狗<del>（可能现在也是）</del>，后来面试师傅刚好是好朋友，一直在催我学相关知识，也很感谢师傅的操心（bushi），如果只是自己一个人的话，很可能就不会再去试着学习这方面的东西提升自己了。</p>\n<p>不管结果怎么样，就是说希望自己这次可以好好学几天东西，算是给自己一个交代吧。</p>\n<p>对咯，接下来 tag:cryptohack 底下的文章都会是 <a href=\"https://cryptohack.org/\">cryptohack</a> 上的题，如果你也是和我一样的小白，也许可以通过这些文章和我一起学习喔。</p>\n","site":{"data":{}},"cover":"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","excerpt":"<p>刚刚搭好博客，来水第一篇文章咯！（bushi</p>","more":"<p>今天去面试 xdsec 咯，虽然很紧张也磕磕绊绊，但总算是结束咯。只是最后惊闻噩耗，面试任务 5.7 截止，所以整个五一假期都要用来做面试任务，那我当然心甘情愿 <del>很不乐意</del> 。又因为想要快点充实自己的博客然后拿去和朋友们分享，所以想到可以用这个博客浅（shen）浅（shen）记录一下学习过程。（和解题思路？虽然面试师傅说布置的都是简单基础题，但是可能对小白 <del>指我</del> 来说还是需要一些思考的吧</p>\n<p>说到这个，想起去年鸽掉了二面，当时虽然想进协会但是自己是个懒狗<del>（可能现在也是）</del>，后来面试师傅刚好是好朋友，一直在催我学相关知识，也很感谢师傅的操心（bushi），如果只是自己一个人的话，很可能就不会再去试着学习这方面的东西提升自己了。</p>\n<p>不管结果怎么样，就是说希望自己这次可以好好学几天东西，算是给自己一个交代吧。</p>\n<p>对咯，接下来 tag:cryptohack 底下的文章都会是 <a href=\"https://cryptohack.org/\">cryptohack</a> 上的题，如果你也是和我一样的小白，也许可以通过这些文章和我一起学习喔。</p>"}],"PostAsset":[],"PostCategory":[],"PostTag":[{"post_id":"cl2neel3w0000dss27mh13an9","tag_id":"cl2mbt3700000ygs2fsyy35lm","_id":"cl2neel410001dss2h6hi10mw"},{"post_id":"cl37evnxx00009wfs0vv4b77m","tag_id":"cl2mbt3700000ygs2fsyy35lm","_id":"cl37evny300029wfs7yfy7hoy"},{"post_id":"cl37evny100019wfs00260g8e","tag_id":"cl2mbt3700000ygs2fsyy35lm","_id":"cl37evny300049wfsfdjg4ksz"},{"post_id":"cl37evny400059wfs99fvajgy","tag_id":"cl2mbt3700000ygs2fsyy35lm","_id":"cl37evny500079wfs6bqu85rg"},{"post_id":"cl3pllpda0000i0fshm52hyxo","tag_id":"cl2mbt3700000ygs2fsyy35lm","_id":"cl3pllpdi0001i0fs5f0fdzho"},{"post_id":"cl2lnhlj0000084s2am0j7q4q","tag_id":"cl3plphdr00000kfshnccadts","_id":"cl3plphds00010kfs4z9s6utx"},{"post_id":"cl3plql9800030kfsc9n40prb","tag_id":"cl3plphdr00000kfshnccadts","_id":"cl3plql9900040kfs7a908xth"},{"post_id":"cl3plql9800030kfsc9n40prb","tag_id":"cl2mbt3700000ygs2fsyy35lm","_id":"cl3plql9a00050kfs2nqjdoxp"}],"Tag":[{"name":"废话","_id":"cl2mawnsb0001gcs2flxl0s20"},{"name":"废话,cryptohack","_id":"cl2mbdq8x0000ygs27l0c6koz"},{"name":"废话, cryptohack","_id":"cl2mbeo1a00007ks28t6456zj"},{"name":"-废话, cryptohack","_id":"cl2mbh0zb00003ss252w37c0k"},{"name":"-废话 -cryptohack","_id":"cl2mbj6430000i4s2hg8tg37c"},{"name":"废话 -cryptohack","_id":"cl2mbk06100004cs204585638"},{"name":"废话 cryptohack","_id":"cl2mbk1iz00024cs21f6ja73x"},{"name":"废话， cryptohack","_id":"cl2mbk37900044cs2ezmx5yzk"},{"name":"cryptohack","_id":"cl2mbt3700000ygs2fsyy35lm"},{"name":"垃圾桶","_id":"cl3plphdr00000kfshnccadts"}]}}