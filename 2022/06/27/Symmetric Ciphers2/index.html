<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Symmetric Ciphers2 | smilin9's Blog</title><meta name="keywords" content="cryptohack"><meta name="author" content="smilin9"><meta name="copyright" content="smilin9"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="SYMMETRIC STARTERModes of Operation StarterDescriptionThe previous set of challenges showed how AES performs a keyed permutation on a block of data. In practice, we need to encrypt messages much longe">
<meta property="og:type" content="article">
<meta property="og:title" content="Symmetric Ciphers2">
<meta property="og:url" content="http://smilin9.com/2022/06/27/Symmetric%20Ciphers2/">
<meta property="og:site_name" content="smilin9&#39;s Blog">
<meta property="og:description" content="SYMMETRIC STARTERModes of Operation StarterDescriptionThe previous set of challenges showed how AES performs a keyed permutation on a block of data. In practice, we need to encrypt messages much longe">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2022-06-27T06:00:00.000Z">
<meta property="article:modified_time" content="2022-11-09T15:12:30.589Z">
<meta property="article:author" content="smilin9">
<meta property="article:tag" content="cryptohack">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://smilin9.com/2022/06/27/Symmetric%20Ciphers2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Symmetric Ciphers2',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-09 23:12:30'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://avatars.githubusercontent.com/u/104638756?v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa-solid fa-house"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa-solid fa-box-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa-solid fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa-solid fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-solid fa-circle-info"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">smilin9's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa-solid fa-house"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa-solid fa-box-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa-solid fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa-solid fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-solid fa-circle-info"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Symmetric Ciphers2</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon fas fa-history"></i><span class="post-meta-label">更新于</span><time datetime="2022-11-09T15:12:30.589Z" title="更新于 2022-11-09 23:12:30">2022-11-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>4分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Symmetric Ciphers2"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="SYMMETRIC-STARTER"><a href="#SYMMETRIC-STARTER" class="headerlink" title="SYMMETRIC STARTER"></a>SYMMETRIC STARTER</h1><h2 id="Modes-of-Operation-Starter"><a href="#Modes-of-Operation-Starter" class="headerlink" title="Modes of Operation Starter"></a>Modes of Operation Starter</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>The previous set of challenges showed how AES performs a keyed permutation on a block of data. In practice, we need to encrypt messages much longer than a single block. A <em>mode of operation</em> describes how to use a cipher like AES on longer messages.</p>
<p>All modes have serious weaknesses when used incorrectly. The challenges in this category take you to a different section of the website where you can interact with APIs and exploit those weaknesses. Get yourself acquainted with the interface and use it to take your next flag!</p>
<p>Play at <a target="_blank" rel="noopener" href="http://aes.cryptohack.org/block_cipher_starter">http://aes.cryptohack.org/block_cipher_starter</a></p>
<h3 id="Analyze"><a href="#Analyze" class="headerlink" title="Analyze"></a>Analyze</h3><p>网站点出去是给了加密方式和过程，一开始以为是要看加密解密函数，但是发现他密文也没给，就很迷。去问了问书记 <code>@chal.route(&#39;/block_cipher_starter/decrypt/&lt;ciphertext&gt;/&#39;)</code> 是啥意思，发现 @ 这个东西表示网页路径，上面这个的网页路径就是 <code>/decrypt/&lt;ciphertext&gt;/</code>， 其中 <ciphertext> 是访问需要的参数，另一个访问不需要参数。就直接请求第二个，得到 <code>encrypt_flag()</code>：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;ciphertext&quot;</span><span class="punctuation">:</span><span class="string">&quot;64cede86f533b58fe197a0c9aca6f8d5a7b4389c629cef1c9e90f4e5fe7629a4&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>然后将密文填进解密函数的参数值里面请求得到：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;plaintext&quot;</span><span class="punctuation">:</span><span class="string">&quot;63727970746f7b626c30636b5f633170683372355f3472335f663435375f217d&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>明文丢进十六进制解码器得到 flag。</p>
<h2 id="Passwords-as-Keys"><a href="#Passwords-as-Keys" class="headerlink" title="Passwords as Keys"></a>Passwords as Keys</h2><h3 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h3><p>It is essential that keys in symmetric-key algorithms are random bytes, instead of passwords or other predictable data. The random bytes should be generated using a cryptographically-secure pseudorandom number generator (CSPRNG). If the keys are predictable in any way, then the security level of the cipher is reduced and it may be possible for an attacker who gets access to the ciphertext to decrypt it.</p>
<p>Just because a key looks like it is formed of random bytes, does not mean that it necessarily is. In this case the key has been derived from a simple password using a hashing function, which makes the ciphertext crackable.</p>
<p>For this challenge you may script your HTTP requests to the endpoints, or alternatively attack the ciphertext offline. Good luck!</p>
<p>Play at <a target="_blank" rel="noopener" href="http://aes.cryptohack.org/passwords_as_keys">http://aes.cryptohack.org/passwords_as_keys</a></p>
<h3 id="Analyze-1"><a href="#Analyze-1" class="headerlink" title="Analyze"></a>Analyze</h3><p>一眼先请求 <code>encrypt_flag()</code>：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;ciphertext&quot;</span><span class="punctuation">:</span><span class="string">&quot;c92b7734070205bdf6c0087a751466ec13ae15e6f1bcdd3f3a535ec0f4bbae66&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>把字典保存到本地，读到列表 words 里遍历，将其中的元素依次作为 key，创建 AES 对象 cipher，过滤出以 <code>crypto&#123;</code> 开头的解密文本就是 flag。</p>
<p>本来是打算爆破然后和密文对比，发现会出好多奇奇怪怪的超时错误，遍历也有问题，9w 多行属实有点离谱。</p>
<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">ciphertext = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;c92b7734070205bdf6c0087a751466ec13ae15e6f1bcdd3f3a535ec0f4bbae66&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./1.txt&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    words = [w.strip() <span class="keyword">for</span> w <span class="keyword">in</span> f.readlines()]</span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> words:</span><br><span class="line">    key = hashlib.md5(w.encode()).digest()</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    decoded_text = cipher.decrypt(ciphertext)</span><br><span class="line">    <span class="keyword">if</span> decoded_text.startswith(<span class="string">&#x27;crypto&#123;&#x27;</span>.encode()):</span><br><span class="line">        <span class="built_in">print</span>(decoded_text)</span><br><span class="line">        exit</span><br></pre></td></tr></table></figure>
<h3 id="SumUp"><a href="#SumUp" class="headerlink" title="SumUp"></a>SumUp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br></pre></td></tr></table></figure>
<h1 id="BLOCK-CIPHERS"><a href="#BLOCK-CIPHERS" class="headerlink" title="BLOCK CIPHERS"></a>BLOCK CIPHERS</h1><h2 id="ECB-CBC-WTF"><a href="#ECB-CBC-WTF" class="headerlink" title="ECB CBC WTF"></a>ECB CBC WTF</h2><h3 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h3><p>Here you can encrypt in CBC but only decrypt in ECB. That shouldn’t be a weakness because they’re different modes… right?</p>
<p>Play at <a target="_blank" rel="noopener" href="http://aes.cryptohack.org/ecbcbcwtf">http://aes.cryptohack.org/ecbcbcwtf</a></p>
<h3 id="Analyze-2"><a href="#Analyze-2" class="headerlink" title="Analyze"></a>Analyze</h3><p>第一眼无脑请求 <code>encrypt_flag()</code>，但偶然发现这个东西每次请求到的密文都不一样，顿悟：“喔这是分组密码”。。。</p>
<p>然后来看图</p>
<p><img src="https://img.hawa130.com/QQ图片20220723214144.jpg" alt="QQ图片20220723214144"></p>
<p>获取到的密文长度是 32*3，由代码得出偏移量是前 32 位，把获取到的 ciphertext 分为三组先：</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">&quot;ciphertext&quot;</span>:<span class="string">&quot;734aaeb24447ac787dfb0cf09f7c3371246be4c9b9974bf6faad679a36dd42c8e529bb2b2cd1bba8afa460364d5d0ec8&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">734aaeb24447ac787dfb0cf09f7c3371  <span class="comment">#iv</span></span><br><span class="line">246be4c9b9974bf6faad679a36dd42c8  <span class="comment">#第一组密文</span></span><br><span class="line">e529bb2b2<span class="keyword">cd</span>1bba8afa460364d5d0ec8  <span class="comment">#第二组密文</span></span><br></pre></td></tr></table></figure>
<p>先解第二组密文，把它填入解密函数的参数位置，得到异或后的密文 </p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;plaintext&quot;</span><span class="punctuation">:</span><span class="string">&quot;7b5f92f988f314c7cdf246bb17fc63b5&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>这是第二组明文和第一组密文异或的结果，由于第一组密文已知，所以直接和它进行异或得到第二组明文 </p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">5f34763031645f31375f21212121217d</span><br></pre></td></tr></table></figure>
<p>同理，第一组密文解密之后得到 </p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;plaintext&quot;</span><span class="punctuation">:</span><span class="string">&quot;1038d7c23028d74b1e9953c5ea1f5844&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>将其与偏移量进行异或得到第一组明文 </p>
<figure class="highlight dns"><table><tr><td class="code"><pre><span class="line"><span class="number">63727970746</span>f7b3363625f<span class="number">3575636b35</span></span><br></pre></td></tr></table></figure>
<p>拼接得到明文为</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">63727970746f7b3363625f3575636b355f34763031645f31375f21212121217d</span><br></pre></td></tr></table></figure>
<p>hex 解码之后得到 flag。</p>
<h2 id="ECB-Oracle"><a href="#ECB-Oracle" class="headerlink" title="ECB Oracle"></a>ECB Oracle</h2><h3 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h3><p>ECB is the most simple mode, with each plaintext block encrypted entirely independently. In this case, your input is prepended to the secret flag and encrypted and that’s it. We don’t even provide a decrypt function. Perhaps you don’t need a padding oracle when you have an “ECB oracle”?</p>
<p>Play at <a target="_blank" rel="noopener" href="http://aes.cryptohack.org/ecb_oracle">http://aes.cryptohack.org/ecb_oracle</a></p>
<h3 id="Analyze-3"><a href="#Analyze-3" class="headerlink" title="Analyze"></a>Analyze</h3><h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="SumUp-1"><a href="#SumUp-1" class="headerlink" title="SumUp"></a>SumUp</h3><h2 id="Flipping-Cookie"><a href="#Flipping-Cookie" class="headerlink" title="Flipping Cookie"></a>Flipping Cookie</h2><h3 id="Description-4"><a href="#Description-4" class="headerlink" title="Description"></a>Description</h3><h3 id="Analyze-4"><a href="#Analyze-4" class="headerlink" title="Analyze"></a>Analyze</h3><h3 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">r = requests.get(<span class="string">&#x27;http://aes.cryptohack.org/flipping_cookie/get_cookie/&#x27;</span>)</span><br><span class="line">cookie_payload = json.loads(r.text)[<span class="string">&quot;cookie&quot;</span>]</span><br><span class="line"></span><br><span class="line">iv = cookie_payload[:<span class="number">32</span>]</span><br><span class="line">cookie = cookie_payload[<span class="number">32</span>:]</span><br><span class="line"></span><br><span class="line">iv_new = copy.deepcopy(iv)</span><br><span class="line">xor_value = (<span class="number">0x12</span> &lt;&lt; <span class="number">72</span> | <span class="number">0x13</span> &lt;&lt; <span class="number">64</span> | <span class="number">0x19</span> &lt;&lt; <span class="number">56</span> | <span class="number">0x16</span> &lt;&lt; <span class="number">48</span> | <span class="number">0x5e</span> &lt;&lt; <span class="number">40</span>) &amp; ((<span class="number">0xFFFFFFFFFF</span> &lt;&lt; <span class="number">88</span>) &gt;&gt; <span class="number">48</span>)</span><br><span class="line"></span><br><span class="line">iv_new = <span class="built_in">int</span>(iv_new, <span class="number">16</span>) ^ xor_value </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(iv_new))</span><br><span class="line"></span><br><span class="line">get_param = <span class="string">&#x27;http://aes.cryptohack.org/flipping_cookie/check_admin/&#x27;</span> + cookie + <span class="string">&#x27;/&#x27;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(iv_new))[<span class="number">2</span>:] + <span class="string">&#x27;/&#x27;</span></span><br><span class="line">r2 = requests.get(get_param)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r2.text)</span><br></pre></td></tr></table></figure>
<h3 id="SumUp-2"><a href="#SumUp-2" class="headerlink" title="SumUp"></a>SumUp</h3><h2 id="Lazy-CBC"><a href="#Lazy-CBC" class="headerlink" title="Lazy CBC"></a>Lazy CBC</h2><h3 id="Description-5"><a href="#Description-5" class="headerlink" title="Description"></a>Description</h3><h3 id="Analyze-5"><a href="#Analyze-5" class="headerlink" title="Analyze"></a>Analyze</h3><h3 id="Code-3"><a href="#Code-3" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="SumUp-3"><a href="#SumUp-3" class="headerlink" title="SumUp"></a>SumUp</h3><h2 id="Triple-DES"><a href="#Triple-DES" class="headerlink" title="Triple DES"></a>Triple DES</h2><h3 id="Description-6"><a href="#Description-6" class="headerlink" title="Description"></a>Description</h3><h3 id="Analyze-6"><a href="#Analyze-6" class="headerlink" title="Analyze"></a>Analyze</h3><h3 id="Code-4"><a href="#Code-4" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="SumUp-4"><a href="#SumUp-4" class="headerlink" title="SumUp"></a>SumUp</h3></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://smilin9.com">smilin9</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://smilin9.com/2022/06/27/Symmetric%20Ciphers2/">http://smilin9.com/2022/06/27/Symmetric Ciphers2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://smilin9.com" target="_blank">smilin9's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/cryptohack/">cryptohack</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2022/06/18/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%8D%E4%B9%A0/"><img class="prev-cover" src="https://img.hawa130.com/数据库.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">数据库复习</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/05/01/Introduction%20To%20Cryptohack/" title="Introduction To Cryptohack"><img class="cover" src="https://img.hawa130.com/Introduction.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-01</div><div class="title">Introduction To Cryptohack</div></div></a></div><div><a href="/2022/05/03/Modular%20Arithmetic/" title="Modular Arithmetic"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-03</div><div class="title">Modular Arithmetic</div></div></a></div><div><a href="/2022/05/08/RSA_STARTER/" title="RSA_STARTER"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-09</div><div class="title">RSA_STARTER</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/104638756?v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">smilin9</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/smilin9"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/smilin9" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:qliu_6@stu.xidian.edu.cn" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="Rss"><i class="fa fa-rss"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SYMMETRIC-STARTER"><span class="toc-number">1.</span> <span class="toc-text">SYMMETRIC STARTER</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Modes-of-Operation-Starter"><span class="toc-number">1.1.</span> <span class="toc-text">Modes of Operation Starter</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description"><span class="toc-number">1.1.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyze"><span class="toc-number">1.1.2.</span> <span class="toc-text">Analyze</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Passwords-as-Keys"><span class="toc-number">1.2.</span> <span class="toc-text">Passwords as Keys</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyze-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">Analyze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code"><span class="toc-number">1.2.3.</span> <span class="toc-text">Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SumUp"><span class="toc-number">1.2.4.</span> <span class="toc-text">SumUp</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BLOCK-CIPHERS"><span class="toc-number">2.</span> <span class="toc-text">BLOCK CIPHERS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ECB-CBC-WTF"><span class="toc-number">2.1.</span> <span class="toc-text">ECB CBC WTF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-2"><span class="toc-number">2.1.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyze-2"><span class="toc-number">2.1.2.</span> <span class="toc-text">Analyze</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ECB-Oracle"><span class="toc-number">2.2.</span> <span class="toc-text">ECB Oracle</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-3"><span class="toc-number">2.2.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyze-3"><span class="toc-number">2.2.2.</span> <span class="toc-text">Analyze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-1"><span class="toc-number">2.2.3.</span> <span class="toc-text">Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SumUp-1"><span class="toc-number">2.2.4.</span> <span class="toc-text">SumUp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Flipping-Cookie"><span class="toc-number">2.3.</span> <span class="toc-text">Flipping Cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-4"><span class="toc-number">2.3.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyze-4"><span class="toc-number">2.3.2.</span> <span class="toc-text">Analyze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-2"><span class="toc-number">2.3.3.</span> <span class="toc-text">Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SumUp-2"><span class="toc-number">2.3.4.</span> <span class="toc-text">SumUp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lazy-CBC"><span class="toc-number">2.4.</span> <span class="toc-text">Lazy CBC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-5"><span class="toc-number">2.4.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyze-5"><span class="toc-number">2.4.2.</span> <span class="toc-text">Analyze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-3"><span class="toc-number">2.4.3.</span> <span class="toc-text">Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SumUp-3"><span class="toc-number">2.4.4.</span> <span class="toc-text">SumUp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Triple-DES"><span class="toc-number">2.5.</span> <span class="toc-text">Triple DES</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-6"><span class="toc-number">2.5.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyze-6"><span class="toc-number">2.5.2.</span> <span class="toc-text">Analyze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-4"><span class="toc-number">2.5.3.</span> <span class="toc-text">Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SumUp-4"><span class="toc-number">2.5.4.</span> <span class="toc-text">SumUp</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/06/27/Symmetric%20Ciphers2/" title="Symmetric Ciphers2"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Symmetric Ciphers2"/></a><div class="content"><a class="title" href="/2022/06/27/Symmetric%20Ciphers2/" title="Symmetric Ciphers2">Symmetric Ciphers2</a><time datetime="2022-06-27T06:00:00.000Z" title="发表于 2022-06-27 14:00:00">2022-06-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/18/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%8D%E4%B9%A0/" title="数据库复习"><img src="https://img.hawa130.com/数据库.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库复习"/></a><div class="content"><a class="title" href="/2022/06/18/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%8D%E4%B9%A0/" title="数据库复习">数据库复习</a><time datetime="2022-06-18T16:00:00.000Z" title="发表于 2022-06-19 00:00:00">2022-06-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/17/%E6%9C%9D%E8%8A%B1%E5%A4%95%E8%AA%93/" title="朝花夕誓"><img src="https://img.hawa130.com/朝花夕誓.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="朝花夕誓"/></a><div class="content"><a class="title" href="/2022/06/17/%E6%9C%9D%E8%8A%B1%E5%A4%95%E8%AA%93/" title="朝花夕誓">朝花夕誓</a><time datetime="2022-06-17T08:53:00.000Z" title="发表于 2022-06-17 16:53:00">2022-06-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/16/%E7%BD%91%E5%AE%89%E6%95%B0%E5%9F%BA%E5%A4%8D%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="网安数基复习"><img src="https://img.hawa130.com/网络空间安全数学基础.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="网安数基复习"/></a><div class="content"><a class="title" href="/2022/06/16/%E7%BD%91%E5%AE%89%E6%95%B0%E5%9F%BA%E5%A4%8D%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="网安数基复习">网安数基复习</a><time datetime="2022-06-16T15:42:00.000Z" title="发表于 2022-06-16 23:42:00">2022-06-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/08/RSA_STARTER/" title="RSA_STARTER"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RSA_STARTER"/></a><div class="content"><a class="title" href="/2022/05/08/RSA_STARTER/" title="RSA_STARTER">RSA_STARTER</a><time datetime="2022-05-08T17:42:00.000Z" title="发表于 2022-05-09 01:42:00">2022-05-09</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By smilin9</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>