<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>前三章补充 | smilin9's Blog</title><meta name="keywords" content="cryptohack"><meta name="author" content="smilin9"><meta name="copyright" content="smilin9"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="之前竟然做错模块了？寄！">
<meta property="og:type" content="article">
<meta property="og:title" content="前三章补充">
<meta property="og:url" content="http://smilin9.com/2022/05/08/%E5%89%8D%E4%B8%89%E7%AB%A0%E8%A1%A5%E5%85%85/">
<meta property="og:site_name" content="smilin9&#39;s Blog">
<meta property="og:description" content="之前竟然做错模块了？寄！">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.hawa130.com/start.jpg">
<meta property="article:published_time" content="2022-05-08T07:29:00.000Z">
<meta property="article:modified_time" content="2022-09-17T07:42:17.504Z">
<meta property="article:author" content="smilin9">
<meta property="article:tag" content="cryptohack">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.hawa130.com/start.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://smilin9.com/2022/05/08/%E5%89%8D%E4%B8%89%E7%AB%A0%E8%A1%A5%E5%85%85/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '前三章补充',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-09-17 15:42:17'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://avatars.githubusercontent.com/u/104638756?v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa-solid fa-house"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa-solid fa-box-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa-solid fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa-solid fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-solid fa-circle-info"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://img.hawa130.com/start.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">smilin9's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa-solid fa-house"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa-solid fa-box-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa-solid fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa-solid fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-solid fa-circle-info"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">前三章补充</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon fas fa-history"></i><span class="post-meta-label">更新于</span><time datetime="2022-09-17T07:42:17.504Z" title="更新于 2022-09-17 15:42:17">2022-09-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>13分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="前三章补充"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>之前竟然做错模块了？寄！</p>
<span id="more"></span>
<p>我真的谢。</p>
<p>7 号凌晨和面试师傅抱怨 Courses 第五章的 ECC 难学，师傅震惊：“你怎么去学 ECC 了？”，然后发现面试任务竟然是 Challenge 的那些章节，当时就心态大崩，我就说 ECC 怎么会是我现在可以染指的东西啊（麻。。</p>
<p>不过还好师傅把二面时间延迟到 10 号了，7 号调休 9 号满课，算下来其实也就多了 8 号的周日可以做题，所以 8 号我必早起！</p>
<p>这篇先补一下 Challenge 前三章没做的题，第五章后面再单独写吧。</p>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><h2 id="Network-Attacks"><a href="#Network-Attacks" class="headerlink" title="Network Attacks"></a>Network Attacks</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>Several of the challenges are dynamic and require you to talk to our challenge servers over the network. This allows you to perform man-in-the-middle attacks on people trying to communicate, or directly attack a vulnerable service. To keep things consistent, our interactive servers always send and receive JSON objects.</p>
<p>Python makes such network communication easy with the <code>telnetlib</code> module. Conveniently, it’s part of Python’s standard library, so let’s use it for now.</p>
<p>For this challenge, connect to <code>socket.cryptohack.org</code> on port <code>11112</code>. Send a JSON object with the key <code>buy</code> and value <code>flag</code>.</p>
<p>The example script below contains the beginnings of a solution for you to modify, and you can reuse it for later challenges.</p>
<p>Connect at <code>nc socket.cryptohack.org 11112</code>.</p>
<h3 id="Analyze"><a href="#Analyze" class="headerlink" title="Analyze"></a>Analyze</h3><p>使用中间人攻击的方式获取 flag 。</p>
<p>使用 telnetlib 库对 socket.cryptohack.org 11112端口以  JSON 对象的方式进行请求。</p>
<p>题目说的很明确，就把 buy 的值改成 flag，运行代码就能出结果。</p>
<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 部分代码</span></span><br><span class="line">request = &#123;</span><br><span class="line">    <span class="string">&quot;buy&quot;</span>: <span class="string">&quot;flag&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="General"><a href="#General" class="headerlink" title="General"></a>General</h1><h2 id="ENCODING-Encoding-Challenge"><a href="#ENCODING-Encoding-Challenge" class="headerlink" title="ENCODING_Encoding Challenge"></a>ENCODING_Encoding Challenge</h2><h3 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h3><p>Now you’ve got the hang of the various encodings you’ll be encountering, let’s have a look at automating it.</p>
<p>Can you pass all 100 levels to get the flag?</p>
<p>The <em>13377.py</em> file attached below is the source code for what’s running on the server. The <em>pwntools_example.py</em> file provides the start of a solution using the incredibly convenient pwntools library. which we recommend. If you’d prefer to use Python’s in-built telnetlib, <em>telnetlib_example.py</em> is also provided.</p>
<p>For more information about connecting to interactive challenges, see the <a target="_blank" rel="noopener" href="https://cryptohack.org/faq#netcat">FAQ</a>. Feel free to skip ahead to the cryptography if you aren’t in the mood for a coding challenge!</p>
<p>Connect at <code>nc socket.cryptohack.org 13377</code>.</p>
<h3 id="Analyze-1"><a href="#Analyze-1" class="headerlink" title="Analyze"></a>Analyze</h3><p>刚开始看题是真没搞明白他要干啥，甚至以为这不是密码题。。（可能我阅读能力有问题？</p>
<p>阅读服务端的代码，第一次连接服务器会返回编码方式以及编码后的字符串，这时候需要提交解码后的字符串，正确解码后服务器会发来下一个。100 次之后服务器主动终止连接，解码之后得到的就是 flag。</p>
<p>解码函数看着他的加密代码倒是蛮容易写的，但是确实不喜欢做这类题。</p>
<h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;socket.cryptohack.org&#x27;</span>, <span class="number">13377</span>, level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">json_recv</span>() -&gt; <span class="built_in">dict</span>:</span><br><span class="line">    line = r.recvline()</span><br><span class="line">    <span class="keyword">return</span> json.loads(line.decode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">json_send</span>(<span class="params">hsh: <span class="built_in">dict</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    request = json.dumps(hsh).encode()</span><br><span class="line">    r.sendline(request)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">encoded: <span class="built_in">str</span>, <span class="built_in">type</span>: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span> == <span class="string">&quot;base64&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> base64.b64decode(encoded).decode()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&quot;hex&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> codecs.decode(encoded, <span class="string">&#x27;hex&#x27;</span>).decode()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&quot;rot13&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> codecs.decode(encoded, <span class="string">&#x27;rot_13&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&quot;bigint&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> long_to_bytes(<span class="built_in">int</span>(encoded, <span class="number">16</span>)).decode()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&quot;utf-8&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> encoded)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Unknown encoding&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一次接收</span></span><br><span class="line">received = json_recv()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    plain_text = decode(received[<span class="string">&quot;encoded&quot;</span>], received[<span class="string">&quot;type&quot;</span>])</span><br><span class="line">    to_send = &#123;</span><br><span class="line">        <span class="string">&quot;decoded&quot;</span>: plain_text</span><br><span class="line">    &#125;</span><br><span class="line">    json_send(to_send)</span><br><span class="line">    received = json_recv()</span><br></pre></td></tr></table></figure>
<h2 id="XOR-Lemur-XOR"><a href="#XOR-Lemur-XOR" class="headerlink" title="XOR_Lemur XOR"></a>XOR_Lemur XOR</h2><h3 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h3><p>I’ve hidden two cool images by XOR with the same secret key so you can’t see them!</p>
<h3 id="Analyze-2"><a href="#Analyze-2" class="headerlink" title="Analyze"></a>Analyze</h3><p>题目描述倒是挺短。</p>
<p>直接二进制异或不行，然后试试像素点异或。</p>
<p>对图片操作很陌生诶。还是菜。</p>
<h3 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">flagImg = Image.<span class="built_in">open</span>(<span class="string">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/flag.png&#x27;</span>)</span><br><span class="line">flag = flagImg.load()</span><br><span class="line"></span><br><span class="line">lemurImg = Image.<span class="built_in">open</span>(<span class="string">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/lemur.png&#x27;</span>)</span><br><span class="line">lemur = lemurImg.load()</span><br><span class="line">width, height = flagImg.size</span><br><span class="line"></span><br><span class="line">newImg = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class="line">new = newImg.load()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        r1, g1, b1 = flag[i, j]</span><br><span class="line">        r2, g2, b2 = lemur[i, j]</span><br><span class="line">        new[i, j] = (r1 ^ r2, g1 ^ g2, b1 ^ b2)</span><br><span class="line"></span><br><span class="line">newImg.save(<span class="string">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/补充/xorimage.png&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="DATA-FORMATS-Privacy-Enhanced-Mail"><a href="#DATA-FORMATS-Privacy-Enhanced-Mail" class="headerlink" title="DATA FORMATS_Privacy-Enhanced Mail?"></a>DATA FORMATS_Privacy-Enhanced Mail?</h2><h3 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h3><p>As we’ve seen in the encoding section, cryptography involves dealing with data in a wide variety of formats: big integers, raw bytes, hex strings and more. A few structured formats have been standardised to help send and receive cryptographic data. It helps to be able to recognise and manipulate these common data formats.</p>
<p>PEM is a popular format for sending keys, certificates, and other cryptographic material. It looks like:</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="params">-----BEGIN</span> RSA PUBLIC KEY<span class="params">-----</span></span><br><span class="line">MIIBCgKC.<span class="string">..</span> *<span class="params">(a whole bunch of base64)</span>*</span><br><span class="line"><span class="params">-----END</span> RSA PUBLIC KEY<span class="params">-----</span></span><br></pre></td></tr></table></figure>
<p>It wraps base64-encoded data by a one-line header and footer to indicate how to parse the data within. Perhaps unexpectedly, it’s important for there to be the correct number of hyphens in the header and footer, otherwise cryptographic tools won’t be able to recognise the file.</p>
<p>The data that gets base64-encoded is DER-encoded ASN.1 values. Confused? <a target="_blank" rel="noopener" href="https://www.cryptologie.net/article/260/asn1-vs-der-vs-pem-vs-x509-vs-pkcs7-vs/">Here</a> is more information about what these acronyms mean but the complexity is there for historical reasons and going too deep into the details may drive you insane.</p>
<p>Extract the private key <em>d</em> as a decimal integer from this PEM-formatted RSA key.</p>
<blockquote>
<p>There are two main approaches for solving this challenge. The data in the certificate can be read with the openssl command line tool, or in Python using PyCryptodome. We recommend using PyCryptodome: first import the RSA module with <code>from Crypto.PublicKey import RSA</code> and you can read the key data using <code>RSA.importKey()</code>.</p>
</blockquote>
<h3 id="Analyze-3"><a href="#Analyze-3" class="headerlink" title="Analyze"></a>Analyze</h3><p>.pem 文件诶，看起来好酷的样子。</p>
<p>用给出的库和函数转换一下直接出。</p>
<h3 id="Code-3"><a href="#Code-3" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">open</span>(<span class="string">r&quot;./privacy_enhanced_mail.pem&quot;</span>).read()</span><br><span class="line">p = RSA.import_key(c)</span><br><span class="line"><span class="built_in">print</span>(p.d)</span><br></pre></td></tr></table></figure>
<h2 id="DATA-FORMATS-CERTainly-not"><a href="#DATA-FORMATS-CERTainly-not" class="headerlink" title="DATA FORMATS_CERTainly not"></a>DATA FORMATS_CERTainly not</h2><h3 id="Description-4"><a href="#Description-4" class="headerlink" title="Description"></a>Description</h3><p>As mentioned in the previous challenge, PEM is just a nice wrapper above DER encoded ASN.1. In some cases you may come across DER files directly; for instance many Windows utilities prefer to work with DER files by default. However, other tools expect PEM format and have difficulty importing a DER file, so it’s good to know how to convert one format to another.</p>
<p>An SSL certificate is a crucial part of the modern web, binding a cryptographic key to details about an organisation. We’ll cover more about these and PKI in the TLS category. Presented here is a DER-encoded x509 RSA certificate. Find the modulus of the certificate, giving your answer as a decimal.</p>
<h3 id="Analyze-4"><a href="#Analyze-4" class="headerlink" title="Analyze"></a>Analyze</h3><p>.der 文件，看起来依然很牛。</p>
<p>和上一题基本就改了个文件名。</p>
<h3 id="Code-4"><a href="#Code-4" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">open</span>(<span class="string">r&quot;./CERTainly not_2048b-rsa-example-cert.der&quot;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">p = RSA.import_key(c)</span><br><span class="line"><span class="built_in">print</span>(p.n)</span><br></pre></td></tr></table></figure>
<h2 id="DATA-FORMATS-SSH-Keys"><a href="#DATA-FORMATS-SSH-Keys" class="headerlink" title="DATA FORMATS_SSH Keys"></a>DATA FORMATS_SSH Keys</h2><h3 id="Description-5"><a href="#Description-5" class="headerlink" title="Description"></a>Description</h3><p>Secure Shell Protocol (SSH) is a network protocol that uses cryptography to establish a secure channel over an insecure network (i.e. the internet). SSH enables developers and system administrators to run commands on servers from the other side of the world, without their password being sniffed or data being stolen. It is therefore critical to the security of the web.</p>
<p>In the old days, system administrators used to logon to their servers using telnet. This works similarly to our interactive challenges that involve connecting to <code>socket.cryptohack.org</code> - data is sent to a remote server, which performs actions based on what is sent. There is no transport encryption, so anyone listening in on the network (such as the WiFi access point owner, your ISP, or the NSA) can see all the telnet traffic.</p>
<p>As the internet became increasingly hostile, people realised the need for both authentication and encryption for administrative network traffic. SSH, first released in 1995, achieves these goals and much more, with advanced functionality built into the software like port forwarding, X11 forwarding, and SFTP (Secure File Transfer Protocol). SSH uses a client-server architecture, meaning the server runs SSH as a service daemon which is always online and waiting to receive connections, and the user runs an SSH client to make a connection to it.</p>
<p>Most commonly, SSH is configured to use public-private key pairs for authentication. On the server, a copy of the user’s public key is stored. The user’s private key is stored locally on their laptop.</p>
<p>Now let’s say Bruce wants to connect as his user account <code>bschneier</code> to his server <code>bruces-server</code>. From his laptop he runs <code>ssh bschneier@bruces-server</code>. His SSH client opens a connection to the server on port 22 where the SSH daemon listens. First, the ciphers that will be used are agreed upon, then a session key to encrypt the connection is established using Diffie-Hellman Key exchange, but we won’t go into the details on that here. Then, the server sends a random challenge message encrypted with Bruce’s public key. Bruce uses his private key to decrypt the challenge and send a hash of the random challenge message back, proving that he owns the correct private key and he therefore authenticates himself to the server as <code>bschneier</code>. Now, the server gives Bruce a shell to run commands. If public-private key cryptography doesn’t make sense to you yet, don’t worry - we’ll cover it extensively in the RSA category.</p>
<p>An SSH private key is stored in the PEM format, which we discussed in the “Privacy-Enhanced Mail” challenge. So it looks like this and is stored on Bruce’s laptop at <code>/home/bschneier/.ssh/id_rsa</code>:</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="params">-----BEGIN</span> RSA PRIVATE KEY<span class="params">-----</span></span><br><span class="line">MIIBCgKC.<span class="string">..</span> *<span class="params">(a whole bunch of base64)</span>*</span><br><span class="line"><span class="params">-----END</span> RSA PRIVATE KEY<span class="params">-----</span></span><br></pre></td></tr></table></figure>
<p>SSH public keys, however, use a different format:</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCtPLqba+GFvDHdFVs1Vvdk56cKqqw5cdomlu034666UsoFIqkig8H5kNsNefSpaR<span class="regexp">/iU7G0ZKCiWRRuAbTsuHN+Cz526XhQvzgKTBkTGYXdF/</span>WdG<span class="regexp">/6/um</span>ou3Z0+wJvTZgvEmeEclvitBrPZkzhAK1M5ypgNR4p8scJplTgSSb84Ckqul<span class="regexp">/Dj/</span>Sh+fwo6sU3S3j92qc27BVGChpQiGwjjut4CkHauzQA<span class="regexp">/gKCBIiLyzoFcLEHhjOBOEErnvrRPWCIAJhALkwV2rUbD4g1IWa7QI2q3nB0nlnjPnjjwaR7TpH4gy2NSIYNDdC1PZ8reBaFnGTXgzhQ2t0ROBNb+ZDgH8Fy+KTG+gEakpu20bRqB86NN6frDLOkZ9x3w32tJtqqrJTALy4Oi3MW0XPO61UBT133VNqAbNYGE2gx+mXBVOezbsY46C/</span>V2fmxBJJKY<span class="regexp">/SFNs8wOVOHKwqRH0GI5VsG1YZClX3fqk8GDJYREaoyoL3HKQt1Ue/</span>ZW7TlPRYzAoIB62C0= bschneier@facts</span><br></pre></td></tr></table></figure>
<p>This format makes it easier for these public keys to be added as lines to the file <code>/home/bschneier/.ssh/authorized_keys</code> on the server. Adding the public key to this file allows the corresponding private key to be used to authenticate on the server.</p>
<p>The <code>ssh-keygen</code> command is used to produce these public-private keypairs.</p>
<p>Extract the modulus <em>n</em> as a decimal integer from Bruce’s SSH public key.</p>
<h3 id="Analyze-5"><a href="#Analyze-5" class="headerlink" title="Analyze"></a>Analyze</h3><p>.pub 后缀更酷了。</p>
<p>不过和第一题解法没区别，只能说函数真的强大。</p>
<h3 id="Code-5"><a href="#Code-5" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">open</span>(<span class="string">r&quot;./SSH Keys_bruce_rsa.pub&quot;</span>).read()</span><br><span class="line">p = RSA.import_key(c)</span><br><span class="line"><span class="built_in">print</span>(p.n)</span><br></pre></td></tr></table></figure>
<h2 id="DATA-FORMATS-Transparency"><a href="#DATA-FORMATS-Transparency" class="headerlink" title="DATA FORMATS_Transparency"></a>DATA FORMATS_Transparency</h2><h3 id="Description-6"><a href="#Description-6" class="headerlink" title="Description"></a>Description</h3><p>When you connect to a website over HTTPS, the first TLS message sent by the server is the ServerHello containing the server TLS certificate. Your browser verifies that the TLS certificate is valid, and if not, will terminate the TLS handshake. Verification includes ensuring that:</p>
<p>- the name on the certificate matches the domain</p>
<p>- the certificate has not expired</p>
<p>- the certificate is ultimately signed (via a “chain of trust”) by a root key of a Certificate Authority (CA) that’s trusted by your browser or operating system</p>
<p>Since CAs have the power to sign any certificate, the security of the internet depends upon these organisations to issue TLS certificates to the correct people: they must only issue certificates to the real domain owners. However with Windows trusting root certificates from over 100 organisations by default, there’s a number of opportunities for hackers, politics, or incompetence to break the whole model. If you could trick just a single CA to issue you a certificate for microsoft.com, you could use the corresponding private key to sign malware and bypass trust controls on Windows. CAs are strongly incentivised to be careful since their business depends upon people trusting them, however in practice they have failed several times.</p>
<p>In 2011 <a target="_blank" rel="noopener" href="https://arstechnica.com/information-technology/2011/03/independent-iranian-hacker-claims-responsibility-for-comodo-hack/">Comodo CA was compromised</a> and the hacker was able to issue certificates for Gmail and other services. In 2016, <a target="_blank" rel="noopener" href="https://security.googleblog.com/2015/10/sustaining-digital-certificate-security.html">Symantec was found</a> to have issued over 150 certificates without the domain owner’s knowledge, as well as 2400 certificates for domains that were never registered.</p>
<p>Due to such events, together with the fact that fraudulent certificates can take a long time to be discovered, since 2018 Certificate Transparency has been enforced by Google Chrome. Every CA must publish all certificates that they issue to a log, which anyone can search.</p>
<p>Attached is an RSA public key in PEM format. Find the subdomain of cryptohack.org which uses these parameters in its TLS certificate, and visit that subdomain to obtain the flag.</p>
<h3 id="Analyze-6"><a href="#Analyze-6" class="headerlink" title="Analyze"></a>Analyze</h3><p>这题怎么说呢，一言难尽。</p>
<p>倒是能解出来 n，但是怎么找到包含 n 的证书对应的域名呢，搜了很久也没找到。</p>
<p>最后是直接去爆破，找到 url 里包含 flag 的子域名，访问得到 flag。</p>
<p>也可以用 <a target="_blank" rel="noopener" href="https://crt.sh/">crt.sh</a> 搜指纹，查日志记录，不过也没用到公钥。</p>
<p>最后还是不知道怎么用公钥推域名，怪捏。</p>
<h1 id="Mathematics"><a href="#Mathematics" class="headerlink" title="Mathematics"></a>Mathematics</h1><p>虽然之前做数学做了很久，不过值得欣慰的是 Challenge 第三章第一部分全都做完了。具体<a href="http://smilin9.com/2022/05/03/Modular%20Arithmetic/">在这里</a> 。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://smilin9.com">smilin9</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://smilin9.com/2022/05/08/%E5%89%8D%E4%B8%89%E7%AB%A0%E8%A1%A5%E5%85%85/">http://smilin9.com/2022/05/08/前三章补充/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://smilin9.com" target="_blank">smilin9's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/cryptohack/">cryptohack</a></div><div class="post_share"><div class="social-share" data-image="https://img.hawa130.com/start.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/05/05/Symmetric%20Ciphers1/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Symmetric Ciphers1</div></div></a></div><div class="next-post pull-right"><a href="/2022/05/08/RSA_STARTER/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">RSA_STARTER</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/05/01/Introduction%20To%20Cryptohack/" title="Introduction To Cryptohack"><img class="cover" src="https://img.hawa130.com/Introduction.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-01</div><div class="title">Introduction To Cryptohack</div></div></a></div><div><a href="/2022/05/03/Modular%20Arithmetic/" title="Modular Arithmetic"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-03</div><div class="title">Modular Arithmetic</div></div></a></div><div><a href="/2022/05/08/RSA_STARTER/" title="RSA_STARTER"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-09</div><div class="title">RSA_STARTER</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/104638756?v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">smilin9</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/smilin9"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/smilin9" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:qliu_6@stu.xidian.edu.cn" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="Rss"><i class="fa fa-rss"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Network-Attacks"><span class="toc-number">1.1.</span> <span class="toc-text">Network Attacks</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description"><span class="toc-number">1.1.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyze"><span class="toc-number">1.1.2.</span> <span class="toc-text">Analyze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code"><span class="toc-number">1.1.3.</span> <span class="toc-text">Code</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#General"><span class="toc-number">2.</span> <span class="toc-text">General</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ENCODING-Encoding-Challenge"><span class="toc-number">2.1.</span> <span class="toc-text">ENCODING_Encoding Challenge</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-1"><span class="toc-number">2.1.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyze-1"><span class="toc-number">2.1.2.</span> <span class="toc-text">Analyze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-1"><span class="toc-number">2.1.3.</span> <span class="toc-text">Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XOR-Lemur-XOR"><span class="toc-number">2.2.</span> <span class="toc-text">XOR_Lemur XOR</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-2"><span class="toc-number">2.2.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyze-2"><span class="toc-number">2.2.2.</span> <span class="toc-text">Analyze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-2"><span class="toc-number">2.2.3.</span> <span class="toc-text">Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DATA-FORMATS-Privacy-Enhanced-Mail"><span class="toc-number">2.3.</span> <span class="toc-text">DATA FORMATS_Privacy-Enhanced Mail?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-3"><span class="toc-number">2.3.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyze-3"><span class="toc-number">2.3.2.</span> <span class="toc-text">Analyze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-3"><span class="toc-number">2.3.3.</span> <span class="toc-text">Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DATA-FORMATS-CERTainly-not"><span class="toc-number">2.4.</span> <span class="toc-text">DATA FORMATS_CERTainly not</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-4"><span class="toc-number">2.4.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyze-4"><span class="toc-number">2.4.2.</span> <span class="toc-text">Analyze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-4"><span class="toc-number">2.4.3.</span> <span class="toc-text">Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DATA-FORMATS-SSH-Keys"><span class="toc-number">2.5.</span> <span class="toc-text">DATA FORMATS_SSH Keys</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-5"><span class="toc-number">2.5.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyze-5"><span class="toc-number">2.5.2.</span> <span class="toc-text">Analyze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-5"><span class="toc-number">2.5.3.</span> <span class="toc-text">Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DATA-FORMATS-Transparency"><span class="toc-number">2.6.</span> <span class="toc-text">DATA FORMATS_Transparency</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-6"><span class="toc-number">2.6.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analyze-6"><span class="toc-number">2.6.2.</span> <span class="toc-text">Analyze</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mathematics"><span class="toc-number">3.</span> <span class="toc-text">Mathematics</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/06/27/Symmetric%20Ciphers2/" title="Symmetric Ciphers2"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Symmetric Ciphers2"/></a><div class="content"><a class="title" href="/2022/06/27/Symmetric%20Ciphers2/" title="Symmetric Ciphers2">Symmetric Ciphers2</a><time datetime="2022-06-27T06:00:00.000Z" title="发表于 2022-06-27 14:00:00">2022-06-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/18/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%8D%E4%B9%A0/" title="数据库复习"><img src="https://img.hawa130.com/数据库.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库复习"/></a><div class="content"><a class="title" href="/2022/06/18/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%8D%E4%B9%A0/" title="数据库复习">数据库复习</a><time datetime="2022-06-18T16:00:00.000Z" title="发表于 2022-06-19 00:00:00">2022-06-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/17/%E6%9C%9D%E8%8A%B1%E5%A4%95%E8%AA%93/" title="朝花夕誓"><img src="https://img.hawa130.com/朝花夕誓.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="朝花夕誓"/></a><div class="content"><a class="title" href="/2022/06/17/%E6%9C%9D%E8%8A%B1%E5%A4%95%E8%AA%93/" title="朝花夕誓">朝花夕誓</a><time datetime="2022-06-17T08:53:00.000Z" title="发表于 2022-06-17 16:53:00">2022-06-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/16/%E7%BD%91%E5%AE%89%E6%95%B0%E5%9F%BA%E5%A4%8D%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="网安数基复习"><img src="https://img.hawa130.com/网络空间安全数学基础.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="网安数基复习"/></a><div class="content"><a class="title" href="/2022/06/16/%E7%BD%91%E5%AE%89%E6%95%B0%E5%9F%BA%E5%A4%8D%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="网安数基复习">网安数基复习</a><time datetime="2022-06-16T15:42:00.000Z" title="发表于 2022-06-16 23:42:00">2022-06-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/08/RSA_STARTER/" title="RSA_STARTER"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RSA_STARTER"/></a><div class="content"><a class="title" href="/2022/05/08/RSA_STARTER/" title="RSA_STARTER">RSA_STARTER</a><time datetime="2022-05-08T17:42:00.000Z" title="发表于 2022-05-09 01:42:00">2022-05-09</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By smilin9</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>