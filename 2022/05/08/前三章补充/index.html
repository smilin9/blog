<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>å‰ä¸‰ç« è¡¥å…… | smilin9's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><div class="darkmode-toggle">ğŸŒ“</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 6.1.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">å‰ä¸‰ç« è¡¥å……</h1><a id="logo" href="/.">smilin9's Blog</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/about/"><i class="fa fa-user"> å…³äº</i></a><a href="/history/"><i class="fa fa-book"> å†å²</i></a><a href="/atom.xml"><i class="fa fa-rss"> è®¢é˜…</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">å‰ä¸‰ç« è¡¥å……</h1><div class="post-meta">2022-05-08<script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> é˜…è¯»</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 2.5k</span><span class="post-meta-item-text"> å­—</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 13</span><span class="post-meta-item-text"> åˆ†é’Ÿ</span></span></span></div><div class="post-content"><p>ä¹‹å‰ç«Ÿç„¶åšé”™æ¨¡å—äº†ï¼Ÿå¯„ï¼</p>
<span id="more"></span>

<p>æˆ‘çœŸçš„è°¢ã€‚</p>
<p>7 å·å‡Œæ™¨å’Œé¢è¯•å¸ˆå‚…æŠ±æ€¨ Courses ç¬¬äº”ç« çš„ ECC éš¾å­¦ï¼Œå¸ˆå‚…éœ‡æƒŠï¼šâ€œä½ æ€ä¹ˆå»å­¦ ECC äº†ï¼Ÿâ€ï¼Œç„¶åå‘ç°é¢è¯•ä»»åŠ¡ç«Ÿç„¶æ˜¯ Challenge çš„é‚£äº›ç« èŠ‚ï¼Œå½“æ—¶å°±å¿ƒæ€å¤§å´©ï¼Œæˆ‘å°±è¯´ ECC æ€ä¹ˆä¼šæ˜¯æˆ‘ç°åœ¨å¯ä»¥æŸ“æŒ‡çš„ä¸œè¥¿å•Šï¼ˆéº»ã€‚ã€‚</p>
<p>ä¸è¿‡è¿˜å¥½å¸ˆå‚…æŠŠäºŒé¢æ—¶é—´å»¶è¿Ÿåˆ° 10 å·äº†ï¼Œ7 å·è°ƒä¼‘ 9 å·æ»¡è¯¾ï¼Œç®—ä¸‹æ¥å…¶å®ä¹Ÿå°±å¤šäº† 8 å·çš„å‘¨æ—¥å¯ä»¥åšé¢˜ï¼Œæ‰€ä»¥ 8 å·æˆ‘å¿…æ—©èµ·ï¼</p>
<p>è¿™ç¯‡å…ˆè¡¥ä¸€ä¸‹ Challenge å‰ä¸‰ç« æ²¡åšçš„é¢˜ï¼Œç¬¬äº”ç« åé¢å†å•ç‹¬å†™å§ã€‚</p>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><h2 id="Network-Attacks"><a href="#Network-Attacks" class="headerlink" title="Network Attacks"></a>Network Attacks</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>Several of the challenges are dynamic and require you to talk to our challenge servers over the network. This allows you to perform man-in-the-middle attacks on people trying to communicate, or directly attack a vulnerable service. To keep things consistent, our interactive servers always send and receive JSON objects.</p>
<p>Python makes such network communication easy with the <code>telnetlib</code> module. Conveniently, itâ€™s part of Pythonâ€™s standard library, so letâ€™s use it for now.</p>
<p>For this challenge, connect to <code>socket.cryptohack.org</code> on port <code>11112</code>. Send a JSON object with the key <code>buy</code> and value <code>flag</code>.</p>
<p>The example script below contains the beginnings of a solution for you to modify, and you can reuse it for later challenges.</p>
<p>Connect at <code>nc socket.cryptohack.org 11112</code>.</p>
<h3 id="Analyze"><a href="#Analyze" class="headerlink" title="Analyze"></a>Analyze</h3><p>ä½¿ç”¨ä¸­é—´äººæ”»å‡»çš„æ–¹å¼è·å– flag ã€‚</p>
<p>ä½¿ç”¨ telnetlib åº“å¯¹ socket.cryptohack.org 11112ç«¯å£ä»¥  JSON å¯¹è±¡çš„æ–¹å¼è¿›è¡Œè¯·æ±‚ã€‚</p>
<p>é¢˜ç›®è¯´çš„å¾ˆæ˜ç¡®ï¼Œå°±æŠŠ buy çš„å€¼æ”¹æˆ flagï¼Œè¿è¡Œä»£ç å°±èƒ½å‡ºç»“æœã€‚</p>
<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># éƒ¨åˆ†ä»£ç </span></span><br><span class="line">request = &#123;</span><br><span class="line">    <span class="string">&quot;buy&quot;</span>: <span class="string">&quot;flag&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="General"><a href="#General" class="headerlink" title="General"></a>General</h1><h2 id="ENCODING-Encoding-Challenge"><a href="#ENCODING-Encoding-Challenge" class="headerlink" title="ENCODING_Encoding Challenge"></a>ENCODING_Encoding Challenge</h2><h3 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h3><p>Now youâ€™ve got the hang of the various encodings youâ€™ll be encountering, letâ€™s have a look at automating it.</p>
<p>Can you pass all 100 levels to get the flag?</p>
<p>The <em>13377.py</em> file attached below is the source code for whatâ€™s running on the server. The <em>pwntools_example.py</em> file provides the start of a solution using the incredibly convenient pwntools library. which we recommend. If youâ€™d prefer to use Pythonâ€™s in-built telnetlib, <em>telnetlib_example.py</em> is also provided.</p>
<p>For more information about connecting to interactive challenges, see the <a target="_blank" rel="noopener" href="https://cryptohack.org/faq#netcat">FAQ</a>. Feel free to skip ahead to the cryptography if you arenâ€™t in the mood for a coding challenge!</p>
<p>Connect at <code>nc socket.cryptohack.org 13377</code>.</p>
<h3 id="Analyze-1"><a href="#Analyze-1" class="headerlink" title="Analyze"></a>Analyze</h3><p>åˆšå¼€å§‹çœ‹é¢˜æ˜¯çœŸæ²¡ææ˜ç™½ä»–è¦å¹²å•¥ï¼Œç”šè‡³ä»¥ä¸ºè¿™ä¸æ˜¯å¯†ç é¢˜ã€‚ã€‚ï¼ˆå¯èƒ½æˆ‘é˜…è¯»èƒ½åŠ›æœ‰é—®é¢˜ï¼Ÿ</p>
<p>é˜…è¯»æœåŠ¡ç«¯çš„ä»£ç ï¼Œç¬¬ä¸€æ¬¡è¿æ¥æœåŠ¡å™¨ä¼šè¿”å›ç¼–ç æ–¹å¼ä»¥åŠç¼–ç åçš„å­—ç¬¦ä¸²ï¼Œè¿™æ—¶å€™éœ€è¦æäº¤è§£ç åçš„å­—ç¬¦ä¸²ï¼Œæ­£ç¡®è§£ç åæœåŠ¡å™¨ä¼šå‘æ¥ä¸‹ä¸€ä¸ªã€‚100 æ¬¡ä¹‹åæœåŠ¡å™¨ä¸»åŠ¨ç»ˆæ­¢è¿æ¥ï¼Œè§£ç ä¹‹åå¾—åˆ°çš„å°±æ˜¯ flagã€‚</p>
<p>è§£ç å‡½æ•°çœ‹ç€ä»–çš„åŠ å¯†ä»£ç å€’æ˜¯è›®å®¹æ˜“å†™çš„ï¼Œä½†æ˜¯ç¡®å®ä¸å–œæ¬¢åšè¿™ç±»é¢˜ã€‚</p>
<h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;socket.cryptohack.org&#x27;</span>, <span class="number">13377</span>, level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">json_recv</span>() -&gt; <span class="built_in">dict</span>:</span><br><span class="line">    line = r.recvline()</span><br><span class="line">    <span class="keyword">return</span> json.loads(line.decode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">json_send</span>(<span class="params">hsh: <span class="built_in">dict</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    request = json.dumps(hsh).encode()</span><br><span class="line">    r.sendline(request)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">encoded: <span class="built_in">str</span>, <span class="built_in">type</span>: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span> == <span class="string">&quot;base64&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> base64.b64decode(encoded).decode()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&quot;hex&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> codecs.decode(encoded, <span class="string">&#x27;hex&#x27;</span>).decode()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&quot;rot13&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> codecs.decode(encoded, <span class="string">&#x27;rot_13&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&quot;bigint&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> long_to_bytes(<span class="built_in">int</span>(encoded, <span class="number">16</span>)).decode()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&quot;utf-8&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> encoded)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Unknown encoding&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬ä¸€æ¬¡æ¥æ”¶</span></span><br><span class="line">received = json_recv()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    plain_text = decode(received[<span class="string">&quot;encoded&quot;</span>], received[<span class="string">&quot;type&quot;</span>])</span><br><span class="line">    to_send = &#123;</span><br><span class="line">        <span class="string">&quot;decoded&quot;</span>: plain_text</span><br><span class="line">    &#125;</span><br><span class="line">    json_send(to_send)</span><br><span class="line">    received = json_recv()</span><br></pre></td></tr></table></figure>

<h2 id="XOR-Lemur-XOR"><a href="#XOR-Lemur-XOR" class="headerlink" title="XOR_Lemur XOR"></a>XOR_Lemur XOR</h2><h3 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h3><p>Iâ€™ve hidden two cool images by XOR with the same secret key so you canâ€™t see them!</p>
<h3 id="Analyze-2"><a href="#Analyze-2" class="headerlink" title="Analyze"></a>Analyze</h3><p>é¢˜ç›®æè¿°å€’æ˜¯æŒºçŸ­ã€‚</p>
<p>ç›´æ¥äºŒè¿›åˆ¶å¼‚æˆ–ä¸è¡Œï¼Œç„¶åè¯•è¯•åƒç´ ç‚¹å¼‚æˆ–ã€‚</p>
<p>å¯¹å›¾ç‰‡æ“ä½œå¾ˆé™Œç”Ÿè¯¶ã€‚è¿˜æ˜¯èœã€‚</p>
<h3 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">flagImg = Image.<span class="built_in">open</span>(<span class="string">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/è¡¥å……/flag.png&#x27;</span>)</span><br><span class="line">flag = flagImg.load()</span><br><span class="line"></span><br><span class="line">lemurImg = Image.<span class="built_in">open</span>(<span class="string">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/è¡¥å……/lemur.png&#x27;</span>)</span><br><span class="line">lemur = lemurImg.load()</span><br><span class="line">width, height = flagImg.size</span><br><span class="line"></span><br><span class="line">newImg = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class="line">new = newImg.load()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        r1, g1, b1 = flag[i, j]</span><br><span class="line">        r2, g2, b2 = lemur[i, j]</span><br><span class="line">        new[i, j] = (r1 ^ r2, g1 ^ g2, b1 ^ b2)</span><br><span class="line"></span><br><span class="line">newImg.save(<span class="string">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/è¡¥å……/xorimage.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="DATA-FORMATS-Privacy-Enhanced-Mail"><a href="#DATA-FORMATS-Privacy-Enhanced-Mail" class="headerlink" title="DATA FORMATS_Privacy-Enhanced Mail?"></a>DATA FORMATS_Privacy-Enhanced Mail?</h2><h3 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h3><p>As weâ€™ve seen in the encoding section, cryptography involves dealing with data in a wide variety of formats: big integers, raw bytes, hex strings and more. A few structured formats have been standardised to help send and receive cryptographic data. It helps to be able to recognise and manipulate these common data formats.</p>
<p>PEM is a popular format for sending keys, certificates, and other cryptographic material. It looks like:</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">-----BEGIN</span> RSA PUBLIC KEY<span class="params">-----</span></span><br><span class="line">MIIBCgKC.<span class="string">..</span> *<span class="params">(a whole bunch of base64)</span>*</span><br><span class="line"><span class="params">-----END</span> RSA PUBLIC KEY<span class="params">-----</span></span><br></pre></td></tr></table></figure>

<p>It wraps base64-encoded data by a one-line header and footer to indicate how to parse the data within. Perhaps unexpectedly, itâ€™s important for there to be the correct number of hyphens in the header and footer, otherwise cryptographic tools wonâ€™t be able to recognise the file.</p>
<p>The data that gets base64-encoded is DER-encoded ASN.1 values. Confused? <a target="_blank" rel="noopener" href="https://www.cryptologie.net/article/260/asn1-vs-der-vs-pem-vs-x509-vs-pkcs7-vs/">Here</a> is more information about what these acronyms mean but the complexity is there for historical reasons and going too deep into the details may drive you insane.</p>
<p>Extract the private key <em>d</em> as a decimal integer from this PEM-formatted RSA key.</p>
<blockquote>
<p>There are two main approaches for solving this challenge. The data in the certificate can be read with the openssl command line tool, or in Python using PyCryptodome. We recommend using PyCryptodome: first import the RSA module with <code>from Crypto.PublicKey import RSA</code> and you can read the key data using <code>RSA.importKey()</code>.</p>
</blockquote>
<h3 id="Analyze-3"><a href="#Analyze-3" class="headerlink" title="Analyze"></a>Analyze</h3><p>.pem æ–‡ä»¶è¯¶ï¼Œçœ‹èµ·æ¥å¥½é…·çš„æ ·å­ã€‚</p>
<p>ç”¨ç»™å‡ºçš„åº“å’Œå‡½æ•°è½¬æ¢ä¸€ä¸‹ç›´æ¥å‡ºã€‚</p>
<h3 id="Code-3"><a href="#Code-3" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">open</span>(<span class="string">r&quot;./privacy_enhanced_mail.pem&quot;</span>).read()</span><br><span class="line">p = RSA.import_key(c)</span><br><span class="line"><span class="built_in">print</span>(p.d)</span><br></pre></td></tr></table></figure>

<h2 id="DATA-FORMATS-CERTainly-not"><a href="#DATA-FORMATS-CERTainly-not" class="headerlink" title="DATA FORMATS_CERTainly not"></a>DATA FORMATS_CERTainly not</h2><h3 id="Description-4"><a href="#Description-4" class="headerlink" title="Description"></a>Description</h3><p>As mentioned in the previous challenge, PEM is just a nice wrapper above DER encoded ASN.1. In some cases you may come across DER files directly; for instance many Windows utilities prefer to work with DER files by default. However, other tools expect PEM format and have difficulty importing a DER file, so itâ€™s good to know how to convert one format to another.</p>
<p>An SSL certificate is a crucial part of the modern web, binding a cryptographic key to details about an organisation. Weâ€™ll cover more about these and PKI in the TLS category. Presented here is a DER-encoded x509 RSA certificate. Find the modulus of the certificate, giving your answer as a decimal.</p>
<h3 id="Analyze-4"><a href="#Analyze-4" class="headerlink" title="Analyze"></a>Analyze</h3><p>.der æ–‡ä»¶ï¼Œçœ‹èµ·æ¥ä¾ç„¶å¾ˆç‰›ã€‚</p>
<p>å’Œä¸Šä¸€é¢˜åŸºæœ¬å°±æ”¹äº†ä¸ªæ–‡ä»¶åã€‚</p>
<h3 id="Code-4"><a href="#Code-4" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">open</span>(<span class="string">r&quot;./CERTainly not_2048b-rsa-example-cert.der&quot;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">p = RSA.import_key(c)</span><br><span class="line"><span class="built_in">print</span>(p.n)</span><br></pre></td></tr></table></figure>

<h2 id="DATA-FORMATS-SSH-Keys"><a href="#DATA-FORMATS-SSH-Keys" class="headerlink" title="DATA FORMATS_SSH Keys"></a>DATA FORMATS_SSH Keys</h2><h3 id="Description-5"><a href="#Description-5" class="headerlink" title="Description"></a>Description</h3><p>Secure Shell Protocol (SSH) is a network protocol that uses cryptography to establish a secure channel over an insecure network (i.e. the internet). SSH enables developers and system administrators to run commands on servers from the other side of the world, without their password being sniffed or data being stolen. It is therefore critical to the security of the web.</p>
<p>In the old days, system administrators used to logon to their servers using telnet. This works similarly to our interactive challenges that involve connecting to <code>socket.cryptohack.org</code> - data is sent to a remote server, which performs actions based on what is sent. There is no transport encryption, so anyone listening in on the network (such as the WiFi access point owner, your ISP, or the NSA) can see all the telnet traffic.</p>
<p>As the internet became increasingly hostile, people realised the need for both authentication and encryption for administrative network traffic. SSH, first released in 1995, achieves these goals and much more, with advanced functionality built into the software like port forwarding, X11 forwarding, and SFTP (Secure File Transfer Protocol). SSH uses a client-server architecture, meaning the server runs SSH as a service daemon which is always online and waiting to receive connections, and the user runs an SSH client to make a connection to it.</p>
<p>Most commonly, SSH is configured to use public-private key pairs for authentication. On the server, a copy of the userâ€™s public key is stored. The userâ€™s private key is stored locally on their laptop.</p>
<p>Now letâ€™s say Bruce wants to connect as his user account <code>bschneier</code> to his server <code>bruces-server</code>. From his laptop he runs <code>ssh bschneier@bruces-server</code>. His SSH client opens a connection to the server on port 22 where the SSH daemon listens. First, the ciphers that will be used are agreed upon, then a session key to encrypt the connection is established using Diffie-Hellman Key exchange, but we wonâ€™t go into the details on that here. Then, the server sends a random challenge message encrypted with Bruceâ€™s public key. Bruce uses his private key to decrypt the challenge and send a hash of the random challenge message back, proving that he owns the correct private key and he therefore authenticates himself to the server as <code>bschneier</code>. Now, the server gives Bruce a shell to run commands. If public-private key cryptography doesnâ€™t make sense to you yet, donâ€™t worry - weâ€™ll cover it extensively in the RSA category.</p>
<p>An SSH private key is stored in the PEM format, which we discussed in the â€œPrivacy-Enhanced Mailâ€ challenge. So it looks like this and is stored on Bruceâ€™s laptop at <code>/home/bschneier/.ssh/id_rsa</code>:</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">-----BEGIN</span> RSA PRIVATE KEY<span class="params">-----</span></span><br><span class="line">MIIBCgKC.<span class="string">..</span> *<span class="params">(a whole bunch of base64)</span>*</span><br><span class="line"><span class="params">-----END</span> RSA PRIVATE KEY<span class="params">-----</span></span><br></pre></td></tr></table></figure>

<p>SSH public keys, however, use a different format:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCtPLqba+GFvDHdFVs1Vvdk56cKqqw5cdomlu034666UsoFIqkig8H5kNsNefSpaR<span class="regexp">/iU7G0ZKCiWRRuAbTsuHN+Cz526XhQvzgKTBkTGYXdF/</span>WdG<span class="regexp">/6/um</span>ou3Z0+wJvTZgvEmeEclvitBrPZkzhAK1M5ypgNR4p8scJplTgSSb84Ckqul<span class="regexp">/Dj/</span>Sh+fwo6sU3S3j92qc27BVGChpQiGwjjut4CkHauzQA<span class="regexp">/gKCBIiLyzoFcLEHhjOBOEErnvrRPWCIAJhALkwV2rUbD4g1IWa7QI2q3nB0nlnjPnjjwaR7TpH4gy2NSIYNDdC1PZ8reBaFnGTXgzhQ2t0ROBNb+ZDgH8Fy+KTG+gEakpu20bRqB86NN6frDLOkZ9x3w32tJtqqrJTALy4Oi3MW0XPO61UBT133VNqAbNYGE2gx+mXBVOezbsY46C/</span>V2fmxBJJKY<span class="regexp">/SFNs8wOVOHKwqRH0GI5VsG1YZClX3fqk8GDJYREaoyoL3HKQt1Ue/</span>ZW7TlPRYzAoIB62C0= bschneier@facts</span><br></pre></td></tr></table></figure>

<p>This format makes it easier for these public keys to be added as lines to the file <code>/home/bschneier/.ssh/authorized_keys</code> on the server. Adding the public key to this file allows the corresponding private key to be used to authenticate on the server.</p>
<p>The <code>ssh-keygen</code> command is used to produce these public-private keypairs.</p>
<p>Extract the modulus <em>n</em> as a decimal integer from Bruceâ€™s SSH public key.</p>
<h3 id="Analyze-5"><a href="#Analyze-5" class="headerlink" title="Analyze"></a>Analyze</h3><p>.pub åç¼€æ›´é…·äº†ã€‚</p>
<p>ä¸è¿‡å’Œç¬¬ä¸€é¢˜è§£æ³•æ²¡åŒºåˆ«ï¼Œåªèƒ½è¯´å‡½æ•°çœŸçš„å¼ºå¤§ã€‚</p>
<h3 id="Code-5"><a href="#Code-5" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">open</span>(<span class="string">r&quot;./SSH Keys_bruce_rsa.pub&quot;</span>).read()</span><br><span class="line">p = RSA.import_key(c)</span><br><span class="line"><span class="built_in">print</span>(p.n)</span><br></pre></td></tr></table></figure>

<h2 id="DATA-FORMATS-Transparency"><a href="#DATA-FORMATS-Transparency" class="headerlink" title="DATA FORMATS_Transparency"></a>DATA FORMATS_Transparency</h2><h3 id="Description-6"><a href="#Description-6" class="headerlink" title="Description"></a>Description</h3><p>When you connect to a website over HTTPS, the first TLS message sent by the server is the ServerHello containing the server TLS certificate. Your browser verifies that the TLS certificate is valid, and if not, will terminate the TLS handshake. Verification includes ensuring that:</p>
<p>- the name on the certificate matches the domain</p>
<p>- the certificate has not expired</p>
<p>- the certificate is ultimately signed (via a â€œchain of trustâ€) by a root key of a Certificate Authority (CA) thatâ€™s trusted by your browser or operating system</p>
<p>Since CAs have the power to sign any certificate, the security of the internet depends upon these organisations to issue TLS certificates to the correct people: they must only issue certificates to the real domain owners. However with Windows trusting root certificates from over 100 organisations by default, thereâ€™s a number of opportunities for hackers, politics, or incompetence to break the whole model. If you could trick just a single CA to issue you a certificate for microsoft.com, you could use the corresponding private key to sign malware and bypass trust controls on Windows. CAs are strongly incentivised to be careful since their business depends upon people trusting them, however in practice they have failed several times.</p>
<p>In 2011 <a target="_blank" rel="noopener" href="https://arstechnica.com/information-technology/2011/03/independent-iranian-hacker-claims-responsibility-for-comodo-hack/">Comodo CA was compromised</a> and the hacker was able to issue certificates for Gmail and other services. In 2016, <a target="_blank" rel="noopener" href="https://security.googleblog.com/2015/10/sustaining-digital-certificate-security.html">Symantec was found</a> to have issued over 150 certificates without the domain ownerâ€™s knowledge, as well as 2400 certificates for domains that were never registered.</p>
<p>Due to such events, together with the fact that fraudulent certificates can take a long time to be discovered, since 2018 Certificate Transparency has been enforced by Google Chrome. Every CA must publish all certificates that they issue to a log, which anyone can search.</p>
<p>Attached is an RSA public key in PEM format. Find the subdomain of cryptohack.org which uses these parameters in its TLS certificate, and visit that subdomain to obtain the flag.</p>
<h3 id="Analyze-6"><a href="#Analyze-6" class="headerlink" title="Analyze"></a>Analyze</h3><p>è¿™é¢˜æ€ä¹ˆè¯´å‘¢ï¼Œä¸€è¨€éš¾å°½ã€‚</p>
<p>å€’æ˜¯èƒ½è§£å‡ºæ¥ nï¼Œä½†æ˜¯æ€ä¹ˆæ‰¾åˆ°åŒ…å« n çš„è¯ä¹¦å¯¹åº”çš„åŸŸåå‘¢ï¼Œæœäº†å¾ˆä¹…ä¹Ÿæ²¡æ‰¾åˆ°ã€‚</p>
<p>æœ€åæ˜¯ç›´æ¥å»çˆ†ç ´ï¼Œæ‰¾åˆ° url é‡ŒåŒ…å« flag çš„å­åŸŸåï¼Œè®¿é—®å¾—åˆ° flagã€‚</p>
<p>ä¹Ÿå¯ä»¥ç”¨ <a target="_blank" rel="noopener" href="https://crt.sh/">crt.sh</a> æœæŒ‡çº¹ï¼ŒæŸ¥æ—¥å¿—è®°å½•ï¼Œä¸è¿‡ä¹Ÿæ²¡ç”¨åˆ°å…¬é’¥ã€‚</p>
<p>æœ€åè¿˜æ˜¯ä¸çŸ¥é“æ€ä¹ˆç”¨å…¬é’¥æ¨åŸŸåï¼Œæ€ªæã€‚</p>
<h1 id="Mathematics"><a href="#Mathematics" class="headerlink" title="Mathematics"></a>Mathematics</h1><p>è™½ç„¶ä¹‹å‰åšæ•°å­¦åšäº†å¾ˆä¹…ï¼Œä¸è¿‡å€¼å¾—æ¬£æ…°çš„æ˜¯ Challenge ç¬¬ä¸‰ç« ç¬¬ä¸€éƒ¨åˆ†å…¨éƒ½åšå®Œäº†ã€‚å…·ä½“<a href="http://smilin9.com/2022/05/03/Modular%20Arithmetic/">ç‚¹è¿™é‡Œ</a> ã€‚</p>
</div><div class="post-copyright"><script type="text/javascript" src="/js/copyright.js?v=1.0.0" successtext="å¤åˆ¶æˆåŠŸ!"></script><link rel="stylesheet" type="text/css" href="/css/copyright.css?v=1.0.0"><p><span>æœ¬æ–‡æ ‡é¢˜ï¼š</span>å‰ä¸‰ç« è¡¥å……</p><p><span>æ–‡ç« ä½œè€…ï¼š</span>smilin9</p><p><span>å‘å¸ƒæ—¶é—´ï¼š</span>2022-05-08</p><p><span>æœ€åæ›´æ–°ï¼š</span>2022-05-12</p><p><span>åŸå§‹é“¾æ¥ï¼š</span><a href="/2022/05/08/å‰ä¸‰ç« è¡¥å……/">http://smilin9.com/2022/05/08/%E5%89%8D%E4%B8%89%E7%AB%A0%E8%A1%A5%E5%85%85/</a><span class="copy-path"><i class="fa fa-clipboard" data-clipboard-text="http://smilin9.com/2022/05/08/%E5%89%8D%E4%B8%89%E7%AB%A0%E8%A1%A5%E5%85%85/"></i></span></p><p><span>ç‰ˆæƒå£°æ˜ï¼š</span>ä½œè€…æ‹¥æœ‰ç‰ˆæƒï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></div><br><div class="tags"><a href="/tags/cryptohack"><i class="fa fa-tag">cryptohack</i></a></div><div class="post-nav"><a class="pre" href="/2022/05/08/RSA_STARTER/">RSA_STARTER</a><a class="next" href="/2022/05/05/Symmetric%20Cryptography_How%20AES%20Works/">Symmetric Cryptography_How AES Works</a></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://smilin9.com"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> åˆ†ç±»</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/tags/cryptohack/" style="font-size: 15px;">cryptohack</a> <a href="/tags/%E5%BA%9F%E8%AF%9D/" style="font-size: 15px;">åºŸè¯</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> æœ€è¿‘æ–‡ç« </i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2022/05/08/RSA_STARTER/">RSA_STARTER</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/05/08/%E5%89%8D%E4%B8%89%E7%AB%A0%E8%A1%A5%E5%85%85/">å‰ä¸‰ç« è¡¥å……</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/05/05/Symmetric%20Cryptography_How%20AES%20Works/">Symmetric Cryptography_How AES Works</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/05/03/Modular%20Arithmetic/">Modular Arithmetic</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/05/01/Introduction%20To%20Cryptohack/">Introduction To Cryptohack</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/30/%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E8%AF%9D/">å†™åœ¨å‰é¢çš„ä¸€äº›è¯</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/30/hello-world/">Hello Worldï¼</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> å‹é“¾</i></div><ul></ul><a href="http://www.hawa130.com/" title="hawa130" target="_blank">hawa130</a><ul></ul><a href="https://blog.ksfu.top/" title="åº·å¸ˆå‚…" target="_blank">åº·å¸ˆå‚…</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2022 <a href="/." rel="nofollow">smilin9's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><script type="text/javascript" src="/js/love.js?v=1.0.0"></script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="å¤åˆ¶æˆåŠŸ!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="/css/external.css?v=1.0.0"><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>