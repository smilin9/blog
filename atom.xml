<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>smilin9&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://smilin9.com/"/>
  <updated>2022-06-17T01:14:47.772Z</updated>
  <id>http://smilin9.com/</id>
  
  <author>
    <name>smilin9</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>é±¼é±¼æ—¥è®°</title>
    <link href="http://smilin9.com/2022/06/13/%E9%B1%BC%E9%B1%BC%E6%97%A5%E8%AE%B0/"/>
    <id>http://smilin9.com/2022/06/13/é±¼é±¼æ—¥è®°/</id>
    <published>2022-06-13T20:23:32.000Z</published>
    <updated>2022-06-17T01:14:47.772Z</updated>
    
    <content type="html"><![CDATA[<h2 id="6-17"><a href="#6-17" class="headerlink" title="6.17"></a>6.17</h2><p>åªæœ‰è€ƒè¯•å‘¨æ‰ä¼šåœ¨å…«ç‚¹åŠèµ·åºŠçš„æ—¶å€™è§‰å¾—è‡ªå·±èµ·å¾—å¥½è¿Ÿç„¶åå¿ƒé‡Œå¥½å¤§çš„ç½ªæ¶æ„ŸğŸ˜¢ã€‚</p><h2 id="6-15"><a href="#6-15" class="headerlink" title="6.15"></a>6.15</h2><h3 id="01-58"><a href="#01-58" class="headerlink" title="01 : 58"></a>01 : 58</h3><p>ä»Šå¤©è¦æ—©ç¡ï¼Œæ˜¨å¤©ä¸‹åˆå¥½å¥½çš„ğŸŸå›°æˆğŸ¶ğŸŸã€‚ã€‚</p><p>äº”ç‚¹å¤šå›å»çœ‹å¤–é¢å¤§å¤ªé˜³ä¸æƒ³å‡ºé—¨ï¼Œç»“æœå›°äº†å°±å¼€å§‹ç¡ï¼Œä¸€ç›´ç¡åˆ°ä¸ƒç‚¹å¤šï¼Œï¼ˆä¸­é—´ç«Ÿç„¶è¿˜é†’æ¥æ¥äº†ä¸ªå¤–å–ç”µè¯ï¼Œï¼‰æœç„¶è¿˜æ˜¯ä¸èƒ½é€šå®µã€‚</p><h3 id="23ï¼š19"><a href="#23ï¼š19" class="headerlink" title="23ï¼š19"></a>23ï¼š19</h3><p>ä»Šå¤©å‡ºå»å­¦ä¹ äº†æï¼Œè™½ç„¶æ˜¯ä¸¤ç‚¹å¤šæ‰å»ï¼Œä¸ƒç‚¹å°±èµ°äº†ï¼Œä½†æ˜¯ä¸­é—´ä¸€ç›´åœ¨å­¦ä¹ æ²¡æ€ä¹ˆç©ï¼Œå¤¸å¤¸è‡ªå·±ï¼<del>åˆšå¥½618å¥–åŠ±è‡ªå·±ä¸€ä¸ªè€³æœº</del></p><p>æ˜å¤©å°±è€ƒä¿¡å·äº†ï¼Œå¥½æ…Œå¥½æ…Œï¼Œè™½ç„¶æœ‰å¤ä¹ ä½†æ˜¯è¿˜æ˜¯è§‰å¾—ä»€ä¹ˆéƒ½ä¸ä¼šï¼Œdbt ä¹Ÿè¿™æ ·ï¼Œå¯èƒ½æ˜¯å¤§å­¦ç”Ÿçš„è€ƒè¯•å‘¨é€šç—…å§ã€‚</p><p>ç‰™åˆå¼€å§‹ç–¼äº†ï¼Œæ‰“ç®—ç­‰è€ƒå®Œè¯•å»æ‹”å’¯ï¼Œåº”è¯¥è¿˜è¦è¡¥ä¸¤é¢—ï¼Œä¸çŸ¥é“ä¼šä¸ä¼šç–¼ã€‚æ°´æ°´è¯´æ ¡åŒ»é™¢æ‹”ç‰™å’Œå¤–é¢åŒ»é™¢ä½“éªŒå·®ä¸å¤šï¼Œæ„Ÿè§‰æ ¡åŒ»é™¢æ–¹ä¾¿ä¸€ç‚¹ï¼Œè¿˜èƒ½ç›´æ¥èµ°åŒ»ä¿ã€‚æ¯æ¬¡æŠ¥é”€åŒ»ä¿çš„æ—¶å€™çœ‹æ”¶ä¸Šæ¥çš„ææ–™éƒ½è§‰å¾—å¥½éº»çƒ¦ï¼Œå»å¤–é¢çš„åŒ»é™¢ä¸‡ä¸€æŠ¥ä¸äº†å°±å¾ˆçƒ¦ã€‚</p><p>ä»Šå¤©æŠŠ zn è€å¸ˆå‘çš„é¢˜å†åšä¸€åšå°±ç¡è§‰ï¼Œæ˜å¤©åšæ ¸é…¸å°±å¯ä»¥ï¼ˆç‰©ç†ï¼‰æ—©èµ·ï¼Œè¿˜èƒ½çœ‹ä¸€ä¼šï¼ˆæˆ–è®¸ã€‚</p><h2 id="6-14"><a href="#6-14" class="headerlink" title="6.14"></a>6.14</h2><h3 id="04-23"><a href="#04-23" class="headerlink" title="04 : 23"></a>04 : 23</h3><p>å¾ˆå¥‡æ€ªä»Šå¤©ä¸€ç‚¹ä¹Ÿä¸å›°å•Šå•Šå•Šå•Šï¼Œä¹Ÿè®¸æ˜¯å› ä¸ºæ˜¨å¤©ä¸‹åˆå››ç‚¹å¤šæ‰èµ·åºŠå§ã€‚è™½ç„¶æ¯æ¬¡æ™šèµ·ç¬¬ä¸€æ—¶é—´éƒ½ä¼šè§‰å¾—å¾ˆæ‡Šæ¼ï¼Œè‡ªå·±æ€ä¹ˆåˆç¡è¿™ä¹ˆä¹…ï¼Œåˆæµªè´¹äº†å¤§åŠå¤©çš„æ—¶é—´ï¼Œå‰©ä¸‹çš„åŠå¤©åˆåšä¸äº†ä»€ä¹ˆï¼Œä¸€å¤©åˆè¦è¿™æ ·è‰ç‡çš„è¿‡å»äº†ã€‚ä½†æ˜¯æœ‰æ—¶å€™ä¹Ÿä¼šæ„Ÿè§‰ï¼Œç¡ç€å¤šå¥½å•Šï¼Œä»€ä¹ˆä¹Ÿä¸çŸ¥é“ï¼ŒçœŸä¹ˆä¹Ÿä¸ç”¨æƒ³ï¼Œä¸ç”¨è€ƒè™‘ï¼Œæ²¡æœ‰çƒ¦å¿ƒäº‹ï¼Œæ²¡æœ‰ ddlï¼Œæ²¡æœ‰ä¸çŸ¥é“æ€ä¹ˆå¤„ç†çš„äººé™…å…³ç³»ï¼Œç¡ç€æœ€å¥½äº†ã€‚</p><p>16 å·å°±è¦å¼€å§‹è€ƒè¯•äº†ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œè¶Šæ˜¯æœŸæœ«è€ƒè¯•å‘¨ä¹‹ç±»åº”è¯¥æœ‰å‹åŠ›æœ‰ç´§è¿«æ„Ÿçš„æ—¶å€™ï¼Œè¶Šæ˜¯é™ä¸ä¸‹å¿ƒæ¥å¥½å¥½å¤ä¹ ã€‚å¹³æ—¶æ²¡ä»€ä¹ˆäº‹çš„æ—¶å€™å´èƒ½å› ä¸ºå­¦ç‚¹ä»€ä¹ˆä¸œè¥¿ä¸€åå°±æ˜¯ä¸€æ•´å¤©ã€‚æ„Ÿè§‰è¿™æ¬¡è€ƒè¯•å¤šåŠåˆæ˜¯è¦å¯„ï¼Œæ¯å¤©çš„æœ‰æ•ˆå¤ä¹ æ—¶é—´æ²¡å‡ ä¸ªå°æ—¶ï¼Œå¾ˆå®¹æ˜“è¢«åˆ«äººå¸å¼•æ³¨æ„åŠ›ã€‚</p><p>ç°åœ¨ååœ¨ 423ï¼Œæˆ´ç€ä¸¤åªè€³æœºï¼Œå¾…åœ¨è‡ªå·±çš„ä¸–ç•Œé‡Œï¼Œåªèƒ½å¬åˆ°è‡ªå·±çš„æ‰“å­—å£°ã€‚ä¸æƒ³å¤ä¹ ï¼Œä¸æƒ³å›å»ç¡è§‰ï¼Œåªæƒ³æ”¾ç©ºè‡ªå·±ï¼Œå®‰å®‰é™é™å¬ä¼šæ­Œï¼Œå¹²ç‚¹è‡ªå·±çš„äº‹æƒ…ï¼Œæˆ–è€…æä¸€æåšå®¢çš„ä¸»é¢˜é…ç½®ï¼Œç„¶åå¾…ä¼šå»åƒæ—©é¥­ã€‚æ„Ÿè§‰è‡ªå·±å…¶å®æ˜¯ä¸€ä¸ªå–œæ¬¢åŠ¨æ‰‹çš„äººï¼Œå­¦ä¼šä¸€äº›æ–°ä¸œè¥¿çš„æ—¶å€™ï¼Œæ€»æ˜¯ä¼šæ€¥äºå°è¯•åŠ¨æ‰‹æ“ä½œæˆ–è€…å¤ç°å®ƒï¼Œè¿™åº”è¯¥ç®—æ˜¯è‡ªå·±æ¯”è¾ƒå¥½çš„ä¸€ç‚¹å§ã€‚ä½†æ˜¯å³ä½¿æ˜¯ä¸€äº›æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰çš„æœºæ¢°æ€§å®æ“ï¼Œå¯¹æˆ‘çš„å¸å¼•åŠ›ä¹Ÿæ¯”ä¸€äº›å¾ˆéœ€è¦åŠ¨è„‘çš„äº‹æƒ…å¤§å¾—å¤šã€‚<del>åæ­£å°±æ˜¯ä¸æ€ä¹ˆçˆ±åŠ¨è„‘å­ï¼ˆä¹</del></p><p>ä¹‹å‰çš„æ—¥è®°ä¸¢å•¦ï¼Œè¿˜æ˜¯å¾ˆé—æ†¾çš„ï¼Œä¸è¿‡æ€ä¹ˆè¯´å‘¢ï¼Œæ„Ÿè§‰å¥½åƒçªç„¶æ”¾ä¸‹äº†ä¸€äº›äº‹æƒ…ã€‚é‡Œé¢è®°å½•äº†å¾ˆå¤šå¤§å¤§å°å°çš„äº‹æƒ…ï¼Œå…¶å®é‡Œé¢æœ‰ä¸€äº›ä¸œè¥¿æˆ‘å·²ç»å¿˜è®°äº†ã€‚ä¹‹å‰å®ƒè¿˜åœ¨çš„æ—¶å€™æˆ‘çŸ¥é“æˆ‘ä¸ç”¨åˆ»æ„è®°å¿†ä¸€äº›äº‹æƒ…ï¼Œä¸ç”¨åå¤æé†’è‡ªå·±ï¼Œç°åœ¨å®ƒæ²¡äº†ï¼Œå‘ç°è®°å¿†æ·±åˆ»çš„äº‹å…¶å®æ²¡å¤šå°‘ï¼Œè™½ç„¶ä¸¢æ‰äº†å¾ˆå¤šä¸œè¥¿ï¼Œä½†æ˜¯æ„Ÿè§‰å¥½åƒä¹Ÿä¸ç®—åäº‹ï¼Œå¥½åƒçªç„¶å°±æ”¾ä¸‹è¿‡å»äº†ï¼Œå¾ˆè½»æ¾çš„æ„Ÿè§‰ï¼Œå¥½åƒåœ¨å¼€å¯ä¸€æ®µæ–°çš„ç”Ÿæ´»ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;6-17&quot;&gt;&lt;a href=&quot;#6-17&quot; class=&quot;headerlink&quot; title=&quot;6.17&quot;&gt;&lt;/a&gt;6.17&lt;/h2&gt;&lt;p&gt;åªæœ‰è€ƒè¯•å‘¨æ‰ä¼šåœ¨å…«ç‚¹åŠèµ·åºŠçš„æ—¶å€™è§‰å¾—è‡ªå·±èµ·å¾—å¥½è¿Ÿç„¶åå¿ƒé‡Œå¥½å¤§çš„ç½ªæ¶æ„ŸğŸ˜¢ã€‚&lt;/p&gt;
&lt;h2 id=&quot;6-15&quot;&gt;&lt;a hre
      
    
    </summary>
    
      <category term="ç”Ÿæ´»" scheme="http://smilin9.com/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
      <category term="åƒåœ¾æ¡¶" scheme="http://smilin9.com/tags/%E5%9E%83%E5%9C%BE%E6%A1%B6/"/>
    
  </entry>
  
  <entry>
    <title>RSA_STARTER</title>
    <link href="http://smilin9.com/2022/05/08/RSA_STARTER/"/>
    <id>http://smilin9.com/2022/05/08/RSA_STARTER/</id>
    <published>2022-05-08T17:42:00.000Z</published>
    <updated>2022-06-17T01:14:47.772Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ä¸ªè¶…å¿«ï¼</p><p>æˆ‘çœ‹è°ä¸æ˜¯é€Ÿé€šï¼ˆbushi</p><span id="more"></span><p>æœ€åä¸€å—å†…å®¹ï¼Œæ²¡æƒ³åˆ°æ„å¤–åœ°é¡ºåˆ©ï¼Œèˆ’æœæã€‚</p><h1 id="RSA-STARTER"><a href="#RSA-STARTER" class="headerlink" title="RSA_STARTER"></a>RSA_STARTER</h1><h2 id="RSA-Starter-1"><a href="#RSA-Starter-1" class="headerlink" title="RSA Starter 1"></a>RSA Starter 1</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>All operations in RSA involve <a href="https://en.wikipedia.org/wiki/Modular_exponentiation">modular exponentiation</a>.</p><p>Modular exponentiation is an operation that is used extensively in cryptography and is normally written like: <code>2Â¹â° mod 17</code></p><p>You can think of this as raising some number to a certain power (<code>2Â¹â° = 1024</code>), and then taking the remainder of the division by some other number (<code>1024 mod 17 = 4</code>). In Python thereâ€™s a built-in operator for performing this operation: <code>pow(base, exponent, modulus)</code></p><p>In RSA, modular exponentiation, together with the problem of prime factorisation, helps us to build a â€œ<a href="https://en.wikipedia.org/wiki/Trapdoor_function">trapdoor function</a>â€œ. This is a function that is easy to compute in one direction, but hard to do in reverse unless you have the right information. It allows us to encrypt a message, and only the person with the key can perform the inverse operation to decrypt it.</p><p>Find the solution to <code>101Â¹â· mod 22663</code></p><h3 id="Analyze"><a href="#Analyze" class="headerlink" title="Analyze"></a>Analyze</h3><p>æ¨¡å¹‚è¿ç®—ï¼Ÿæœ‰ç§å›åˆ°åšæ•°è®ºé¢˜çš„é”™è§‰ï¼ˆå‡ºæˆã€‚</p><p>ä¸è¿‡ pow() æ˜¯ä¹‹å‰å°±ç”¨è¿‡çš„ä¸œè¥¿è¯¶ï¼Œçªç„¶äº²åˆ‡ã€‚</p><p>æ— è„‘å¡«æ•°å°±è¡Œã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(<span class="number">101</span>, <span class="number">17</span>, <span class="number">22663</span>))</span><br></pre></td></tr></table></figure><h2 id="RSA-Starter-2"><a href="#RSA-Starter-2" class="headerlink" title="RSA Starter 2"></a>RSA Starter 2</h2><h3 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h3><p>RSA encryption is modular exponentiation of a message with an exponent <code>e</code> and a modulus <code>N</code> which is normally a product of two primes: <code>N = p * q</code>.</p><p>Together the exponent and modulus form an RSA â€œpublic keyâ€ <code>(N, e)</code>. The most common value for <code>e</code> is <code>0x10001</code> or <code>65537</code>.</p><p>â€œEncryptâ€ the number <code>12</code> using the exponent <code>e = 65537</code> and the primes <code>p = 17</code> and <code>q = 23</code>. What number do you get as the ciphertext?</p><h3 id="Analyze-1"><a href="#Analyze-1" class="headerlink" title="Analyze"></a>Analyze</h3><p>ä¸¤ä¸ªç´ æ•°çš„ä¹˜ç§¯ä¸ºæ¨¡æ•°ã€‚è¿˜æ˜¯æ— è„‘å¡«æ•°ã€‚</p><h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">b = <span class="number">12</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p, q = <span class="number">17</span>, <span class="number">23</span></span><br><span class="line">N = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(b, e, N))</span><br></pre></td></tr></table></figure><h2 id="RSA-Starter-3"><a href="#RSA-Starter-3" class="headerlink" title="RSA Starter 3"></a>RSA Starter 3</h2><h3 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h3><p>RSA relies on the difficulty of the factorisation of the modulus <code>N</code>. If the primes can be found then we can calculate the <a href="https://leimao.github.io/article/RSA-Algorithm/">Euler totient</a> of <code>N</code> and thus decrypt the ciphertext.</p><p>Given <code>N = p*q</code> and two primes:</p><figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">p</span> <span class="operator">=</span> <span class="number">857504083339712752489993810777</span></span><br><span class="line"><span class="attribute">q</span> <span class="operator">=</span> <span class="number">1029224947942998075080348647219</span></span><br></pre></td></tr></table></figure><p>What is the totient of <code>N</code>?</p><h3 id="Analyze-2"><a href="#Analyze-2" class="headerlink" title="Analyze"></a>Analyze</h3><p>æ¬§æ‹‰æ–¹ç¨‹ï¼š$Ï†(mn) &#x3D; Ï†(m)Ï†(n)$</p><p>å› ä¸º pï¼Œq éƒ½æ˜¯ç´ æ•°ï¼Œæ‰€ä»¥ $Ï†(p) &#x3D; p - 1$ ï¼Œ$Ï†(q) &#x3D; q - 1$ã€‚</p><p>åœ¨è¿™é“é¢˜é‡Œé¢æ˜¯è¿™æ ·</p><p>$$\begin{align}Ï†(N) &amp;&#x3D; Ï†(p*q) \\ &amp;&#x3D; Ï†(p)Ï†(q) \\ &amp;&#x3D; (p-1)(q-1)\end{align}$$</p><h3 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = <span class="number">857504083339712752489993810777</span></span><br><span class="line">q = <span class="number">1029224947942998075080348647219</span></span><br><span class="line">N = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(N)</span><br></pre></td></tr></table></figure><h2 id="RSA-Starter-4"><a href="#RSA-Starter-4" class="headerlink" title="RSA Starter 4"></a>RSA Starter 4</h2><h3 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h3><p>The private key <code>d</code> is used to decrypt ciphertexts created with the corresponding public key (itâ€™s also used to â€œsignâ€ a message but weâ€™ll get to that later).</p><p>The private key is the secret piece of information or â€œtrapdoorâ€ which allows us to quickly invert the encryption function. If RSA is implemented well, if you do not have the private key the fastest way to decrypt the ciphertext is to first factorise the modulus.</p><p>In RSA the private key is the <a href="https://en.wikipedia.org/wiki/Modular_multiplicative_inverse">modular multiplicative inverse</a> of the exponent <code>e</code> modulo the totient of <code>N</code>.</p><p>Given the two primes:</p><figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">p</span> <span class="operator">=</span> <span class="number">857504083339712752489993810777</span></span><br><span class="line"><span class="attribute">q</span> <span class="operator">=</span> <span class="number">1029224947942998075080348647219</span></span><br></pre></td></tr></table></figure><p>and the exponent:</p><figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">e</span> <span class="operator">=</span> <span class="number">65537</span></span><br></pre></td></tr></table></figure><p>What is the private key <code>d</code>?</p><h3 id="Analyze-3"><a href="#Analyze-3" class="headerlink" title="Analyze"></a>Analyze</h3><p>å¯¹ e æ±‚é€†å…ƒã€‚$d * e&#x3D; 1 \mod N$ã€‚</p><p>ç¬¬ä¸€æ¬¡ç”¨è¿™ä¸ªåº“å¥½åƒï¼Ÿ</p><h3 id="Code-3"><a href="#Code-3" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">857504083339712752489993810777</span></span><br><span class="line">q = <span class="number">1029224947942998075080348647219</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">N = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, N)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br></pre></td></tr></table></figure><h2 id="RSA-Starter-5"><a href="#RSA-Starter-5" class="headerlink" title="RSA Starter 5"></a>RSA Starter 5</h2><h3 id="Description-4"><a href="#Description-4" class="headerlink" title="Description"></a>Description</h3><p>Iâ€™ve encrypted a secret number for your eyes only using your public key parameters:</p><figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">N</span> <span class="operator">=</span> <span class="number">882564595536224140639625987659416029426239230804614613279163</span></span><br><span class="line"><span class="attribute">e</span> <span class="operator">=</span> <span class="number">65537</span></span><br></pre></td></tr></table></figure><p>Use the private key that you found for these parameters in the previous challenge to decrypt this ciphertext:</p><figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">c</span> <span class="operator">=</span> <span class="number">77578995801157823671636298847186723593814843845525223303932</span></span><br></pre></td></tr></table></figure><h3 id="Analyze-4"><a href="#Analyze-4" class="headerlink" title="Analyze"></a>Analyze</h3><p>å’Œç¬¬ä¸€é¢˜æ²¡åŒºåˆ«ï¼Œæ— è„‘å¡«æ•°ã€‚</p><h3 id="Code-4"><a href="#Code-4" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">N = <span class="number">882564595536224140639625987659416029426239230804614613279163</span></span><br><span class="line">c = <span class="number">77578995801157823671636298847186723593814843845525223303932</span></span><br><span class="line">d = <span class="number">121832886702415731577073962957377780195510499965398469843281</span></span><br><span class="line">flag = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="RSA-Starter-6"><a href="#RSA-Starter-6" class="headerlink" title="RSA Starter 6"></a>RSA Starter 6</h2><h3 id="Description-5"><a href="#Description-5" class="headerlink" title="Description"></a>Description</h3><p>How can you ensure that the person receiving your message knows that you wrote it?</p><p>Youâ€™ve been asked out on a date, and you want to send a message telling them that youâ€™d love to go, however a jealous lover isnâ€™t so happy about this.</p><p>When you send your message saying yes, your jealous lover intercepts the message and corrupts it so it now says no!</p><p>We can protect against these attacks by signing the message.</p><p>Imagine you write a message <code>M</code>. You encrypt this message with your <strong>friendâ€™s public key</strong>: <code>C = Máµ‰â° mod Nâ‚€</code>.</p><p>To sign this message, you calculate the hash of the message: <code>H(M)</code> and â€œencryptâ€ this with <strong>your private key</strong>: <code>S = H(M)áµˆÂ¹ mod Nâ‚</code>.</p><blockquote><p>In real cryptosystems, itâ€™s <a href="https://crypto.stackexchange.com/a/12138">best practice to use separate keys</a> for encrypting and signing messages.</p></blockquote><p>Your friend can decrypt the message using <strong>their private key</strong>: <code>m = Cáµˆâ° mod Nâ‚€</code>. Using your public key they calculate <code>s = Sáµ‰Â¹ mod Nâ‚</code>.</p><p>Now by computing <code>H(m)</code> and comparing it to <code>s</code>: <code>assert H(m) == s</code>, they can ensure that the message you sent them, is the message that they received!</p><p>Sign the flag <code>crypto&#123;Immut4ble_m3ssag1ng&#125;</code> using your private key and the SHA256 hash function.</p><h3 id="Analyze-5"><a href="#Analyze-5" class="headerlink" title="Analyze"></a>Analyze</h3><p>è‹±æ–‡çœ‹å¾—æœ‰ç‚¹å¤´å¤§ï¼Œå¾—æµ…ç†ä¸€ä¸‹é€»è¾‘ã€‚</p><blockquote><p>Alice å‘ Bob å‘é€æ¶ˆæ¯ï¼š</p><ol><li><p>ç”¨ Bob çš„å…¬é’¥åŠ å¯†å¾—åˆ° C</p></li><li><p>ç­¾å</p></li></ol><blockquote><p>ç­¾åæ­¥éª¤</p><ol><li>æ±‚æ¶ˆæ¯çš„å“ˆå¸Œå€¼ H</li><li>ç”¨ Alice çš„ç§é’¥â€œåŠ å¯†â€å“ˆå¸Œå€¼å¾—åˆ° S</li></ol></blockquote><p>Bob æ¥æ”¶ Alice çš„æ¶ˆæ¯ï¼š</p><ol><li>ç”¨ Bob çš„ç§é’¥è§£å¯†å¾—åˆ° m</li><li>ç”¨ Alice çš„å…¬é’¥è®¡ç®—â€œè§£å¯†â€å¾—åˆ° s</li><li>è®¡ç®—æ¶ˆæ¯çš„å“ˆå¸Œå€¼ H</li><li>æ¯”è¾ƒ s å’Œ Hï¼ŒäºŒè€…ç›¸ç­‰å°±èƒ½ç¡®å®šæ¶ˆæ¯æ˜¯çœŸå®çš„</li></ol></blockquote><p>ç­¾åæ˜¯ä¸ªè›®å¥½ç©çš„ä¸œè¥¿æã€‚</p><h3 id="Code-5"><a href="#Code-5" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line">N = <span class="number">15216583654836731327639981224133918855895948374072384050848479908982286890731769486609085918857664046075375253168955058743185664390273058074450390236774324903305663479046566232967297765731625328029814055635316002591227570271271445226094919864475407884459980489638001092788574811554149774028950310695112688723853763743238753349782508121985338746755237819373178699343135091783992299561827389745132880022259873387524273298850340648779897909381979714026837172003953221052431217940632552930880000919436507245150726543040714721553361063311954285289857582079880295199632757829525723874753306371990452491305564061051059885803</span></span><br><span class="line">d = <span class="number">11175901210643014262548222473449533091378848269490518850474399681690547281665059317155831692300453197335735728459259392366823302405685389586883670043744683993709123180805154631088513521456979317628012721881537154107239389466063136007337120599915456659758559300673444689263854921332185562706707573660658164991098457874495054854491474065039621922972671588299315846306069845169959451250821044417886630346229021305410340100401530146135418806544340908355106582089082980533651095594192031411679866134256418292249592135441145384466261279428795408721990564658703903787956958168449841491667690491585550160457893350536334242689</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;crypto&#123;Immut4ble_m3ssag1ng&#125;&quot;</span></span><br><span class="line">flag = flag.encode()</span><br><span class="line"><span class="built_in">hash</span> = sha256(flag)</span><br><span class="line"><span class="built_in">hash</span> = <span class="built_in">hash</span>.hexdigest()</span><br><span class="line"><span class="built_in">hash</span> = <span class="built_in">int</span>(<span class="built_in">hash</span>, <span class="number">16</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(<span class="built_in">hash</span>, d, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(c))</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™ä¸ªè¶…å¿«ï¼&lt;/p&gt;
&lt;p&gt;æˆ‘çœ‹è°ä¸æ˜¯é€Ÿé€šï¼ˆbushi&lt;/p&gt;
    
    </summary>
    
      <category term="å­¦ä¹ " scheme="http://smilin9.com/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="cryptohack" scheme="http://smilin9.com/tags/cryptohack/"/>
    
  </entry>
  
  <entry>
    <title>å‰ä¸‰ç« è¡¥å……</title>
    <link href="http://smilin9.com/2022/05/08/%E5%89%8D%E4%B8%89%E7%AB%A0%E8%A1%A5%E5%85%85/"/>
    <id>http://smilin9.com/2022/05/08/å‰ä¸‰ç« è¡¥å……/</id>
    <published>2022-05-08T07:29:00.000Z</published>
    <updated>2022-06-17T01:14:47.772Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰ç«Ÿç„¶åšé”™æ¨¡å—äº†ï¼Ÿå¯„ï¼</p><span id="more"></span><p>æˆ‘çœŸçš„è°¢ã€‚</p><p>7 å·å‡Œæ™¨å’Œé¢è¯•å¸ˆå‚…æŠ±æ€¨ Courses ç¬¬äº”ç« çš„ ECC éš¾å­¦ï¼Œå¸ˆå‚…éœ‡æƒŠï¼šâ€œä½ æ€ä¹ˆå»å­¦ ECC äº†ï¼Ÿâ€ï¼Œç„¶åå‘ç°é¢è¯•ä»»åŠ¡ç«Ÿç„¶æ˜¯ Challenge çš„é‚£äº›ç« èŠ‚ï¼Œå½“æ—¶å°±å¿ƒæ€å¤§å´©ï¼Œæˆ‘å°±è¯´ ECC æ€ä¹ˆä¼šæ˜¯æˆ‘ç°åœ¨å¯ä»¥æŸ“æŒ‡çš„ä¸œè¥¿å•Šï¼ˆéº»ã€‚ã€‚</p><p>ä¸è¿‡è¿˜å¥½å¸ˆå‚…æŠŠäºŒé¢æ—¶é—´å»¶è¿Ÿåˆ° 10 å·äº†ï¼Œ7 å·è°ƒä¼‘ 9 å·æ»¡è¯¾ï¼Œç®—ä¸‹æ¥å…¶å®ä¹Ÿå°±å¤šäº† 8 å·çš„å‘¨æ—¥å¯ä»¥åšé¢˜ï¼Œæ‰€ä»¥ 8 å·æˆ‘å¿…æ—©èµ·ï¼</p><p>è¿™ç¯‡å…ˆè¡¥ä¸€ä¸‹ Challenge å‰ä¸‰ç« æ²¡åšçš„é¢˜ï¼Œç¬¬äº”ç« åé¢å†å•ç‹¬å†™å§ã€‚</p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><h2 id="Network-Attacks"><a href="#Network-Attacks" class="headerlink" title="Network Attacks"></a>Network Attacks</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>Several of the challenges are dynamic and require you to talk to our challenge servers over the network. This allows you to perform man-in-the-middle attacks on people trying to communicate, or directly attack a vulnerable service. To keep things consistent, our interactive servers always send and receive JSON objects.</p><p>Python makes such network communication easy with the <code>telnetlib</code> module. Conveniently, itâ€™s part of Pythonâ€™s standard library, so letâ€™s use it for now.</p><p>For this challenge, connect to <code>socket.cryptohack.org</code> on port <code>11112</code>. Send a JSON object with the key <code>buy</code> and value <code>flag</code>.</p><p>The example script below contains the beginnings of a solution for you to modify, and you can reuse it for later challenges.</p><p>Connect at <code>nc socket.cryptohack.org 11112</code>.</p><h3 id="Analyze"><a href="#Analyze" class="headerlink" title="Analyze"></a>Analyze</h3><p>ä½¿ç”¨ä¸­é—´äººæ”»å‡»çš„æ–¹å¼è·å– flag ã€‚</p><p>ä½¿ç”¨ telnetlib åº“å¯¹ socket.cryptohack.org 11112ç«¯å£ä»¥  JSON å¯¹è±¡çš„æ–¹å¼è¿›è¡Œè¯·æ±‚ã€‚</p><p>é¢˜ç›®è¯´çš„å¾ˆæ˜ç¡®ï¼Œå°±æŠŠ buy çš„å€¼æ”¹æˆ flagï¼Œè¿è¡Œä»£ç å°±èƒ½å‡ºç»“æœã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># éƒ¨åˆ†ä»£ç </span></span><br><span class="line">request = &#123;</span><br><span class="line">    <span class="string">&quot;buy&quot;</span>: <span class="string">&quot;flag&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="General"><a href="#General" class="headerlink" title="General"></a>General</h1><h2 id="ENCODING-Encoding-Challenge"><a href="#ENCODING-Encoding-Challenge" class="headerlink" title="ENCODING_Encoding Challenge"></a>ENCODING_Encoding Challenge</h2><h3 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h3><p>Now youâ€™ve got the hang of the various encodings youâ€™ll be encountering, letâ€™s have a look at automating it.</p><p>Can you pass all 100 levels to get the flag?</p><p>The <em>13377.py</em> file attached below is the source code for whatâ€™s running on the server. The <em>pwntools_example.py</em> file provides the start of a solution using the incredibly convenient pwntools library. which we recommend. If youâ€™d prefer to use Pythonâ€™s in-built telnetlib, <em>telnetlib_example.py</em> is also provided.</p><p>For more information about connecting to interactive challenges, see the <a href="https://cryptohack.org/faq#netcat">FAQ</a>. Feel free to skip ahead to the cryptography if you arenâ€™t in the mood for a coding challenge!</p><p>Connect at <code>nc socket.cryptohack.org 13377</code>.</p><h3 id="Analyze-1"><a href="#Analyze-1" class="headerlink" title="Analyze"></a>Analyze</h3><p>åˆšå¼€å§‹çœ‹é¢˜æ˜¯çœŸæ²¡ææ˜ç™½ä»–è¦å¹²å•¥ï¼Œç”šè‡³ä»¥ä¸ºè¿™ä¸æ˜¯å¯†ç é¢˜ã€‚ã€‚ï¼ˆå¯èƒ½æˆ‘é˜…è¯»èƒ½åŠ›æœ‰é—®é¢˜ï¼Ÿ</p><p>é˜…è¯»æœåŠ¡ç«¯çš„ä»£ç ï¼Œç¬¬ä¸€æ¬¡è¿æ¥æœåŠ¡å™¨ä¼šè¿”å›ç¼–ç æ–¹å¼ä»¥åŠç¼–ç åçš„å­—ç¬¦ä¸²ï¼Œè¿™æ—¶å€™éœ€è¦æäº¤è§£ç åçš„å­—ç¬¦ä¸²ï¼Œæ­£ç¡®è§£ç åæœåŠ¡å™¨ä¼šå‘æ¥ä¸‹ä¸€ä¸ªã€‚100 æ¬¡ä¹‹åæœåŠ¡å™¨ä¸»åŠ¨ç»ˆæ­¢è¿æ¥ï¼Œè§£ç ä¹‹åå¾—åˆ°çš„å°±æ˜¯ flagã€‚</p><p>è§£ç å‡½æ•°çœ‹ç€ä»–çš„åŠ å¯†ä»£ç å€’æ˜¯è›®å®¹æ˜“å†™çš„ï¼Œä½†æ˜¯ç¡®å®ä¸å–œæ¬¢åšè¿™ç±»é¢˜ã€‚</p><h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;socket.cryptohack.org&#x27;</span>, <span class="number">13377</span>, level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">json_recv</span>() -&gt; <span class="built_in">dict</span>:</span><br><span class="line">    line = r.recvline()</span><br><span class="line">    <span class="keyword">return</span> json.loads(line.decode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">json_send</span>(<span class="params">hsh: <span class="built_in">dict</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    request = json.dumps(hsh).encode()</span><br><span class="line">    r.sendline(request)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">encoded: <span class="built_in">str</span>, <span class="built_in">type</span>: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span> == <span class="string">&quot;base64&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> base64.b64decode(encoded).decode()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&quot;hex&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> codecs.decode(encoded, <span class="string">&#x27;hex&#x27;</span>).decode()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&quot;rot13&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> codecs.decode(encoded, <span class="string">&#x27;rot_13&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&quot;bigint&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> long_to_bytes(<span class="built_in">int</span>(encoded, <span class="number">16</span>)).decode()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&quot;utf-8&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> encoded)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Unknown encoding&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬ä¸€æ¬¡æ¥æ”¶</span></span><br><span class="line">received = json_recv()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    plain_text = decode(received[<span class="string">&quot;encoded&quot;</span>], received[<span class="string">&quot;type&quot;</span>])</span><br><span class="line">    to_send = &#123;</span><br><span class="line">        <span class="string">&quot;decoded&quot;</span>: plain_text</span><br><span class="line">    &#125;</span><br><span class="line">    json_send(to_send)</span><br><span class="line">    received = json_recv()</span><br></pre></td></tr></table></figure><h2 id="XOR-Lemur-XOR"><a href="#XOR-Lemur-XOR" class="headerlink" title="XOR_Lemur XOR"></a>XOR_Lemur XOR</h2><h3 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h3><p>Iâ€™ve hidden two cool images by XOR with the same secret key so you canâ€™t see them!</p><h3 id="Analyze-2"><a href="#Analyze-2" class="headerlink" title="Analyze"></a>Analyze</h3><p>é¢˜ç›®æè¿°å€’æ˜¯æŒºçŸ­ã€‚</p><p>ç›´æ¥äºŒè¿›åˆ¶å¼‚æˆ–ä¸è¡Œï¼Œç„¶åè¯•è¯•åƒç´ ç‚¹å¼‚æˆ–ã€‚</p><p>å¯¹å›¾ç‰‡æ“ä½œå¾ˆé™Œç”Ÿè¯¶ã€‚è¿˜æ˜¯èœã€‚</p><h3 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">flagImg = Image.<span class="built_in">open</span>(<span class="string">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/è¡¥å……/flag.png&#x27;</span>)</span><br><span class="line">flag = flagImg.load()</span><br><span class="line"></span><br><span class="line">lemurImg = Image.<span class="built_in">open</span>(<span class="string">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/è¡¥å……/lemur.png&#x27;</span>)</span><br><span class="line">lemur = lemurImg.load()</span><br><span class="line">width, height = flagImg.size</span><br><span class="line"></span><br><span class="line">newImg = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height))</span><br><span class="line">new = newImg.load()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        r1, g1, b1 = flag[i, j]</span><br><span class="line">        r2, g2, b2 = lemur[i, j]</span><br><span class="line">        new[i, j] = (r1 ^ r2, g1 ^ g2, b1 ^ b2)</span><br><span class="line"></span><br><span class="line">newImg.save(<span class="string">&#x27;D:/files/codeFiles/pyCode/cryptohack/Challenge/è¡¥å……/xorimage.png&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="DATA-FORMATS-Privacy-Enhanced-Mail"><a href="#DATA-FORMATS-Privacy-Enhanced-Mail" class="headerlink" title="DATA FORMATS_Privacy-Enhanced Mail?"></a>DATA FORMATS_Privacy-Enhanced Mail?</h2><h3 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h3><p>As weâ€™ve seen in the encoding section, cryptography involves dealing with data in a wide variety of formats: big integers, raw bytes, hex strings and more. A few structured formats have been standardised to help send and receive cryptographic data. It helps to be able to recognise and manipulate these common data formats.</p><p>PEM is a popular format for sending keys, certificates, and other cryptographic material. It looks like:</p><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="params">-----BEGIN</span> RSA PUBLIC KEY<span class="params">-----</span></span><br><span class="line">MIIBCgKC.<span class="string">..</span> *<span class="params">(a whole bunch of base64)</span>*</span><br><span class="line"><span class="params">-----END</span> RSA PUBLIC KEY<span class="params">-----</span></span><br></pre></td></tr></table></figure><p>It wraps base64-encoded data by a one-line header and footer to indicate how to parse the data within. Perhaps unexpectedly, itâ€™s important for there to be the correct number of hyphens in the header and footer, otherwise cryptographic tools wonâ€™t be able to recognise the file.</p><p>The data that gets base64-encoded is DER-encoded ASN.1 values. Confused? <a href="https://www.cryptologie.net/article/260/asn1-vs-der-vs-pem-vs-x509-vs-pkcs7-vs/">Here</a> is more information about what these acronyms mean but the complexity is there for historical reasons and going too deep into the details may drive you insane.</p><p>Extract the private key <em>d</em> as a decimal integer from this PEM-formatted RSA key.</p><blockquote><p>There are two main approaches for solving this challenge. The data in the certificate can be read with the openssl command line tool, or in Python using PyCryptodome. We recommend using PyCryptodome: first import the RSA module with <code>from Crypto.PublicKey import RSA</code> and you can read the key data using <code>RSA.importKey()</code>.</p></blockquote><h3 id="Analyze-3"><a href="#Analyze-3" class="headerlink" title="Analyze"></a>Analyze</h3><p>.pem æ–‡ä»¶è¯¶ï¼Œçœ‹èµ·æ¥å¥½é…·çš„æ ·å­ã€‚</p><p>ç”¨ç»™å‡ºçš„åº“å’Œå‡½æ•°è½¬æ¢ä¸€ä¸‹ç›´æ¥å‡ºã€‚</p><h3 id="Code-3"><a href="#Code-3" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">open</span>(<span class="string">r&quot;./privacy_enhanced_mail.pem&quot;</span>).read()</span><br><span class="line">p = RSA.import_key(c)</span><br><span class="line"><span class="built_in">print</span>(p.d)</span><br></pre></td></tr></table></figure><h2 id="DATA-FORMATS-CERTainly-not"><a href="#DATA-FORMATS-CERTainly-not" class="headerlink" title="DATA FORMATS_CERTainly not"></a>DATA FORMATS_CERTainly not</h2><h3 id="Description-4"><a href="#Description-4" class="headerlink" title="Description"></a>Description</h3><p>As mentioned in the previous challenge, PEM is just a nice wrapper above DER encoded ASN.1. In some cases you may come across DER files directly; for instance many Windows utilities prefer to work with DER files by default. However, other tools expect PEM format and have difficulty importing a DER file, so itâ€™s good to know how to convert one format to another.</p><p>An SSL certificate is a crucial part of the modern web, binding a cryptographic key to details about an organisation. Weâ€™ll cover more about these and PKI in the TLS category. Presented here is a DER-encoded x509 RSA certificate. Find the modulus of the certificate, giving your answer as a decimal.</p><h3 id="Analyze-4"><a href="#Analyze-4" class="headerlink" title="Analyze"></a>Analyze</h3><p>.der æ–‡ä»¶ï¼Œçœ‹èµ·æ¥ä¾ç„¶å¾ˆç‰›ã€‚</p><p>å’Œä¸Šä¸€é¢˜åŸºæœ¬å°±æ”¹äº†ä¸ªæ–‡ä»¶åã€‚</p><h3 id="Code-4"><a href="#Code-4" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">open</span>(<span class="string">r&quot;./CERTainly not_2048b-rsa-example-cert.der&quot;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">p = RSA.import_key(c)</span><br><span class="line"><span class="built_in">print</span>(p.n)</span><br></pre></td></tr></table></figure><h2 id="DATA-FORMATS-SSH-Keys"><a href="#DATA-FORMATS-SSH-Keys" class="headerlink" title="DATA FORMATS_SSH Keys"></a>DATA FORMATS_SSH Keys</h2><h3 id="Description-5"><a href="#Description-5" class="headerlink" title="Description"></a>Description</h3><p>Secure Shell Protocol (SSH) is a network protocol that uses cryptography to establish a secure channel over an insecure network (i.e. the internet). SSH enables developers and system administrators to run commands on servers from the other side of the world, without their password being sniffed or data being stolen. It is therefore critical to the security of the web.</p><p>In the old days, system administrators used to logon to their servers using telnet. This works similarly to our interactive challenges that involve connecting to <code>socket.cryptohack.org</code> - data is sent to a remote server, which performs actions based on what is sent. There is no transport encryption, so anyone listening in on the network (such as the WiFi access point owner, your ISP, or the NSA) can see all the telnet traffic.</p><p>As the internet became increasingly hostile, people realised the need for both authentication and encryption for administrative network traffic. SSH, first released in 1995, achieves these goals and much more, with advanced functionality built into the software like port forwarding, X11 forwarding, and SFTP (Secure File Transfer Protocol). SSH uses a client-server architecture, meaning the server runs SSH as a service daemon which is always online and waiting to receive connections, and the user runs an SSH client to make a connection to it.</p><p>Most commonly, SSH is configured to use public-private key pairs for authentication. On the server, a copy of the userâ€™s public key is stored. The userâ€™s private key is stored locally on their laptop.</p><p>Now letâ€™s say Bruce wants to connect as his user account <code>bschneier</code> to his server <code>bruces-server</code>. From his laptop he runs <code>ssh bschneier@bruces-server</code>. His SSH client opens a connection to the server on port 22 where the SSH daemon listens. First, the ciphers that will be used are agreed upon, then a session key to encrypt the connection is established using Diffie-Hellman Key exchange, but we wonâ€™t go into the details on that here. Then, the server sends a random challenge message encrypted with Bruceâ€™s public key. Bruce uses his private key to decrypt the challenge and send a hash of the random challenge message back, proving that he owns the correct private key and he therefore authenticates himself to the server as <code>bschneier</code>. Now, the server gives Bruce a shell to run commands. If public-private key cryptography doesnâ€™t make sense to you yet, donâ€™t worry - weâ€™ll cover it extensively in the RSA category.</p><p>An SSH private key is stored in the PEM format, which we discussed in the â€œPrivacy-Enhanced Mailâ€ challenge. So it looks like this and is stored on Bruceâ€™s laptop at <code>/home/bschneier/.ssh/id_rsa</code>:</p><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="params">-----BEGIN</span> RSA PRIVATE KEY<span class="params">-----</span></span><br><span class="line">MIIBCgKC.<span class="string">..</span> *<span class="params">(a whole bunch of base64)</span>*</span><br><span class="line"><span class="params">-----END</span> RSA PRIVATE KEY<span class="params">-----</span></span><br></pre></td></tr></table></figure><p>SSH public keys, however, use a different format:</p><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCtPLqba+GFvDHdFVs1Vvdk56cKqqw5cdomlu034666UsoFIqkig8H5kNsNefSpaR<span class="regexp">/iU7G0ZKCiWRRuAbTsuHN+Cz526XhQvzgKTBkTGYXdF/</span>WdG<span class="regexp">/6/um</span>ou3Z0+wJvTZgvEmeEclvitBrPZkzhAK1M5ypgNR4p8scJplTgSSb84Ckqul<span class="regexp">/Dj/</span>Sh+fwo6sU3S3j92qc27BVGChpQiGwjjut4CkHauzQA<span class="regexp">/gKCBIiLyzoFcLEHhjOBOEErnvrRPWCIAJhALkwV2rUbD4g1IWa7QI2q3nB0nlnjPnjjwaR7TpH4gy2NSIYNDdC1PZ8reBaFnGTXgzhQ2t0ROBNb+ZDgH8Fy+KTG+gEakpu20bRqB86NN6frDLOkZ9x3w32tJtqqrJTALy4Oi3MW0XPO61UBT133VNqAbNYGE2gx+mXBVOezbsY46C/</span>V2fmxBJJKY<span class="regexp">/SFNs8wOVOHKwqRH0GI5VsG1YZClX3fqk8GDJYREaoyoL3HKQt1Ue/</span>ZW7TlPRYzAoIB62C0= bschneier@facts</span><br></pre></td></tr></table></figure><p>This format makes it easier for these public keys to be added as lines to the file <code>/home/bschneier/.ssh/authorized_keys</code> on the server. Adding the public key to this file allows the corresponding private key to be used to authenticate on the server.</p><p>The <code>ssh-keygen</code> command is used to produce these public-private keypairs.</p><p>Extract the modulus <em>n</em> as a decimal integer from Bruceâ€™s SSH public key.</p><h3 id="Analyze-5"><a href="#Analyze-5" class="headerlink" title="Analyze"></a>Analyze</h3><p>.pub åç¼€æ›´é…·äº†ã€‚</p><p>ä¸è¿‡å’Œç¬¬ä¸€é¢˜è§£æ³•æ²¡åŒºåˆ«ï¼Œåªèƒ½è¯´å‡½æ•°çœŸçš„å¼ºå¤§ã€‚</p><h3 id="Code-5"><a href="#Code-5" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">open</span>(<span class="string">r&quot;./SSH Keys_bruce_rsa.pub&quot;</span>).read()</span><br><span class="line">p = RSA.import_key(c)</span><br><span class="line"><span class="built_in">print</span>(p.n)</span><br></pre></td></tr></table></figure><h2 id="DATA-FORMATS-Transparency"><a href="#DATA-FORMATS-Transparency" class="headerlink" title="DATA FORMATS_Transparency"></a>DATA FORMATS_Transparency</h2><h3 id="Description-6"><a href="#Description-6" class="headerlink" title="Description"></a>Description</h3><p>When you connect to a website over HTTPS, the first TLS message sent by the server is the ServerHello containing the server TLS certificate. Your browser verifies that the TLS certificate is valid, and if not, will terminate the TLS handshake. Verification includes ensuring that:</p><p>- the name on the certificate matches the domain</p><p>- the certificate has not expired</p><p>- the certificate is ultimately signed (via a â€œchain of trustâ€) by a root key of a Certificate Authority (CA) thatâ€™s trusted by your browser or operating system</p><p>Since CAs have the power to sign any certificate, the security of the internet depends upon these organisations to issue TLS certificates to the correct people: they must only issue certificates to the real domain owners. However with Windows trusting root certificates from over 100 organisations by default, thereâ€™s a number of opportunities for hackers, politics, or incompetence to break the whole model. If you could trick just a single CA to issue you a certificate for microsoft.com, you could use the corresponding private key to sign malware and bypass trust controls on Windows. CAs are strongly incentivised to be careful since their business depends upon people trusting them, however in practice they have failed several times.</p><p>In 2011 <a href="https://arstechnica.com/information-technology/2011/03/independent-iranian-hacker-claims-responsibility-for-comodo-hack/">Comodo CA was compromised</a> and the hacker was able to issue certificates for Gmail and other services. In 2016, <a href="https://security.googleblog.com/2015/10/sustaining-digital-certificate-security.html">Symantec was found</a> to have issued over 150 certificates without the domain ownerâ€™s knowledge, as well as 2400 certificates for domains that were never registered.</p><p>Due to such events, together with the fact that fraudulent certificates can take a long time to be discovered, since 2018 Certificate Transparency has been enforced by Google Chrome. Every CA must publish all certificates that they issue to a log, which anyone can search.</p><p>Attached is an RSA public key in PEM format. Find the subdomain of cryptohack.org which uses these parameters in its TLS certificate, and visit that subdomain to obtain the flag.</p><h3 id="Analyze-6"><a href="#Analyze-6" class="headerlink" title="Analyze"></a>Analyze</h3><p>è¿™é¢˜æ€ä¹ˆè¯´å‘¢ï¼Œä¸€è¨€éš¾å°½ã€‚</p><p>å€’æ˜¯èƒ½è§£å‡ºæ¥ nï¼Œä½†æ˜¯æ€ä¹ˆæ‰¾åˆ°åŒ…å« n çš„è¯ä¹¦å¯¹åº”çš„åŸŸåå‘¢ï¼Œæœäº†å¾ˆä¹…ä¹Ÿæ²¡æ‰¾åˆ°ã€‚</p><p>æœ€åæ˜¯ç›´æ¥å»çˆ†ç ´ï¼Œæ‰¾åˆ° url é‡ŒåŒ…å« flag çš„å­åŸŸåï¼Œè®¿é—®å¾—åˆ° flagã€‚</p><p>ä¹Ÿå¯ä»¥ç”¨ <a href="https://crt.sh/">crt.sh</a> æœæŒ‡çº¹ï¼ŒæŸ¥æ—¥å¿—è®°å½•ï¼Œä¸è¿‡ä¹Ÿæ²¡ç”¨åˆ°å…¬é’¥ã€‚</p><p>æœ€åè¿˜æ˜¯ä¸çŸ¥é“æ€ä¹ˆç”¨å…¬é’¥æ¨åŸŸåï¼Œæ€ªæã€‚</p><h1 id="Mathematics"><a href="#Mathematics" class="headerlink" title="Mathematics"></a>Mathematics</h1><p>è™½ç„¶ä¹‹å‰åšæ•°å­¦åšäº†å¾ˆä¹…ï¼Œä¸è¿‡å€¼å¾—æ¬£æ…°çš„æ˜¯ Challenge ç¬¬ä¸‰ç« ç¬¬ä¸€éƒ¨åˆ†å…¨éƒ½åšå®Œäº†ã€‚å…·ä½“<a href="http://smilin9.com/2022/05/03/Modular%20Arithmetic/">ç‚¹è¿™é‡Œ</a> ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¹‹å‰ç«Ÿç„¶åšé”™æ¨¡å—äº†ï¼Ÿå¯„ï¼&lt;/p&gt;
    
    </summary>
    
      <category term="å­¦ä¹ " scheme="http://smilin9.com/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="cryptohack" scheme="http://smilin9.com/tags/cryptohack/"/>
    
  </entry>
  
  <entry>
    <title>Symmetric Cryptography_How AES Works</title>
    <link href="http://smilin9.com/2022/05/05/Symmetric%20Cryptography_How%20AES%20Works/"/>
    <id>http://smilin9.com/2022/05/05/Symmetric Cryptography_How AES Works/</id>
    <published>2022-05-05T15:42:00.000Z</published>
    <updated>2022-06-17T01:14:47.772Z</updated>
    
    <content type="html"><![CDATA[<p>ç¬¬ä¸‰ç« å¥½åƒæ˜¯åšçš„æœ€è¿·çš„</p><span id="more"></span><p>è™½ç„¶åªéœ€è¦åš â€How AES Worksâ€ éƒ¨åˆ†ã€‚ä½†æ˜¯â€”â€”</p><p>åˆšå¼€å§‹ç¬¬ä¸‰ç« ï¼šè¿˜ä»¥ä¸ºä¼šè¶Šæ¥è¶Šéš¾ï¼Œæ²¡æƒ³åˆ°åšå®Œæ•°è®ºå°±æŸ³æš—èŠ±æ˜äº†ï¼Ÿ</p><p>ç¬¬ä¸‰ç« æœ€åä¸€é¢˜ï¼šä»€ä¹ˆä¸œè¥¿å•Šè¿™æ˜¯ï¼Œè¿™æ€ä¹ˆæ¯”æ•°è®ºé‚£å—è¿˜å¤æ‚ã€‚ã€‚</p><h1 id="Symmetric-Cryptography-How-AES-Works"><a href="#Symmetric-Cryptography-How-AES-Works" class="headerlink" title="Symmetric Cryptography_How AES Works"></a>Symmetric Cryptography_How AES Works</h1><h2 id="Keyed-Permutations"><a href="#Keyed-Permutations" class="headerlink" title="Keyed Permutations"></a>Keyed Permutations</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>AES, like all good block ciphers, performs a â€œkeyed permutationâ€. This means that it maps every possible input block to a unique output block, with a key determining which permutation to perform.</p><blockquote><p>A â€œblockâ€ just refers to a fixed number of bits or bytes, which may represent any kind of data. AES processes a block and outputs another block. Weâ€™ll be specifically talking the variant of AES which works on 128 bit (16 byte) blocks and a 128 bit key, known as AES-128.</p></blockquote><p>Using the same key, the permutation can be performed in reverse, mapping the output block back to the original input block. It is important that there is a one-to-one correspondence between input and output blocks, otherwise we wouldnâ€™t be able to rely on the ciphertext to decrypt back to the same plaintext we started with.</p><p>What is the mathematical term for a one-to-one correspondence?</p><h3 id="Analyze"><a href="#Analyze" class="headerlink" title="Analyze"></a>Analyze</h3><p>å–”è¿™é¢˜ç®€å•ï¼Œæˆ‘ä¸çŸ¥é“ä½† Google çŸ¥é“ï¼Œæµ…æœä¸€ä¸‹â€ä¸€ä¸€å¯¹åº”çš„æ•°å­¦æœ¯è¯­â€œï¼ŒçŸ¥é“å«åŒå°„å‡½æ•°ï¼Œæµ…æµ…ä¸Šä¸ªç™¾ç§‘ï¼Œå°±çŸ¥é“è‹±è¯­å’¯ã€‚</p><h2 id="Resisting-Bruteforce"><a href="#Resisting-Bruteforce" class="headerlink" title="Resisting Bruteforce"></a>Resisting Bruteforce</h2><h3 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h3><p>If a block cipher is secure, there should be no way for an attacker to distinguish the output of AES from a <a href="https://en.wikipedia.org/wiki/Pseudorandom_permutation">random permutation</a> of bits. Furthermore, there should be no better way to undo the permutation than simply bruteforcing every possible key. Thatâ€™s why academics consider a cipher theoretically â€œbrokenâ€ if they can find an attack that takes fewer steps to perform than bruteforcing the key, even if that attack is practically infeasible.</p><blockquote><p>How difficult is it to bruteforce a 128-bit keyspace? <a href="https://crypto.stackexchange.com/a/48669">Somebody estimated</a> that if you turned the power of the entire Bitcoin mining network against an AES-128 key, it would take over a hundred times the age of the universe to crack the key.</p></blockquote><p>It turns out that there is <a href="https://en.wikipedia.org/wiki/Biclique_attack">an attack</a> on AES thatâ€™s better than bruteforce, but only slightly â€“ it lowers the security level of AES-128 down to 126.1 bits, and hasnâ€™t been improved on for over 8 years. Given the large â€œsecurity marginâ€ provided by 128 bits, and the lack of improvements despite extensive study, itâ€™s not considered a credible risk to the security of AES. But yes, in a very narrow sense, it â€œbreaksâ€ AES.</p><p>Finally, while quantum computers have the potential to completely break popular public-key cryptosystems like RSA via <a href="https://en.wikipedia.org/wiki/Shor's_algorithm">Shorâ€™s algorithm</a>, they are thought to only cut in half the security level of symmetric cryptosystems via <a href="https://en.wikipedia.org/wiki/Grover's_algorithm">Groverâ€™s algorithm</a>. This is one reason why people recommend using AES-256, despite it being less performant, as it would still provide a very adequate 128 bits of security in a quantum future.</p><p>What is the name for the best single-key attack against AES?</p><h3 id="Analyze-1"><a href="#Analyze-1" class="headerlink" title="Analyze"></a>Analyze</h3><p>è™½ç„¶ä½†æ˜¯ï¼Œä¾ç„¶å»æŸ¥äº† Googleï¼Œé è°±ï¼</p><p>ä¸è¿‡å‘ç°ç½‘ä¸Šæœ biclique çš„ç»“æœå±…ç„¶ä¸æ˜¯å¾ˆå¤šï¼Œæˆ‘æ‰“å¼€æ–¹å¼æœ‰é—®é¢˜å—æ˜¯ï¼Œåé¢å†çœ‹çœ‹ã€‚</p><h2 id="Structure-of-AES"><a href="#Structure-of-AES" class="headerlink" title="Structure of AES"></a>Structure of AES</h2><h3 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h3><p>To achieve a keyed permutation that is infeasible to invert without the key, AES applies a large number of ad-hoc mixing operations on the input. This is in stark contrast to public-key cryptosystems like RSA, which are based on elegant individual mathematical problems. AES is much less elegant, but itâ€™s very fast.</p><p>At a high level, AES-128 begins with a â€œkey scheduleâ€ and then runs 10 rounds over a state. The starting state is just the plaintext block that we want to encrypt, represented as a 4x4 matrix of bytes. Over the course of the 10 rounds, the state is repeatedly modified by a number of invertible transformations.</p><blockquote><p>Each transformation step has a defined purpose based on theoretical properties of secure ciphers established by Claude Shannon in the 1940s. Weâ€™ll look closer at each of these in the following challenges.</p></blockquote><p>Hereâ€™s an overview of the phases of AES encryption:</p><p><img src="https://cryptohack.org/static/img/aes/Structure.png" alt="diagram showing AES rounds"></p><ol><li><strong>KeyExpansion</strong> or Key Schedule</li></ol><p>â€ƒFrom the 128 bit key, 11 separate 128 bit â€œround keysâ€ are derived: one to be used in each AddRoundKey step.</p><ol start="2"><li><strong>Initial key addition</strong></li></ol><p>â€ƒ<em>AddRoundKey</em> - the bytes of the first round key are XORâ€™d with the bytes of the state.</p><ol start="3"><li><strong>Round</strong> - this phase is looped 10 times, for 9 main rounds plus one â€œfinal roundâ€</li></ol><p>â€ƒa) <em>SubBytes</em> - each byte of the state is substituted for a different byte according to a lookup table (â€œS-boxâ€).</p><p>â€‹â€ƒb) <em>ShiftRows</em> - the last three rows of the state matrix are transposedâ€”shifted over a column or two or three.</p><p>â€‹â€ƒc) <em>MixColumns</em> - matrix multiplication is performed on the columns of the state, combining the four bytes in each column. This is skipped in the final round.</p><p>â€‹â€ƒd) <em>AddRoundKey</em> - the bytes of the current round key are XORâ€™d with the bytes of the state.</p><p>Included is a <code>bytes2matrix</code> function for converting our initial plaintext block into a state matrix. Write a <code>matrix2bytes</code> function to turn that matrix back into bytes, and submit the resulting plaintext as the flag.</p><h3 id="Analyze-2"><a href="#Analyze-2" class="headerlink" title="Analyze"></a>Analyze</h3><p>è¿™é¢˜æˆ‘ä¼šï¼</p><p>è¡¥å…¨ matrix2bytes()ï¼Œç›´æ¥ç”¨ sum() æŠŠçŸ©é˜µå‹ç¼©æˆä¸€ç»´åˆ—è¡¨ï¼Œç„¶åè½¬å­—èŠ‚è¾“å‡ºã€‚</p><p>è¡¥å…¨å‡½æ•°çš„é¢˜æ¯”è‡ªå·±å†™ä»£ç çš„ç®€å•å¤šäº†ï¼ˆbushi</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">bytes2matrix</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Converts a 16-byte array into a 4x4 matrix.  &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">list</span>(text[i:i+<span class="number">4</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(text), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix2bytes</span>(<span class="params">matrix</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array.  &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">sum</span>(matrix, []))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">matrix = [</span><br><span class="line">    [<span class="number">99</span>, <span class="number">114</span>, <span class="number">121</span>, <span class="number">112</span>],</span><br><span class="line">    [<span class="number">116</span>, <span class="number">111</span>, <span class="number">123</span>, <span class="number">105</span>],</span><br><span class="line">    [<span class="number">110</span>, <span class="number">109</span>, <span class="number">97</span>, <span class="number">116</span>],</span><br><span class="line">    [<span class="number">114</span>, <span class="number">105</span>, <span class="number">120</span>, <span class="number">125</span>],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(matrix2bytes(matrix))</span><br></pre></td></tr></table></figure><h3 id="SumUp"><a href="#SumUp" class="headerlink" title="SumUp"></a>SumUp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># function</span></span><br><span class="line"><span class="built_in">sum</span>()  <span class="comment"># æŠŠè¿­ä»£å¯¹è±¡é‡Œçš„æ¯ä¸€ä¸ªå…ƒç´ ç›¸åŠ ã€‚ï¼ˆå½“å…ƒç´ æ˜¯åˆ—è¡¨ï¼Œå°±æœ‰å‹å¹³çš„æ•ˆæœå’¯ï¼‰</span></span><br></pre></td></tr></table></figure><h2 id="Round-Keys"><a href="#Round-Keys" class="headerlink" title="Round Keys"></a>Round Keys</h2><h3 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h3><p>Weâ€™re going to skip over the finer details of the <strong>KeyExpansion</strong> phase for now. The main point is that it takes in our 16 byte key and produces 11 4x4 matrices called â€œround keysâ€ derived from our initial key. These round keys allow AES to get extra mileage out of the single key that we provided.</p><p>The <strong>initial key addition</strong> phase, which is next, has a single <em>AddRoundKey</em> step. The <em>AddRoundKey</em> step is straightforward: it XORs the current state with the current round key.</p><p><img src="https://cryptohack.org/static/img/aes/AddRoundKey.png" alt="diagram showing AddRoundKey"></p><p><em>AddRoundKey</em> also occurs as the final step of each round. <em>AddRoundKey</em> is what makes AES a â€œkeyed permutationâ€ rather than just a permutation. Itâ€™s the only part of AES where the key is mixed into the state, but is crucial for determining the permutation that occurs.</p><p>As youâ€™ve seen in previous challenges, XOR is an easily invertible operation if you know the key, but tough to undo if you donâ€™t. Now imagine trying to recover plaintext which has been XORâ€™d with 11 different keys, and heavily jumbled between each XOR operation with a series of substitution and transposition ciphers. Thatâ€™s kinda what AES does! And weâ€™ll see just how effective the jumbling is in the next few challenges.</p><p>Complete the <code>add_round_key</code> function, then use the <code>matrix2bytes</code> function to get your next flag.</p><h3 id="Analyze-3"><a href="#Analyze-3" class="headerlink" title="Analyze"></a>Analyze</h3><p>é‡åˆ°å¼‚æˆ–å°±æ¬ pwn.xor()ï¼</p><p>æ˜æ–‡ç»è¿‡äº† 11 ä¸ªä¸åŒçš„å¯†é’¥è¿›è¡Œå¼‚æˆ–ï¼Œå†å¼‚æˆ–å›å»å°±å¯ä»¥å¾—åˆ°åŸæ–‡ã€‚</p><p>è¿”å›å¼‚æˆ–å€¼å°± okã€‚</p><p>æ„Ÿè§‰å¼‚æˆ–è¿˜æ˜¯è›®æœ‰æ„æ€çš„ã€‚</p><h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line">state = [</span><br><span class="line">    [<span class="number">206</span>, <span class="number">243</span>, <span class="number">61</span>, <span class="number">34</span>],</span><br><span class="line">    [<span class="number">171</span>, <span class="number">11</span>, <span class="number">93</span>, <span class="number">31</span>],</span><br><span class="line">    [<span class="number">16</span>, <span class="number">200</span>, <span class="number">91</span>, <span class="number">108</span>],</span><br><span class="line">    [<span class="number">150</span>, <span class="number">3</span>, <span class="number">194</span>, <span class="number">51</span>],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">round_key = [</span><br><span class="line">    [<span class="number">173</span>, <span class="number">129</span>, <span class="number">68</span>, <span class="number">82</span>],</span><br><span class="line">    [<span class="number">223</span>, <span class="number">100</span>, <span class="number">38</span>, <span class="number">109</span>],</span><br><span class="line">    [<span class="number">32</span>, <span class="number">189</span>, <span class="number">53</span>, <span class="number">8</span>],</span><br><span class="line">    [<span class="number">253</span>, <span class="number">48</span>, <span class="number">187</span>, <span class="number">78</span>],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">s, k</span>):</span><br><span class="line">    <span class="keyword">return</span> xor(s, k)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(add_round_key(state, round_key))</span><br></pre></td></tr></table></figure><h2 id="Confusion-through-Substitution"><a href="#Confusion-through-Substitution" class="headerlink" title="Confusion through Substitution"></a>Confusion through Substitution</h2><h3 id="Description-4"><a href="#Description-4" class="headerlink" title="Description"></a>Description</h3><p>The first step of each AES round is <em>SubBytes</em>. This involves taking each byte of the state matrix and substituting it for a different byte in a preset 16x16 lookup table. The lookup table is called a â€œSubstitution boxâ€ or â€œS-boxâ€ for short, and can be perplexing at first sight. Letâ€™s break it down.</p><p><img src="https://cryptohack.org/static/img/aes/Substitution.png" alt="diagram showing Substitution"></p><p>In 1945 American mathematician Claude Shannon published a groundbreaking paper on Information Theory. It identified â€œconfusionâ€ as an essential property of a secure cipher. â€œConfusionâ€ means that the relationship between the ciphertext and the key should be as complex as possible. Given just a ciphertext, there should be no way to learn anything about the key.</p><p>If a cipher has poor confusion, it is possible to express a relationship between ciphertext, key, and plaintext as a linear function. For instance, in a Caesar cipher, <code>ciphertext = plaintext + key</code>. Thatâ€™s an obvious relation, which is easy to reverse. More complicated linear transformations can be solved using techniques like Gaussian elimination. Even low-degree polynomials, e.g. an equation like <code>x^4 + 51x^3 + x</code>, can be solved efficiently using <a href="https://math.stackexchange.com/a/1078515">algebraic methods</a>. However, the higher the degree of a polynomial, generally the harder it becomes to solve â€“ it can only be approximated by a larger and larger amount of linear functions.</p><p>The main purpose of the S-box is to transform the input in a way that is resistant to being approximated by linear functions. S-boxes are aiming for high <em>non-linearity</em>, and while AESâ€™s one is not perfect, itâ€™s pretty close. The fast lookup in an S-box is a shortcut for performing a very nonlinear function on the input bytes. This function involves taking the modular inverse in the <a href="https://www.samiam.org/galois.html">Galois field 2**8</a> and then applying an affine transformation which has been tweaked for maximum confusion. The simplest way to express the function is through the following high-degree polynomial:</p><p><img src="https://cryptohack.org/static/img/aes/SBoxEq.png" alt="diagram showing S-Box equation"></p><p>To make the S-box, the function has been calculated on all input values from 0x00 to 0xff and the outputs put in the lookup table.</p><p>Implement <code>sub_bytes</code>, send the state matrix through the inverse S-box and then convert it to bytes to get the flag.</p><h3 id="Analyze-4"><a href="#Analyze-4" class="headerlink" title="Analyze"></a>Analyze</h3><p>æ„æ€å°±æ˜¯è®©è¡¥å…¨ sub_bytes å‡½æ•°ï¼Œç„¶åè½¬æ¢æˆå­—èŠ‚å¾—åˆ° flagã€‚</p><p>å…¶å® state é‡Œé¢çš„å­˜çš„æ˜¯å®ƒæ¯ä¸ªä½ç½®ä¸Šæœ¬æ¥çš„æ•°æ®åœ¨æŸ¥æ‰¾åº“ sbox ä¸­çš„åºå·ï¼Œæ‰€ä»¥éå† stateï¼ŒæŒ‰åºå·å–å‡ºå¯¹åº”çš„åŸæ•°æ®ï¼Œç„¶åè¿”å›å­—èŠ‚å°±å¥½å’¯ã€‚</p><h3 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å†™æ³•ä¸€</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">s, sbox=s_box</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] = sbox[s[i][j]]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">sum</span>(s, []))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(sub_bytes(state, sbox=inv_s_box))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™æ³•äºŒ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix2bytes</span>(<span class="params">matrix</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array.  &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">sum</span>(matrix, []))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">s, sbox=s_box</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] = sbox[s[i][j]]</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(matrix2bytes(sub_bytes(state, sbox=inv_s_box)))</span><br></pre></td></tr></table></figure><h3 id="SumUp-1"><a href="#SumUp-1" class="headerlink" title="SumUp"></a>SumUp</h3><p>ä¸¤ç§å†™æ³•æ€ä¹ˆè¯´å‘¢ï¼Œç¬¬ä¸€ç§æ›´ç®€æ´æ˜äº†ï¼Œçœ‹èµ·æ¥å¥½åƒä¹Ÿæ›´ä¼˜é›…ã€‚</p><p>ç¬¬äºŒç§è™½ç„¶æ¬è¿‡æ¥äº† matrix2bytes() å‡½æ•°ï¼ˆä¹Ÿå¯ä»¥ä¸æ¬å‡½æ•°ç›´æ¥ä¸€è¡Œæå®šï¼Œä¸è¿‡è¯»èµ·æ¥è´¹åŠ²ç‚¹ï¼‰ï¼Œçœ‹èµ·æ¥æ›´ç¹çï¼Œä¸è¿‡è¿™ç§å†™æ³•æ›´ä¸å®¹æ˜“åƒäºï¼ˆåœ¨æœ€åä¸€é¢˜å·²ç»æ·±åˆ»ä½“ä¼šè¿‡äº†ï¼‰ã€‚æ‰€ä»¥æœ¬æ¥æ˜¯å–œæ¬¢ç¬¬ä¸€ç§å†™æ³•çš„ï¼Œåšå®Œæœ€åä¸€é¢˜ä¹‹åè¿˜æ˜¯å–œæ¬¢ç¬¬äºŒç§äº†ã€‚</p><p>ï¼ˆå‘œå‘œå‘œæˆ‘ä¹Ÿä¸æƒ³è¢«é’“å•Šï¼Œå¯æ˜¯å®ƒè§£é¢˜æ›´å¥½ç”¨è¯¶ï¼‰ã€‚</p><h2 id="Diffusion-through-Permutation"><a href="#Diffusion-through-Permutation" class="headerlink" title="Diffusion through Permutation"></a>Diffusion through Permutation</h2><h3 id="Description-5"><a href="#Description-5" class="headerlink" title="Description"></a>Description</h3><p>Weâ€™ve seen how S-box substitution provides confusion. The other crucial property described by Shannon is â€œdiffusionâ€. This relates to how every part of a cipherâ€™s input should spread to every part of the output.</p><p>Substitution on its own creates non-linearity, however it doesnâ€™t distribute it over the entire state. Without diffusion, the same byte in the same position would get the same transformations applied to it each round. This would allow cryptanalysts to attack each byte position in the state matrix separately. We need to alternate substitutions by scrambling the state (in an invertible way) so that substitutions applied on one byte influence all other bytes in the state. Each input into the next S-box then becomes a function of multiple bytes, meaning that with every round the algebraic complexity of the system increases enormously.</p><blockquote><p>An ideal amount of diffusion causes a change of one bit in the plaintext to lead to a change in statistically half the bits of the ciphertext. This desirable outcome is called the <a href="https://en.wikipedia.org/wiki/Avalanche_effect">Avalanche effect</a>.</p></blockquote><p>The <em>ShiftRows</em> and <em>MixColumns</em> steps combine to achieve this. They work together to ensure every byte affects every other byte in the state within just two rounds.</p><p><em>ShiftRows</em> is the most simple transformation in AES. It keeps the first row of the state matrix the same. The second row is shifted over one column to the left, wrapping around. The third row is shifted two columns, the fourth row by three. Wikipedia puts it nicely: â€œthe importance of this step is to avoid the columns being encrypted independently, in which case AES degenerates into four independent block ciphers.â€</p><p><img src="https://cryptohack.org/static/img/aes/ShiftRows.png" alt="diagram showing ShiftRows"></p><p><em>MixColumns</em> is more complex. It performs Matrix multiplication in Rijndaelâ€™s Galois field between the columns of the state matrix and a preset matrix. Each single byte of each column therefore affects all the bytes of the resulting column. The implementation details are nuanced; <a href="https://www.samiam.org/mix-column.html">this page</a> and <a href="https://en.wikipedia.org/wiki/Rijndael_MixColumns">Wikipedia</a> do a good job of covering them.</p><p><img src="https://cryptohack.org/static/img/aes/MixColumns.png" alt="diagram showing MixColumns"></p><p>Weâ€™ve provided code to perform MixColumns and the forward ShiftRows operation. After implementing <code>inv_shift_rows</code>, take the state, run <code>inv_mix_columns</code> on it, then <code>inv_shift_rows</code>, convert to bytes and you will have your flag.</p><h3 id="Analyze-5"><a href="#Analyze-5" class="headerlink" title="Analyze"></a>Analyze</h3><p>é¦–å…ˆæ˜¯è¡¥å…¨ inv_shift_rows()ï¼Œå‚è€ƒ shift_rows()ï¼Œå‘ç°æ˜¯ç»™ç¬¬ n è¡Œå‘å·¦ç§»åŠ¨ n ä¸ªå•ä½ ï¼Œé‚£ inv_shift_rows å°±ç»™ç¬¬ n è¡Œå‘å³ç§»åŠ¨ n ä¸ªå•ä½ã€‚</p><p>ç„¶åæ ¹æ® description ä¾æ¬¡è¿è¡Œ <code>inv_mix_columns(state)</code> <code>inv_shift_rows(state)</code>ï¼Œç„¶åæŠŠå‰é¢ç”¨è¿‡çš„çŸ©é˜µè½¬å­—èŠ‚çš„å‡½æ•° matrix2bytes() æ¬è¿‡æ¥ï¼Œè¾“å‡ºä¸€ä¸‹ã€‚</p><h3 id="Code-3"><a href="#Code-3" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">inv_shift_rows</span>(<span class="params">s</span>):</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix2bytes</span>(<span class="params">matrix</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array.  &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">sum</span>(matrix, []))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">inv_mix_columns(state)</span><br><span class="line">inv_shift_rows(state)</span><br><span class="line"><span class="built_in">print</span>(matrix2bytes(state))</span><br></pre></td></tr></table></figure><h2 id="Bringing-It-All-Together"><a href="#Bringing-It-All-Together" class="headerlink" title="Bringing It All Together"></a>Bringing It All Together</h2><h3 id="Description-6"><a href="#Description-6" class="headerlink" title="Description"></a>Description</h3><p>Apart from the <strong>KeyExpansion</strong> phase, weâ€™ve sketched out all the components of AES. Weâ€™ve shown how <em>SubBytes</em> provides confusion and <em>ShiftRows</em> and <em>MixColumns</em> provide diffusion, and how these two properties work together to repeatedly circulate non-linear transformations over the state. Finally, <em>AddRoundKey</em> seeds the key into this substitution-permutation network, making the cipher a keyed permutation.</p><p>Decryption involves performing the steps described in the â€œStructure of AESâ€ challenge in reverse, applying the inverse operations. Note that the KeyExpansion still needs to be run first, and the round keys will be used in reverse order. <em>AddRoundKey</em> and its inverse are identical as XOR has the self-inverse property.</p><p><img src="https://cryptohack.org/static/img/aes/Structure2.png" alt="diagram showing AES decryption"></p><p>Weâ€™ve provided the key expansion code, and ciphertext thatâ€™s been properly encrypted by AES-128. Copy in all the building blocks youâ€™ve coded so far, and complete the <code>decrypt</code> function that implements the steps shown in the diagram. The decrypted plaintext is the flag.</p><p>Yes, you can cheat on this challenge, but whereâ€™s the fun in that?</p><p>The code used in these exercises has been taken from Bo Zhuâ€™s super simple Python AES implementation, so weâ€™ve reproduced the license here.</p><h3 id="Analyze-6"><a href="#Analyze-6" class="headerlink" title="Analyze"></a>Analyze</h3><p>è¿™é¢˜æœ€å¤´ç–¼äº†ï¼Œå¼€å§‹æ²¡æ˜ç™½åˆ°åº•è¦å•¥ï¼Œçœ‹äº†åŠå¤©å‘ç°æ˜¯è¦è¡¥å…¨å¥½å‡ å¤„ä»£ç ï¼Œè€Œä¸”ç»™çš„ .py æ–‡ä»¶è¿˜å„ç§æŠ¥é”™ï¼Œå¾ˆçƒ¦åæ­£ã€‚</p><p>åé¢å‘ç°è¿™æ˜¯ AES åŸºç¡€çš„æœ€åä¸€é“ç›¸å½“äºæ€»ç»“çš„é¢˜ï¼Œå°±ç›´æ¥æŠŠå‰é¢å‡ é“é¢˜ç”¨åˆ°çš„å‡½æ•°å’ŒçŸ©é˜µå•¥çš„å…¨ç²˜è¿‡æ¥äº†ï¼Œç„¶åçœ‹äº†çœ‹æœ‰æ³¨é‡Šä½†æ²¡ä»£ç çš„åœ°æ–¹ï¼Œå‡ ä¹æ˜¯æŠŠå‰å‡ ä¸ªæ–‡ä»¶çš„ä»£ç æ‹¼åˆ°ä¸€èµ·å’¯ã€‚ç„¶ååŸºæœ¬å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ AESã€‚</p><p>è¿˜æœ‰ï¼Œå‰é¢æœ‰ä¸€é“é¢˜æåˆ°ç”¨äº† pwn åº“çš„ xor() å‡½æ•°ï¼Œç°åœ¨æƒ³ç»™è‡ªå·±åŸ‹å’¯ã€‚</p><p>æœ€åä»£ç ä¸€ç›´æŠ¥é”™ï¼Œçœ‹äº†çœ‹æ—¥å¿—ï¼Œæ‰‹å†™äº†ä¸€ä¸‹ xorï¼Œå±…ç„¶å°±å¾ˆé¡ºåˆ©äº†ï¼Ÿ</p><p>æŠŠ pwn åº“åŸ‹å’¯ï¼</p><p>ï¼ˆå› ä¸ºè¿™é¢˜éœ€è¦è‡ªå·±å†™çš„ä»£ç åˆ†å¸ƒæ¯”è¾ƒé›¶æ•£ï¼Œæ‰¾èµ·æ¥ä¹Ÿæ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥å¹²è„†æŠŠå…¨éƒ¨ä»£ç è´´ä¸Šæ¥ã€‚ï¼‰</p><h3 id="Code-4"><a href="#Code-4" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">N_ROUNDS = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;\xc3,\\\xa6\xb5\x80^\x0c\xdb\x8d\xa5z*\xb6\xfe\\&#x27;</span></span><br><span class="line">ciphertext = <span class="string">b&#x27;\xd1O\x14j\xa4+O\xb6\xa1\xc4\x08B)\x8f\x12\xdd&#x27;</span></span><br><span class="line">s_box = (</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line">    <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line">    <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line">    <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>,</span><br><span class="line">)</span><br><span class="line">inv_s_box = (</span><br><span class="line">    <span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6A</span>, <span class="number">0xD5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xA5</span>, <span class="number">0x38</span>, <span class="number">0xBF</span>, <span class="number">0x40</span>, <span class="number">0xA3</span>, <span class="number">0x9E</span>, <span class="number">0x81</span>, <span class="number">0xF3</span>, <span class="number">0xD7</span>, <span class="number">0xFB</span>,</span><br><span class="line">    <span class="number">0x7C</span>, <span class="number">0xE3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9B</span>, <span class="number">0x2F</span>, <span class="number">0xFF</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8E</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xC4</span>, <span class="number">0xDE</span>, <span class="number">0xE9</span>, <span class="number">0xCB</span>,</span><br><span class="line">    <span class="number">0x54</span>, <span class="number">0x7B</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xA6</span>, <span class="number">0xC2</span>, <span class="number">0x23</span>, <span class="number">0x3D</span>, <span class="number">0xEE</span>, <span class="number">0x4C</span>, <span class="number">0x95</span>, <span class="number">0x0B</span>, <span class="number">0x42</span>, <span class="number">0xFA</span>, <span class="number">0xC3</span>, <span class="number">0x4E</span>,</span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0x2E</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xD9</span>, <span class="number">0x24</span>, <span class="number">0xB2</span>, <span class="number">0x76</span>, <span class="number">0x5B</span>, <span class="number">0xA2</span>, <span class="number">0x49</span>, <span class="number">0x6D</span>, <span class="number">0x8B</span>, <span class="number">0xD1</span>, <span class="number">0x25</span>,</span><br><span class="line">    <span class="number">0x72</span>, <span class="number">0xF8</span>, <span class="number">0xF6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xD4</span>, <span class="number">0xA4</span>, <span class="number">0x5C</span>, <span class="number">0xCC</span>, <span class="number">0x5D</span>, <span class="number">0x65</span>, <span class="number">0xB6</span>, <span class="number">0x92</span>,</span><br><span class="line">    <span class="number">0x6C</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xFD</span>, <span class="number">0xED</span>, <span class="number">0xB9</span>, <span class="number">0xDA</span>, <span class="number">0x5E</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xA7</span>, <span class="number">0x8D</span>, <span class="number">0x9D</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x90</span>, <span class="number">0xD8</span>, <span class="number">0xAB</span>, <span class="number">0x00</span>, <span class="number">0x8C</span>, <span class="number">0xBC</span>, <span class="number">0xD3</span>, <span class="number">0x0A</span>, <span class="number">0xF7</span>, <span class="number">0xE4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xB8</span>, <span class="number">0xB3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0x2C</span>, <span class="number">0x1E</span>, <span class="number">0x8F</span>, <span class="number">0xCA</span>, <span class="number">0x3F</span>, <span class="number">0x0F</span>, <span class="number">0x02</span>, <span class="number">0xC1</span>, <span class="number">0xAF</span>, <span class="number">0xBD</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8A</span>, <span class="number">0x6B</span>,</span><br><span class="line">    <span class="number">0x3A</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4F</span>, <span class="number">0x67</span>, <span class="number">0xDC</span>, <span class="number">0xEA</span>, <span class="number">0x97</span>, <span class="number">0xF2</span>, <span class="number">0xCF</span>, <span class="number">0xCE</span>, <span class="number">0xF0</span>, <span class="number">0xB4</span>, <span class="number">0xE6</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x96</span>, <span class="number">0xAC</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xE7</span>, <span class="number">0xAD</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xE2</span>, <span class="number">0xF9</span>, <span class="number">0x37</span>, <span class="number">0xE8</span>, <span class="number">0x1C</span>, <span class="number">0x75</span>, <span class="number">0xDF</span>, <span class="number">0x6E</span>,</span><br><span class="line">    <span class="number">0x47</span>, <span class="number">0xF1</span>, <span class="number">0x1A</span>, <span class="number">0x71</span>, <span class="number">0x1D</span>, <span class="number">0x29</span>, <span class="number">0xC5</span>, <span class="number">0x89</span>, <span class="number">0x6F</span>, <span class="number">0xB7</span>, <span class="number">0x62</span>, <span class="number">0x0E</span>, <span class="number">0xAA</span>, <span class="number">0x18</span>, <span class="number">0xBE</span>, <span class="number">0x1B</span>,</span><br><span class="line">    <span class="number">0xFC</span>, <span class="number">0x56</span>, <span class="number">0x3E</span>, <span class="number">0x4B</span>, <span class="number">0xC6</span>, <span class="number">0xD2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9A</span>, <span class="number">0xDB</span>, <span class="number">0xC0</span>, <span class="number">0xFE</span>, <span class="number">0x78</span>, <span class="number">0xCD</span>, <span class="number">0x5A</span>, <span class="number">0xF4</span>,</span><br><span class="line">    <span class="number">0x1F</span>, <span class="number">0xDD</span>, <span class="number">0xA8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xC7</span>, <span class="number">0x31</span>, <span class="number">0xB1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7F</span>, <span class="number">0xA9</span>, <span class="number">0x19</span>, <span class="number">0xB5</span>, <span class="number">0x4A</span>, <span class="number">0x0D</span>, <span class="number">0x2D</span>, <span class="number">0xE5</span>, <span class="number">0x7A</span>, <span class="number">0x9F</span>, <span class="number">0x93</span>, <span class="number">0xC9</span>, <span class="number">0x9C</span>, <span class="number">0xEF</span>,</span><br><span class="line">    <span class="number">0xA0</span>, <span class="number">0xE0</span>, <span class="number">0x3B</span>, <span class="number">0x4D</span>, <span class="number">0xAE</span>, <span class="number">0x2A</span>, <span class="number">0xF5</span>, <span class="number">0xB0</span>, <span class="number">0xC8</span>, <span class="number">0xEB</span>, <span class="number">0xBB</span>, <span class="number">0x3C</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>,</span><br><span class="line">    <span class="number">0x17</span>, <span class="number">0x2B</span>, <span class="number">0x04</span>, <span class="number">0x7E</span>, <span class="number">0xBA</span>, <span class="number">0x77</span>, <span class="number">0xD6</span>, <span class="number">0x26</span>, <span class="number">0xE1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0C</span>, <span class="number">0x7D</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes2matrix</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Converts a 16-byte array into a 4x4 matrix.  &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">list</span>(text[i:i+<span class="number">4</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(text), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix2bytes</span>(<span class="params">matrix</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array.  &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">sum</span>(matrix, []))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">s, k</span>):</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">        [s[i][j] ^ k[i][j] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">s, sbox=s_box</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] = sbox[s[i][j]]</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_rows</span>(<span class="params">s</span>):</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_shift_rows</span>(<span class="params">s</span>):</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># learned from http://cs.ucsb.edu/~koc/cs178/projects/JT/aes.c</span></span><br><span class="line">xtime = <span class="keyword">lambda</span> a: (((a &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x1B</span>) &amp; <span class="number">0xFF</span>) <span class="keyword">if</span> (a &amp; <span class="number">0x80</span>) <span class="keyword">else</span> (a &lt;&lt; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_single_column</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="comment"># see Sec 4.1.2 in The Design of Rijndael</span></span><br><span class="line">    t = a[<span class="number">0</span>] ^ a[<span class="number">1</span>] ^ a[<span class="number">2</span>] ^ a[<span class="number">3</span>]</span><br><span class="line">    u = a[<span class="number">0</span>]</span><br><span class="line">    a[<span class="number">0</span>] ^= t ^ xtime(a[<span class="number">0</span>] ^ a[<span class="number">1</span>])</span><br><span class="line">    a[<span class="number">1</span>] ^= t ^ xtime(a[<span class="number">1</span>] ^ a[<span class="number">2</span>])</span><br><span class="line">    a[<span class="number">2</span>] ^= t ^ xtime(a[<span class="number">2</span>] ^ a[<span class="number">3</span>])</span><br><span class="line">    a[<span class="number">3</span>] ^= t ^ xtime(a[<span class="number">3</span>] ^ u)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_columns</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        mix_single_column(s[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_mix_columns</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="comment"># see Sec 4.1.3 in The Design of Rijndael</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        u = xtime(xtime(s[i][<span class="number">0</span>] ^ s[i][<span class="number">2</span>]))</span><br><span class="line">        v = xtime(xtime(s[i][<span class="number">1</span>] ^ s[i][<span class="number">3</span>]))</span><br><span class="line">        s[i][<span class="number">0</span>] ^= u</span><br><span class="line">        s[i][<span class="number">1</span>] ^= v</span><br><span class="line">        s[i][<span class="number">2</span>] ^= u</span><br><span class="line">        s[i][<span class="number">3</span>] ^= v</span><br><span class="line"></span><br><span class="line">    mix_columns(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">expand_key</span>(<span class="params">master_key</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Expands and returns a list of key matrices for the given master_key.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Round constants https://en.wikipedia.org/wiki/AES_key_schedule#Round_constants</span></span><br><span class="line">    r_con = (</span><br><span class="line">        <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>,</span><br><span class="line">        <span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>, <span class="number">0x6C</span>, <span class="number">0xD8</span>, <span class="number">0xAB</span>, <span class="number">0x4D</span>, <span class="number">0x9A</span>,</span><br><span class="line">        <span class="number">0x2F</span>, <span class="number">0x5E</span>, <span class="number">0xBC</span>, <span class="number">0x63</span>, <span class="number">0xC6</span>, <span class="number">0x97</span>, <span class="number">0x35</span>, <span class="number">0x6A</span>,</span><br><span class="line">        <span class="number">0xD4</span>, <span class="number">0xB3</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0xEF</span>, <span class="number">0xC5</span>, <span class="number">0x91</span>, <span class="number">0x39</span>,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Initialize round keys with raw key material.</span></span><br><span class="line">    key_columns = bytes2matrix(master_key)</span><br><span class="line">    iteration_size = <span class="built_in">len</span>(master_key) // <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Each iteration has exactly as many columns as the key material.</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(key_columns) &lt; (N_ROUNDS + <span class="number">1</span>) * <span class="number">4</span>:</span><br><span class="line">        <span class="comment"># Copy previous word.</span></span><br><span class="line">        word = <span class="built_in">list</span>(key_columns[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Perform schedule_core once every &quot;row&quot;.</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(key_columns) % iteration_size == <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># Circular shift.</span></span><br><span class="line">            word.append(word.pop(<span class="number">0</span>))</span><br><span class="line">            <span class="comment"># Map to S-BOX.</span></span><br><span class="line">            word = [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> word]</span><br><span class="line">            <span class="comment"># XOR with first byte of R-CON, since the others bytes of R-CON are 0.</span></span><br><span class="line">            word[<span class="number">0</span>] ^= r_con[i]</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">len</span>(master_key) == <span class="number">32</span> <span class="keyword">and</span> <span class="built_in">len</span>(key_columns) % iteration_size == <span class="number">4</span>:</span><br><span class="line">            <span class="comment"># Run word through S-box in the fourth iteration when using a</span></span><br><span class="line">            <span class="comment"># 256-bit key.</span></span><br><span class="line">            word = [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> word]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># XOR with equivalent word from previous iteration.</span></span><br><span class="line">        word = <span class="built_in">bytes</span>(i ^ j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(word, key_columns[-iteration_size]))</span><br><span class="line">        key_columns.append(word)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Group key words in 4x4 byte matrices.</span></span><br><span class="line">    <span class="keyword">return</span> [key_columns[<span class="number">4</span> * i: <span class="number">4</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key_columns) // <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">key, ciphertext</span>):</span><br><span class="line">    round_keys = expand_key(key)  <span class="comment"># Remember to start from the last round key and work backwards through them when decrypting</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Convert ciphertext to state matrix</span></span><br><span class="line">    state = bytes2matrix(ciphertext)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Initial add round key step</span></span><br><span class="line">    state = add_round_key(state, round_keys[-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N_ROUNDS - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">        inv_shift_rows(state)</span><br><span class="line">        state = sub_bytes(state, inv_s_box)</span><br><span class="line">        state = add_round_key(state, round_keys[i])</span><br><span class="line">        inv_mix_columns(state)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Run final round (skips the InvMixColumns step)</span></span><br><span class="line">    inv_shift_rows(state)</span><br><span class="line">    state = sub_bytes(state, inv_s_box)</span><br><span class="line">    state = add_round_key(state, round_keys[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Convert state matrix to plaintext</span></span><br><span class="line">    <span class="keyword">return</span> matrix2bytes(state)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypt(key, ciphertext))</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç¬¬ä¸‰ç« å¥½åƒæ˜¯åšçš„æœ€è¿·çš„&lt;/p&gt;
    
    </summary>
    
      <category term="å­¦ä¹ " scheme="http://smilin9.com/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="cryptohack" scheme="http://smilin9.com/tags/cryptohack/"/>
    
  </entry>
  
  <entry>
    <title>Modular Arithmetic</title>
    <link href="http://smilin9.com/2022/05/03/Modular%20Arithmetic/"/>
    <id>http://smilin9.com/2022/05/03/Modular Arithmetic/</id>
    <published>2022-05-03T11:56:00.000Z</published>
    <updated>2022-06-17T01:14:47.772Z</updated>
    
    <content type="html"><![CDATA[<p>ç¬¬äºŒç« ä¹Ÿåšå®Œå’¯~</p><span id="more"></span><p>çœ‹åˆ°è¿™ç« çš„æ ‡é¢˜å°±æ„Ÿè§‰è¦å¯„ã€‚</p><p>è¿›å»ä¸€çœ‹æœç„¶ï¼Œå…¨æ˜¯æ•°å­¦ã€‚ã€‚ï¼ˆæ•°å­¦åºŸç‰©ç¬‘ä¸å‡ºæ¥</p><p>åšäº†è¿‘ä¸¤å¤©ï¼Œæˆ‘åªèƒ½è¯´æ•°å­¦åšå¤§ç²¾æ·±ï¼Œåšæ•°å­¦é¢˜çœŸçš„ä¼šè°¢ã€‚ã€‚</p><p>äº¤å®Œæœ€åä¸€é¢˜çš„ flag è§‰å¾—æ•´ä¸ªäººéƒ½æ”¾æ¾ä¸‹æ¥äº†ï¼Œç„¶åå°±æ„Ÿè§‰ç²¾ç–²åŠ›å°½ã€‚</p><p>åšçš„å¾ˆè‰°éš¾ï¼Œå°¤å…¶ python ç”¨çš„è¿˜æ˜¯é‚£ä¹ˆä¸åˆ©ç´¢ã€‚</p><p>ç”±äºæœ‰äº›é¢˜çš„ä»£ç æ˜¯é€šè¿‡æ¨å¯¼ä¹‹åç›´æ¥é€šè¿‡æ•°å­¦å®šç†åŒ–ç®€ï¼Œæ‰€ä»¥ä»£ç å¾ˆç®€å•ã€‚</p><h1 id="Modular-Arithmetic"><a href="#Modular-Arithmetic" class="headerlink" title="Modular Arithmetic"></a>Modular Arithmetic</h1><h2 id="Greatest-Common-Divisor"><a href="#Greatest-Common-Divisor" class="headerlink" title="Greatest Common Divisor"></a>Greatest Common Divisor</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>The Greatest Common Divisor (GCD), sometimes known as the highest common factor, is the largest number which divides two positive integers (a,b).</p><p>For <code>a = 12, b = 8</code> we can calculate the divisors of a: <code>&#123;1,2,3,4,6,12&#125;</code> and the divisors of b: <code>&#123;1,2,4,8&#125;</code>. Comparing these two, we see that <code>gcd(a,b) = 4</code>.</p><p>Now imagine we take <code>a = 11, b = 17</code>. Both <code>a</code> and <code>b</code> are prime numbers. As a prime number has only itself and <code>1</code> as divisors, <code>gcd(a,b) = 1</code>.</p><p>We say that for any two integers <code>a,b</code>, if <code>gcd(a,b) = 1</code> then <code>a</code> and <code>b</code> are coprime integers.</p><p>If <code>a</code> and <code>b</code> are prime, they are also coprime. If <code>a</code> is prime and <code>b &lt; a</code> then <code>a</code> and <code>b</code> are coprime.</p><blockquote><p>Think about the case for <code>a</code> prime and <code>b &gt; a</code>, why are these not necessarily coprime?</p></blockquote><p>There are many tools to calculate the GCD of two integers, but for this task we recommend looking up <a href="https://en.wikipedia.org/wiki/Euclidean_algorithm">Euclidâ€™s Algorithm</a>.</p><p>Try coding it up; itâ€™s only a couple of lines. Use <code>a = 12, b = 8</code> to test it.</p><p>Now calculate <code>gcd(a,b)</code> for <code>a = 66528, b = 52920</code> and enter it below.</p><h3 id="Analyze"><a href="#Analyze" class="headerlink" title="Analyze"></a>Analyze</h3><p>å°±æ˜¯ç®—æœ€å¤§å…¬çº¦æ•°å•¦ï¼Œç®€å•å†™ä¸ªå‡½æ•°å°±å¥½å’¯ã€‚</p><p>ç°åœ¨å†çœ‹è¿™é¢˜æ˜¯çœŸç®€å•å•Šã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">a: <span class="built_in">int</span>, b: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, b = b, a % b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">b = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="built_in">print</span>(gcd(a, b))</span><br></pre></td></tr></table></figure><h3 id="SumUp"><a href="#SumUp" class="headerlink" title="SumUp"></a>SumUp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œæ˜¯ C è¯­è¨€åšè¿‡çš„ä¸œè¥¿</span></span><br><span class="line"><span class="comment"># functionï¼š gcd(a, b)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">a: <span class="built_in">int</span>, b: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, b = b, a % b</span><br><span class="line">    <span class="keyword">return</span> a</span><br></pre></td></tr></table></figure><h2 id="Extended-GCD"><a href="#Extended-GCD" class="headerlink" title="Extended GCD"></a>Extended GCD</h2><h3 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h3><p>Let <code>a</code> and <code>b</code> be positive integers.</p><p>The extended Euclidean algorithm is an efficient way to find integers <code>u,v</code> such that</p><figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line"><span class="keyword">a</span> * u + b * v = gcd(<span class="keyword">a</span>,b)</span><br></pre></td></tr></table></figure><blockquote><p>Later, when we learn to decrypt RSA, we will need this algorithm to calculate the modular inverse of the public exponent.</p></blockquote><p>Using the two primes <code>p = 26513, q = 32321</code>, find the integers <code>u,v</code> such that</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">p <span class="emphasis">* u + q *</span> v = gcd(p,q)</span><br></pre></td></tr></table></figure><p>Enter whichever of <code>u</code> and <code>v</code> is the lower number as the flag.</p><blockquote><p>Knowing that <code>p,q</code> are prime, what would you expect <code>gcd(p,q)</code> to be? For more details on the extended Euclidean algorithm, check out <a href="http://www-math.ucdenver.edu/~wcherowi/courses/m5410/exeucalg.html">this page</a>.</p></blockquote><h3 id="Analyze-1"><a href="#Analyze-1" class="headerlink" title="Analyze"></a>Analyze</h3><p>ç”¨åˆ°æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œæ•°å­¦åŸç†å’Œè¾—è½¬ç›¸é™¤å¤§åŒå°å¼‚ï¼Œç®€å•ä»£ä¸‹æ•°å­—æ‰‹æ¨ä¸€éè¯¦ç»†è¿‡ç¨‹å°±çŸ¥é“æ€ä¹ˆå›äº‹å’¯ã€‚</p><h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">exgcd</span>(<span class="params">a: <span class="built_in">int</span>, b: <span class="built_in">int</span></span>) -&gt; (<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>):</span><br><span class="line">    <span class="keyword">if</span> a &lt; b:</span><br><span class="line">        t = a</span><br><span class="line">        a = b</span><br><span class="line">        b = t</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> a, <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, x, y = exgcd(b, a % b)</span><br><span class="line">        <span class="keyword">return</span> g, y, x - (a // b) * y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">b = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="built_in">print</span>(exgcd(a, b))</span><br></pre></td></tr></table></figure><h3 id="SumUp-1"><a href="#SumUp-1" class="headerlink" title="SumUp"></a>SumUp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‰©å±•æ¬§å‡ é‡Œå¾—ï¼Œä¸é™åˆ¶è¾“å…¥çš„å¤§å°é¡ºåº</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exgcd</span>(<span class="params">a: <span class="built_in">int</span>, b: <span class="built_in">int</span></span>) -&gt; (<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>):</span><br><span class="line">    <span class="keyword">if</span> a &lt; b:</span><br><span class="line">        t = a</span><br><span class="line">        a = b</span><br><span class="line">        b = t</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> a, <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, x, y = exgcd(b, a % b)</span><br><span class="line">        <span class="keyword">return</span> g, y, x - (a // b) * y</span><br><span class="line"><span class="comment"># ax0 + by0 = gcd(a, b)</span></span><br><span class="line"><span class="comment"># è¾“å…¥ a, b</span></span><br><span class="line"><span class="comment"># è¾“å‡º g, x0, y0</span></span><br><span class="line"><span class="comment"># å…¶ä¸­ g = gcd(a, b)</span></span><br></pre></td></tr></table></figure><h2 id="Modular-Arithmetic-1"><a href="#Modular-Arithmetic-1" class="headerlink" title="Modular Arithmetic 1"></a>Modular Arithmetic 1</h2><h3 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h3><p>Imagine you lean over and look at a cryptographerâ€™s notebook. You see some notes in the margin:</p><figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="symbol">4 </span>+ <span class="number">9</span> = <span class="number">1</span></span><br><span class="line"><span class="symbol">5 </span>- <span class="number">7</span> = <span class="number">10</span></span><br><span class="line"><span class="symbol">2 </span>+ <span class="number">3</span> = <span class="number">5</span></span><br></pre></td></tr></table></figure><p>At first you might think theyâ€™ve gone mad. Maybe this is why there are so many data leaks nowadays youâ€™d think, but this is nothing more than modular arithmetic modulo 12 (albeit with some sloppy notation).</p><p>You may not have been calling it modular arithmetic, but youâ€™ve been doing these kinds of calculations since you learnt to tell the time (look again at those equations and think about adding hours).</p><p>Formally, â€œcalculating timeâ€ is described by the theory of congruences. We say that two integers are congruent modulo m if <code>a â‰¡ b mod m</code>.</p><p>Another way of saying this, is that when we divide the integer <code>a</code> by <code>m</code>, the remainder is <code>b</code>. This tells you that if m divides a (this can be written as <code>m | a</code>) then <code>a â‰¡ 0 mod m</code>.</p><p>Calculate the following integers:</p><figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="symbol">11 </span>â‰¡ x <span class="keyword">mod</span> <span class="number">6</span></span><br><span class="line"><span class="symbol">8146798528947 </span>â‰¡ y <span class="keyword">mod</span> <span class="number">17</span></span><br></pre></td></tr></table></figure><p>The solution is the smaller of the two integers.</p><h3 id="Analyze-2"><a href="#Analyze-2" class="headerlink" title="Analyze"></a>Analyze</h3><p>æ¨¡è¿ç®—æ¥äº†ï¼Œå¤´å¤§ã€‚åé¢å…¨æ˜¯å’Œæ¨¡è¿ç®—æœ‰å…³çš„ï¼ˆå‡†ç¡®æ¥è¯´è¿™ä¸€æ•´ç« éƒ½æ˜¯</p><p>è¿™é“ç®—ç®€å•ï¼Œå–ä½™ç®—ä¸€ä¸‹ x å’Œ yï¼Œç„¶åæŒ‰è¦æ±‚è¾“å‡ºå°çš„ã€‚æ²¡å•¥å¥½æ€è€ƒçš„æã€‚</p><h3 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">8146798528947</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">min</span>(n % <span class="number">17</span>, <span class="number">11</span> % <span class="number">6</span>))</span><br></pre></td></tr></table></figure><h2 id="Modular-Arithmetic-2"><a href="#Modular-Arithmetic-2" class="headerlink" title="Modular Arithmetic 2"></a>Modular Arithmetic 2</h2><h3 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h3><p>Weâ€™ll pick up from the last challenge and imagine weâ€™ve picked a modulus <code>p</code>, and we will restrict ourselves to the case when <code>p</code> is prime.</p><p>The integers modulo <code>p</code> define a field, denoted <code>Fp</code>.</p><blockquote><p>If the modulus is not prime, the set of integers modulo <code>n</code> define a ring.</p></blockquote><p>A finite field <code>Fp</code> is the set of integers <code>&#123;0,1,...,p-1&#125;</code>, and under both addition and multiplication there is an inverse element <code>b</code> for every element <code>a</code> in the set, such that <code>a + b = 0</code> and <code>a * b = 1</code>.</p><blockquote><p>Note that the identity element for addition and multiplication is different! This is because the identity when acted with the operator should do nothing: <code>a + 0 = a</code> and <code>a * 1 = a</code>.</p></blockquote><p>Lets say we pick <code>p = 17</code>. Calculate <code>317 mod 17</code>. Now do the same but with <code>517 mod 17</code>.</p><p>What would you expect to get for <code>716 mod 17</code>? Try calculating that.</p><p>This interesting fact is known as Fermatâ€™s little theorem. Weâ€™ll be needing this (and its generalisations) when we look at RSA cryptography.</p><p>Now take the prime <code>p = 65537</code>. Calculate <code>27324678765465536 mod 65537</code>.</p><p>Did you need a calculator?</p><h3 id="Analyze-3"><a href="#Analyze-3" class="headerlink" title="Analyze"></a>Analyze</h3><p>è´¹é©¬å°å®šç†ï¼Œè›®æœ‰æ„æ€çš„ä¸€ä¸ªå…¬å¼ã€‚</p><p>$a^{p} \equiv a \mod p$ï¼Œæµ…æµ…å˜å½¢ä¸€ä¸‹ï¼š$a^{p-1} \equiv 1 \mod p$</p><p>ä¸»è¦é¢˜ç›®æè¿°è¿™ä¸ªå®šç†çš„æ—¶å€™ç•¥å¾®æœ‰ä¸€ç‚¹å†™å¤æ‚å’¯ï¼Œä¸å¤Ÿä¼˜é›…ï¼ˆ bushiã€‚</p><p>è¿™ä¹ˆæ¨å¯¼å‡ºæ¥å…¶å®æ²¡æœ‰å†™ä»£ç çš„å¿…è¦ã€‚</p><h3 id="Code-3"><a href="#Code-3" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = <span class="number">273246787654</span></span><br><span class="line">p = <span class="number">65537</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">1</span> % p)</span><br><span class="line"></span><br><span class="line"><span class="comment"># a^(p-1) â‰¡ 1(mod p)</span></span><br></pre></td></tr></table></figure><h2 id="Modular-Inverting"><a href="#Modular-Inverting" class="headerlink" title="Modular Inverting"></a>Modular Inverting</h2><h3 id="Description-4"><a href="#Description-4" class="headerlink" title="Description"></a>Description</h3><p>As weâ€™ve seen, we can work within a finite field <code>Fp</code>, adding and multiplying elements, and always obtain another element of the field.</p><p>For all elements <code>g</code> in the field, there exists a unique integer <code>d</code> such that <code>g * d â‰¡ 1 mod p</code>.</p><p>This is the multiplicative inverse of <code>g</code>.</p><p><strong>Example</strong>: <code>7 * 8 = 56 â‰¡ 1 mod 11</code></p><p>What is the inverse element: <code>3 * d â‰¡ 1 mod 13</code>?</p><blockquote><p>Think about the little theorem we just worked with. How does this help you find the inverse of an element?</p></blockquote><h3 id="Analyze-4"><a href="#Analyze-4" class="headerlink" title="Analyze"></a>Analyze</h3><p>æ¨¡é€†è¿ç®—ï¼ŒåŒä½™è¿™å—çš„çŸ¥è¯†ã€‚ä¸»è¦æ˜¯æ¬§æ‹‰å®šç†å’Œè´¹é©¬å°å®šç†çš„åº”ç”¨ã€‚</p><p>æ¬§æ‹‰å®šç†ï¼š$a^{Ï†(n)} \equiv 1 \mod n$</p><p>è´¹é©¬å°å®šç†ï¼š$a^{p-1} \equiv 1 \mod p$</p><p>å¯¹äºè¿™é“é¢˜ï¼Œæœ‰ $3 * d \equiv 1 \mod 13$</p><p>å› ä¸º gcd(3, 13) &#x3D; 1ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å¾—$$d\ &#x3D;\ 3^{Ï†(13)-1}\ *\ 1&#x3D;3^{11} \mod 13$$ </p><p>python çš„ pow() å‡½æ•°çœŸçš„å¾ˆå¥½ç”¨ï¼</p><h3 id="Code-4"><a href="#Code-4" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d = <span class="built_in">pow</span> (<span class="number">3</span>, <span class="number">11</span>, <span class="number">13</span>)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br></pre></td></tr></table></figure><h3 id="SumUp-2"><a href="#SumUp-2" class="headerlink" title="SumUp"></a>SumUp</h3><p>$Ï†(n)$ å³ <code>1 ~ (n-1)</code> èŒƒå›´å†…ä¸ n äº’ç´ çš„æ•°çš„ä¸ªæ•°ï¼Œè‹¥ n æœ¬èº«ä¸ºç´ æ•°ï¼Œåˆ™ $Ï†(n)&#x3D;n-1$ ã€‚</p><h2 id="Quadratic-Residues"><a href="#Quadratic-Residues" class="headerlink" title="Quadratic Residues"></a>Quadratic Residues</h2><h3 id="Description-5"><a href="#Description-5" class="headerlink" title="Description"></a>Description</h3><p>Weâ€™ve looked at multiplication and division in modular arithmetic, but what does it mean to take the square root modulo an integer?</p><p>For the following discussion, letâ€™s work modulo <code>p = 29</code>. We can take the integer <code>a = 11</code> and calculate <code>aÂ² = 5 mod 29</code>.</p><p>As <code>a = 11, aÂ² = 5</code>, we say the square root of <code>5</code> is <code>11</code>.</p><p>This feels good, but now letâ€™s think about the square root of <code>18</code>. From the above, we know we need to find some integer <code>a</code> such that <code>aÂ² = 18</code></p><p>Your first idea might be to start with <code>a = 1</code> and loop to <code>a = p-1</code>. In this discussion <code>p</code> isnâ€™t too large and we can quickly look.</p><p>Have a go, try coding this and see what you find. If youâ€™ve coded it right, youâ€™ll find that for all <code>a âˆˆ Fp*</code> you never find an <code>a</code> such that <code>aÂ² = 18</code>.</p><p>What we are seeing, is that for the elements of <code>F*p</code>, not every element has a square root. In fact, what we find is that for roughly one half of the elements of <code>Fp*</code>, there is no square root.</p><blockquote><p>We say that an integer <code>x</code> is a <em>Quadratic Residue</em> if there exists an <code>a</code> such that <code>aÂ² = x mod p</code>. If there is no such solution, then the integer is a <em>Quadratic Non-Residue</em>.</p></blockquote><p>In other words, <code>x</code> is a quadratic residue when it is possible to take the square root of <code>x</code> modulo an integer <code>p</code>.</p><p>In the below list there are two non-quadratic residues and one quadratic residue.</p><p>Find the quadratic residue and then calculate its square root. Of the two possible roots, submit the smaller one as the flag.</p><blockquote><p>If <code>aÂ² = x</code> then (-a)Â² &#x3D; x. So if <code>x</code> is a quadratic residue in some finite field, then there are always two solutions for <code>a</code>.</p></blockquote><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">p</span> = <span class="number">29</span></span><br><span class="line"><span class="attr">ints</span> = [<span class="number">14</span>, <span class="number">6</span>, <span class="number">11</span>]</span><br></pre></td></tr></table></figure><h3 id="Analyze-5"><a href="#Analyze-5" class="headerlink" title="Analyze"></a>Analyze</h3><p>Legendre ç¬¦å·ï¼ˆæ¬§æ‹‰åˆ¤åˆ«æ³•ï¼‰çš„å†…å®¹ï¼ŒäºŒæ¬¡å‰©ä½™ã€‚</p><p>å®šä¹‰ï¼šå¦‚æœ $a^2 \equiv x \mod p$ æœ‰è§£ï¼Œåˆ™ x æ˜¯æ¨¡ p çš„äºŒæ¬¡å‰©ä½™ï¼Œå¦åˆ™ç§°ä¸ºäºŒæ¬¡éå‰©ä½™,ã€‚</p><p>Given: p, x[]</p><p>Asked: æ‰¾å‡ºäºŒæ¬¡å‰©ä½™ï¼Œå¹¶æ±‚å‡ºå¹³æ–¹æ ¹ã€‚</p><p>éå† x in range(1, p)ï¼Œè®¡ç®— x çš„å¹³æ–¹æ¨¡ pï¼Œå¹¶ä¸ ints[] ä¸­çš„å…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œæ‰¾å‡ºæ¨¡ p çš„äºŒæ¬¡å‰©ä½™ï¼Œæ­¤æ—¶çš„ x å³ä¸ºè¯¥äºŒæ¬¡å‰©ä½™çš„å¹³æ–¹æ ¹ã€‚</p><p>å…¬å¼å’Œé¢˜é‡Œçš„ a å’Œ x å‚æ•°çœŸçš„å¾ˆå®¹æ˜“å¼„æ··ï¼Œç†äº†åŠå¤©æ‰ç†æ¸…æ¥š ã€‚ã€‚</p><h3 id="Code-5"><a href="#Code-5" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = <span class="number">29</span></span><br><span class="line">ints = [<span class="number">14</span>, <span class="number">6</span>, <span class="number">11</span>]</span><br><span class="line">flag = <span class="built_in">min</span>(x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, p) <span class="keyword">if</span> <span class="built_in">pow</span>(x, <span class="number">2</span>, p) <span class="keyword">in</span> ints)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="Legendre-Symbol"><a href="#Legendre-Symbol" class="headerlink" title="Legendre Symbol"></a>Legendre Symbol</h2><h3 id="Description-6"><a href="#Description-6" class="headerlink" title="Description"></a>Description</h3><p>In Quadratic Residues we learnt what it means to take the square root modulo an integer. We also saw that taking a root isnâ€™t always possible.</p><p>In the previous case when <code>p = 29</code>, even the simplest method of calculating the square root was fast enough, but as <code>p</code> gets larger, this method becomes wildly unreasonable.</p><p>Lucky for us, we have a way to check whether an integer is a quadratic residue with a single calculation thanks to Legendre. In the following, we will assume we are working modulo a prime <code>p</code>.</p><p>Before looking at Legendreâ€™s symbol, letâ€™s take a brief detour to see an interesting property of quadratic (non-)residues.</p><figure class="highlight mathematica"><table><tr><td class="code"><pre><span class="line"><span class="variable">Quadratic</span> <span class="built_in">Residue</span> <span class="operator">*</span> <span class="variable">Quadratic</span> <span class="built_in">Residue</span> <span class="operator">=</span> <span class="variable">Quadratic</span> <span class="built_in">Residue</span></span><br><span class="line"><span class="variable">Quadratic</span> <span class="built_in">Residue</span> <span class="operator">*</span> <span class="variable">Quadratic</span> <span class="variable">Non</span><span class="operator">-</span><span class="variable">residue</span> <span class="operator">=</span> <span class="variable">Quadratic</span> <span class="variable">Non</span><span class="operator">-</span><span class="variable">residue</span></span><br><span class="line"><span class="variable">Quadratic</span> <span class="variable">Non</span><span class="operator">-</span><span class="variable">residue</span> <span class="operator">*</span> <span class="variable">Quadratic</span> <span class="variable">Non</span><span class="operator">-</span><span class="variable">residue</span> <span class="operator">=</span> <span class="variable">Quadratic</span> <span class="built_in">Residue</span></span><br></pre></td></tr></table></figure><blockquote><p>Want an easy way to remember this? Replace â€œQuadratic Residueâ€ with <code>+1</code> and â€œQuadratic Non-residueâ€ with <code>-1</code>, all three results are the same!</p></blockquote><p>So whatâ€™s the trick? The <a href="https://en.wikipedia.org/wiki/Legendre_symbol">Legendre Symbol</a> gives an efficient way to determine whether an integer is a quadratic residue modulo an odd prime <code>p</code>.</p><p>Legendreâ€™s Symbol: <code>(a / p) â‰¡ a(p-1)/2 mod p</code> obeys:</p><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">(<span class="selector-tag">a</span> / p) = <span class="number">1</span> <span class="keyword">if</span> <span class="selector-tag">a</span> is <span class="selector-tag">a</span> quadratic residue and <span class="selector-tag">a</span> â‰¢ <span class="number">0</span> mod <span class="selector-tag">p</span></span><br><span class="line">(<span class="selector-tag">a</span> / p) = -<span class="number">1</span> <span class="keyword">if</span> <span class="selector-tag">a</span> is <span class="selector-tag">a</span> quadratic non-residue mod <span class="selector-tag">p</span></span><br><span class="line">(<span class="selector-tag">a</span> / p) = <span class="number">0</span> <span class="keyword">if</span> <span class="selector-tag">a</span> â‰¡ <span class="number">0</span> mod p</span><br></pre></td></tr></table></figure><p>Which means given any integer <code>a</code>, calculating <code>pow(a,(p-1)/2,p)</code> is enough to determine if <code>a</code> is a quadratic residue.</p><p>Now for the flag. Given the following 1024 bit prime and 10 integers, find the quadratic residue and then calculate its square root; the square root is your flag. Of the two possible roots, submit the larger one as your answer.</p><blockquote><p>So Legendreâ€™s symbol tells us which integer is a quadratic residue, but how do we find the square root?! The prime supplied obeys <code>p = 3 mod 4</code>, which allows us easily compute the square root. The answer is online, but you can figure it out yourself if you think about Fermatâ€™s little theorem.</p></blockquote><h3 id="Analyze-6"><a href="#Analyze-6" class="headerlink" title="Analyze"></a>Analyze</h3><p>Legendre ç¬¦å·çš„æ¬§æ‹‰åˆ¤åˆ«æ³•ã€‚</p><p>$$\left(\frac{a}{p}\right)&#x3D;\begin{cases}1, &amp;a â‰¢ 0 \mod p\text{ ä¸” }a\text{ æ˜¯æ¨¡ }p\text{ çš„äºŒæ¬¡å‰©ä½™} \\ -1, &amp;a â‰¢ 0 \mod p\text{ ä¸” }a\text{ æ˜¯æ¨¡ }p\text{ çš„äºŒæ¬¡éå‰©ä½™} \\ 0, &amp;a â‰¡0 \mod p \end{cases}$$</p><p>æ¬§æ‹‰åˆ¤åˆ«æ³•å†…å®¹ï¼š$(a&#x2F;p) \equiv a^{(p-1)&#x2F;2} \mod p$ã€‚</p><p>éå† ints åˆ¤æ–­å„è‡ªå¯¹åº”çš„ $(a&#x2F;p)$ æ˜¯å¦ç­‰äº 1ï¼Œå¾—åˆ°äºŒæ¬¡å‰©ä½™ a ä¹‹åè®¡ç®—å¹³æ–¹æ ¹ $a^{(p+1)&#x2F;4} \mod p$ ã€‚</p><h3 id="Code-6"><a href="#Code-6" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = <span class="number">101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139</span></span><br><span class="line">ints = [<span class="number">25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803</span>, <span class="number">45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555</span>, <span class="number">17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325</span>, <span class="number">14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863</span>, <span class="number">4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318</span>, <span class="number">85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771</span>, <span class="number">50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987</span>, <span class="number">96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871</span>, <span class="number">4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721</span>, <span class="number">18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565</span>]</span><br><span class="line"></span><br><span class="line">res = [x <span class="keyword">for</span> x <span class="keyword">in</span> ints <span class="keyword">if</span> <span class="built_in">pow</span>(x, (p-<span class="number">1</span>)//<span class="number">2</span>, p) == <span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(res, (p + <span class="number">1</span>)//<span class="number">4</span>, p))</span><br></pre></td></tr></table></figure><h2 id="Modular-Square-Root"><a href="#Modular-Square-Root" class="headerlink" title="Modular Square Root"></a>Modular Square Root</h2><h3 id="Description-7"><a href="#Description-7" class="headerlink" title="Description"></a>Description</h3><p>In Legendre Symbol we introduced a fast way to determine whether a number is a square root modulo a prime. We can go further: there are algorithms for efficiently calculating such roots. The best one in practice is called Tonelli-Shanks, which gets its funny name from the fact that it was first described by an Italian in the 19th century and rediscovered independently by Daniel Shanks in the 1970s.</p><p>All primes that arenâ€™t 2 are of the form <code>p â‰¡ 1 mod 4</code> or <code>p â‰¡ 3 mod 4</code>, since all odd numbers obey these congruences. As the previous challenge hinted, in the <code>p â‰¡ 3 mod 4</code> case, a really simple formula for computing square roots can be <a href="https://crypto.stackexchange.com/a/20994">derived</a> directly from Fermatâ€™s little theorem. That leaves us still with the <code>p â‰¡ 1 mod 4</code> case, so a more general algorithm is required.</p><p>In a congruence of the form <code>rÂ² â‰¡ a mod p</code>, Tonelli-Shanks calculates <code>r</code>.</p><blockquote><p>Tonelli-Shanks doesnâ€™t work for composite (non-prime) moduli. Finding square roots modulo composites is computationally equivalent to integer factorization.</p></blockquote><p>The main use-case for this algorithm is finding elliptic curve co-ordinates. Its operation is somewhat complex so weâ€™re not going to discuss the details, however, implementations are easy to find and Sage has one built-in.</p><p>Find the square root of <code>a</code> modulo the 2048-bit prime <code>p</code>. Give the smaller of the two roots as your answer.</p><h3 id="Analyze-7"><a href="#Analyze-7" class="headerlink" title="Analyze"></a>Analyze</h3><p>sympy æ¨¡å—å†…æœ‰å°è£…å¥½çš„å‡½æ•°å¯ä»¥è®¡ç®—äºŒæ¬¡å‰©ä½™ã€‚</p><p>å‡½æ•° nthroot_mod(a, n, p) ç”¨äºæ±‚è§£äº $x^{n} \equiv a\ mod\ p$ çš„åŒä½™å¼ã€‚</p><p>é¢˜ç›®ç»™äº†è¡¨è¾¾å¼ $r^2 \equiv a\ mod\ p$ï¼Œæ±‚ rã€‚</p><p>å†™äº†åŠå¤©å‡½æ•°å¿ƒæ€çˆ†ç‚¸ï¼Œç„¶åæœäº†ä¸‹ python ç›¸å…³çš„åº“ï¼Œå‡ è¡Œå°±è§£å†³ã€‚</p><p>å†æ¬¡æ„Ÿå¹ï¼Œpython çœŸæ˜¯ä¸ªå¥½ä¸œè¥¿ã€‚</p><h3 id="Code-7"><a href="#Code-7" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line">a = <span class="number">8479994658316772151941616510097127087554541274812435112009425778595495359700244470400642403747058566807127814165396640215844192327900454116257979487432016769329970767046735091249898678088061634796559556704959846424131820416048436501387617211770124292793308079214153179977624440438616958575058361193975686620046439877308339989295604537867493683872778843921771307305602776398786978353866231661453376056771972069776398999013769588936194859344941268223184197231368887060609212875507518936172060702209557124430477137421847130682601666968691651447236917018634902407704797328509461854842432015009878011354022108661461024768</span></span><br><span class="line">p = <span class="number">30531851861994333252675935111487950694414332763909083514133769861350960895076504687261369815735742549428789138300843082086550059082835141454526618160634109969195486322015775943030060449557090064811940139431735209185996454739163555910726493597222646855506445602953689527405362207926990442391705014604777038685880527537489845359101552442292804398472642356609304810680731556542002301547846635101455995732584071355903010856718680732337369128498655255277003643669031694516851390505923416710601212618443109844041514942401969629158975457079026906304328749039997262960301209158175920051890620947063936347307238412281568760161</span></span><br><span class="line">r = sympy.nthroot_mod(a, <span class="number">2</span>, p)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br></pre></td></tr></table></figure><h3 id="SumUp-3"><a href="#SumUp-3" class="headerlink" title="SumUp"></a>SumUp</h3><p>$x^{n} \equiv a\ mod\ p$ï¼Œæ±‚ x</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># function:</span></span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.residue_ntheory <span class="keyword">import</span> nthroot_mod</span><br><span class="line">x = nthroot_mod(a, n, p)</span><br></pre></td></tr></table></figure><h2 id="Chinese-Remainder-Theorem"><a href="#Chinese-Remainder-Theorem" class="headerlink" title="Chinese Remainder Theorem"></a>Chinese Remainder Theorem</h2><h3 id="Description-8"><a href="#Description-8" class="headerlink" title="Description"></a>Description</h3><p>The Chinese Remainder Theorem gives a unique solution to a set of linear congruences if their moduli are coprime.</p><p>This means, that given a set of arbitrary integers <code>ai</code>, and pairwise coprime integers <code>ni</code>, such that the following linear congruences hold:</p><blockquote><p>Note â€œpairwise coprime integersâ€ means that if we have a set of integers <code>&#123;n1, n2, ..., ni&#125;</code>, all pairs of integers selected from the set are coprime: <code>gcd(ni, nj) = 1</code>.</p></blockquote><figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">x â‰¡ a1 <span class="keyword">mod</span> n1</span><br><span class="line">x â‰¡ a2 <span class="keyword">mod</span> n2</span><br><span class="line">...</span><br><span class="line">x â‰¡ <span class="keyword">an</span> <span class="keyword">mod</span> nn</span><br></pre></td></tr></table></figure><p>There is a unique solution <code>x â‰¡ a mod N</code> where <code>N = n1 * n2 * ... * nn</code>.</p><p>In cryptography, we commonly use the Chinese Remainder Theorem to help us reduce a problem of very large integers into a set of several, easier problems.</p><p>Given the following set of linear congruences:</p><figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">x</span> â‰¡ <span class="number">2</span> mod <span class="number">5</span></span><br><span class="line"><span class="attribute">x</span> â‰¡ <span class="number">3</span> mod <span class="number">11</span></span><br><span class="line"><span class="attribute">x</span> â‰¡ <span class="number">5</span> mod <span class="number">17</span></span><br></pre></td></tr></table></figure><p>Find the integer <code>a</code> such that <code>x â‰¡ a mod 935</code></p><blockquote><p>Starting with the congruence with the largest modulus, use that for <code>x â‰¡ a mod p</code> we can write <code>x = a + k*p</code> for arbitrary integer <code>k</code>.</p></blockquote><h3 id="Analyze-8"><a href="#Analyze-8" class="headerlink" title="Analyze"></a>Analyze</h3><p>ä¸­å›½å‰©ä½™å®šç†ï¼Œä¹Ÿå«å­™å­å®šç†ã€‚ä¸»è¦é’ˆå¯¹åŒä½™æ–¹ç¨‹ç»„çš„æ±‚è§£é—®é¢˜ã€‚</p><p>YouTube ä¸Šæ‰¾äº†ä¸ªè§†é¢‘çœ‹äº†åŸç†ï¼Œè·Ÿç€è§†é¢‘æ‰‹ç®—å‡ºæ¥äº†ç»“æœï¼Œæ„Ÿè§‰è·Ÿç€ä¾‹é¢˜ä¸€æ­¥æ­¥ç®—çœŸçš„èƒ½åŠ æ·±ç†è§£è¯¶ï¼Œå¾ˆå®¹æ˜“å°±ç†è§£åˆ°äº†åŸç†å’Œç”¨æ³•ã€‚</p><p><img src="https://img.hawa130.com/%E6%B1%82%E8%A7%A3%E8%BF%87%E7%A8%8B.jpg" alt="æ±‚è§£è¿‡ç¨‹"></p><p>ç®—æ³•ç›´æ¥æ‰¾äº†ä¸ªæ¿å­ï¼Œå·ä¸ªæ‡’æã€‚</p><h3 id="Code-8"><a href="#Code-8" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chinese_remainder</span>(<span class="params">n, a</span>):</span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    prod = reduce(<span class="keyword">lambda</span> a, b: a * b, n)</span><br><span class="line">    <span class="keyword">for</span> n_i, a_i <span class="keyword">in</span> <span class="built_in">zip</span>(n, a):</span><br><span class="line">        p = prod // n_i</span><br><span class="line">        <span class="built_in">sum</span> += a_i * mul_inv(p, n_i) * p</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span> % prod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul_inv</span>(<span class="params">a, b</span>):</span><br><span class="line">    b0 = b</span><br><span class="line">    x0, x1 = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> a &gt; <span class="number">1</span>:</span><br><span class="line">        q = a // b</span><br><span class="line">        a, b = b, a % b</span><br><span class="line">        x0, x1 = x1 - q * x0, x0</span><br><span class="line">    <span class="keyword">if</span> x1 &lt; <span class="number">0</span>:</span><br><span class="line">        x1 += b0</span><br><span class="line">    <span class="keyword">return</span> x1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = [<span class="number">5</span>, <span class="number">11</span>, <span class="number">17</span>]</span><br><span class="line">a = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>]</span><br><span class="line"><span class="built_in">print</span>(chinese_remainder(n, a))</span><br></pre></td></tr></table></figure><h2 id="Adrienâ€™s-Signs"><a href="#Adrienâ€™s-Signs" class="headerlink" title="Adrienâ€™s Signs"></a>Adrienâ€™s Signs</h2><h3 id="Description-9"><a href="#Description-9" class="headerlink" title="Description"></a>Description</h3><p>Adrienâ€™s been looking at ways to encrypt his messages with the help of symbols and minus signs. Can you find a way to recover the flag?</p><h3 id="Analyze-9"><a href="#Analyze-9" class="headerlink" title="Analyze"></a>Analyze</h3><p>python å­¦å¾—ä¸å¥½ï¼ŒåŠ å¯†å‡½æ•°ç†è§£äº†å¥½ä¹…ã€‚</p><p>è§£å¯†å€’è¿˜å¥½ï¼Œæ‹¿åˆ°å¯†æ–‡ç›´æ¥æ­£å¸¸å–å¯¹æ•°ï¼Œå–ä¸åˆ°å°±è´Ÿæ•°å–ä½™æŠŠ n è¿˜åŸå›å»å†å–å¯¹æ•°ã€‚</p><p>ä¸è¿‡ä»£ç å¾—è·‘ä¸€ä¼šæ‰èƒ½å‡ºç»“æœï¼Œåé¢æˆ–è®¸å¯ä»¥å†çœ‹çœ‹æœ‰æ²¡æœ‰æ›´ä¼˜è§£ã€‚</p><p>ï¼ˆæœ€åä¸€è¡Œçš„ä»£ç ç®€ç›´å†™å¾—å¤ªä¼˜é›…å’¯</p><h3 id="Code-9"><a href="#Code-9" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> arange</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> discrete_log</span><br><span class="line"></span><br><span class="line">lis = [<span class="number">67594220461269</span>, <span class="number">501237540280788</span>, <span class="number">718316769824518</span>, <span class="number">296304224247167</span>, <span class="number">48290626940198</span>, <span class="number">30829701196032</span>, <span class="number">521453693392074</span>, <span class="number">840985324383794</span>, <span class="number">770420008897119</span>, <span class="number">745131486581197</span>, <span class="number">729163531979577</span>, <span class="number">334563813238599</span>, <span class="number">289746215495432</span>, <span class="number">538664937794468</span>, <span class="number">894085795317163</span>, <span class="number">983410189487558</span>, <span class="number">863330928724430</span>, <span class="number">996272871140947</span>, <span class="number">352175210511707</span>, <span class="number">306237700811584</span>, <span class="number">631393408838583</span>, <span class="number">589243747914057</span>, <span class="number">538776819034934</span>, <span class="number">365364592128161</span>, <span class="number">454970171810424</span>, <span class="number">986711310037393</span>, <span class="number">657756453404881</span>, <span class="number">388329936724352</span>, <span class="number">90991447679370</span>, <span class="number">714742162831112</span>, <span class="number">62293519842555</span>, <span class="number">653941126489711</span>, <span class="number">448552658212336</span>, <span class="number">970169071154259</span>, <span class="number">339472870407614</span>, <span class="number">406225588145372</span>, <span class="number">205721593331090</span>, <span class="number">926225022409823</span>, <span class="number">904451547059845</span>, <span class="number">789074084078342</span>, <span class="number">886420071481685</span>, <span class="number">796827329208633</span>, <span class="number">433047156347276</span>, <span class="number">21271315846750</span>, <span class="number">719248860593631</span>, <span class="number">534059295222748</span>, <span class="number">879864647580512</span>, <span class="number">918055794962142</span>, <span class="number">635545050939893</span>, <span class="number">319549343320339</span>, <span class="number">93008646178282</span>, <span class="number">926080110625306</span>, <span class="number">385476640825005</span>, <span class="number">483740420173050</span>, <span class="number">866208659796189</span>, <span class="number">883359067574584</span>, <span class="number">913405110264883</span>, <span class="number">898864873510337</span>, <span class="number">208598541987988</span>, <span class="number">23412800024088</span>, <span class="number">911541450703474</span>, <span class="number">57446699305445</span>, <span class="number">513296484586451</span>, <span class="number">180356843554043</span>, <span class="number">756391301483653</span>, <span class="number">823695939808936</span>, <span class="number">452898981558365</span>, <span class="number">383286682802447</span>, <span class="number">381394258915860</span>, <span class="number">385482809649632</span>, <span class="number">357950424436020</span>, <span class="number">212891024562585</span>, <span class="number">906036654538589</span>, <span class="number">706766032862393</span>, <span class="number">500658491083279</span>, <span class="number">134746243085697</span>, <span class="number">240386541491998</span>, <span class="number">850341345692155</span>, <span class="number">826490944132718</span>, <span class="number">329513332018620</span>, <span class="number">41046816597282</span>, <span class="number">396581286424992</span>, <span class="number">488863267297267</span>, <span class="number">92023040998362</span>, <span class="number">529684488438507</span>, <span class="number">925328511390026</span>, <span class="number">524897846090435</span>, <span class="number">413156582909097</span>, <span class="number">840524616502482</span>, <span class="number">325719016994120</span>, <span class="number">402494835113608</span>, <span class="number">145033960690364</span>, <span class="number">43932113323388</span>, <span class="number">683561775499473</span>, <span class="number">434510534220939</span>, <span class="number">92584300328516</span>, <span class="number">763767269974656</span>, <span class="number">289837041593468</span>, <span class="number">11468527450938</span>, <span class="number">628247946152943</span>, <span class="number">8844724571683</span>, <span class="number">813851806959975</span>, <span class="number">72001988637120</span>, <span class="number">875394575395153</span>, <span class="number">70667866716476</span>, <span class="number">75304931994100</span>, <span class="number">226809172374264</span>, <span class="number">767059176444181</span>, <span class="number">45462007920789</span>, <span class="number">472607315695803</span>, <span class="number">325973946551448</span>, <span class="number">64200767729194</span>, <span class="number">534886246409921</span>, <span class="number">950408390792175</span>, <span class="number">492288777130394</span>, <span class="number">226746605380806</span>, <span class="number">944479111810431</span>, <span class="number">776057001143579</span>, <span class="number">658971626589122</span>, <span class="number">231918349590349</span>, <span class="number">699710172246548</span>, <span class="number">122457405264610</span>, <span class="number">643115611310737</span>, <span class="number">999072890586878</span>, <span class="number">203230862786955</span>, <span class="number">348112034218733</span>, <span class="number">240143417330886</span>, <span class="number">927148962961842</span>, <span class="number">661569511006072</span>, <span class="number">190334725550806</span>, <span class="number">763365444730995</span>, <span class="number">516228913786395</span>, <span class="number">846501182194443</span>, <span class="number">741210200995504</span>, <span class="number">511935604454925</span>, <span class="number">687689993302203</span>, <span class="number">631038090127480</span>, <span class="number">961606522916414</span>, <span class="number">138550017953034</span>, <span class="number">932105540686829</span>, <span class="number">215285284639233</span>, <span class="number">772628158955819</span>, <span class="number">496858298527292</span>, <span class="number">730971468815108</span>, <span class="number">896733219370353</span>, <span class="number">967083685727881</span>, <span class="number">607660822695530</span>, <span class="number">650953466617730</span>, <span class="number">133773994258132</span>, <span class="number">623283311953090</span>, <span class="number">436380836970128</span>, <span class="number">237114930094468</span>, <span class="number">115451711811481</span>, <span class="number">674593269112948</span>, <span class="number">140400921371770</span>, <span class="number">659335660634071</span>, <span class="number">536749311958781</span>, <span class="number">854645598266824</span>, <span class="number">303305169095255</span>, <span class="number">91430489108219</span>, <span class="number">573739385205188</span>, <span class="number">400604977158702</span>, <span class="number">728593782212529</span>, <span class="number">807432219147040</span>, <span class="number">893541884126828</span>, <span class="number">183964371201281</span>, <span class="number">422680633277230</span>, <span class="number">218817645778789</span>, <span class="number">313025293025224</span>, <span class="number">657253930848472</span>, <span class="number">747562211812373</span>, <span class="number">83456701182914</span>, <span class="number">470417289614736</span>, <span class="number">641146659305859</span>, <span class="number">468130225316006</span>, <span class="number">46960547227850</span>, <span class="number">875638267674897</span>, <span class="number">662661765336441</span>, <span class="number">186533085001285</span>, <span class="number">743250648436106</span>, <span class="number">451414956181714</span>, <span class="number">527954145201673</span>, <span class="number">922589993405001</span>, <span class="number">242119479617901</span>, <span class="number">865476357142231</span>, <span class="number">988987578447349</span>, <span class="number">430198555146088</span>, <span class="number">477890180119931</span>, <span class="number">844464003254807</span>, <span class="number">503374203275928</span>, <span class="number">775374254241792</span>, <span class="number">346653210679737</span>, <span class="number">789242808338116</span>, <span class="number">48503976498612</span>, <span class="number">604300186163323</span>, <span class="number">475930096252359</span>, <span class="number">860836853339514</span>, <span class="number">994513691290102</span>, <span class="number">591343659366796</span>, <span class="number">944852018048514</span>, <span class="number">82396968629164</span>, <span class="number">152776642436549</span>, <span class="number">916070996204621</span>, <span class="number">305574094667054</span>, <span class="number">981194179562189</span>, <span class="number">126174175810273</span>, <span class="number">55636640522694</span>, <span class="number">44670495393401</span>, <span class="number">74724541586529</span>, <span class="number">988608465654705</span>, <span class="number">870533906709633</span>, <span class="number">374564052429787</span>, <span class="number">486493568142979</span>, <span class="number">469485372072295</span>, <span class="number">221153171135022</span>, <span class="number">289713227465073</span>, <span class="number">952450431038075</span>, <span class="number">107298466441025</span>, <span class="number">938262809228861</span>, <span class="number">253919870663003</span>, <span class="number">835790485199226</span>, <span class="number">655456538877798</span>, <span class="number">595464842927075</span>, <span class="number">191621819564547</span>]</span><br><span class="line">a = <span class="number">288260533169915</span></span><br><span class="line">p = <span class="number">1007621497415251</span></span><br><span class="line">decode = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> arange(<span class="built_in">len</span>(lis)):</span><br><span class="line">    cipher = lis[i]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = discrete_log(p, cipher, a)</span><br><span class="line">        decode += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        r = discrete_log(p, -cipher % p, a)</span><br><span class="line">        decode += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(decode[i:i+<span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(decode), <span class="number">8</span>)]))</span><br></pre></td></tr></table></figure><h2 id="Modular-Binomials"><a href="#Modular-Binomials" class="headerlink" title="Modular Binomials"></a>Modular Binomials</h2><h3 id="Description-10"><a href="#Description-10" class="headerlink" title="Description"></a>Description</h3><p>Rearrange the following equations to get <code>p,q</code></p><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">N</span> = p*q</span><br><span class="line"><span class="attr">c1</span> = (<span class="number">2</span>*p + <span class="number">3</span>*q)**e1 mod N</span><br><span class="line"><span class="attr">c2</span> = (<span class="number">5</span>*p + <span class="number">7</span>*q)**e2 mod N</span><br></pre></td></tr></table></figure><h3 id="Analyze-10"><a href="#Analyze-10" class="headerlink" title="Analyze"></a>Analyze</h3><p>ç»™äº†äº”ä¸ªå‚æ•°ï¼Œæ±‚ä¸¤ä¸ªæœªçŸ¥æ•° p å’Œ qï¼Œä¸€çœ¼çœ‹åˆ°ç»™äº† pï¼Œq çš„ä¹˜ç§¯ Nï¼Œæ‰€ä»¥åªè¦éšä¾¿æ±‚å‡ºæ¥å…¶ä¸­ä¸€ä¸ªç„¶åé™¤ N å°±å¯ä»¥å’¯ã€‚</p><p>æˆ‘æ˜¯å…ˆæ±‚äº† qï¼Œæ‰€ä»¥å…ˆæŠŠä¸¤ä¸ªæ–¹ç¨‹å³è¾¹é…æˆé½æ¬¡çš„ï¼Œç„¶åæŠŠè¦æ¶ˆæ‰çš„ p çš„ç³»æ•°é…æˆä¸€æ ·çš„ï¼Œq çš„ç³»æ•°åˆšå¥½æ˜¯ 15 å’Œ 14ï¼Œç›¸å‡å°±æ˜¯ q å’¯ã€‚</p><p>æœ€åä¸€é“é¢˜å€’æ˜¯æ²¡å•¥æŠ€æœ¯å«é‡ï¼Œå°±å—¯è§£æ–¹ç¨‹ç»„ã€‚</p><h3 id="Code-10"><a href="#Code-10" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line">N = <span class="number">14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073</span></span><br><span class="line">e1 = <span class="number">12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137</span></span><br><span class="line">e2 = <span class="number">12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697</span></span><br><span class="line">c1 = <span class="number">14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051</span></span><br><span class="line">c2 = <span class="number">14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q = math.gcd(N, <span class="built_in">pow</span>(c1, e2, N) * <span class="built_in">pow</span>(<span class="number">5</span>, e1 * e2, N) - <span class="built_in">pow</span>(c2, e1, N) * <span class="built_in">pow</span>(<span class="number">2</span>, e1 * e2, N))</span><br><span class="line">p = N // q</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç¬¬äºŒç« ä¹Ÿåšå®Œå’¯~&lt;/p&gt;
    
    </summary>
    
      <category term="å­¦ä¹ " scheme="http://smilin9.com/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="cryptohack" scheme="http://smilin9.com/tags/cryptohack/"/>
    
  </entry>
  
  <entry>
    <title>Introduction To Cryptohack</title>
    <link href="http://smilin9.com/2022/05/01/Introduction%20To%20Cryptohack/"/>
    <id>http://smilin9.com/2022/05/01/Introduction To Cryptohack/</id>
    <published>2022-05-01T11:33:32.000Z</published>
    <updated>2022-06-17T01:14:47.772Z</updated>
    
    <content type="html"><![CDATA[<p>åšå®Œç¬¬ä¸€ç« å’¯~</p><span id="more"></span><p>åšäº†å¤§åŠå¤©æ‰åšå®Œï¼Œä¸»è¦æ˜¯ python è¯­æ³•ä»€ä¹ˆçš„å†™èµ·æ¥æ¯”è¾ƒæ‰‹ç”Ÿï¼Œæœ‰ python åŸºç¡€çš„è¯å¯èƒ½ä¼šåšå¾—æ›´é¡ºæ‰‹ä¸€ç‚¹ã€‚</p><p>è¿™ä¸€ç« çš„çŸ¥è¯†éƒ½å±äºæ¯”è¾ƒåŸºç¡€çš„ï¼Œç”šè‡³å¤§éƒ¨åˆ†é¢˜å‡ ä¹éƒ½æ˜¯ç›´æ¥æŠŠ flag æ€¼è„¸ä¸Šï¼ˆç¬‘</p><p>åšå®Œé¢˜ä¹‹åçŠ¹è±«äº†ä¸€ä¸‹åšå®¢æ˜¯å•çº¯å†™è§£é¢˜ç›¸å…³è¿˜æ˜¯é¡ºä¾¿é™„ä¸ŠçŸ¥è¯†ç‚¹æ€»ç»“ï¼Œæƒ³èµ·ä¹‹å‰è¯´çš„æµ…ï¼ˆshenï¼‰æµ…ï¼ˆshenï¼‰è®°å½•ï¼Œæ‰€ä»¥è¿˜æ˜¯æ‰“ç®—éƒ½å†™å†™ï¼Œä¸æ˜¯ä»€ä¹ˆåäº‹æã€‚</p><h1 id="Introduction-To-Cryptohack"><a href="#Introduction-To-Cryptohack" class="headerlink" title="Introduction To Cryptohack"></a>Introduction To Cryptohack</h1><h2 id="Finding-Flags"><a href="#Finding-Flags" class="headerlink" title="Finding Flags"></a>Finding Flags</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>Each challenge is designed to help introduce you to a new piece of cryptography. Solving a challenge will require you to find a â€œflagâ€.</p><p>These flags will usually be in the format<code>crypto&#123;y0ur_f1rst_fl4g&#125;</code>. The flag format helps you verify that you found the correct solution.</p><p>Try submitting this into the form below to solve your first challenge.</p><h3 id="Analyze"><a href="#Analyze" class="headerlink" title="Analyze"></a>Analyze</h3><p>ç®€å•è¯´äº†ä¸‹ flag æ˜¯å•¥ï¼Œæ ¼å¼æ˜¯ <code>crypto&#123;y0ur_f1rst_fl4g&#125;</code>ã€‚flag å·²ç»ç»™å’¯ï¼Œç›´æ¥å¡«~</p><h2 id="Great-Snakes"><a href="#Great-Snakes" class="headerlink" title="Great Snakes"></a>Great Snakes</h2><h3 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h3><p>Modern cryptography involves code, and code involves coding. CryptoHack provides a good opportunity to sharpen your skills.</p><p>Of all modern programming languages, Python 3 stands out as ideal for quickly writing cryptographic scripts and attacks.</p><p>Run the attached Python script and it will output your flag.</p><h3 id="Analyze-1"><a href="#Analyze-1" class="headerlink" title="Analyze"></a>Analyze</h3><p>å°±ç›´æ¥åœ¨ python3 ä¸‹è¿è¡Œ .py æ–‡ä»¶å°±çœ‹åˆ° <code>flag</code> å’¯ã€‚</p><p>ç›´æ¥åœ¨ vscode é‡Œè·‘çš„æ—¶å€™è€æ˜¯æŠ¥é”™ï¼Œå‘ç°ç¬¬ä¸€è¡Œæ³¨é‡Š <code>#!/usr/bin/env python3</code> æ˜¯ç»™ Linux&#x2F;macOS ç¯å¢ƒå‡†å¤‡çš„ï¼ŒWindows ç›´æ¥åˆ æ‰å°±å¥½å’¯ã€‚</p><p><del>ï¼ˆå­¤å„¿ Windows å®é”¤ï¼‰</del></p><h2 id="ASCII"><a href="#ASCII" class="headerlink" title="ASCII"></a>ASCII</h2><h3 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h3><p>ASCII is a 7-bit encoding standard which allows the representation of text using the integers 0-127.</p><p>Using the below integer array, convert the numbers to their corresponding ASCII characters to obtain a flag.</p><figure class="highlight accesslog"><table><tr><td class="code"><pre><span class="line"><span class="string">[99, 114, 121, 112, 116, 111, 123, 65, 83, 67, 73, 73, 95, 112, 114, 49, 110, 116, 52, 98, 108, 51, 125]</span></span><br></pre></td></tr></table></figure><blockquote><p>In Python, the <code>chr()</code> function can be used to convert an ASCII ordinal number to a character (the <code>ord()</code> function does the opposite).</p></blockquote><h3 id="Analyze-2"><a href="#Analyze-2" class="headerlink" title="Analyze"></a>Analyze</h3><p>ä»‹ç»äº†ä¸‹ ASCII æ˜¯å•¥ï¼Œç›´æ¥æŒ‰ç»™å‡ºçš„ <code>chr()</code> å‡½æ•°è½¬æ¢ä¸€ä¸‹è¾“å‡º <code>flag</code>ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ord</span> = [<span class="number">99</span>, <span class="number">114</span>, <span class="number">121</span>, <span class="number">112</span>, <span class="number">116</span>, <span class="number">111</span>, <span class="number">123</span>, <span class="number">65</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">73</span>, <span class="number">73</span>, <span class="number">95</span>, <span class="number">112</span>, <span class="number">114</span>, <span class="number">49</span>, <span class="number">110</span>, <span class="number">116</span>,</span><br><span class="line">       <span class="number">52</span>, <span class="number">98</span>, <span class="number">108</span>, <span class="number">51</span>, <span class="number">125</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(o) <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">ord</span>))</span><br></pre></td></tr></table></figure><h3 id="SumUp"><a href="#SumUp" class="headerlink" title="SumUp"></a>SumUp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">function:</span><br><span class="line"><span class="built_in">chr</span>()  <span class="comment"># ASCII--&gt;char</span></span><br><span class="line"><span class="built_in">ord</span>()  <span class="comment"># char--&gt;ASCII</span></span><br></pre></td></tr></table></figure><h2 id="Hex"><a href="#Hex" class="headerlink" title="Hex"></a>Hex</h2><h3 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h3><p>When we encrypt something the resulting ciphertext commonly has bytes which are not printable ASCII characters. If we want to share our encrypted data, itâ€™s common to encode it into something more user-friendly and portable across different systems.</p><p>Included below is a flag encoded as a hex string. Decode this back into bytes to get the flag.</p><figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line"><span class="number">63727970746</span>f<span class="number">7</span>b<span class="number">596</span>f<span class="number">755</span>f<span class="number">77696</span><span class="keyword">c</span><span class="number">6</span><span class="keyword">c</span><span class="number">5</span>f<span class="number">62655</span>f<span class="number">776</span>f<span class="number">726</span>b<span class="number">696e675</span>f<span class="number">776974685</span>f<span class="number">6865785</span>f<span class="number">737472696e67735</span>f<span class="number">615</span>f<span class="number">6</span><span class="keyword">c</span><span class="number">6</span>f<span class="number">747</span>d</span><br></pre></td></tr></table></figure><p> In Python, the <code>bytes.fromhex()</code> function can be used to convert hex to bytes. The <code>.hex()</code> instance method can be called on byte strings to get the hex representation.</p><h3 id="Analyze-3"><a href="#Analyze-3" class="headerlink" title="Analyze"></a>Analyze</h3><p>åå…­è¿›åˆ¶æ¥å’¯ã€‚</p><p>è¦æ±‚æŠŠç»™å‡ºçš„åå…­è¿›åˆ¶ decode å› byteï¼Œç”¨ç»™å‡ºçš„å‡½æ•°ç›´æ¥ decode è¾“å‡ºã€‚</p><h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">h = <span class="string">&#x27;63727970746f7b596f755f77696c6c5f62655f776f726b696e675f77697685f6865785f737472696e67\</span></span><br><span class="line"><span class="string">35f615f6c6f747d&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(h))</span><br></pre></td></tr></table></figure><h3 id="SumUp-1"><a href="#SumUp-1" class="headerlink" title="SumUp"></a>SumUp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">function:</span><br><span class="line"><span class="built_in">bytes</span>.fromhex()  <span class="comment"># hex--&gt;bytes</span></span><br><span class="line"><span class="built_in">bytes</span>.<span class="built_in">hex</span>()  <span class="comment"># bytes--&gt;hex</span></span><br></pre></td></tr></table></figure><h2 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h2><h3 id="Description-4"><a href="#Description-4" class="headerlink" title="Description"></a>Description</h3><p>Another common encoding scheme is Base64, which allows us to represent binary data as an ASCII string using 64 characters. One character of a Base64 string encodes 6 bits, and so 4 characters of Base64 encode three 8-bit bytes.</p><p>Base64 is most commonly used online, so binary data such as images can be easily included into HTML or CSS files.</p><p>Take the below hex string, <em>decode</em> it into bytes and then <em>encode</em> it into Base64.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf</span><br></pre></td></tr></table></figure><p> In Python, after importing the base64 module with <code>import base64</code>, you can use the <code>base64.b64encode()</code> function. Remember to decode the hex first as the challenge description states.</p><h3 id="Analyze-4"><a href="#Analyze-4" class="headerlink" title="Analyze"></a>Analyze</h3><p>æ˜¯ base64 æï¼Œç»™çš„æ˜¯åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå…ˆç”¨ <code>bytes.fromhex</code> å‡½æ•° encode å¾—åˆ° byteï¼Œç„¶åç”¨ base64 åº“é‡Œçš„ <code>base64.b64encode()</code> å‡½æ•°ç¼–ç ã€‚</p><p>è®°å¾—å…ˆå®‰ base64 åº“å–”~</p><h3 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">h = <span class="string">&#x27;72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf&#x27;</span></span><br><span class="line">decode = <span class="built_in">bytes</span>.fromhex(h)  <span class="comment"># hex --&gt; bytes</span></span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(decode))  <span class="comment"># base64 ç¼–ç </span></span><br></pre></td></tr></table></figure><h3 id="SumUp-2"><a href="#SumUp-2" class="headerlink" title="SumUp"></a>SumUp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">base64.b64encode() <span class="comment"># bytes--&gt;base64Code</span></span><br></pre></td></tr></table></figure><h2 id="Bytes-and-Big-Integers"><a href="#Bytes-and-Big-Integers" class="headerlink" title="Bytes and Big Integers"></a>Bytes and Big Integers</h2><h3 id="Description-5"><a href="#Description-5" class="headerlink" title="Description"></a>Description</h3><p>Cryptosystems like RSA works on numbers, but messages are made up of characters. How should we convert our messages into numbers so that mathematical operations can be applied?</p><p>The most common way is to take the ordinal bytes of the message, convert them into hexadecimal, and concatenate. This can be interpreted as a base-16 number, and also represented in base-10.</p><p>To illustrate:</p><figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">message</span>: HELLO</span><br><span class="line"><span class="attribute">ascii</span> bytes:<span class="meta"> [72, 69, 76, 76, 79]</span></span><br><span class="line"><span class="attribute">hex</span> bytes:<span class="meta"> [0x48, 0x45, 0x4c, 0x4c, 0x4f]</span></span><br><span class="line"><span class="attribute">base</span>-<span class="number">16</span>: <span class="number">0</span>x48454c4c4f</span><br><span class="line"><span class="attribute">base</span>-<span class="number">10</span>: <span class="number">310400273487</span></span><br></pre></td></tr></table></figure><blockquote><p>Pythonâ€™s PyCryptodome library implements this with the methods <code>Crypto.Util.number.bytes_to_long()</code> and <code>Crypto.Util.number.long_to_bytes()</code>. You may first have to install PyCryptodome and import it with <code>from Crypto.Util.number import *</code>. </p></blockquote><p>Convert the following integer back into a message:</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">11515195063862318899931685488813747395775516287289682636499965282714637259206269</span><br></pre></td></tr></table></figure><h3 id="Analyze-5"><a href="#Analyze-5" class="headerlink" title="Analyze"></a>Analyze</h3><p>ç»™äº†ä¸€ä¸ªå¤§æ•´æ•°ï¼Œç”¨å‡½æ•° <code>long_to_bytes()</code> è½¬åŒ–ä¸‹å°±è§£å†³å’¯ã€‚</p><h3 id="Code-3"><a href="#Code-3" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">lis = <span class="number">11515195063862318899931685488813747395775516287289682636499965282714637259206269</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(lis))</span><br></pre></td></tr></table></figure><h3 id="SumUp-3"><a href="#SumUp-3" class="headerlink" title="SumUp"></a>SumUp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">Crypto.Util.number.bytes_to_long()</span><br><span class="line">Crypto.Util.number.long_to_bytes()</span><br></pre></td></tr></table></figure><p>è™½ç„¶ä½†æ˜¯ï¼Œæˆ‘ä¸€å®šè¦åæ§½ Crypto åº“ï¼Œè¿™ä¹Ÿå¤ªçƒ¦äº†ï¼</p><p>å®‰äº†ä¹‹åè¿˜æ˜¯ä¸åœæŠ¥é”™è¯´æ²¡æœ‰æ‰¾åˆ° Crypto åº“ï¼Œåˆæ˜¯å¸è½½é‡è£…åˆæ˜¯é‡å¯ã€‚</p><p>è¯•äº†ä¸€ç³»åˆ—åŠæ³•ä¹‹åæ±‚åŠ©äº’è”ç½‘ï¼Œå» <code>.\python310\Lib\site-packages</code> é‡Œé¢æŠŠ crypto æ–‡ä»¶å¤¹ç›´æ¥é‡å‘½åä¸º Cryptoï¼Œç„¶åå®ƒå°±å¥½äº†ï¼Ÿä»£ç å°±è·‘èµ·æ¥äº†ï¼</p><p>è£… py åº“çœŸçš„å¯ä»¥æ²»ç–—ä½è¡€å‹ã€‚ã€‚</p><h2 id="XOR-Starter"><a href="#XOR-Starter" class="headerlink" title="XOR Starter"></a>XOR Starter</h2><h3 id="Description-6"><a href="#Description-6" class="headerlink" title="Description"></a>Description</h3><p>XOR is a bitwise operator which returns 0 if the bits are the same, and 1 otherwise. In textbooks the XOR operator is denoted by âŠ•, but in most challenges and programming languages you will see the caret <code>^</code> used instead.</p><table><thead><tr><th align="center">A</th><th align="center">B</th><th align="center">Output</th></tr></thead><tbody><tr><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">0</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="center">1</td><td align="center">0</td><td align="center">1</td></tr><tr><td align="center">1</td><td align="center">1</td><td align="center">0</td></tr></tbody></table><p>For longer binary numbers we XOR bit by bit: <code>0110 ^ 1010 = 1100</code>. We can XOR integers by first converting the integer from decimal to binary. We can XOR strings by first converting each character to the integer representing the Unicode character.</p><p>Given the string <code>&quot;label&quot;</code>, XOR each character with the integer <code>13</code>. Convert these integers back to a string and submit the flag as <code>crypto&#123;new_string&#125;</code>.</p><blockquote><p>The Python <code>pwntools</code> library has a convenient <code>xor()</code> function that can XOR together data of different types and lengths.</p></blockquote><h3 id="Analyze-6"><a href="#Analyze-6" class="headerlink" title="Analyze"></a>Analyze</h3><p>ç»™äº†å­—ç¬¦ä¸² <code>&quot;label&quot;</code>ï¼Œæ¯ä¸ªå­—ç¬¦å’Œæ•´æ•° 13 å¼‚æˆ–å¾—åˆ° flagã€‚</p><p>é¡ºæ‰‹ä¸‹è½½ pwntools å’Œ pwn åº“å–”~</p><p><code>pip install pwntools</code></p><p><code>pip install pwn</code></p><h3 id="Code-4"><a href="#Code-4" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">XOR</span>(<span class="params"><span class="built_in">str</span>, key</span>):</span><br><span class="line">    res=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        res += <span class="built_in">chr</span>(<span class="built_in">ord</span>(s) ^ key)</span><br><span class="line">    <span class="comment">#print(o)</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&#x27;label&#x27;</span></span><br><span class="line">flag = XOR(<span class="built_in">str</span>,<span class="number">13</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;crypto&#123;%s&#125;&#x27;</span>% flag)</span><br></pre></td></tr></table></figure><h3 id="SumUp-4"><a href="#SumUp-4" class="headerlink" title="SumUp"></a>SumUp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwntools <span class="keyword">import</span> xor</span><br><span class="line">xor()  <span class="comment"># å¯ä»¥æŠŠä¸åŒé•¿åº¦å’Œç±»å‹çš„æ•°æ®è¿›è¡Œå¼‚æˆ–ï¼Œä»€ä¹ˆç±»å‹çš„æ•°æ®éƒ½å¯ä»¥å–”</span></span><br></pre></td></tr></table></figure><h2 id="XOR-Properties"><a href="#XOR-Properties" class="headerlink" title="XOR Properties"></a>XOR Properties</h2><h3 id="Description-7"><a href="#Description-7" class="headerlink" title="Description"></a>Description</h3><p>In the last challenge, you saw how XOR worked at the level of bits. In this one, weâ€™re going to cover the properties of the XOR operation and then use them to undo a chain of operations that have encrypted a flag. Gaining an intuition for how this works will help greatly when you come to attacking real cryptosystems later, especially in the block ciphers category.</p><p>There are four main properties we should consider when we solve challenges using the XOR operator</p><figure class="highlight dns"><table><tr><td class="code"><pre><span class="line">Commutative: <span class="keyword">A</span> âŠ• B = B âŠ• <span class="keyword">A</span></span><br><span class="line">Associative: <span class="keyword">A</span> âŠ• (B âŠ• C) = (<span class="keyword">A</span> âŠ• B) âŠ• C</span><br><span class="line">Identity: <span class="keyword">A</span> âŠ• <span class="number">0</span> = <span class="keyword">A</span></span><br><span class="line">Self-Inverse: <span class="keyword">A</span> âŠ• <span class="keyword">A</span> = <span class="number">0</span></span><br></pre></td></tr></table></figure><p>Letâ€™s break this down. Commutative means that the order of the XOR operations is not important. Associative means that a chain of operations can be carried out without order (we do not need to worry about brackets). The identity is 0, so XOR with 0 â€œdoes nothingâ€, and lastly something XORâ€™d with itself returns zero.</p><p>Letâ€™s try this out in action! Below is a series of outputs where three random keys have been XORâ€™d together and with the flag. Use the above properties to undo the encryption in the final line to obtain the flag.</p><figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">KEY<span class="number">1</span> <span class="operator">=</span> a<span class="number">6</span><span class="keyword">c</span><span class="number">8</span>b<span class="number">6733</span><span class="keyword">c</span><span class="number">9</span>b<span class="number">22</span>de<span class="number">7</span>bc<span class="number">0253266</span>a<span class="number">3867</span>df<span class="number">55</span>acde<span class="number">8635e19</span><span class="keyword">c</span><span class="number">73313</span></span><br><span class="line">KEY<span class="number">2</span> ^ KEY<span class="number">1</span> <span class="operator">=</span> <span class="number">37</span>dcb<span class="number">292030</span>faa<span class="number">90</span>d<span class="number">07</span>eec<span class="number">17e3</span>b<span class="number">1</span><span class="keyword">c</span><span class="number">6</span>d<span class="number">8</span>daf<span class="number">94</span><span class="keyword">c</span><span class="number">35</span>d<span class="number">4</span><span class="keyword">c</span><span class="number">9191</span>a<span class="number">5e1</span>e</span><br><span class="line">KEY<span class="number">2</span> ^ KEY<span class="number">3</span> <span class="operator">=</span> <span class="keyword">c</span><span class="number">1545756687e7573</span>db<span class="number">23</span>aa<span class="number">1</span><span class="keyword">c</span><span class="number">3452</span>a<span class="number">098</span>b<span class="number">71</span>a<span class="number">7</span>fbf<span class="number">0</span>fddddde<span class="number">5</span>fc<span class="number">1</span></span><br><span class="line">FLAG ^ KEY<span class="number">1</span> ^ KEY<span class="number">3</span> ^ KEY<span class="number">2</span> <span class="operator">=</span> <span class="number">04</span>ee<span class="number">9855208</span>a<span class="number">2</span>cd<span class="number">59091</span>d<span class="number">04767</span>ae<span class="number">47963170</span>d<span class="number">1660</span>df<span class="number">7</span>f<span class="number">56</span>f<span class="number">5</span>faf</span><br></pre></td></tr></table></figure><p> Before you XOR these objects, be sure to decode from hex to bytes.</p><h3 id="Analyze-7"><a href="#Analyze-7" class="headerlink" title="Analyze"></a>Analyze</h3><p>å¼‚æˆ–çš„ä¸€äº›æ€§è´¨~</p><p>å¾ˆç®€å•çš„ä¸€ç‚¹æ•°å­¦è¿ç®—</p><p>$$\begin{align}&amp;FK123âŠ•K1âŠ•K23 \\ &#x3D;&amp;(FâŠ•K1âŠ•K2âŠ•K3)âŠ•K1âŠ•(K2âŠ•K3) \\ &#x3D;&amp;(FâŠ•K2âŠ•K3)âŠ•0âŠ•(K2âŠ•K3) \\ &#x3D;&amp;(FâŠ•K2âŠ•K3)âŠ•(K2âŠ•K3) \\ &#x3D;&amp;FâŠ•0 \\ &#x3D;&amp;F\end{align}$$</p><p>ï¼ˆå…¶å®åªæ˜¯æƒ³æµ…è¯•ä¸€ä¸‹æ•°å­¦å…¬å¼çš„åŠŸèƒ½~</p><h3 id="Code-5"><a href="#Code-5" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line">K1 = <span class="string">&#x27;a6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313&#x27;</span></span><br><span class="line">K21 = <span class="string">&#x27;37dcb292030faa90d07eec17e3b1c6d8daf94c35d4c9191a5e1e&#x27;</span></span><br><span class="line">K23 = <span class="string">&#x27;c1545756687e7573db23aa1c3452a098b71a7fbf0fddddde5fc1&#x27;</span></span><br><span class="line">FK132 = <span class="string">&#x27;04ee9855208a2cd59091d04767ae47963170d1660df7f56f5faf&#x27;</span></span><br><span class="line">flag = xor(<span class="built_in">bytes</span>.fromhex(FK132), <span class="built_in">bytes</span>.fromhex(K1), <span class="built_in">bytes</span>.fromhex(K23))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="Favourite-byte"><a href="#Favourite-byte" class="headerlink" title="Favourite byte"></a>Favourite byte</h2><h3 id="Description-8"><a href="#Description-8" class="headerlink" title="Description"></a>Description</h3><p>For the next few challenges, youâ€™ll use what youâ€™ve just learned to solve some more XOR puzzles.</p><p>Iâ€™ve hidden some data using XOR with a single byte, but that byte is a secret. Donâ€™t forget to decode from hex first.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d</span><br></pre></td></tr></table></figure><h3 id="Analyze-8"><a href="#Analyze-8" class="headerlink" title="Analyze"></a>Analyze</h3><p>å…ˆä»16è¿›åˆ¶ decode å–”</p><p>å› ä¸ºä¹‹å’Œå•ä¸ª byte è¿›è¡Œäº†å¼‚æˆ–ï¼ŒåˆçŸ¥é“ flag çš„é¦–å­—æ¯æ˜¯ <code>&#39;c&#39;</code>ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ decode ä¹‹åçš„ç¬¬ä¸€ä½å’Œ <code>&#39;c&#39;</code> è¿›è¡Œå¼‚æˆ–å¾—åˆ° secretã€‚</p><p>ä¹‹åæŠŠæ•´ä¸ªå­—ç¬¦ä¸²å’Œ secret å¼‚æˆ–ä¹‹åè¾“å‡ºã€‚</p><h3 id="Code-6"><a href="#Code-6" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">xor_byte</span>(<span class="params">a: <span class="built_in">bytes</span>, b: <span class="built_in">int</span></span>):</span><br><span class="line">    res = <span class="built_in">bytes</span>([_a ^ b <span class="keyword">for</span> _a <span class="keyword">in</span> a])</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">lis = <span class="string">&#x27;73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d&#x27;</span></span><br><span class="line">decode = <span class="built_in">bytes</span>.fromhex(lis)</span><br><span class="line">secret = decode[<span class="number">0</span>] ^ <span class="built_in">ord</span>(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(xor_byte(decode, secret))</span><br></pre></td></tr></table></figure><h2 id="You-either-know-XOR-you-donâ€™t"><a href="#You-either-know-XOR-you-donâ€™t" class="headerlink" title="You either know, XOR you donâ€™t"></a>You either know, XOR you donâ€™t</h2><h3 id="Description-9"><a href="#Description-9" class="headerlink" title="Description"></a>Description</h3><p>Iâ€™ve encrypted the flag with my secret key, youâ€™ll never be able to guess it.</p><blockquote><p>Remember the flag format and how it might help you in this challenge!</p></blockquote><figure class="highlight dns"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span>e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e<span class="number">263451150104</span></span><br></pre></td></tr></table></figure><h3 id="Analyze-9"><a href="#Analyze-9" class="headerlink" title="Analyze"></a>Analyze</h3><p>ç¬¬ä¸€æ­¥å½“ç„¶ä¹Ÿæ˜¯ä»åå…­è¿›åˆ¶ decode å’¯ã€‚</p><p>å’Œä¸Šä¸€é¢˜çš„æ€è·¯æœ‰ç‚¹åƒæï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨ flag çš„æ ¼å¼å¾—åˆ°åŠ å¯†ç”¨åˆ°çš„ keyã€‚</p><p>åªè¦æŠŠ <code>&#39;c&#39;</code> æ¢æˆ <code>&#39;crypto&#123;&#39;</code>ï¼Œç„¶ååŠ ä¸Šä¸€ç‚¹ç‚¹çš„çŒœæƒ³<del>ï¼ˆè‡ªåŠ¨è¡¥å…¨ï¼‰</del>å°±å¯ä»¥å’¯ã€‚</p><h3 id="Code-7"><a href="#Code-7" class="headerlink" title="Code"></a>Code</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lis = <span class="string">&#x27;0e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e263451150\</span></span><br><span class="line"><span class="string">104&#x27;</span></span><br><span class="line">decode = <span class="built_in">bytes</span>.fromhex(lis)</span><br><span class="line">flag = <span class="string">&#x27;crypto&#123;&#x27;</span></span><br><span class="line"><span class="comment"># akey = xor(decode[:7], [ord(o) for o in flag])</span></span><br><span class="line"><span class="comment"># print(akey)</span></span><br><span class="line">key = <span class="string">&#x27;myXORkey&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(xor(decode, key))</span><br><span class="line"></span><br><span class="line"><span class="comment"># akey = myXORke,çŒœæƒ³key = myXORkey</span></span><br></pre></td></tr></table></figure><h2 id="è‡´è°¢ï¼ˆè¢«è¿«çš„ï¼‰"><a href="#è‡´è°¢ï¼ˆè¢«è¿«çš„ï¼‰" class="headerlink" title="è‡´è°¢ï¼ˆè¢«è¿«çš„ï¼‰"></a>è‡´è°¢<del>ï¼ˆè¢«è¿«çš„ï¼‰</del></h2><p>éå¸¸æ„Ÿè°¢ <a href="https://hawa130.com/">hawa130</a> å¯¹æœ¬æ–‡æ’ç‰ˆç­‰é—®é¢˜çš„ç»†å¿ƒçº æ­£ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åšå®Œç¬¬ä¸€ç« å’¯~&lt;/p&gt;
    
    </summary>
    
      <category term="å­¦ä¹ " scheme="http://smilin9.com/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="cryptohack" scheme="http://smilin9.com/tags/cryptohack/"/>
    
  </entry>
  
  <entry>
    <title>Start Of Cryptohack</title>
    <link href="http://smilin9.com/2022/04/30/start%20of%20cryptohack/"/>
    <id>http://smilin9.com/2022/04/30/start of cryptohack/</id>
    <published>2022-04-30T20:04:32.000Z</published>
    <updated>2022-06-17T01:14:47.772Z</updated>
    
    <content type="html"><![CDATA[<p>åˆšåˆšæ­å¥½åšå®¢ï¼Œæ¥æ°´ç¬¬ä¸€ç¯‡æ–‡ç« å’¯ï¼ï¼ˆbushi</p><span id="more"></span><p>ä»Šå¤©å»é¢è¯• xdsec å’¯ï¼Œè™½ç„¶å¾ˆç´§å¼ ä¹Ÿç£•ç£•ç»Šç»Šï¼Œä½†æ€»ç®—æ˜¯ç»“æŸå’¯ã€‚åªæ˜¯æœ€åæƒŠé—»å™©è€—ï¼Œé¢è¯•ä»»åŠ¡ 5.7 æˆªæ­¢ï¼Œæ‰€ä»¥æ•´ä¸ªäº”ä¸€å‡æœŸéƒ½è¦ç”¨æ¥åšé¢è¯•ä»»åŠ¡ï¼Œé‚£æˆ‘å½“ç„¶å¿ƒç”˜æƒ…æ„¿ <del>å¾ˆä¸ä¹æ„</del> ã€‚åˆå› ä¸ºæƒ³è¦å¿«ç‚¹å……å®è‡ªå·±çš„åšå®¢ç„¶åæ‹¿å»å’Œæœ‹å‹ä»¬åˆ†äº«ï¼Œæ‰€ä»¥æƒ³åˆ°å¯ä»¥ç”¨è¿™ä¸ªåšå®¢æµ…ï¼ˆshenï¼‰æµ…ï¼ˆshenï¼‰è®°å½•ä¸€ä¸‹å­¦ä¹ è¿‡ç¨‹ã€‚ï¼ˆå’Œè§£é¢˜æ€è·¯ï¼Ÿè™½ç„¶é¢è¯•å¸ˆå‚…è¯´å¸ƒç½®çš„éƒ½æ˜¯ç®€å•åŸºç¡€é¢˜ï¼Œä½†æ˜¯å¯èƒ½å¯¹å°ç™½ <del>æŒ‡æˆ‘</del> æ¥è¯´è¿˜æ˜¯éœ€è¦ä¸€äº›æ€è€ƒçš„å§</p><p>è¯´åˆ°è¿™ä¸ªï¼Œæƒ³èµ·å»å¹´é¸½æ‰äº†äºŒé¢ï¼Œå½“æ—¶è™½ç„¶æƒ³è¿›åä¼šä½†æ˜¯è‡ªå·±æ˜¯ä¸ªæ‡’ç‹—<del>ï¼ˆå¯èƒ½ç°åœ¨ä¹Ÿæ˜¯ï¼‰</del>ï¼Œåæ¥é¢è¯•å¸ˆå‚…åˆšå¥½æ˜¯å¥½æœ‹å‹ï¼Œä¸€ç›´åœ¨å‚¬æˆ‘å­¦ç›¸å…³çŸ¥è¯†ï¼Œä¹Ÿå¾ˆæ„Ÿè°¢å¸ˆå‚…çš„æ“å¿ƒï¼ˆbushiï¼‰ï¼Œå¦‚æœåªæ˜¯è‡ªå·±ä¸€ä¸ªäººçš„è¯ï¼Œå¾ˆå¯èƒ½å°±ä¸ä¼šå†å»è¯•ç€å­¦ä¹ è¿™æ–¹é¢çš„ä¸œè¥¿æå‡è‡ªå·±äº†ã€‚</p><p>ä¸ç®¡ç»“æœæ€ä¹ˆæ ·ï¼Œå°±æ˜¯è¯´å¸Œæœ›è‡ªå·±è¿™æ¬¡å¯ä»¥å¥½å¥½å­¦å‡ å¤©ä¸œè¥¿ï¼Œç®—æ˜¯ç»™è‡ªå·±ä¸€ä¸ªäº¤ä»£å§ã€‚</p><p>å¯¹å’¯ï¼Œæ¥ä¸‹æ¥ tag:cryptohack åº•ä¸‹çš„æ–‡ç« éƒ½ä¼šæ˜¯ <a href="https://cryptohack.org/">cryptohack</a> ä¸Šçš„é¢˜ï¼Œå¦‚æœä½ ä¹Ÿæ˜¯å’Œæˆ‘ä¸€æ ·çš„å°ç™½ï¼Œä¹Ÿè®¸å¯ä»¥é€šè¿‡è¿™äº›æ–‡ç« å’Œæˆ‘ä¸€èµ·å­¦ä¹ å–”ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åˆšåˆšæ­å¥½åšå®¢ï¼Œæ¥æ°´ç¬¬ä¸€ç¯‡æ–‡ç« å’¯ï¼ï¼ˆbushi&lt;/p&gt;
    
    </summary>
    
      <category term="å­¦ä¹ " scheme="http://smilin9.com/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="cryptohack" scheme="http://smilin9.com/tags/cryptohack/"/>
    
      <category term="åƒåœ¾æ¡¶" scheme="http://smilin9.com/tags/%E5%9E%83%E5%9C%BE%E6%A1%B6/"/>
    
  </entry>
  
  <entry>
    <title>Hello Worldï¼</title>
    <link href="http://smilin9.com/2022/04/30/hello-world/"/>
    <id>http://smilin9.com/2022/04/30/hello-world/</id>
    <published>2022-04-30T07:30:00.000Z</published>
    <updated>2022-06-17T01:14:47.772Z</updated>
    
    <content type="html"><![CDATA[<p>æ¬¢è¿æ¥åˆ°æˆ‘çš„ Blogï¼è¿™æ˜¯æœ¬åšå®¢çš„ç¬¬ä¸€ç¯‡æ–‡ç« ã€‚</p><span id="more"></span><p>è¿™æ˜¯<del>è¶…å‰å®³çš„</del> smilin9 å†æ—¶ä¸¤å¤©ï¼ˆå…¶å®åŠ èµ·æ¥ä¸åˆ°ä¸€å¤©ï¼‰æ­å»ºçš„é™æ€åšå®¢ã€‚</p><p>éå¸¸æ„Ÿè°¢ <a href="https://hawa130.com/">hawa130</a> è€å¿ƒè§£ç­”æˆ‘çš„ä¸€ç³»åˆ—å‚»ç“œé—®é¢˜ã€‚</p><p>æ¬¢è¿äº¤æµå­¦ä¹ ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¬¢è¿æ¥åˆ°æˆ‘çš„ Blogï¼è¿™æ˜¯æœ¬åšå®¢çš„ç¬¬ä¸€ç¯‡æ–‡ç« ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="åƒåœ¾æ¡¶" scheme="http://smilin9.com/tags/%E5%9E%83%E5%9C%BE%E6%A1%B6/"/>
    
  </entry>
  
</feed>
